<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>INET Framework for OMNeT++/OMNEST: TCPDumper Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript">
$(document).ready(initResizable);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">INET Framework for OMNeT++/OMNEST</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('class_t_c_p_dumper.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="#pri-attribs">Private Attributes</a>  </div>
  <div class="headertitle">
<div class="title">TCPDumper Class Reference</div>  </div>
</div>
<div class="contents">
<!-- doxytag: class="TCPDumper" -->
<p><code>#include &lt;TCPDump.h&gt;</code></p>

<p><a href="class_t_c_p_dumper-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_c_p_dumper.html#afafd43a193f6e03d7815770131cbf1c6">TCPDumper</a> (std::ostream &amp;o)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_c_p_dumper.html#af5ca12c679ec1f262c145a397574708d">~TCPDumper</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_c_p_dumper.html#a6fccb0507cbb7ba38d1eba9b7c2523bb">setVerbosity</a> (const int32 verbosityLevel)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_c_p_dumper.html#a8fc2fe9f248124d89647f38a787e6c41">ipDump</a> (const char *label, IPDatagram *dgram, const char *comment=NULL)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_c_p_dumper.html#a9b424b32c950eef380e172b7f23808f3">sctpDump</a> (const char *label, <a class="el" href="class_s_c_t_p_message.html">SCTPMessage</a> *sctpmsg, const std::string &amp;srcAddr, const std::string &amp;destAddr, const char *comment=NULL)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_c_p_dumper.html#a1d37f218e819252c027368ef08a2220d">dump</a> (const char *label, const char *msg)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_c_p_dumper.html#a03e9cc1b3d71ebe68154d989a8b19476">tcpDump</a> (bool l2r, const char *label, IPDatagram *dgram, const char *comment=NULL)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_c_p_dumper.html#af74e04c18e244f24defa9f3cf87f6f9c">tcpDump</a> (bool l2r, const char *label, <a class="el" href="class_t_c_p_segment.html">TCPSegment</a> *tcpseg, const std::string &amp;srcAddr, const std::string &amp;destAddr, const char *comment=NULL)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_c_p_dumper.html#a754be936c3dc1a76c2e2a64879833e90">dumpIPv6</a> (bool l2r, const char *label, IPv6Datagram_Base *dgram, const char *comment=NULL)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_c_p_dumper.html#a734f25e12b7e32b04b7895fca3f0bd85">udpDump</a> (bool l2r, const char *label, IPDatagram *dgram, const char *comment)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_c_p_dumper.html#a7d5379ed750f858d72e4769fc4cde6c1">intToChunk</a> (int32 type)</td></tr>
<tr><td colspan="2"><h2><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">FILE *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_c_p_dumper.html#a419e96d410875d31fe2d7a1dec03b8fc">dumpfile</a></td></tr>
<tr><td colspan="2"><h2><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int32&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_c_p_dumper.html#adf96516a68506b6cce543912d6ea58ea">seq</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::ostream *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_c_p_dumper.html#a1ab7e43bb867592f56861effcb369e8c">outp</a></td></tr>
<tr><td colspan="2"><h2><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_c_p_dumper.html#a14d65f28ff5c5d7cc11e1837eadf0236">verbosity</a></td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>Dumps <a class="el" href="class_s_c_t_p.html">SCTP</a> packets in tcpdump format. </p>
</div><hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="afafd43a193f6e03d7815770131cbf1c6"></a><!-- doxytag: member="TCPDumper::TCPDumper" ref="afafd43a193f6e03d7815770131cbf1c6" args="(std::ostream &amp;o)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TCPDumper::TCPDumper </td>
          <td>(</td>
          <td class="paramtype">std::ostream &amp;&#160;</td>
          <td class="paramname"><em>o</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<div class="fragment"><pre class="fragment">{
     <a class="code" href="class_t_c_p_dumper.html#a1ab7e43bb867592f56861effcb369e8c">outp</a> = &amp;out;
}
</pre></div>
</div>
</div>
<a class="anchor" id="af5ca12c679ec1f262c145a397574708d"></a><!-- doxytag: member="TCPDumper::~TCPDumper" ref="af5ca12c679ec1f262c145a397574708d" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TCPDumper::~TCPDumper </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<div class="fragment"><pre class="fragment">{
}
</pre></div>
</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="a1d37f218e819252c027368ef08a2220d"></a><!-- doxytag: member="TCPDumper::dump" ref="a1d37f218e819252c027368ef08a2220d" args="(const char *label, const char *msg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TCPDumper::dump </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>label</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>msg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="class_t_c_p_dump.html#ad2c36cf696c676be6fd15b4eead2ecf4">TCPDump::finish()</a>.</p>
<div class="fragment"><pre class="fragment">{
     std::ostream&amp; out = *<a class="code" href="class_t_c_p_dumper.html#a1ab7e43bb867592f56861effcb369e8c">outp</a>;

     <span class="comment">// seq and time (not part of the tcpdump format)</span>
     <span class="keywordtype">char</span> buf[30];
     sprintf(buf,<span class="stringliteral">&quot;[%.3f%s] &quot;</span>, simulation.getSimTime().dbl(), label);
     out &lt;&lt; buf;

     out &lt;&lt; msg &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a754be936c3dc1a76c2e2a64879833e90"></a><!-- doxytag: member="TCPDumper::dumpIPv6" ref="a754be936c3dc1a76c2e2a64879833e90" args="(bool l2r, const char *label, IPv6Datagram_Base *dgram, const char *comment=NULL)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TCPDumper::dumpIPv6 </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>l2r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>label</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IPv6Datagram_Base *&#160;</td>
          <td class="paramname"><em>dgram</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>comment</em> = <code>NULL</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="class_t_c_p_dump.html#a6c6aae2b0258f57b57eef0ad10df6f5d">TCPDump::handleMessage()</a>.</p>
<div class="fragment"><pre class="fragment">{
     cMessage *encapmsg = dgram-&gt;getEncapsulatedPacket();
     <span class="keywordflow">if</span> (dynamic_cast&lt;TCPSegment *&gt;(encapmsg))
     {
          <span class="comment">// if TCP, dump as TCP</span>
          <a class="code" href="class_t_c_p_dumper.html#a03e9cc1b3d71ebe68154d989a8b19476">tcpDump</a>(l2r, label, (<a class="code" href="class_t_c_p_segment.html">TCPSegment</a> *)encapmsg, dgram-&gt;getSrcAddress().str(), dgram-&gt;getDestAddress().str(), comment);
     }
     <span class="keywordflow">else</span>
     {
          <span class="comment">// some other packet, dump what we can</span>
          std::ostream&amp; out = *<a class="code" href="class_t_c_p_dumper.html#a1ab7e43bb867592f56861effcb369e8c">outp</a>;

          <span class="comment">// seq and time (not part of the tcpdump format)</span>
          <span class="keywordtype">char</span> buf[30];
          sprintf(buf,<span class="stringliteral">&quot;[%.3f%s] &quot;</span>, SIMTIME_DBL(simTime()), label);
          out &lt;&lt; buf;

          <span class="comment">// packet class and name</span>
          out &lt;&lt; <span class="stringliteral">&quot;? &quot;</span> &lt;&lt; encapmsg-&gt;getClassName() &lt;&lt; <span class="stringliteral">&quot; \&quot;&quot;</span> &lt;&lt; encapmsg-&gt;getName() &lt;&lt; <span class="stringliteral">&quot;\&quot;\n&quot;</span>;
     }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a7d5379ed750f858d72e4769fc4cde6c1"></a><!-- doxytag: member="TCPDumper::intToChunk" ref="a7d5379ed750f858d72e4769fc4cde6c1" args="(int32 type)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char * TCPDumper::intToChunk </td>
          <td>(</td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>type</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<div class="fragment"><pre class="fragment">{
     <span class="keywordflow">switch</span> (type)
     {
          <span class="keywordflow">case</span> 0: <span class="keywordflow">return</span> <span class="stringliteral">&quot;DATA&quot;</span>;
          <span class="keywordflow">case</span> 1: <span class="keywordflow">return</span> <span class="stringliteral">&quot;INIT&quot;</span>;
          <span class="keywordflow">case</span> 2: <span class="keywordflow">return</span> <span class="stringliteral">&quot;INIT_ACK&quot;</span>;
          <span class="keywordflow">case</span> 3: <span class="keywordflow">return</span> <span class="stringliteral">&quot;SACK&quot;</span>;
          <span class="keywordflow">case</span> 4: <span class="keywordflow">return</span> <span class="stringliteral">&quot;HEARTBEAT&quot;</span>;
          <span class="keywordflow">case</span> 5: <span class="keywordflow">return</span> <span class="stringliteral">&quot;HEARTBEAT_ACK&quot;</span>;
          <span class="keywordflow">case</span> 6: <span class="keywordflow">return</span> <span class="stringliteral">&quot;ABORT&quot;</span>;
          <span class="keywordflow">case</span> 7: <span class="keywordflow">return</span> <span class="stringliteral">&quot;SHUTDOWN&quot;</span>;
          <span class="keywordflow">case</span> 8: <span class="keywordflow">return</span> <span class="stringliteral">&quot;SHUTDOWN_ACK&quot;</span>;
          <span class="keywordflow">case</span> 9: <span class="keywordflow">return</span> <span class="stringliteral">&quot;ERRORTYPE&quot;</span>;
          <span class="keywordflow">case</span> 10: <span class="keywordflow">return</span> <span class="stringliteral">&quot;COOKIE_ECHO&quot;</span>;
          <span class="keywordflow">case</span> 11: <span class="keywordflow">return</span> <span class="stringliteral">&quot;COOKIE_ACK&quot;</span>;
          <span class="keywordflow">case</span> 14: <span class="keywordflow">return</span> <span class="stringliteral">&quot;SHUTDOWN_COMPLETE&quot;</span>;
     }
     <span class="keywordflow">return</span> <span class="stringliteral">&quot;&quot;</span>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a8fc2fe9f248124d89647f38a787e6c41"></a><!-- doxytag: member="TCPDumper::ipDump" ref="a8fc2fe9f248124d89647f38a787e6c41" args="(const char *label, IPDatagram *dgram, const char *comment=NULL)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TCPDumper::ipDump </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>label</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IPDatagram *&#160;</td>
          <td class="paramname"><em>dgram</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>comment</em> = <code>NULL</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="class_t_c_p_dump.html#a6c6aae2b0258f57b57eef0ad10df6f5d">TCPDump::handleMessage()</a>.</p>
<div class="fragment"><pre class="fragment">{
     <span class="keywordflow">if</span> (dynamic_cast&lt;SCTPMessage *&gt;(dgram-&gt;getEncapsulatedPacket()))
     {
          <a class="code" href="class_s_c_t_p_message.html">SCTPMessage</a> *sctpmsg = check_and_cast&lt;<a class="code" href="class_s_c_t_p_message.html">SCTPMessage</a> *&gt;(dgram-&gt;getEncapsulatedPacket());
          <span class="keywordflow">if</span> (dgram-&gt;hasBitError())
                sctpmsg-&gt;setBitError(<span class="keyword">true</span>);
          <a class="code" href="class_t_c_p_dumper.html#a9b424b32c950eef380e172b7f23808f3">sctpDump</a>(label, sctpmsg, dgram-&gt;getSrcAddress().str(), dgram-&gt;getDestAddress().str(), comment);
     }
     <span class="keywordflow">else</span>
          <span class="keyword">delete</span> dgram;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a9b424b32c950eef380e172b7f23808f3"></a><!-- doxytag: member="TCPDumper::sctpDump" ref="a9b424b32c950eef380e172b7f23808f3" args="(const char *label, SCTPMessage *sctpmsg, const std::string &amp;srcAddr, const std::string &amp;destAddr, const char *comment=NULL)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TCPDumper::sctpDump </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>label</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_s_c_t_p_message.html">SCTPMessage</a> *&#160;</td>
          <td class="paramname"><em>sctpmsg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>srcAddr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>destAddr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>comment</em> = <code>NULL</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="class_t_c_p_dump.html#a6c6aae2b0258f57b57eef0ad10df6f5d">TCPDump::handleMessage()</a>, <a class="el" href="class_t_c_p_dumper.html#a8fc2fe9f248124d89647f38a787e6c41">ipDump()</a>, and <a class="el" href="class_t_c_p_dumper.html#a734f25e12b7e32b04b7895fca3f0bd85">udpDump()</a>.</p>
<div class="fragment"><pre class="fragment">{
     std::ostream&amp; out = *<a class="code" href="class_t_c_p_dumper.html#a1ab7e43bb867592f56861effcb369e8c">outp</a>;
     uint32 numberOfChunks;
     SCTPChunk* <a class="code" href="structchunk.html">chunk</a>;
     uint8 type;
     <span class="comment">// seq and time (not part of the tcpdump format)</span>
     <span class="keywordtype">char</span> buf[30];
     sprintf(buf,<span class="stringliteral">&quot;[%.3f%s] &quot;</span>, simulation.getSimTime().dbl(), label);
     out &lt;&lt; buf;

     <span class="comment">// src/dest</span>
     out &lt;&lt; srcAddr  &lt;&lt; <span class="stringliteral">&quot;.&quot;</span> &lt;&lt; sctpmsg-&gt;getSrcPort()  &lt;&lt; <span class="stringliteral">&quot; &gt; &quot;</span>;

     out &lt;&lt; destAddr &lt;&lt; <span class="stringliteral">&quot;.&quot;</span> &lt;&lt; sctpmsg-&gt;getDestPort() &lt;&lt; <span class="stringliteral">&quot;: &quot;</span>;
     <span class="keywordflow">if</span> (sctpmsg-&gt;hasBitError())
     {
          sctpmsg-&gt;setChecksumOk(<span class="keyword">false</span>);
     }
     numberOfChunks = sctpmsg-&gt;<a class="code" href="class_s_c_t_p_message.html#a6f20de2280586794996c56c77bf5c479">getChunksArraySize</a>();
     out &lt;&lt; <span class="stringliteral">&quot;numberOfChunks=&quot;</span>&lt;&lt;numberOfChunks&lt;&lt;<span class="stringliteral">&quot; VTag=&quot;</span>&lt;&lt;sctpmsg-&gt;getTag()&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;
     <span class="keywordflow">if</span> (sctpmsg-&gt;hasBitError())
          out &lt;&lt; <span class="stringliteral">&quot;Packet has bit error!!\n&quot;</span>;
     <span class="keywordflow">for</span> (uint32 i=0; i&lt;numberOfChunks; i++)
     {
          chunk = (SCTPChunk*)sctpmsg-&gt;<a class="code" href="class_s_c_t_p_message.html#a3fee5bba66df88a7771c3b5984f33008">getChunks</a>(i);
          type  = chunk-&gt;getChunkType();
          <span class="keywordflow">switch</span> (type)
          {
                <span class="keywordflow">case</span> <a class="code" href="_s_c_t_p_association_8h.html#a8886377ab3f4b4ef217558f2b83b7b12a0cb1b2c6a7db1f1084886c98909a3f36">INIT</a>:
                     out &lt;&lt; <span class="stringliteral">&quot;INIT &quot;</span>;
                     <span class="keywordflow">break</span>;
                <span class="keywordflow">case</span> <a class="code" href="_s_c_t_p_association_8h.html#a8886377ab3f4b4ef217558f2b83b7b12abb473557985d30fdf16d2525388e3a22">INIT_ACK</a>:
                     out &lt;&lt; <span class="stringliteral">&quot;INIT_ACK &quot;</span>;
                     <span class="keywordflow">break</span>;
                <span class="keywordflow">case</span> <a class="code" href="_s_c_t_p_association_8h.html#a8886377ab3f4b4ef217558f2b83b7b12ac6c3901afa866152be0e645c2c38f471">COOKIE_ECHO</a>:
                     out &lt;&lt; <span class="stringliteral">&quot;COOKIE_ECHO &quot;</span>;
                     <span class="keywordflow">break</span>;
                <span class="keywordflow">case</span> <a class="code" href="_s_c_t_p_association_8h.html#a8886377ab3f4b4ef217558f2b83b7b12a8cb5544ff09ee0b2ae1f1171de9597bd">COOKIE_ACK</a>:
                     out &lt;&lt; <span class="stringliteral">&quot;COOKIE_ACK &quot;</span>;
                     <span class="keywordflow">break</span>;
                <span class="keywordflow">case</span> <a class="code" href="_consts80211_8h.html#ad70ed57eb996b190fc586f309107250ea9d7d6f31868d66330397c967c4afd2d2">DATA</a>:
                     out &lt;&lt; <span class="stringliteral">&quot;DATA &quot;</span>;
                     <span class="keywordflow">break</span>;
                <span class="keywordflow">case</span> <a class="code" href="_s_c_t_p_association_8h.html#a8886377ab3f4b4ef217558f2b83b7b12a689bf9c7470080fd0180eb7f5c293bd4">SACK</a>:
                     out &lt;&lt; <span class="stringliteral">&quot;SACK &quot;</span>;
                     <span class="keywordflow">break</span>;
                <span class="keywordflow">case</span> <a class="code" href="_s_c_t_p_association_8h.html#a8886377ab3f4b4ef217558f2b83b7b12a0f286b0bbc1ee4f20be5136a55cf8923">HEARTBEAT</a>:
                     out &lt;&lt; <span class="stringliteral">&quot;HEARTBEAT &quot;</span>;
                     <span class="keywordflow">break</span>;
                <span class="keywordflow">case</span> <a class="code" href="_s_c_t_p_association_8h.html#a8886377ab3f4b4ef217558f2b83b7b12a5621dd83f6f32ee90c0d505867c67b71">HEARTBEAT_ACK</a>:
                     out &lt;&lt; <span class="stringliteral">&quot;HEARTBEAT_ACK &quot;</span>;
                     <span class="keywordflow">break</span>;
                <span class="keywordflow">case</span> <a class="code" href="_s_c_t_p_association_8h.html#a8886377ab3f4b4ef217558f2b83b7b12a781ad2788df9e25c59a70894c7832096">ABORT</a>:
                     out &lt;&lt; <span class="stringliteral">&quot;ABORT &quot;</span>;
                     <span class="keywordflow">break</span>;
                <span class="keywordflow">case</span> <a class="code" href="_s_c_t_p_association_8h.html#a8886377ab3f4b4ef217558f2b83b7b12a7690b021f467450541d8d89123429d40">SHUTDOWN</a>:
                     out &lt;&lt; <span class="stringliteral">&quot;SHUTDOWN &quot;</span>;
                     <span class="keywordflow">break</span>;
                <span class="keywordflow">case</span> <a class="code" href="_s_c_t_p_association_8h.html#a8886377ab3f4b4ef217558f2b83b7b12a7f11b152058ba8f4656266d735a50c4b">SHUTDOWN_ACK</a>:
                     out &lt;&lt; <span class="stringliteral">&quot;SHUTDOWN_ACK &quot;</span>;
                     <span class="keywordflow">break</span>;
                <span class="keywordflow">case</span> <a class="code" href="_s_c_t_p_association_8h.html#a8886377ab3f4b4ef217558f2b83b7b12a1ac9ae29771c5095efe16ce822d561d7">SHUTDOWN_COMPLETE</a>:
                     out &lt;&lt; <span class="stringliteral">&quot;SHUTDOWN_COMPLETE &quot;</span>;
                     <span class="keywordflow">break</span>;
                <span class="keywordflow">case</span> <a class="code" href="_s_c_t_p_association_8h.html#a8886377ab3f4b4ef217558f2b83b7b12a511842f389362e9f11f52a88556455f1">ERRORTYPE</a>:
                     out &lt;&lt; <span class="stringliteral">&quot;ERROR&quot;</span>;
                     <span class="keywordflow">break</span>;

          }
     }

     <span class="keywordflow">if</span> (<a class="code" href="class_t_c_p_dumper.html#a14d65f28ff5c5d7cc11e1837eadf0236">verbosity</a> &gt;= 1)
     {
          out &lt;&lt; endl;
          <span class="keywordflow">for</span> (uint32 i=0; i&lt;numberOfChunks; i++)
          {
                chunk = (SCTPChunk*)sctpmsg-&gt;<a class="code" href="class_s_c_t_p_message.html#a3fee5bba66df88a7771c3b5984f33008">getChunks</a>(i);
                type    = chunk-&gt;getChunkType();

                sprintf(buf,  <span class="stringliteral">&quot;   %3u: &quot;</span>, i + 1);
                out &lt;&lt; buf;
                <span class="keywordflow">switch</span> (type)
                {
                     <span class="keywordflow">case</span> <a class="code" href="_s_c_t_p_association_8h.html#a8886377ab3f4b4ef217558f2b83b7b12a0cb1b2c6a7db1f1084886c98909a3f36">INIT</a>:
                     {
                          SCTPInitChunk* initChunk;
                          initChunk = check_and_cast&lt;SCTPInitChunk *&gt;(chunk);
                          out &lt;&lt; <span class="stringliteral">&quot;INIT[InitiateTag=&quot;</span>;
                          out &lt;&lt; initChunk-&gt;getInitTag();
                          out &lt;&lt; <span class="stringliteral">&quot;; a_rwnd=&quot;</span>;
                          out &lt;&lt; initChunk-&gt;getA_rwnd();
                          out &lt;&lt; <span class="stringliteral">&quot;; OS=&quot;</span>;
                          out &lt;&lt; initChunk-&gt;getNoOutStreams();
                          out &lt;&lt; <span class="stringliteral">&quot;; IS=&quot;</span>;
                          out &lt;&lt; initChunk-&gt;getNoInStreams();
                          out &lt;&lt; <span class="stringliteral">&quot;; InitialTSN=&quot;</span>;
                          out &lt;&lt; initChunk-&gt;getInitTSN();
                          <span class="keywordflow">if</span> (initChunk-&gt;getAddressesArraySize() &gt; 0)
                          {
                                out &lt;&lt;<span class="stringliteral">&quot;; Addresses=&quot;</span>;
                                <span class="keywordflow">for</span> (uint32 i = 0; i &lt; initChunk-&gt;getAddressesArraySize(); i++)
                                {
                                     <span class="keywordflow">if</span> (i &gt; 0)
                                          out &lt;&lt; <span class="stringliteral">&quot;,&quot;</span>;
                                     <span class="keywordflow">if</span> (initChunk-&gt;getAddresses(i).isIPv6())
                                          out &lt;&lt; initChunk-&gt;getAddresses(i).str();
                                     <span class="keywordflow">else</span>
                                          out &lt;&lt; initChunk-&gt;getAddresses(i);
                                }
                          }

                          out &lt;&lt;<span class="stringliteral">&quot;]&quot;</span>;
                          <span class="keywordflow">break</span>;
                     }
                     <span class="keywordflow">case</span> <a class="code" href="_s_c_t_p_association_8h.html#a8886377ab3f4b4ef217558f2b83b7b12abb473557985d30fdf16d2525388e3a22">INIT_ACK</a>:
                     {
                          SCTPInitAckChunk* initackChunk;
                          initackChunk = check_and_cast&lt;SCTPInitAckChunk *&gt;(chunk);
                          out &lt;&lt; <span class="stringliteral">&quot;INIT_ACK[InitiateTag=&quot;</span>;
                          out &lt;&lt; initackChunk-&gt;getInitTag();
                          out &lt;&lt; <span class="stringliteral">&quot;; a_rwnd=&quot;</span>;
                          out &lt;&lt; initackChunk-&gt;getA_rwnd();
                          out &lt;&lt; <span class="stringliteral">&quot;; OS=&quot;</span>;
                          out &lt;&lt; initackChunk-&gt;getNoOutStreams();
                          out &lt;&lt; <span class="stringliteral">&quot;; IS=&quot;</span>;
                          out &lt;&lt; initackChunk-&gt;getNoInStreams();
                          out &lt;&lt; <span class="stringliteral">&quot;; InitialTSN=&quot;</span>;
                          out &lt;&lt; initackChunk-&gt;getInitTSN();
                          out &lt;&lt; <span class="stringliteral">&quot;; CookieLength=&quot;</span>;
                          out &lt;&lt; initackChunk-&gt;getCookieArraySize();
                          <span class="keywordflow">if</span> (initackChunk-&gt;getAddressesArraySize() &gt; 0)
                          {
                                out &lt;&lt;<span class="stringliteral">&quot;; Addresses=&quot;</span>;
                                <span class="keywordflow">for</span> (uint32 i = 0; i &lt; initackChunk-&gt;getAddressesArraySize(); i++)
                                {
                                     <span class="keywordflow">if</span> (i &gt; 0)
                                          out &lt;&lt; <span class="stringliteral">&quot;,&quot;</span>;
                                     out &lt;&lt; initackChunk-&gt;getAddresses(i);
                                }
                          }
                          out &lt;&lt;<span class="stringliteral">&quot;]&quot;</span>;
                          <span class="keywordflow">break</span>;
                     }
                     <span class="keywordflow">case</span> <a class="code" href="_s_c_t_p_association_8h.html#a8886377ab3f4b4ef217558f2b83b7b12ac6c3901afa866152be0e645c2c38f471">COOKIE_ECHO</a>:
                          out &lt;&lt; <span class="stringliteral">&quot;COOKIE_ECHO[CookieLength=&quot;</span>;
                          out &lt;&lt;     chunk-&gt;getBitLength()/8 - 4;
                          out &lt;&lt;<span class="stringliteral">&quot;]&quot;</span>;
                          <span class="keywordflow">break</span>;
                     <span class="keywordflow">case</span> <a class="code" href="_s_c_t_p_association_8h.html#a8886377ab3f4b4ef217558f2b83b7b12a8cb5544ff09ee0b2ae1f1171de9597bd">COOKIE_ACK</a>:
                          out &lt;&lt; <span class="stringliteral">&quot;COOKIE_ACK &quot;</span>;
                          <span class="keywordflow">break</span>;
                     <span class="keywordflow">case</span> <a class="code" href="_consts80211_8h.html#ad70ed57eb996b190fc586f309107250ea9d7d6f31868d66330397c967c4afd2d2">DATA</a>:
                     {
                          SCTPDataChunk* dataChunk;
                          dataChunk = check_and_cast&lt;SCTPDataChunk *&gt;(chunk);
                          out &lt;&lt; <span class="stringliteral">&quot;DATA[TSN=&quot;</span>;
                          out &lt;&lt; dataChunk-&gt;getTsn();
                          out &lt;&lt; <span class="stringliteral">&quot;; SID=&quot;</span>;
                          out &lt;&lt; dataChunk-&gt;getSid();
                          out &lt;&lt; <span class="stringliteral">&quot;; SSN=&quot;</span>;
                          out &lt;&lt; dataChunk-&gt;getSsn();
                          out &lt;&lt; <span class="stringliteral">&quot;; PPID=&quot;</span>;
                          out &lt;&lt; dataChunk-&gt;getPpid();
                          out &lt;&lt; <span class="stringliteral">&quot;; PayloadLength=&quot;</span>;
                          out &lt;&lt; dataChunk-&gt;getBitLength()/8 - 16;
                          out &lt;&lt;<span class="stringliteral">&quot;]&quot;</span>;
                          <span class="keywordflow">break</span>;
                     }
                     <span class="keywordflow">case</span> <a class="code" href="_s_c_t_p_association_8h.html#a8886377ab3f4b4ef217558f2b83b7b12a689bf9c7470080fd0180eb7f5c293bd4">SACK</a>:
                     {
                          SCTPSackChunk* sackChunk;
                          sackChunk = check_and_cast&lt;SCTPSackChunk *&gt;(chunk);
                          out &lt;&lt; <span class="stringliteral">&quot;SACK[CumTSNAck=&quot;</span>;
                          out &lt;&lt; sackChunk-&gt;getCumTsnAck();
                          out &lt;&lt; <span class="stringliteral">&quot;; a_rwnd=&quot;</span>;
                          out &lt;&lt; sackChunk-&gt;getA_rwnd();
                          <span class="keywordflow">if</span> (sackChunk-&gt;getGapStartArraySize() &gt; 0)
                          {
                                out &lt;&lt;<span class="stringliteral">&quot;; Gaps=&quot;</span>;
                                <span class="keywordflow">for</span> (uint32 i = 0; i &lt; sackChunk-&gt;getGapStartArraySize(); i++)
                                {
                                     <span class="keywordflow">if</span> (i &gt; 0)
                                          out &lt;&lt; <span class="stringliteral">&quot;, &quot;</span>;
                                     out &lt;&lt; sackChunk-&gt;getGapStart(i) &lt;&lt; <span class="stringliteral">&quot;-&quot;</span> &lt;&lt; sackChunk-&gt;getGapStop(i);
                                }
                          }
                          <span class="keywordflow">if</span> (sackChunk-&gt;getDupTsnsArraySize() &gt; 0)
                          {
                                out &lt;&lt;<span class="stringliteral">&quot;; Dups=&quot;</span>;
                                <span class="keywordflow">for</span> (uint32 i = 0; i &lt; sackChunk-&gt;getDupTsnsArraySize(); i++)
                                {
                                     <span class="keywordflow">if</span> (i &gt; 0)
                                          out &lt;&lt; <span class="stringliteral">&quot;, &quot;</span>;
                                     out &lt;&lt; sackChunk-&gt;getDupTsns(i);
                                }
                          }
                          out &lt;&lt;<span class="stringliteral">&quot;]&quot;</span>;
                          <span class="keywordflow">break</span>;
                     }
                     <span class="keywordflow">case</span> <a class="code" href="_s_c_t_p_association_8h.html#a8886377ab3f4b4ef217558f2b83b7b12a0f286b0bbc1ee4f20be5136a55cf8923">HEARTBEAT</a>:
                          SCTPHeartbeatChunk* heartbeatChunk;
                          heartbeatChunk = check_and_cast&lt;SCTPHeartbeatChunk *&gt;(chunk);
                          out &lt;&lt; <span class="stringliteral">&quot;HEARTBEAT[InfoLength=&quot;</span>;
                          out &lt;&lt;     chunk-&gt;getBitLength()/8 - 4;
                          out &lt;&lt; <span class="stringliteral">&quot;; time=&quot;</span>;
                          out &lt;&lt; heartbeatChunk-&gt;getTimeField();
                          out &lt;&lt;<span class="stringliteral">&quot;]&quot;</span>;
                          <span class="keywordflow">break</span>;
                     <span class="keywordflow">case</span> <a class="code" href="_s_c_t_p_association_8h.html#a8886377ab3f4b4ef217558f2b83b7b12a5621dd83f6f32ee90c0d505867c67b71">HEARTBEAT_ACK</a>:
                          out &lt;&lt; <span class="stringliteral">&quot;HEARTBEAT_ACK[InfoLength=&quot;</span>;
                          out &lt;&lt;     chunk-&gt;getBitLength()/8 - 4;
                          out &lt;&lt;<span class="stringliteral">&quot;]&quot;</span>;
                          <span class="keywordflow">break</span>;
                     <span class="keywordflow">case</span> <a class="code" href="_s_c_t_p_association_8h.html#a8886377ab3f4b4ef217558f2b83b7b12a781ad2788df9e25c59a70894c7832096">ABORT</a>:
                          SCTPAbortChunk* abortChunk;
                          abortChunk = check_and_cast&lt;SCTPAbortChunk *&gt;(chunk);
                          out &lt;&lt; <span class="stringliteral">&quot;ABORT[T-Bit=&quot;</span>;
                          out &lt;&lt; abortChunk-&gt;getT_Bit();
                          out &lt;&lt; <span class="stringliteral">&quot;]&quot;</span>;
                          <span class="keywordflow">break</span>;
                     <span class="keywordflow">case</span> <a class="code" href="_s_c_t_p_association_8h.html#a8886377ab3f4b4ef217558f2b83b7b12a7690b021f467450541d8d89123429d40">SHUTDOWN</a>:
                          SCTPShutdownChunk* shutdown;
                          shutdown = check_and_cast&lt;SCTPShutdownChunk *&gt;(chunk);
                          out &lt;&lt; <span class="stringliteral">&quot;SHUTDOWN[CumTSNAck=&quot;</span>;
                          out &lt;&lt; shutdown-&gt;getCumTsnAck();
                          out &lt;&lt; <span class="stringliteral">&quot;]&quot;</span>;
                          <span class="keywordflow">break</span>;
                     <span class="keywordflow">case</span> <a class="code" href="_s_c_t_p_association_8h.html#a8886377ab3f4b4ef217558f2b83b7b12a7f11b152058ba8f4656266d735a50c4b">SHUTDOWN_ACK</a>:
                          out &lt;&lt; <span class="stringliteral">&quot;SHUTDOWN_ACK &quot;</span>;
                          <span class="keywordflow">break</span>;
                     <span class="keywordflow">case</span> <a class="code" href="_s_c_t_p_association_8h.html#a8886377ab3f4b4ef217558f2b83b7b12a1ac9ae29771c5095efe16ce822d561d7">SHUTDOWN_COMPLETE</a>:
                          out &lt;&lt; <span class="stringliteral">&quot;SHUTDOWN_COMPLETE &quot;</span>;
                          <span class="keywordflow">break</span>;
                     <span class="keywordflow">case</span> <a class="code" href="_s_c_t_p_association_8h.html#a8886377ab3f4b4ef217558f2b83b7b12a511842f389362e9f11f52a88556455f1">ERRORTYPE</a>:
                     {
                          <a class="code" href="class_s_c_t_p_error_chunk.html">SCTPErrorChunk</a>* errorChunk;
                          errorChunk = check_and_cast&lt;<a class="code" href="class_s_c_t_p_error_chunk.html">SCTPErrorChunk</a>*&gt;(chunk);
                          uint32 numberOfParameters = errorChunk-&gt;<a class="code" href="class_s_c_t_p_error_chunk.html#a7b3588b447bfe205e5ef507e509e5ff0">getParametersArraySize</a>();
                          uint32 parameterType;
                          <span class="keywordflow">for</span> (uint32 i=0; i&lt;numberOfParameters; i++)
                          {
                                SCTPParameter* param = (SCTPParameter*)errorChunk-&gt;<a class="code" href="class_s_c_t_p_error_chunk.html#a6aa4518527f7ac33f91ac89a6537cc4f">getParameters</a>(i);
                                parameterType   = param-&gt;getParameterType();
                          }

                          <span class="keywordflow">break</span>;
                     }

                }
                out &lt;&lt; endl;
          }
     }
     <span class="comment">// comment</span>
     <span class="keywordflow">if</span> (comment)
          out &lt;&lt; <span class="stringliteral">&quot;# &quot;</span> &lt;&lt; comment;

     out &lt;&lt; endl;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a6fccb0507cbb7ba38d1eba9b7c2523bb"></a><!-- doxytag: member="TCPDumper::setVerbosity" ref="a6fccb0507cbb7ba38d1eba9b7c2523bb" args="(const int32 verbosityLevel)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TCPDumper::setVerbosity </td>
          <td>(</td>
          <td class="paramtype">const int32&#160;</td>
          <td class="paramname"><em>verbosityLevel</em></td><td>)</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="class_t_c_p_dump.html#a99ea2e21ea0ef5af65258834540d73ef">TCPDump::initialize()</a>.</p>
<div class="fragment"><pre class="fragment">                                                             {
            <a class="code" href="class_t_c_p_dumper.html#a14d65f28ff5c5d7cc11e1837eadf0236">verbosity</a> = verbosityLevel;
        }
</pre></div>
</div>
</div>
<a class="anchor" id="a03e9cc1b3d71ebe68154d989a8b19476"></a><!-- doxytag: member="TCPDumper::tcpDump" ref="a03e9cc1b3d71ebe68154d989a8b19476" args="(bool l2r, const char *label, IPDatagram *dgram, const char *comment=NULL)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TCPDumper::tcpDump </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>l2r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>label</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IPDatagram *&#160;</td>
          <td class="paramname"><em>dgram</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>comment</em> = <code>NULL</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="class_t_c_p_dumper.html#a754be936c3dc1a76c2e2a64879833e90">dumpIPv6()</a>, and <a class="el" href="class_t_c_p_dump.html#a6c6aae2b0258f57b57eef0ad10df6f5d">TCPDump::handleMessage()</a>.</p>
<div class="fragment"><pre class="fragment">{
     cMessage *encapmsg = dgram-&gt;getEncapsulatedPacket();
     <span class="keywordflow">if</span> (dynamic_cast&lt;TCPSegment *&gt;(encapmsg))
     {
          <span class="comment">// if TCP, dump as TCP</span>
          <a class="code" href="class_t_c_p_dumper.html#a03e9cc1b3d71ebe68154d989a8b19476">tcpDump</a>(l2r, label, (<a class="code" href="class_t_c_p_segment.html">TCPSegment</a> *)encapmsg, dgram-&gt;getSrcAddress().str(), dgram-&gt;getDestAddress().str(), comment);
     }
     <span class="keywordflow">else</span>
     {
          <span class="comment">// some other packet, dump what we can</span>
          std::ostream&amp; out = *<a class="code" href="class_t_c_p_dumper.html#a1ab7e43bb867592f56861effcb369e8c">outp</a>;

          <span class="comment">// seq and time (not part of the tcpdump format)</span>
          <span class="keywordtype">char</span> buf[30];
          sprintf(buf,<span class="stringliteral">&quot;[%.3f%s] &quot;</span>, SIMTIME_DBL(simTime()), label);
          out &lt;&lt; buf;

          <span class="comment">// packet class and name</span>
          out &lt;&lt; <span class="stringliteral">&quot;? &quot;</span> &lt;&lt; encapmsg-&gt;getClassName() &lt;&lt; <span class="stringliteral">&quot; \&quot;&quot;</span> &lt;&lt; encapmsg-&gt;getName() &lt;&lt; <span class="stringliteral">&quot;\&quot;\n&quot;</span>;
     }
}
</pre></div>
</div>
</div>
<a class="anchor" id="af74e04c18e244f24defa9f3cf87f6f9c"></a><!-- doxytag: member="TCPDumper::tcpDump" ref="af74e04c18e244f24defa9f3cf87f6f9c" args="(bool l2r, const char *label, TCPSegment *tcpseg, const std::string &amp;srcAddr, const std::string &amp;destAddr, const char *comment=NULL)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TCPDumper::tcpDump </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>l2r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>label</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_t_c_p_segment.html">TCPSegment</a> *&#160;</td>
          <td class="paramname"><em>tcpseg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>srcAddr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>destAddr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>comment</em> = <code>NULL</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<div class="fragment"><pre class="fragment">{
     std::ostream&amp; out = *<a class="code" href="class_t_c_p_dumper.html#a1ab7e43bb867592f56861effcb369e8c">outp</a>;

    <span class="comment">// seq and time (not part of the tcpdump format)</span>
    <span class="keywordtype">char</span> buf[30];
    sprintf(buf,<span class="stringliteral">&quot;[%.3f%s] &quot;</span>, SIMTIME_DBL(simTime()), label);
    out &lt;&lt; buf;
    <span class="comment">// src/dest ports</span>
    <span class="keywordflow">if</span> (l2r)
    {
        out &lt;&lt; srcAddr &lt;&lt; <span class="stringliteral">&quot;.&quot;</span> &lt;&lt; tcpseg-&gt;getSrcPort() &lt;&lt; <span class="stringliteral">&quot; &gt; &quot;</span>;
        out &lt;&lt; destAddr &lt;&lt; <span class="stringliteral">&quot;.&quot;</span> &lt;&lt; tcpseg-&gt;getDestPort() &lt;&lt; <span class="stringliteral">&quot;: &quot;</span>;
    }
    <span class="keywordflow">else</span>
    {
        out &lt;&lt; destAddr &lt;&lt; <span class="stringliteral">&quot;.&quot;</span> &lt;&lt; tcpseg-&gt;getDestPort() &lt;&lt; <span class="stringliteral">&quot; &lt; &quot;</span>;
        out &lt;&lt; srcAddr &lt;&lt; <span class="stringliteral">&quot;.&quot;</span> &lt;&lt; tcpseg-&gt;getSrcPort() &lt;&lt; <span class="stringliteral">&quot;: &quot;</span>;
    }

    <span class="comment">// flags</span>
    <span class="keywordtype">bool</span> flags = <span class="keyword">false</span>;
    <span class="keywordflow">if</span> (tcpseg-&gt;getUrgBit()) {flags=<span class="keyword">true</span>; out &lt;&lt; <span class="stringliteral">&quot;U &quot;</span>;}
    <span class="keywordflow">if</span> (tcpseg-&gt;getAckBit()) {flags=<span class="keyword">true</span>; out &lt;&lt; <span class="stringliteral">&quot;A &quot;</span>;}
    <span class="keywordflow">if</span> (tcpseg-&gt;getPshBit()) {flags=<span class="keyword">true</span>; out &lt;&lt; <span class="stringliteral">&quot;P &quot;</span>;}
    <span class="keywordflow">if</span> (tcpseg-&gt;getRstBit()) {flags=<span class="keyword">true</span>; out &lt;&lt; <span class="stringliteral">&quot;R &quot;</span>;}
    <span class="keywordflow">if</span> (tcpseg-&gt;getSynBit()) {flags=<span class="keyword">true</span>; out &lt;&lt; <span class="stringliteral">&quot;S &quot;</span>;}
    <span class="keywordflow">if</span> (tcpseg-&gt;getFinBit()) {flags=<span class="keyword">true</span>; out &lt;&lt; <span class="stringliteral">&quot;F &quot;</span>;}
    <span class="keywordflow">if</span> (!flags) {out &lt;&lt; <span class="stringliteral">&quot;. &quot;</span>;}

    <span class="comment">// data-seqno</span>
    <span class="keywordflow">if</span> (tcpseg-&gt;getPayloadLength()&gt;0 || tcpseg-&gt;getSynBit())
    {
        out &lt;&lt; tcpseg-&gt;getSequenceNo() &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; tcpseg-&gt;getSequenceNo()+tcpseg-&gt;getPayloadLength();
        out &lt;&lt; <span class="stringliteral">&quot;(&quot;</span> &lt;&lt; tcpseg-&gt;getPayloadLength() &lt;&lt; <span class="stringliteral">&quot;) &quot;</span>;
    }

    <span class="comment">// ack</span>
    <span class="keywordflow">if</span> (tcpseg-&gt;getAckBit())
        out &lt;&lt; <span class="stringliteral">&quot;ack &quot;</span> &lt;&lt; tcpseg-&gt;getAckNo() &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;

    <span class="comment">// window</span>
    out &lt;&lt; <span class="stringliteral">&quot;win &quot;</span> &lt;&lt; tcpseg-&gt;getWindow() &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;

    <span class="comment">// urgent</span>
    <span class="keywordflow">if</span> (tcpseg-&gt;getUrgBit())
        out &lt;&lt; <span class="stringliteral">&quot;urg &quot;</span> &lt;&lt; tcpseg-&gt;getUrgentPointer() &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;

    <span class="comment">// options present?</span>
    <span class="keywordflow">if</span> (tcpseg-&gt;getHeaderLength() &gt; 20)
        {
        std::string direction = <span class="stringliteral">&quot;sent&quot;</span>;
        <span class="keywordflow">if</span> (l2r) <span class="comment">// change direction</span>
            {direction = <span class="stringliteral">&quot;received&quot;</span>;}

        <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> numOptions = tcpseg-&gt;getOptionsArraySize();
        out &lt;&lt; <span class="stringliteral">&quot;\nTCP Header Option(s) &quot;</span> &lt;&lt; direction &lt;&lt; <span class="stringliteral">&quot;:\n&quot;</span>;
        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;numOptions; i++)
        {
            TCPOption option = tcpseg-&gt;getOptions(i);
            <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> kind = option.getKind();
            <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> length = option.getLength();
            out &lt;&lt; (i+1) &lt;&lt; <span class="stringliteral">&quot;. option kind=&quot;</span> &lt;&lt; kind &lt;&lt; <span class="stringliteral">&quot; length=&quot;</span> &lt;&lt; length &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;
        }
    }

    <span class="comment">// comment</span>
    <span class="keywordflow">if</span> (comment)
        out &lt;&lt; <span class="stringliteral">&quot;# &quot;</span> &lt;&lt; comment;

     out &lt;&lt; endl;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a734f25e12b7e32b04b7895fca3f0bd85"></a><!-- doxytag: member="TCPDumper::udpDump" ref="a734f25e12b7e32b04b7895fca3f0bd85" args="(bool l2r, const char *label, IPDatagram *dgram, const char *comment)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TCPDumper::udpDump </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>l2r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>label</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IPDatagram *&#160;</td>
          <td class="paramname"><em>dgram</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>comment</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="class_t_c_p_dump.html#a6c6aae2b0258f57b57eef0ad10df6f5d">TCPDump::handleMessage()</a>.</p>
<div class="fragment"><pre class="fragment">{
    cMessage *encapmsg = dgram-&gt;getEncapsulatedPacket();
    <span class="keywordflow">if</span> (dynamic_cast&lt;UDPPacket *&gt;(encapmsg))
    {
        std::ostream&amp; out = *<a class="code" href="class_t_c_p_dumper.html#a1ab7e43bb867592f56861effcb369e8c">outp</a>;

        <span class="comment">// seq and time (not part of the tcpdump format)</span>
        <span class="keywordtype">char</span> buf[30];
        sprintf(buf,<span class="stringliteral">&quot;[%.3f%s] &quot;</span>, simulation.getSimTime().dbl(), label);
        out &lt;&lt; buf;
        UDPPacket* udppkt = check_and_cast&lt;UDPPacket*&gt;(encapmsg);

        <span class="comment">// src/dest</span>
        <span class="keywordflow">if</span> (l2r)
        {
            out &lt;&lt; dgram-&gt;getSrcAddress().str() &lt;&lt; <span class="stringliteral">&quot;.&quot;</span> &lt;&lt; udppkt-&gt;getSourcePort() &lt;&lt; <span class="stringliteral">&quot; &gt; &quot;</span>;
            out &lt;&lt; dgram-&gt;getDestAddress().str() &lt;&lt; <span class="stringliteral">&quot;.&quot;</span> &lt;&lt; udppkt-&gt;getDestinationPort() &lt;&lt; <span class="stringliteral">&quot;: &quot;</span>;
        }
        <span class="keywordflow">else</span>
        {
            out &lt;&lt; dgram-&gt;getDestAddress().str() &lt;&lt; <span class="stringliteral">&quot;.&quot;</span> &lt;&lt; udppkt-&gt;getDestinationPort() &lt;&lt; <span class="stringliteral">&quot; &lt; &quot;</span>;
            out &lt;&lt; dgram-&gt;getSrcAddress().str() &lt;&lt; <span class="stringliteral">&quot;.&quot;</span> &lt;&lt; udppkt-&gt;getSourcePort() &lt;&lt; <span class="stringliteral">&quot;: &quot;</span>;
        }

        <span class="comment">//out &lt;&lt; endl;</span>
        out &lt;&lt; <span class="stringliteral">&quot;UDP: Payload length=&quot;</span> &lt;&lt; udppkt-&gt;getByteLength()-8 &lt;&lt; endl;
        <span class="keywordflow">if</span> (udppkt-&gt;getSourcePort()==9899 || udppkt-&gt;getDestinationPort() == 9899)
        {
            <span class="keywordflow">if</span> (dynamic_cast&lt;SCTPMessage *&gt;(udppkt-&gt;getEncapsulatedPacket()))
                <a class="code" href="class_t_c_p_dumper.html#a9b424b32c950eef380e172b7f23808f3">sctpDump</a>(<span class="stringliteral">&quot;&quot;</span>, (<a class="code" href="class_s_c_t_p_message.html">SCTPMessage</a> *)(udppkt-&gt;getEncapsulatedPacket()), std::string(l2r?<span class="stringliteral">&quot;A&quot;</span>:<span class="stringliteral">&quot;B&quot;</span>),std::string(l2r?<span class="stringliteral">&quot;B&quot;</span>:<span class="stringliteral">&quot;A&quot;</span>));
        }
    }
}
</pre></div>
</div>
</div>
<hr/><h2>Member Data Documentation</h2>
<a class="anchor" id="a419e96d410875d31fe2d7a1dec03b8fc"></a><!-- doxytag: member="TCPDumper::dumpfile" ref="a419e96d410875d31fe2d7a1dec03b8fc" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">FILE* <a class="el" href="class_t_c_p_dumper.html#a419e96d410875d31fe2d7a1dec03b8fc">TCPDumper::dumpfile</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="class_t_c_p_dump.html#ad2c36cf696c676be6fd15b4eead2ecf4">TCPDump::finish()</a>, <a class="el" href="class_t_c_p_dump.html#a6c6aae2b0258f57b57eef0ad10df6f5d">TCPDump::handleMessage()</a>, and <a class="el" href="class_t_c_p_dump.html#a99ea2e21ea0ef5af65258834540d73ef">TCPDump::initialize()</a>.</p>

</div>
</div>
<a class="anchor" id="a1ab7e43bb867592f56861effcb369e8c"></a><!-- doxytag: member="TCPDumper::outp" ref="a1ab7e43bb867592f56861effcb369e8c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::ostream* <a class="el" href="class_t_c_p_dumper.html#a1ab7e43bb867592f56861effcb369e8c">TCPDumper::outp</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="class_t_c_p_dumper.html#a1d37f218e819252c027368ef08a2220d">dump()</a>, <a class="el" href="class_t_c_p_dumper.html#a754be936c3dc1a76c2e2a64879833e90">dumpIPv6()</a>, <a class="el" href="class_t_c_p_dumper.html#a9b424b32c950eef380e172b7f23808f3">sctpDump()</a>, <a class="el" href="class_t_c_p_dumper.html#a03e9cc1b3d71ebe68154d989a8b19476">tcpDump()</a>, <a class="el" href="class_t_c_p_dumper.html#afafd43a193f6e03d7815770131cbf1c6">TCPDumper()</a>, and <a class="el" href="class_t_c_p_dumper.html#a734f25e12b7e32b04b7895fca3f0bd85">udpDump()</a>.</p>

</div>
</div>
<a class="anchor" id="adf96516a68506b6cce543912d6ea58ea"></a><!-- doxytag: member="TCPDumper::seq" ref="adf96516a68506b6cce543912d6ea58ea" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int32 <a class="el" href="class_t_c_p_dumper.html#adf96516a68506b6cce543912d6ea58ea">TCPDumper::seq</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a14d65f28ff5c5d7cc11e1837eadf0236"></a><!-- doxytag: member="TCPDumper::verbosity" ref="a14d65f28ff5c5d7cc11e1837eadf0236" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="class_t_c_p_dumper.html#a14d65f28ff5c5d7cc11e1837eadf0236">TCPDumper::verbosity</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="class_t_c_p_dumper.html#a9b424b32c950eef380e172b7f23808f3">sctpDump()</a>, and <a class="el" href="class_t_c_p_dumper.html#a6fccb0507cbb7ba38d1eba9b7c2523bb">setVerbosity()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="_t_c_p_dump_8h.html">TCPDump.h</a></li>
<li><a class="el" href="_t_c_p_dump_8cc.html">TCPDump.cc</a></li>
</ul>
</div>
</div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="class_t_c_p_dumper.html">TCPDumper</a>      </li>
      <li class="footer">Generated on Fri Nov 18 2011 12:47:16 for INET Framework for OMNeT++/OMNEST by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </li>
    </ul>
  </div>

</body>
</html>
