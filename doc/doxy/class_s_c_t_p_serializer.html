<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>INET Framework for OMNeT++/OMNEST: SCTPSerializer Class Reference</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>


</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">INET Framework for OMNeT++/OMNEST
   
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('class_s_c_t_p_serializer.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a>  </div>
  <div class="headertitle">
<div class="title">SCTPSerializer Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<!-- doxytag: class="SCTPSerializer" -->
<p>Converts between <a class="el" href="class_s_c_t_p_message.html" title="Represents a SCTP Message.">SCTPMessage</a> and binary (network byte order) <a class="el" href="class_s_c_t_p.html" title="Implements the SCTP protocol.">SCTP</a> header.  
 <a href="class_s_c_t_p_serializer.html#details">More...</a></p>

<p><code>#include &lt;SCTPSerializer.h&gt;</code></p>

<p><a href="class_s_c_t_p_serializer-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_s_c_t_p_serializer.html#a27462af14637ce784663e6c6bb783c10">SCTPSerializer</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int32&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_s_c_t_p_serializer.html#ab955e6ade690a1a3332ec8827af55ddf">serialize</a> (const <a class="el" href="class_s_c_t_p_message.html">SCTPMessage</a> *msg, uint8 *buf, uint32 bufsize)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Serializes an <a class="el" href="class_s_c_t_p_message.html" title="Represents a SCTP Message.">SCTPMessage</a> for transmission on the wire.  <a href="#ab955e6ade690a1a3332ec8827af55ddf"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="timer__queue_8h.html#a07640d68b3fdfaa5c48a36265e8f10b8">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_s_c_t_p_serializer.html#a6f98120b3c9485fab42e24b9ab455b88">parse</a> (const uint8 *buf, uint32 bufsize, <a class="el" href="class_s_c_t_p_message.html">SCTPMessage</a> *dest)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Puts a packet sniffed from the wire into an <a class="el" href="class_s_c_t_p_message.html" title="Represents a SCTP Message.">SCTPMessage</a>.  <a href="#a6f98120b3c9485fab42e24b9ab455b88"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static uint32&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_s_c_t_p_serializer.html#afc95affdb742652c06ca52fdd86da488">checksum</a> (const uint8 *buf, register uint32 <a class="el" href="_t_c_p___n_s_c_8cc.html#a8aed22e2c7b283705ec82e0120515618">len</a>)</td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>Converts between <a class="el" href="class_s_c_t_p_message.html" title="Represents a SCTP Message.">SCTPMessage</a> and binary (network byte order) <a class="el" href="class_s_c_t_p.html" title="Implements the SCTP protocol.">SCTP</a> header. </p>
</div><hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a27462af14637ce784663e6c6bb783c10"></a><!-- doxytag: member="SCTPSerializer::SCTPSerializer" ref="a27462af14637ce784663e6c6bb783c10" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_s_c_t_p_serializer.html#a27462af14637ce784663e6c6bb783c10">SCTPSerializer::SCTPSerializer</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<div class="fragment"><pre class="fragment">{}
</pre></div>
</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="afc95affdb742652c06ca52fdd86da488"></a><!-- doxytag: member="SCTPSerializer::checksum" ref="afc95affdb742652c06ca52fdd86da488" args="(const uint8 *buf, register uint32 len)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32 <a class="el" href="class_s_c_t_p_serializer.html#afc95affdb742652c06ca52fdd86da488">SCTPSerializer::checksum</a> </td>
          <td>(</td>
          <td class="paramtype">const uint8 *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">register uint32&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<div class="fragment"><pre class="fragment">{
    uint32 h;
    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> byte0, byte1, byte2, byte3;
    uint32 crc32c;
    <span class="keyword">register</span> uint32 i;
    <span class="keyword">register</span> uint32 res = (~0L);
    <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="_t_c_p___n_s_c_8cc.html#a8aed22e2c7b283705ec82e0120515618">len</a>; i++)
      <a class="code" href="sctp_8h.html#ad3af2094050495f1c8c0857d9fd97813">CRC32C</a>(res, buf[i]);
    h = ~res;
    byte0 = h &amp; 0xff;
    byte1 = (h&gt;&gt;8) &amp; 0xff;
    byte2 = (h&gt;&gt;16) &amp; 0xff;
    byte3 = (h&gt;&gt;24) &amp; 0xff;
    crc32c = ((byte0 &lt;&lt; 24) | (byte1 &lt;&lt; 16) | (byte2 &lt;&lt; 8) | byte3);
    <span class="keywordflow">return</span> <a class="code" href="aodv__uu__omnet_8h.html#ae4027a6ad07f13aa12eab285a1b46019">htonl</a>(crc32c);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a6f98120b3c9485fab42e24b9ab455b88"></a><!-- doxytag: member="SCTPSerializer::parse" ref="a6f98120b3c9485fab42e24b9ab455b88" args="(const uint8 *buf, uint32 bufsize, SCTPMessage *dest)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="timer__queue_8h.html#a07640d68b3fdfaa5c48a36265e8f10b8">void</a> <a class="el" href="class_s_c_t_p_serializer.html#a6f98120b3c9485fab42e24b9ab455b88">SCTPSerializer::parse</a> </td>
          <td>(</td>
          <td class="paramtype">const uint8 *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32&#160;</td>
          <td class="paramname"><em>bufsize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_s_c_t_p_message.html">SCTPMessage</a> *&#160;</td>
          <td class="paramname"><em>dest</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Puts a packet sniffed from the wire into an <a class="el" href="class_s_c_t_p_message.html" title="Represents a SCTP Message.">SCTPMessage</a>. </p>
<div class="fragment"><pre class="fragment">{
    int32 size_common_header = <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1common__header.html">common_header</a>);
    int32 size_init_chunk = <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1init__chunk.html">init_chunk</a>);
    int32 size_init_ack_chunk = <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1init__ack__chunk.html">init_ack_chunk</a>);
    int32 size_data_chunk = <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1data__chunk.html">data_chunk</a>);
    int32 size_sack_chunk = <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1sack__chunk.html">sack_chunk</a>);
    int32 size_heartbeat_chunk = <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1heartbeat__chunk.html">heartbeat_chunk</a>);
    int32 size_heartbeat_ack_chunk = <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1heartbeat__ack__chunk.html">heartbeat_ack_chunk</a>);
    int32 size_abort_chunk = <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1abort__chunk.html">abort_chunk</a>);
    int32 size_cookie_echo_chunk = <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1cookie__echo__chunk.html">cookie_echo_chunk</a>);
    uint16 paramType;
    int32 parptr, chunklen, cLen, woPadding;
    <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1common__header.html">common_header</a> *<a class="code" href="struct_i_n_e_t_fw_1_1common__header.html">common_header</a> = (<span class="keyword">struct </span>common_header*) (buf);
    int32 tempChecksum = common_header-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1common__header.html#ad9a0af9b8746c7819868702a962fabea">checksum</a>;
    common_header-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1common__header.html#ad9a0af9b8746c7819868702a962fabea">checksum</a> = 0;
    int32 chksum = <a class="code" href="class_s_c_t_p_serializer.html#afc95affdb742652c06ca52fdd86da488">checksum</a>((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*)common_header, bufsize);
    common_header-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1common__header.html#ad9a0af9b8746c7819868702a962fabea">checksum</a> = tempChecksum;

    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *chunks = (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*) (buf + size_common_header);
    <a class="code" href="_s_c_t_p_socket_8cc.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a>&lt;&lt;<span class="stringliteral">&quot;SCTPSerializer::parse SCTPMessage\n&quot;</span>;
    <span class="keywordflow">if</span> (tempChecksum == chksum)
        dest-&gt;<a class="code" href="class_s_c_t_p_message___base.html#ae299c41194b5c0a4c5534b5654bea272">setChecksumOk</a>(<span class="keyword">true</span>);
    <span class="keywordflow">else</span>
        dest-&gt;<a class="code" href="class_s_c_t_p_message___base.html#ae299c41194b5c0a4c5534b5654bea272">setChecksumOk</a>(<span class="keyword">false</span>);
    <a class="code" href="_s_c_t_p_socket_8cc.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a>&lt;&lt;<span class="stringliteral">&quot;checksumOK=&quot;</span>&lt;&lt;dest-&gt;<a class="code" href="class_s_c_t_p_message___base.html#a910312a024d42e851fd60799bf76606f">getChecksumOk</a>()&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;
    dest-&gt;<a class="code" href="class_s_c_t_p_message___base.html#aeed6b672691a326fc06b308881a53bef">setSrcPort</a>(<a class="code" href="aodv__uu__omnet_8h.html#ada37feda716b4ba89cf9dba34288141d">ntohs</a>(common_header-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1common__header.html#a16df1d45094b56d46256db05ebb39fc3">source_port</a>));
    dest-&gt;<a class="code" href="class_s_c_t_p_message___base.html#aa5bfb997ae8e96519d8ececd94ad0b65">setDestPort</a>(<a class="code" href="aodv__uu__omnet_8h.html#ada37feda716b4ba89cf9dba34288141d">ntohs</a>(common_header-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1common__header.html#a6b69320aeac29fa21ad450b2104336c1">destination_port</a>));
    dest-&gt;<a class="code" href="class_s_c_t_p_message___base.html#a0fb05182f7935eede02a1ae4ea95489d">setTag</a>(<a class="code" href="aodv__uu__omnet_8h.html#ac317b3e903719ba02894f1710f7f2439">ntohl</a>(common_header-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1common__header.html#a7405e47d14a91f6fa6558a25770b94b2">verification_tag</a>));
    dest-&gt;setBitLength(<a class="code" href="_s_c_t_p_association_8h.html#a5cd94d6b80cfc4869b11f345c9de4d93">SCTP_COMMON_HEADER</a>*8);
    <span class="comment">// chunks</span>
    uint32 chunkPtr = 0;

    <span class="comment">// catch ALL chunks - when a chunk is taken, the chunkPtr is set to the next chunk</span>
    <span class="keywordflow">while</span> (chunkPtr &lt; (bufsize - size_common_header))
    {
        <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1chunk.html">chunk</a> * <a class="code" href="struct_i_n_e_t_fw_1_1chunk.html">chunk</a> = (<span class="keyword">struct </span>chunk*)(chunks + chunkPtr);
        int32 chunkType = chunk-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1chunk.html#a69925dfff6d4ce8883b99cfafed2ce27">type</a>;
<a class="code" href="_s_c_t_p_socket_8cc.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a>&lt;&lt;<span class="stringliteral">&quot;chunkType=&quot;</span>&lt;&lt;chunkType&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;
        woPadding = <a class="code" href="aodv__uu__omnet_8h.html#ada37feda716b4ba89cf9dba34288141d">ntohs</a>(chunk-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1chunk.html#a022a582b013130ede9f353c628d32b49">length</a>);
<a class="code" href="_s_c_t_p_socket_8cc.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a>&lt;&lt;<span class="stringliteral">&quot;chunk-&gt;length=&quot;</span>&lt;&lt;<a class="code" href="aodv__uu__omnet_8h.html#ada37feda716b4ba89cf9dba34288141d">ntohs</a>(chunk-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1chunk.html#a022a582b013130ede9f353c628d32b49">length</a>)&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;
        cLen = <a class="code" href="_s_c_t_p_association_8h.html#a34c6101299ca6658c48834e679883867">ADD_PADDING</a>(woPadding);
        <span class="keywordflow">switch</span> (chunkType)
        {
            <span class="keywordflow">case</span> <a class="code" href="_s_c_t_p_association_8h.html#a8886377ab3f4b4ef217558f2b83b7b12a9d7d6f31868d66330397c967c4afd2d2">DATA</a>:
            {
                ev&lt;&lt;<span class="stringliteral">&quot;Data received\n&quot;</span>;
                <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1data__chunk.html">data_chunk</a> *dc = (<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1data__chunk.html">data_chunk</a>*) (chunks + chunkPtr);
                <a class="code" href="_s_c_t_p_socket_8cc.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a>&lt;&lt;<span class="stringliteral">&quot;cLen=&quot;</span>&lt;&lt;cLen&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;
                <span class="keywordflow">if</span> (cLen == 0)
                    <span class="keywordflow">throw</span> <span class="keyword">new</span> cRuntimeError(<span class="stringliteral">&quot;Incoming SCTP packet contains data chunk with length==0&quot;</span>);
                <a class="code" href="class_s_c_t_p_data_chunk.html" title="Class generated from transport/sctp/SCTPMessage.msg by opp_msgc.">SCTPDataChunk</a> *chunk = <span class="keyword">new</span> <a class="code" href="class_s_c_t_p_data_chunk.html" title="Class generated from transport/sctp/SCTPMessage.msg by opp_msgc.">SCTPDataChunk</a>(<span class="stringliteral">&quot;DATA&quot;</span>);
                chunk-&gt;<a class="code" href="class_s_c_t_p_chunk.html#a9a923c2c54b4f6f78933e3c1b8990ca5">setChunkType</a>(chunkType);
                chunk-&gt;<a class="code" href="class_s_c_t_p_data_chunk.html#a99013063035bedbbd17c30065bf08456">setUBit</a>(dc-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1data__chunk.html#a41dcf9feaa1ad2f81414ca7eab15e3b8">flags</a> &amp; UNORDERED_BIT);
                chunk-&gt;<a class="code" href="class_s_c_t_p_data_chunk.html#a090c8efe884baac89000bab8f82d5e2a">setBBit</a>(dc-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1data__chunk.html#a41dcf9feaa1ad2f81414ca7eab15e3b8">flags</a> &amp; BEGIN_BIT);
                chunk-&gt;<a class="code" href="class_s_c_t_p_data_chunk.html#aad169a4470b00979ccb4d80ad7ea3da0">setEBit</a>(dc-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1data__chunk.html#a41dcf9feaa1ad2f81414ca7eab15e3b8">flags</a> &amp; END_BIT);
                chunk-&gt;<a class="code" href="class_s_c_t_p_data_chunk.html#a0baf07902b2f541fb3396d7f5014378a">setTsn</a>(<a class="code" href="aodv__uu__omnet_8h.html#ac317b3e903719ba02894f1710f7f2439">ntohl</a>(dc-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1data__chunk.html#a25db3ec53867059f7ffe5b050a43ae14">tsn</a>));
                chunk-&gt;<a class="code" href="class_s_c_t_p_data_chunk.html#a8246b3f08904b7d7827a06b27e238cc3">setSid</a>(<a class="code" href="aodv__uu__omnet_8h.html#ada37feda716b4ba89cf9dba34288141d">ntohs</a>(dc-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1data__chunk.html#a22aace84bd5e2295d4e706a55437cc1d">sid</a>));
                chunk-&gt;<a class="code" href="class_s_c_t_p_data_chunk.html#ade79e6f27fbb45aae0ac76b5cfa74b03">setSsn</a>(<a class="code" href="aodv__uu__omnet_8h.html#ada37feda716b4ba89cf9dba34288141d">ntohs</a>(dc-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1data__chunk.html#a240c6255e13bad8f6a7d41f5ec3559ef">ssn</a>));
                chunk-&gt;<a class="code" href="class_s_c_t_p_data_chunk.html#a75351dc8f81e7660a714ed90a7865f58">setPpid</a>(<a class="code" href="aodv__uu__omnet_8h.html#ac317b3e903719ba02894f1710f7f2439">ntohl</a>(dc-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1data__chunk.html#a379ae5a1ddc385ee44d98cffd39632ee">ppi</a>));
                chunk-&gt;setBitLength(<a class="code" href="_s_c_t_p_association_8h.html#aad0be78d1352b9d9fa6a695ed18c9d65">SCTP_DATA_CHUNK_LENGTH</a>*8);
                <a class="code" href="_s_c_t_p_socket_8cc.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a>&lt;&lt;<span class="stringliteral">&quot;parse data: woPadding=&quot;</span>&lt;&lt;woPadding&lt;&lt;<span class="stringliteral">&quot; size_data_chunk=&quot;</span>&lt;&lt;size_data_chunk&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;
                <span class="keywordflow">if</span> (woPadding &gt; size_data_chunk)
                {
                    <a class="code" href="class_s_c_t_p_simple_message.html" title="Class generated from transport/sctp/SCTPMessage.msg by opp_msgc.">SCTPSimpleMessage</a>* msg = <span class="keyword">new</span> <a class="code" href="class_s_c_t_p_simple_message.html" title="Class generated from transport/sctp/SCTPMessage.msg by opp_msgc.">SCTPSimpleMessage</a>(<span class="stringliteral">&quot;data&quot;</span>);
                    int32 datalen = (woPadding - size_data_chunk);
                    msg-&gt;setBitLength(datalen*8);
                    msg-&gt;<a class="code" href="class_s_c_t_p_simple_message.html#a78f4ca1ba9872abdf91c0feb0546c62f">setDataLen</a>(datalen);
                    msg-&gt;<a class="code" href="class_s_c_t_p_simple_message.html#a19267ba50e2bce996b9290544b436477">setDataArraySize</a>(datalen);
                    <span class="keywordflow">for</span> (int32 i=0; i&lt;datalen; i++)
                        msg-&gt;<a class="code" href="class_s_c_t_p_simple_message.html#a1692ff852ccdf5d64ddf27d68d191625">setData</a>(i, dc-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1data__chunk.html#a3747c423ac3fa73c5954351d1e38ded0">user_data</a>[i]);

                    chunk-&gt;encapsulate(msg);
                }
                <a class="code" href="_s_c_t_p_socket_8cc.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a>&lt;&lt;<span class="stringliteral">&quot;datachunkLength=&quot;</span>&lt;&lt;chunk-&gt;getBitLength()&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;
                dest-&gt;<a class="code" href="class_s_c_t_p_message.html#a46c6cc49994da66b04d2ab9eadc564b7" title="Adds a message object to the SCTP packet.">addChunk</a>(chunk);
                <span class="keywordflow">break</span>;
            }
            <span class="keywordflow">case</span> <a class="code" href="_s_c_t_p_association_8h.html#a8886377ab3f4b4ef217558f2b83b7b12a0cb1b2c6a7db1f1084886c98909a3f36">INIT</a>:
            {
                ev&lt;&lt;<span class="stringliteral">&quot;parse INIT\n&quot;</span>;
                <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1init__chunk.html">init_chunk</a> *<a class="code" href="struct_i_n_e_t_fw_1_1init__chunk.html">init_chunk</a> = (<span class="keyword">struct </span>init_chunk*) (chunks + chunkPtr); <span class="comment">// (recvBuffer + size_ip + size_common_header);</span>
                chunklen = <a class="code" href="_s_c_t_p_association_8h.html#a685f1682f68294dbb12e7953e02748a0">SCTP_INIT_CHUNK_LENGTH</a>;
                <a class="code" href="class_s_c_t_p_init_chunk.html" title="Class generated from transport/sctp/SCTPMessage.msg by opp_msgc.">SCTPInitChunk</a> *chunk = <span class="keyword">new</span> <a class="code" href="class_s_c_t_p_init_chunk.html" title="Class generated from transport/sctp/SCTPMessage.msg by opp_msgc.">SCTPInitChunk</a>(<span class="stringliteral">&quot;INIT&quot;</span>);
                chunk-&gt;<a class="code" href="class_s_c_t_p_chunk.html#a9a923c2c54b4f6f78933e3c1b8990ca5">setChunkType</a>(chunkType);
                chunk-&gt;setName(<span class="stringliteral">&quot;INIT&quot;</span>);
                chunk-&gt;<a class="code" href="class_s_c_t_p_init_chunk.html#a487eb7a954c947a7c520a78293eb9b34">setInitTag</a>(<a class="code" href="aodv__uu__omnet_8h.html#ac317b3e903719ba02894f1710f7f2439">ntohl</a>(init_chunk-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1init__chunk.html#a7315d4164cc15995adf0bdec0511af1c">initiate_tag</a>));
                chunk-&gt;<a class="code" href="class_s_c_t_p_init_chunk.html#ae53b87f194d88be7590ebff733859f3d">setA_rwnd</a>(<a class="code" href="aodv__uu__omnet_8h.html#ac317b3e903719ba02894f1710f7f2439">ntohl</a>(init_chunk-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1init__chunk.html#a54cf1029a7b2d050336e4c76cd197654">a_rwnd</a>));
                chunk-&gt;<a class="code" href="class_s_c_t_p_init_chunk.html#a9e781273e2fc591331d2b172731308e5">setNoOutStreams</a>(<a class="code" href="aodv__uu__omnet_8h.html#ada37feda716b4ba89cf9dba34288141d">ntohs</a>(init_chunk-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1init__chunk.html#a947a36c02bac8bb6549ad270fe51714e">mos</a>));
                chunk-&gt;<a class="code" href="class_s_c_t_p_init_chunk.html#a8e614c251b343a32917bc51ad3027241">setNoInStreams</a>(<a class="code" href="aodv__uu__omnet_8h.html#ada37feda716b4ba89cf9dba34288141d">ntohs</a>(init_chunk-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1init__chunk.html#ae3094436bd6843ba61ab9b20f44e87f9">mis</a>));
                chunk-&gt;<a class="code" href="class_s_c_t_p_init_chunk.html#a6ffa4a7478119b0d45d07d81e5e9e20e">setInitTSN</a>(<a class="code" href="aodv__uu__omnet_8h.html#ac317b3e903719ba02894f1710f7f2439">ntohl</a>(init_chunk-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1init__chunk.html#ad0e25ef59a88465391ed7ed5608f9b70">initial_tsn</a>));
                chunk-&gt;<a class="code" href="class_s_c_t_p_init_chunk.html#a3ac368b37dbf105ed1c996a3e61011c1">setAddressesArraySize</a>(0);
                chunk-&gt;<a class="code" href="class_s_c_t_p_init_chunk.html#a8016aa2e43011981afe3029692d2708a">setUnrecognizedParametersArraySize</a>(0);
                <span class="comment">//sctpEV3&lt;&lt;&quot;INIT arrived from wire\n&quot;;</span>
                <span class="keywordflow">if</span> (cLen &gt; size_init_chunk)
                {
                    int32 parcounter = 0, addrcounter = 0;
                    parptr = 0;
                    <span class="keywordtype">bool</span> stopProcessing = <span class="keyword">false</span>;
                    <span class="keywordflow">while</span> (cLen &gt; size_init_chunk+parptr &amp;&amp; !stopProcessing)
                    {
                        <a class="code" href="_s_c_t_p_socket_8cc.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a>&lt;&lt;<span class="stringliteral">&quot;Process INIT parameters\n&quot;</span>;
                        <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1tlv.html">tlv</a> *parameter = (<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1tlv.html">tlv</a>*)(((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*)init_chunk) + size_init_chunk + parptr);
                        paramType = <a class="code" href="aodv__uu__omnet_8h.html#ada37feda716b4ba89cf9dba34288141d">ntohs</a>(parameter-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1tlv.html#a0376609c5b5aeb16ae4840581987d033">type</a>);
                        <a class="code" href="_s_c_t_p_socket_8cc.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a>&lt;&lt;<span class="stringliteral">&quot;search for param &quot;</span>&lt;&lt;paramType&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;
                        <span class="keywordflow">switch</span> (paramType)
                        {
                            <span class="keywordflow">case</span> <a class="code" href="_s_c_t_p_association_8h.html#a8d59686e974f326f12076166b80dcad1af17cc3bab233e3bca306ffc579984acc">SUPPORTED_ADDRESS_TYPES</a>:
                            {
                                <span class="keywordflow">break</span>;
                            }
                            <span class="keywordflow">case</span> <a class="code" href="sctp_8h.html#a42777cc0d8e665b540eb6edc1ee831dd">INIT_PARAM_IPV4</a>:
                            {
                                <span class="comment">// we supppose an ipv4 address parameter</span>
                                <a class="code" href="_s_c_t_p_socket_8cc.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a>&lt;&lt;<span class="stringliteral">&quot;IPv4\n&quot;</span>;
                                <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1init__ipv4__address__parameter.html">init_ipv4_address_parameter</a> *v4addr;
                                v4addr = (<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1init__ipv4__address__parameter.html">init_ipv4_address_parameter</a>*) (((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*)init_chunk) + size_init_chunk + parptr);
                                chunk-&gt;<a class="code" href="class_s_c_t_p_init_chunk.html#a3ac368b37dbf105ed1c996a3e61011c1">setAddressesArraySize</a>(++addrcounter);
                                <a class="code" href="class_i_pv_x_address.html" title="Stores an IPv4 or an IPv6 address.">IPvXAddress</a> localv4Addr(<a class="code" href="class_i_pv4_address.html" title="IPv4 address.">IPv4Address</a>(<a class="code" href="aodv__uu__omnet_8h.html#ac317b3e903719ba02894f1710f7f2439">ntohl</a>(v4addr-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1init__ipv4__address__parameter.html#a9538c188df90d12ec2860698be2d2368">address</a>)));
                                chunk-&gt;<a class="code" href="class_s_c_t_p_init_chunk.html#a72123f66502f6d5b9e40f62538f82259">setAddresses</a>(addrcounter-1, localv4Addr);
                                chunklen += 8;
                                <span class="keywordflow">break</span>;
                            }
                            <span class="keywordflow">case</span> <a class="code" href="sctp_8h.html#a5e8308210ed9cdacf7346535647bbb00">INIT_PARAM_IPV6</a>:
                            {
                                <a class="code" href="_s_c_t_p_socket_8cc.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a>&lt;&lt;<span class="stringliteral">&quot;IPv6\n&quot;</span>;
                                <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1init__ipv6__address__parameter.html">init_ipv6_address_parameter</a> *ipv6addr;
                                ipv6addr = (<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1init__ipv6__address__parameter.html">init_ipv6_address_parameter</a>*) (((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*)init_chunk) + size_init_chunk + parptr);
                                <a class="code" href="class_i_pv6_address.html" title="Stores a 128-bit IPv6 address in an efficient way.">IPv6Address</a> ipv6Addr = <a class="code" href="class_i_pv6_address.html" title="Stores a 128-bit IPv6 address in an efficient way.">IPv6Address</a>(ipv6addr-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1init__ipv6__address__parameter.html#adfb4cf9aa03f83ebf1636acd6e501af4">address</a>[0], ipv6addr-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1init__ipv6__address__parameter.html#adfb4cf9aa03f83ebf1636acd6e501af4">address</a>[1],
                                                                    ipv6addr-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1init__ipv6__address__parameter.html#adfb4cf9aa03f83ebf1636acd6e501af4">address</a>[2], ipv6addr-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1init__ipv6__address__parameter.html#adfb4cf9aa03f83ebf1636acd6e501af4">address</a>[3]);
                                <a class="code" href="class_i_pv_x_address.html" title="Stores an IPv4 or an IPv6 address.">IPvXAddress</a> localv6Addr(ipv6Addr);
                                <a class="code" href="_s_c_t_p_socket_8cc.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a>&lt;&lt;<span class="stringliteral">&quot;address&quot;</span>&lt;&lt;ipv6Addr&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;
                                chunk-&gt;<a class="code" href="class_s_c_t_p_init_chunk.html#a3ac368b37dbf105ed1c996a3e61011c1">setAddressesArraySize</a>(++addrcounter);
                                chunk-&gt;<a class="code" href="class_s_c_t_p_init_chunk.html#a72123f66502f6d5b9e40f62538f82259">setAddresses</a>(addrcounter-1, localv6Addr);
                                chunklen += 20;
                                <span class="keywordflow">break</span>;
                            }
                            <span class="keywordflow">default</span>:
                            {
                                <a class="code" href="_s_c_t_p_socket_8cc.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a> &lt;&lt; <span class="stringliteral">&quot;ExtInterface: Unknown SCTP INIT parameter type &quot;</span> &lt;&lt; paramType&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;
                                uint16 skip = (paramType &amp; 0x8000) &gt;&gt; 15;
                                <span class="keywordflow">if</span> (skip == 0)
                                    stopProcessing = <span class="keyword">true</span>;
                                uint16 report = (paramType &amp; 0x4000) &gt;&gt; 14;
                                <span class="keywordflow">if</span> (report != 0)
                                {
                                    <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1tlv.html">tlv</a> *unknown;
                                    unknown = (<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1tlv.html">tlv</a>*) (((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*)init_chunk) + size_init_chunk + parptr);
                                    uint32 unknownLen = chunk-&gt;<a class="code" href="class_s_c_t_p_init_chunk.html#a823a5de4117c53aae7d59244b02c6e63">getUnrecognizedParametersArraySize</a>();
                                    chunk-&gt;<a class="code" href="class_s_c_t_p_init_chunk.html#a8016aa2e43011981afe3029692d2708a">setUnrecognizedParametersArraySize</a>(unknownLen+<a class="code" href="_s_c_t_p_association_8h.html#a34c6101299ca6658c48834e679883867">ADD_PADDING</a>(<a class="code" href="aodv__uu__omnet_8h.html#ada37feda716b4ba89cf9dba34288141d">ntohs</a>(unknown-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1tlv.html#ad8504a2c0218d4213b377e2ddb240a9c">length</a>)));
                                    <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1data__vector.html">data_vector</a>* dv = (<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1data__vector.html">data_vector</a>*) (((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*)init_chunk) + size_init_chunk + parptr);

                                    <span class="keywordflow">for</span> (uint32 i=unknownLen; i&lt;unknownLen+<a class="code" href="_s_c_t_p_association_8h.html#a34c6101299ca6658c48834e679883867">ADD_PADDING</a>(<a class="code" href="aodv__uu__omnet_8h.html#ada37feda716b4ba89cf9dba34288141d">ntohs</a>(unknown-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1tlv.html#ad8504a2c0218d4213b377e2ddb240a9c">length</a>)); i++)
                                        chunk-&gt;<a class="code" href="class_s_c_t_p_init_chunk.html#a06d16b62dc6aebbf4b492b30fa9e15af">setUnrecognizedParameters</a>(i, dv-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1data__vector.html#afde96dce63b62a4c06a7deb55600afff">data</a>[i-unknownLen]);
                                }
                                <a class="code" href="_s_c_t_p_socket_8cc.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a>&lt;&lt;<span class="stringliteral">&quot;stopProcessing=&quot;</span>&lt;&lt;stopProcessing&lt;&lt;<span class="stringliteral">&quot; report=&quot;</span>&lt;&lt;report&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;
                                <span class="keywordflow">break</span>;
                            }
                        }
                        parptr += <a class="code" href="_s_c_t_p_association_8h.html#a34c6101299ca6658c48834e679883867">ADD_PADDING</a>(<a class="code" href="aodv__uu__omnet_8h.html#ada37feda716b4ba89cf9dba34288141d">ntohs</a>(parameter-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1tlv.html#ad8504a2c0218d4213b377e2ddb240a9c">length</a>));
                        parcounter++;
                    }


                }
                chunk-&gt;setBitLength(chunklen*8);
                dest-&gt;<a class="code" href="class_s_c_t_p_message.html#a46c6cc49994da66b04d2ab9eadc564b7" title="Adds a message object to the SCTP packet.">addChunk</a>(chunk);
                <span class="comment">//chunkPtr += cLen;</span>
                <span class="keywordflow">break</span>;
            }
            <span class="keywordflow">case</span> <a class="code" href="_s_c_t_p_association_8h.html#a8886377ab3f4b4ef217558f2b83b7b12abb473557985d30fdf16d2525388e3a22">INIT_ACK</a>:
            {
                <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1init__ack__chunk.html">init_ack_chunk</a> *iac = (<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1init__ack__chunk.html">init_ack_chunk</a>*) (chunks + chunkPtr);
                chunklen = <a class="code" href="_s_c_t_p_association_8h.html#a685f1682f68294dbb12e7953e02748a0">SCTP_INIT_CHUNK_LENGTH</a>;
                <a class="code" href="class_s_c_t_p_init_ack_chunk.html" title="Class generated from transport/sctp/SCTPMessage.msg by opp_msgc.">SCTPInitAckChunk</a> *chunk = <span class="keyword">new</span> <a class="code" href="class_s_c_t_p_init_ack_chunk.html" title="Class generated from transport/sctp/SCTPMessage.msg by opp_msgc.">SCTPInitAckChunk</a>(<span class="stringliteral">&quot;INIT_ACK&quot;</span>);
                chunk-&gt;<a class="code" href="class_s_c_t_p_chunk.html#a9a923c2c54b4f6f78933e3c1b8990ca5">setChunkType</a>(chunkType);
                chunk-&gt;<a class="code" href="class_s_c_t_p_init_ack_chunk.html#a3f562c82479ddffea16147033c8c80a7">setInitTag</a>(<a class="code" href="aodv__uu__omnet_8h.html#ac317b3e903719ba02894f1710f7f2439">ntohl</a>(iac-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1init__ack__chunk.html#a7a54bd2ed88345cdb5c902f56bc8d3c7">initiate_tag</a>));
                chunk-&gt;<a class="code" href="class_s_c_t_p_init_ack_chunk.html#a24c58bece86436da39a7d7a7ec09ce1b">setA_rwnd</a>(<a class="code" href="aodv__uu__omnet_8h.html#ac317b3e903719ba02894f1710f7f2439">ntohl</a>(iac-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1init__ack__chunk.html#aa95033ee21e5290df42be51a8b696679">a_rwnd</a>));
                chunk-&gt;<a class="code" href="class_s_c_t_p_init_ack_chunk.html#aacf1927eee1e5eae184d35267bbd0375">setNoOutStreams</a>(<a class="code" href="aodv__uu__omnet_8h.html#ada37feda716b4ba89cf9dba34288141d">ntohs</a>(iac-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1init__ack__chunk.html#af32685d03e6d9489916b3e6824261ac5">mos</a>));
                chunk-&gt;<a class="code" href="class_s_c_t_p_init_ack_chunk.html#a307358fd682e09a6b204213678ff29e3">setNoInStreams</a>(<a class="code" href="aodv__uu__omnet_8h.html#ada37feda716b4ba89cf9dba34288141d">ntohs</a>(iac-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1init__ack__chunk.html#af18c98e1baef7393f88d5141b17e0c91">mis</a>));
                chunk-&gt;<a class="code" href="class_s_c_t_p_init_ack_chunk.html#a8d44f62b401981f22a6f0933b7bab97e">setInitTSN</a>(<a class="code" href="aodv__uu__omnet_8h.html#ac317b3e903719ba02894f1710f7f2439">ntohl</a>(iac-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1init__ack__chunk.html#af9294b9a9ff18b46973e93b122b74413">initial_tsn</a>));
                chunk-&gt;<a class="code" href="class_s_c_t_p_init_ack_chunk.html#ae7750b4f43ce1ba6d61af64d3ff27501">setUnrecognizedParametersArraySize</a>(0);
                <span class="keywordflow">if</span> (cLen &gt; size_init_ack_chunk)
                {
                    int32 parcounter = 0, addrcounter = 0;
                    parptr = 0;
                    <span class="keywordtype">bool</span> stopProcessing = <span class="keyword">false</span>;
                    <span class="comment">//sctpEV3&lt;&lt;&quot;cLen=&quot;&lt;&lt;cLen&lt;&lt;&quot;\n&quot;;</span>
                    <span class="keywordflow">while</span> (cLen &gt; size_init_ack_chunk+parptr &amp;&amp; !stopProcessing)
                    {
                        <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1tlv.html">tlv</a> *parameter = (<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1tlv.html">tlv</a>*)(((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*)iac) + size_init_ack_chunk + parptr);
                        paramType = <a class="code" href="aodv__uu__omnet_8h.html#ada37feda716b4ba89cf9dba34288141d">ntohs</a>(parameter-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1tlv.html#a0376609c5b5aeb16ae4840581987d033">type</a>);
                        <span class="comment">//sctpEV3&lt;&lt;&quot;ParamType = &quot;&lt;&lt;paramType&lt;&lt;&quot; parameterLength=&quot;&lt;&lt;ntohs(parameter-&gt;length)&lt;&lt;&quot;\n&quot;;</span>
                        <span class="keywordflow">switch</span> (paramType)
                        {
                            <span class="keywordflow">case</span> <a class="code" href="_s_c_t_p_association_8h.html#a8d59686e974f326f12076166b80dcad1af17cc3bab233e3bca306ffc579984acc">SUPPORTED_ADDRESS_TYPES</a>:
                            {
                                <span class="keywordflow">break</span>;
                            }
                            <span class="keywordflow">case</span> <a class="code" href="sctp_8h.html#a42777cc0d8e665b540eb6edc1ee831dd">INIT_PARAM_IPV4</a>:
                            {
                                <a class="code" href="_s_c_t_p_socket_8cc.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a>&lt;&lt;<span class="stringliteral">&quot;parse IPv4\n&quot;</span>;
                                <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1init__ipv4__address__parameter.html">init_ipv4_address_parameter</a> *v4addr;
                                v4addr = (<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1init__ipv4__address__parameter.html">init_ipv4_address_parameter</a>*) (((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*)iac) + size_init_ack_chunk + parptr);
                                chunk-&gt;<a class="code" href="class_s_c_t_p_init_ack_chunk.html#ad70d5abe980530ad3acbf9cbcf419a8a">setAddressesArraySize</a>(++addrcounter);
                                <a class="code" href="class_i_pv_x_address.html" title="Stores an IPv4 or an IPv6 address.">IPvXAddress</a> localv4Addr(<a class="code" href="class_i_pv4_address.html" title="IPv4 address.">IPv4Address</a>(<a class="code" href="aodv__uu__omnet_8h.html#ac317b3e903719ba02894f1710f7f2439">ntohl</a>(v4addr-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1init__ipv4__address__parameter.html#a9538c188df90d12ec2860698be2d2368">address</a>)));
                                chunk-&gt;<a class="code" href="class_s_c_t_p_init_ack_chunk.html#a860688e8ac6670ea702752b6afd6c09b">setAddresses</a>(addrcounter-1, localv4Addr);
                                chunklen += 8;
                                <span class="keywordflow">break</span>;
                            }
                            <span class="keywordflow">case</span> <a class="code" href="sctp_8h.html#a5e8308210ed9cdacf7346535647bbb00">INIT_PARAM_IPV6</a>:
                            {
                                <a class="code" href="_s_c_t_p_socket_8cc.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a>&lt;&lt;<span class="stringliteral">&quot;IPv6\n&quot;</span>;
                                <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1init__ipv6__address__parameter.html">init_ipv6_address_parameter</a> *ipv6addr;
                                ipv6addr = (<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1init__ipv6__address__parameter.html">init_ipv6_address_parameter</a>*) (((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*)iac) + size_init_chunk + parptr);
                                <a class="code" href="class_i_pv6_address.html" title="Stores a 128-bit IPv6 address in an efficient way.">IPv6Address</a> ipv6Addr = <a class="code" href="class_i_pv6_address.html" title="Stores a 128-bit IPv6 address in an efficient way.">IPv6Address</a>(ipv6addr-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1init__ipv6__address__parameter.html#adfb4cf9aa03f83ebf1636acd6e501af4">address</a>[0], ipv6addr-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1init__ipv6__address__parameter.html#adfb4cf9aa03f83ebf1636acd6e501af4">address</a>[1],
                                                                    ipv6addr-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1init__ipv6__address__parameter.html#adfb4cf9aa03f83ebf1636acd6e501af4">address</a>[2], ipv6addr-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1init__ipv6__address__parameter.html#adfb4cf9aa03f83ebf1636acd6e501af4">address</a>[3]);
                                <a class="code" href="_s_c_t_p_socket_8cc.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a>&lt;&lt;<span class="stringliteral">&quot;address&quot;</span>&lt;&lt;ipv6Addr&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;
                                <a class="code" href="class_i_pv_x_address.html" title="Stores an IPv4 or an IPv6 address.">IPvXAddress</a> localv6Addr(ipv6Addr);

                                chunk-&gt;<a class="code" href="class_s_c_t_p_init_ack_chunk.html#ad70d5abe980530ad3acbf9cbcf419a8a">setAddressesArraySize</a>(++addrcounter);
                                chunk-&gt;<a class="code" href="class_s_c_t_p_init_ack_chunk.html#a860688e8ac6670ea702752b6afd6c09b">setAddresses</a>(addrcounter-1, localv6Addr);
                                chunklen += 20;
                                <span class="keywordflow">break</span>;
                            }
                            <span class="keywordflow">case</span> <a class="code" href="sctp_8h.html#a34127e7f145642fb19969a905c0511dc">INIT_PARAM_COOKIE</a>:
                            {
                                <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1tlv.html">tlv</a> *cookie = (<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1tlv.html">tlv</a>*) (((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*)iac) + size_init_ack_chunk + parptr);
                                int32 cookieLen = <a class="code" href="aodv__uu__omnet_8h.html#ada37feda716b4ba89cf9dba34288141d">ntohs</a>(cookie-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1tlv.html#ad8504a2c0218d4213b377e2ddb240a9c">length</a>) - 4;
                                <span class="comment">// put cookie data into chunk (char array cookie)</span>
                                chunk-&gt;<a class="code" href="class_s_c_t_p_init_ack_chunk.html#aacea71bb3621de42025d61f5b7db987d">setCookieArraySize</a>(cookieLen);
                                <span class="keywordflow">for</span> (int32 i=0; i&lt;cookieLen; i++)
                                    chunk-&gt;<a class="code" href="class_s_c_t_p_init_ack_chunk.html#a73189ef040167ba6133e2988704a49fe">setCookie</a>(i, cookie-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1tlv.html#ab0de063235e7569ee8c41a4d3f94312c">value</a>[i]);
                                chunklen += cookieLen+4;
                                <span class="keywordflow">break</span>;
                            }
                            <span class="keywordflow">default</span>:
                            {
                                <a class="code" href="_s_c_t_p_socket_8cc.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a> &lt;&lt; <span class="stringliteral">&quot;ExtInterface: Unknown SCTP INIT-ACK parameter type &quot;</span> &lt;&lt; paramType&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;
                                uint16 skip = (paramType &amp; 0x8000) &gt;&gt; 15;
                                <span class="keywordflow">if</span> (skip == 0)
                                    stopProcessing = <span class="keyword">true</span>;
                                uint16 report = (paramType &amp; 0x4000) &gt;&gt; 14;
                                <span class="keywordflow">if</span> (report != 0)
                                {
                                    <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1tlv.html">tlv</a> *unknown;
                                    unknown = (<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1tlv.html">tlv</a>*) (((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*)iac) + size_init_ack_chunk + parptr);
                                    uint32 unknownLen = chunk-&gt;<a class="code" href="class_s_c_t_p_init_ack_chunk.html#a782f1937ded9a07b427f13c9a6a22330">getUnrecognizedParametersArraySize</a>();
                                    chunk-&gt;<a class="code" href="class_s_c_t_p_init_ack_chunk.html#ae7750b4f43ce1ba6d61af64d3ff27501">setUnrecognizedParametersArraySize</a>(unknownLen+<a class="code" href="_s_c_t_p_association_8h.html#a34c6101299ca6658c48834e679883867">ADD_PADDING</a>(<a class="code" href="aodv__uu__omnet_8h.html#ada37feda716b4ba89cf9dba34288141d">ntohs</a>(unknown-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1tlv.html#ad8504a2c0218d4213b377e2ddb240a9c">length</a>)));
                                    <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1data__vector.html">data_vector</a>* dv = (<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1data__vector.html">data_vector</a>*) (((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*)iac) + size_init_ack_chunk + parptr);

                                    <span class="keywordflow">for</span> (uint32 i=unknownLen; i&lt;unknownLen+<a class="code" href="_s_c_t_p_association_8h.html#a34c6101299ca6658c48834e679883867">ADD_PADDING</a>(<a class="code" href="aodv__uu__omnet_8h.html#ada37feda716b4ba89cf9dba34288141d">ntohs</a>(unknown-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1tlv.html#ad8504a2c0218d4213b377e2ddb240a9c">length</a>)); i++)
                                        chunk-&gt;<a class="code" href="class_s_c_t_p_init_ack_chunk.html#a91d73439e9ccca5ab15ae8a586cf99fe">setUnrecognizedParameters</a>(i, dv-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1data__vector.html#afde96dce63b62a4c06a7deb55600afff">data</a>[i-unknownLen]);
                                }
                                <a class="code" href="_s_c_t_p_socket_8cc.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a>&lt;&lt;<span class="stringliteral">&quot;stopProcessing=&quot;</span>&lt;&lt;stopProcessing&lt;&lt;<span class="stringliteral">&quot;  report=&quot;</span>&lt;&lt;report&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;

                                <span class="keywordflow">break</span>;
                            }
                        }
                        parptr += <a class="code" href="_s_c_t_p_association_8h.html#a34c6101299ca6658c48834e679883867">ADD_PADDING</a>(<a class="code" href="aodv__uu__omnet_8h.html#ada37feda716b4ba89cf9dba34288141d">ntohs</a>(parameter-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1tlv.html#ad8504a2c0218d4213b377e2ddb240a9c">length</a>));
                        <span class="comment">//sctpEV3&lt;&lt;&quot;parptr=&quot;&lt;&lt;parptr&lt;&lt;&quot;\n&quot;;</span>
                        parcounter++;
                    }
                }
                chunk-&gt;setBitLength(chunklen*8);
                dest-&gt;<a class="code" href="class_s_c_t_p_message.html#a46c6cc49994da66b04d2ab9eadc564b7" title="Adds a message object to the SCTP packet.">addChunk</a>(chunk);
                <span class="keywordflow">break</span>;
            }
            <span class="keywordflow">case</span> <a class="code" href="_s_c_t_p_association_8h.html#a8886377ab3f4b4ef217558f2b83b7b12a689bf9c7470080fd0180eb7f5c293bd4">SACK</a>:
            {
                ev&lt;&lt;<span class="stringliteral">&quot;SCTPMessage: SACK received\n&quot;</span>;
                <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1sack__chunk.html">sack_chunk</a> *sac = (<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1sack__chunk.html">sack_chunk</a>*) (chunks + chunkPtr);
                <a class="code" href="class_s_c_t_p_sack_chunk.html" title="Class generated from transport/sctp/SCTPMessage.msg by opp_msgc.">SCTPSackChunk</a> *chunk = <span class="keyword">new</span> <a class="code" href="class_s_c_t_p_sack_chunk.html" title="Class generated from transport/sctp/SCTPMessage.msg by opp_msgc.">SCTPSackChunk</a>(<span class="stringliteral">&quot;SACK&quot;</span>);
                chunk-&gt;<a class="code" href="class_s_c_t_p_chunk.html#a9a923c2c54b4f6f78933e3c1b8990ca5">setChunkType</a>(chunkType);
                uint32 cumtsnack = <a class="code" href="aodv__uu__omnet_8h.html#ac317b3e903719ba02894f1710f7f2439">ntohl</a>(sac-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1sack__chunk.html#a561d6bef13b80381e25a0712b3b283a0">cum_tsn_ack</a>);
                chunk-&gt;<a class="code" href="class_s_c_t_p_sack_chunk.html#acfe084efc3ce7ae06d3b98fe872e6ed7">setCumTsnAck</a>(cumtsnack);
                chunk-&gt;<a class="code" href="class_s_c_t_p_sack_chunk.html#a3d88ff84d1111791e58994b183146d5d">setA_rwnd</a>(<a class="code" href="aodv__uu__omnet_8h.html#ac317b3e903719ba02894f1710f7f2439">ntohl</a>(sac-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1sack__chunk.html#a9d989ff6f677f8d5afcbbe2d73ece439">a_rwnd</a>));

                int32 ngaps = <a class="code" href="aodv__uu__omnet_8h.html#ada37feda716b4ba89cf9dba34288141d">ntohs</a>(sac-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1sack__chunk.html#addf4a98ed2d76970afe2a63340a95f00">nr_of_gaps</a>);
                int32 ndups = <a class="code" href="aodv__uu__omnet_8h.html#ada37feda716b4ba89cf9dba34288141d">ntohs</a>(sac-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1sack__chunk.html#a36b9ecced9fc135bc8906b8d5a58c7ed">nr_of_dups</a>);
                chunk-&gt;<a class="code" href="class_s_c_t_p_sack_chunk.html#acd635d18b33b92a1356cd1d4ed7d7def">setNumGaps</a>(ngaps);
                chunk-&gt;<a class="code" href="class_s_c_t_p_sack_chunk.html#ab573ebf62634bb0306637d52baaa7443">setNumDupTsns</a>(ndups);

                chunk-&gt;<a class="code" href="class_s_c_t_p_sack_chunk.html#aa22cbec49f7fc2ff0aadaabd28e4c6b1">setGapStartArraySize</a>(ngaps);
                chunk-&gt;<a class="code" href="class_s_c_t_p_sack_chunk.html#a0d448534ac6ccbc9b4f8b57a8d522d43">setGapStopArraySize</a>(ngaps);
                chunk-&gt;<a class="code" href="class_s_c_t_p_sack_chunk.html#a31719ebfeea4149c98eec8da38013b0a">setDupTsnsArraySize</a>(ndups);

                <span class="keywordflow">for</span> (int32 i=0; i&lt;ngaps; i++)
                {
                    <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1sack__gap.html">sack_gap</a> *gap = (<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1sack__gap.html">sack_gap</a>*) (((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*)sac) + size_sack_chunk + i*<span class="keyword">sizeof</span>(<a class="code" href="struct_i_n_e_t_fw_1_1sack__gap.html">sack_gap</a>));
                    chunk-&gt;<a class="code" href="class_s_c_t_p_sack_chunk.html#a744f899fd45c41f98fd7d117a7ee34a4">setGapStart</a>(i, <a class="code" href="aodv__uu__omnet_8h.html#ada37feda716b4ba89cf9dba34288141d">ntohs</a>(gap-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1sack__gap.html#a06092a86c2ef2a22d5412e2d7096563f">start</a>) + cumtsnack);
                    chunk-&gt;<a class="code" href="class_s_c_t_p_sack_chunk.html#a2f6a9c6f425695fa5a36bc4e953c83ca">setGapStop</a>(i, <a class="code" href="aodv__uu__omnet_8h.html#ada37feda716b4ba89cf9dba34288141d">ntohs</a>(gap-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1sack__gap.html#aff0a1d1c21dd6d36e7b0fff135c93e23">stop</a>) + cumtsnack);
                }
                <span class="keywordflow">for</span> (int32 i=0; i&lt;ndups; i++)
                {
                    <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1sack__duptsn.html">sack_duptsn</a> *dup = (<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1sack__duptsn.html">sack_duptsn</a>*) (((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*)sac) + size_sack_chunk + ngaps*<span class="keyword">sizeof</span>(<a class="code" href="struct_i_n_e_t_fw_1_1sack__gap.html">sack_gap</a>) + i*<span class="keyword">sizeof</span>(<a class="code" href="struct_i_n_e_t_fw_1_1sack__duptsn.html">sack_duptsn</a>));
                    chunk-&gt;<a class="code" href="class_s_c_t_p_sack_chunk.html#a1cd920e2657876ae4525e5c1bbd2fbe9">setDupTsns</a>(i, <a class="code" href="aodv__uu__omnet_8h.html#ac317b3e903719ba02894f1710f7f2439">ntohl</a>(dup-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1sack__duptsn.html#a264c16210059305d5716d62f3f44366e">tsn</a>));
                }

                chunk-&gt;setBitLength(cLen*8);
                dest-&gt;<a class="code" href="class_s_c_t_p_message.html#a46c6cc49994da66b04d2ab9eadc564b7" title="Adds a message object to the SCTP packet.">addChunk</a>(chunk);
                <span class="keywordflow">break</span>;
            }
            <span class="keywordflow">case</span> <a class="code" href="_s_c_t_p_association_8h.html#a8886377ab3f4b4ef217558f2b83b7b12a0f286b0bbc1ee4f20be5136a55cf8923">HEARTBEAT</a>:
            {
                <span class="comment">//sctpEV3&lt;&lt;&quot;SCTPMessage: Heartbeat received\n&quot;;</span>
                <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1heartbeat__chunk.html">heartbeat_chunk</a> *hbc = (<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1heartbeat__chunk.html">heartbeat_chunk</a>*) (chunks + chunkPtr);
                <a class="code" href="class_s_c_t_p_heartbeat_chunk.html" title="Class generated from transport/sctp/SCTPMessage.msg by opp_msgc.">SCTPHeartbeatChunk</a> *chunk = <span class="keyword">new</span> <a class="code" href="class_s_c_t_p_heartbeat_chunk.html" title="Class generated from transport/sctp/SCTPMessage.msg by opp_msgc.">SCTPHeartbeatChunk</a>(<span class="stringliteral">&quot;HEARTBEAT&quot;</span>);
                chunk-&gt;<a class="code" href="class_s_c_t_p_chunk.html#a9a923c2c54b4f6f78933e3c1b8990ca5">setChunkType</a>(chunkType);
                <span class="keywordflow">if</span> (cLen &gt; size_heartbeat_chunk)
                {
                    int32 parcounter = 0;
                    parptr = 0;
                    <span class="keywordflow">while</span> (cLen &gt; size_heartbeat_chunk+parptr)
                    {
                        <span class="comment">// we supppose type 1 here</span>
                        <span class="comment">//sctpEV3&lt;&lt;&quot;HB-chunk+parptr=&quot;&lt;&lt;size_heartbeat_chunk+parptr&lt;&lt;&quot;\n&quot;;</span>
                        <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1heartbeat__info.html">heartbeat_info</a> *hbi = (<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1heartbeat__info.html">heartbeat_info</a>*) (((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*)hbc) + size_heartbeat_chunk + parptr);
                        <span class="keywordflow">if</span> (<a class="code" href="aodv__uu__omnet_8h.html#ada37feda716b4ba89cf9dba34288141d">ntohs</a>(hbi-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1heartbeat__info.html#a9c496e01fb626983dd7449c4d299c4dd">type</a>) == 1) <span class="comment">// sender specific hb info</span>
                        {
                            <span class="comment">//sctpEV3&lt;&lt;&quot;HBInfo\n&quot;;</span>
                            int32 infoLen = <a class="code" href="aodv__uu__omnet_8h.html#ada37feda716b4ba89cf9dba34288141d">ntohs</a>(hbi-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1heartbeat__info.html#a165225a4bed745a098ebc07d514b0a62">length</a>) - 4;
                            parptr += <a class="code" href="_s_c_t_p_association_8h.html#a34c6101299ca6658c48834e679883867">ADD_PADDING</a>(infoLen) + 4;
                            parcounter++;
                            chunk-&gt;<a class="code" href="class_s_c_t_p_heartbeat_chunk.html#a074df611249523d0e39593083d98fc59">setInfoArraySize</a>(infoLen);
                            <span class="keywordflow">for</span> (int32 i=0; i&lt;infoLen; i++)
                                chunk-&gt;<a class="code" href="class_s_c_t_p_heartbeat_chunk.html#ac8144a7e0bd4121433b8ab2e723ccb7f">setInfo</a>(i, <a class="code" href="sctp_8h.html#a35a07f4d1137779b208b608ac62f7561">HBI_INFO</a>(hbi)[i]);
                        }
                        <span class="keywordflow">else</span>
                        {
                            parptr += <a class="code" href="_s_c_t_p_association_8h.html#a34c6101299ca6658c48834e679883867">ADD_PADDING</a>(<a class="code" href="aodv__uu__omnet_8h.html#ada37feda716b4ba89cf9dba34288141d">ntohs</a>(hbi-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1heartbeat__info.html#a165225a4bed745a098ebc07d514b0a62">length</a>));  <span class="comment">// set pointer forwards with count of bytes in length field of TLV</span>
                            parcounter++;
                            <span class="keywordflow">continue</span>;
                        }
                    }
                }
                chunk-&gt;setBitLength(cLen*8);
                dest-&gt;<a class="code" href="class_s_c_t_p_message.html#a46c6cc49994da66b04d2ab9eadc564b7" title="Adds a message object to the SCTP packet.">addChunk</a>(chunk);
                <span class="keywordflow">break</span>;
            }
            <span class="keywordflow">case</span> <a class="code" href="_s_c_t_p_association_8h.html#a8886377ab3f4b4ef217558f2b83b7b12a5621dd83f6f32ee90c0d505867c67b71">HEARTBEAT_ACK</a>:
            {
                ev&lt;&lt;<span class="stringliteral">&quot;SCTPMessage: Heartbeat_Ack received\n&quot;</span>;
                <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1heartbeat__ack__chunk.html">heartbeat_ack_chunk</a> *hbac = (<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1heartbeat__ack__chunk.html">heartbeat_ack_chunk</a>*) (chunks + chunkPtr);
                <a class="code" href="class_s_c_t_p_heartbeat_ack_chunk.html" title="Class generated from transport/sctp/SCTPMessage.msg by opp_msgc.">SCTPHeartbeatAckChunk</a> *chunk = <span class="keyword">new</span> <a class="code" href="class_s_c_t_p_heartbeat_ack_chunk.html" title="Class generated from transport/sctp/SCTPMessage.msg by opp_msgc.">SCTPHeartbeatAckChunk</a>(<span class="stringliteral">&quot;HEARTBEAT_ACK&quot;</span>);
                chunk-&gt;<a class="code" href="class_s_c_t_p_chunk.html#a9a923c2c54b4f6f78933e3c1b8990ca5">setChunkType</a>(chunkType);
                <span class="keywordflow">if</span> (cLen&gt;size_heartbeat_ack_chunk)
                {
                    int32 parcounter = 0;
                    parptr = 0;
                    <span class="keywordflow">while</span> (cLen &gt; size_heartbeat_ack_chunk+parptr)
                    {
                        <span class="comment">// we supppose type 1 here, the same provided in heartbeat chunks</span>
                        <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1heartbeat__info.html">heartbeat_info</a> *hbi = (<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1heartbeat__info.html">heartbeat_info</a>*) (((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*)hbac) + size_heartbeat_ack_chunk + parptr);
                        <span class="keywordflow">if</span> (<a class="code" href="aodv__uu__omnet_8h.html#ada37feda716b4ba89cf9dba34288141d">ntohs</a>(hbi-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1heartbeat__info.html#a9c496e01fb626983dd7449c4d299c4dd">type</a>) == 1) <span class="comment">// sender specific hb info</span>
                        {
                            parptr += <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1heartbeat__info.html">heartbeat_info</a>);
                            parcounter++;
                            chunk-&gt;<a class="code" href="class_s_c_t_p_heartbeat_ack_chunk.html#af18892d8c500c984b83d3a0060606ab8">setRemoteAddr</a>(<a class="code" href="class_i_pv_x_address.html" title="Stores an IPv4 or an IPv6 address.">IPvXAddress</a>(<a class="code" href="class_i_pv4_address.html" title="IPv4 address.">IPv4Address</a>(<a class="code" href="aodv__uu__omnet_8h.html#ac317b3e903719ba02894f1710f7f2439">ntohl</a>(<a class="code" href="sctp_8h.html#aed9342dc5ddcea1e525b7b449fab35a3">HBI_ADDR</a>(hbi)))));
                            chunk-&gt;<a class="code" href="class_s_c_t_p_heartbeat_ack_chunk.html#ab4c84ef5b3924859d0b86fb6e784da5a">setTimeField</a>(<a class="code" href="aodv__uu__omnet_8h.html#ac317b3e903719ba02894f1710f7f2439">ntohl</a>((uint32)<a class="code" href="sctp_8h.html#a350cf5878ce2f8cb42cca735e0f99c1d">HBI_TIME</a>(hbi)));
                        }
                        <span class="keywordflow">else</span>
                        {
                            parptr += <a class="code" href="aodv__uu__omnet_8h.html#ada37feda716b4ba89cf9dba34288141d">ntohs</a>(hbi-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1heartbeat__info.html#a165225a4bed745a098ebc07d514b0a62">length</a>);   <span class="comment">// set pointer forwards with count of bytes in length field of TLV</span>
                            parcounter++;
                            <span class="keywordflow">continue</span>;
                        }

                    }
                }
                chunk-&gt;setBitLength(cLen*8);
                dest-&gt;<a class="code" href="class_s_c_t_p_message.html#a46c6cc49994da66b04d2ab9eadc564b7" title="Adds a message object to the SCTP packet.">addChunk</a>(chunk);
                <span class="keywordflow">break</span>;
            }
            <span class="keywordflow">case</span> <a class="code" href="_s_c_t_p_association_8h.html#a8886377ab3f4b4ef217558f2b83b7b12a781ad2788df9e25c59a70894c7832096">ABORT</a>:
            {
                ev&lt;&lt;<span class="stringliteral">&quot;SCTPMessage: Abort received\n&quot;</span>;
                <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1abort__chunk.html">abort_chunk</a> *ac = (<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1abort__chunk.html">abort_chunk</a>*) (chunks + chunkPtr);
                cLen = <a class="code" href="aodv__uu__omnet_8h.html#ada37feda716b4ba89cf9dba34288141d">ntohs</a>(ac-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1abort__chunk.html#ac0550cef90bd35ba1bf8430ee783743d">length</a>);
                <a class="code" href="class_s_c_t_p_abort_chunk.html" title="Class generated from transport/sctp/SCTPMessage.msg by opp_msgc.">SCTPAbortChunk</a> *chunk = <span class="keyword">new</span> <a class="code" href="class_s_c_t_p_abort_chunk.html" title="Class generated from transport/sctp/SCTPMessage.msg by opp_msgc.">SCTPAbortChunk</a>(<span class="stringliteral">&quot;ABORT&quot;</span>);
                chunk-&gt;<a class="code" href="class_s_c_t_p_chunk.html#a9a923c2c54b4f6f78933e3c1b8990ca5">setChunkType</a>(chunkType);
                chunk-&gt;<a class="code" href="class_s_c_t_p_abort_chunk.html#a202e1e251cdf08c575bbfff87f471d94">setT_Bit</a>(ac-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1abort__chunk.html#af7c6588f89c568b6ca8dcf40cb32daf7">flags</a> &amp; T_BIT);
                <span class="keywordflow">if</span> (cLen&gt;size_abort_chunk)
                {
                    <span class="comment">// TODO: handle attached error causes</span>
                }
                chunk-&gt;setBitLength(cLen*8);
                dest-&gt;<a class="code" href="class_s_c_t_p_message.html#a46c6cc49994da66b04d2ab9eadc564b7" title="Adds a message object to the SCTP packet.">addChunk</a>(chunk);
                <span class="keywordflow">break</span>;
            }
            <span class="keywordflow">case</span> <a class="code" href="_s_c_t_p_association_8h.html#a8886377ab3f4b4ef217558f2b83b7b12ac6c3901afa866152be0e645c2c38f471">COOKIE_ECHO</a>:
            {
                <a class="code" href="class_s_c_t_p_cookie_echo_chunk.html" title="Class generated from transport/sctp/SCTPMessage.msg by opp_msgc.">SCTPCookieEchoChunk</a> *chunk = <span class="keyword">new</span> <a class="code" href="class_s_c_t_p_cookie_echo_chunk.html" title="Class generated from transport/sctp/SCTPMessage.msg by opp_msgc.">SCTPCookieEchoChunk</a>(<span class="stringliteral">&quot;COOKIE_ECHO&quot;</span>);
                chunk-&gt;<a class="code" href="class_s_c_t_p_chunk.html#a9a923c2c54b4f6f78933e3c1b8990ca5">setChunkType</a>(chunkType);
                <a class="code" href="_s_c_t_p_socket_8cc.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a>&lt;&lt;<span class="stringliteral">&quot;Parse Cookie-Echo\n&quot;</span>;
                <span class="keywordflow">if</span> (cLen&gt;size_cookie_echo_chunk)
                {
                    int32 cookieSize = woPadding-size_cookie_echo_chunk;
                    <a class="code" href="_s_c_t_p_socket_8cc.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a>&lt;&lt;<span class="stringliteral">&quot;cookieSize=&quot;</span>&lt;&lt;cookieSize&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;
                    <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1cookie__parameter.html">cookie_parameter</a> *cookie = (<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1cookie__parameter.html">cookie_parameter</a>*)(chunks+chunkPtr+4);
                    <a class="code" href="class_s_c_t_p_cookie.html" title="Class generated from transport/sctp/SCTPMessage.msg by opp_msgc.">SCTPCookie</a>* stateCookie = <span class="keyword">new</span> <a class="code" href="class_s_c_t_p_cookie.html" title="Class generated from transport/sctp/SCTPMessage.msg by opp_msgc.">SCTPCookie</a>();
                    stateCookie-&gt;<a class="code" href="class_s_c_t_p_cookie.html#a00cd28f412b3f03100081aaee7666281">setCreationTime</a>(<a class="code" href="aodv__uu__omnet_8h.html#ac317b3e903719ba02894f1710f7f2439">ntohl</a>(cookie-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1cookie__parameter.html#a96b0f36a38c9886943c75ba5b29c0ef0">creationTime</a>));
                    stateCookie-&gt;<a class="code" href="class_s_c_t_p_cookie.html#a22f9a93576e81d6f06872a9d91d1c3f8">setLocalTag</a>(<a class="code" href="aodv__uu__omnet_8h.html#ac317b3e903719ba02894f1710f7f2439">ntohl</a>(cookie-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1cookie__parameter.html#a023a4299beb2cfb28dd2ef1dfd0478c7">localTag</a>));
                    stateCookie-&gt;<a class="code" href="class_s_c_t_p_cookie.html#a5b241fba18b76328801d62eb6e6198ae">setPeerTag</a>(<a class="code" href="aodv__uu__omnet_8h.html#ac317b3e903719ba02894f1710f7f2439">ntohl</a>(cookie-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1cookie__parameter.html#a648153b48ec8424e1f72ff921b8a644d">peerTag</a>));
                    stateCookie-&gt;<a class="code" href="class_s_c_t_p_cookie.html#a418651ad52ef5a5e436689a21eee0575">setLocalTieTagArraySize</a>(32);
                    stateCookie-&gt;<a class="code" href="class_s_c_t_p_cookie.html#a0cab05bbec5ce9ad0f62107a871e3bdd">setPeerTieTagArraySize</a>(32);
                    <span class="keywordflow">for</span> (int32 i=0; i&lt;32; i++)
                    {
                        stateCookie-&gt;<a class="code" href="class_s_c_t_p_cookie.html#af6b595bf524224f8cc983eb8bbd20dd9">setLocalTieTag</a>(i, cookie-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1cookie__parameter.html#ad99c0071b11d8dfd434ec386226611f7">localTieTag</a>[i]);
                        stateCookie-&gt;<a class="code" href="class_s_c_t_p_cookie.html#a087978eb336fd599d1cbf7dc82ef4fd8">setPeerTieTag</a>(i, cookie-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1cookie__parameter.html#a34286a6e985ef4527a947f4199333dc0">peerTieTag</a>[i]);
                    }
                    stateCookie-&gt;setBitLength(<a class="code" href="_s_c_t_p_association_8h.html#a3aeb03eaba88c9681ecb920f24c689d2">SCTP_COOKIE_LENGTH</a>*8);
                    chunk-&gt;<a class="code" href="class_s_c_t_p_cookie_echo_chunk.html#a12ab8ce719ddfcbb665a539ff5acf96e">setStateCookie</a>(stateCookie);
                }
                chunk-&gt;setBitLength(woPadding*8);
                dest-&gt;<a class="code" href="class_s_c_t_p_message.html#a46c6cc49994da66b04d2ab9eadc564b7" title="Adds a message object to the SCTP packet.">addChunk</a>(chunk);
                <span class="keywordflow">break</span>;
            }
            <span class="keywordflow">case</span> <a class="code" href="_s_c_t_p_association_8h.html#a8886377ab3f4b4ef217558f2b83b7b12a8cb5544ff09ee0b2ae1f1171de9597bd">COOKIE_ACK</a>:
            {
                ev&lt;&lt;<span class="stringliteral">&quot;SCTPMessage: Cookie_Ack received\n&quot;</span>;
                <a class="code" href="class_s_c_t_p_cookie_ack_chunk.html" title="Class generated from transport/sctp/SCTPMessage.msg by opp_msgc.">SCTPCookieAckChunk</a> *chunk = <span class="keyword">new</span> <a class="code" href="class_s_c_t_p_cookie_ack_chunk.html" title="Class generated from transport/sctp/SCTPMessage.msg by opp_msgc.">SCTPCookieAckChunk</a>(<span class="stringliteral">&quot;COOKIE_ACK&quot;</span>);
                chunk-&gt;<a class="code" href="class_s_c_t_p_chunk.html#a9a923c2c54b4f6f78933e3c1b8990ca5">setChunkType</a>(chunkType);
                chunk-&gt;setBitLength(cLen*8);
                dest-&gt;<a class="code" href="class_s_c_t_p_message.html#a46c6cc49994da66b04d2ab9eadc564b7" title="Adds a message object to the SCTP packet.">addChunk</a>(chunk);
                <span class="keywordflow">break</span>;
            }
            <span class="keywordflow">case</span> <a class="code" href="_s_c_t_p_association_8h.html#a8886377ab3f4b4ef217558f2b83b7b12a7690b021f467450541d8d89123429d40">SHUTDOWN</a>:
            {
                ev&lt;&lt;<span class="stringliteral">&quot;SCTPMessage: Shutdown received\n&quot;</span>;
                <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1shutdown__chunk.html">shutdown_chunk</a> *sc = (<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1shutdown__chunk.html">shutdown_chunk</a>*) (chunks + chunkPtr);
                <a class="code" href="class_s_c_t_p_shutdown_chunk.html" title="Class generated from transport/sctp/SCTPMessage.msg by opp_msgc.">SCTPShutdownChunk</a> *chunk = <span class="keyword">new</span> <a class="code" href="class_s_c_t_p_shutdown_chunk.html" title="Class generated from transport/sctp/SCTPMessage.msg by opp_msgc.">SCTPShutdownChunk</a>(<span class="stringliteral">&quot;SHUTDOWN&quot;</span>);
                chunk-&gt;<a class="code" href="class_s_c_t_p_chunk.html#a9a923c2c54b4f6f78933e3c1b8990ca5">setChunkType</a>(chunkType);
                uint32 cumtsnack = <a class="code" href="aodv__uu__omnet_8h.html#ac317b3e903719ba02894f1710f7f2439">ntohl</a>(sc-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1shutdown__chunk.html#a294183dee80de069c3e9583ff376b791">cumulative_tsn_ack</a>);
                chunk-&gt;<a class="code" href="class_s_c_t_p_shutdown_chunk.html#ade43b5d35a9a15e393623acd0ae62b21">setCumTsnAck</a>(cumtsnack);
                chunk-&gt;setBitLength(cLen*8);
                dest-&gt;<a class="code" href="class_s_c_t_p_message.html#a46c6cc49994da66b04d2ab9eadc564b7" title="Adds a message object to the SCTP packet.">addChunk</a>(chunk);
                <span class="keywordflow">break</span>;
            }
            <span class="keywordflow">case</span> <a class="code" href="_s_c_t_p_association_8h.html#a8886377ab3f4b4ef217558f2b83b7b12a7f11b152058ba8f4656266d735a50c4b">SHUTDOWN_ACK</a>:
            {
                ev&lt;&lt;<span class="stringliteral">&quot;SCTPMessage: ShutdownAck received\n&quot;</span>;
                <a class="code" href="class_s_c_t_p_shutdown_ack_chunk.html" title="Class generated from transport/sctp/SCTPMessage.msg by opp_msgc.">SCTPShutdownAckChunk</a> *chunk = <span class="keyword">new</span> <a class="code" href="class_s_c_t_p_shutdown_ack_chunk.html" title="Class generated from transport/sctp/SCTPMessage.msg by opp_msgc.">SCTPShutdownAckChunk</a>(<span class="stringliteral">&quot;SHUTDOWN_ACK&quot;</span>);
                chunk-&gt;<a class="code" href="class_s_c_t_p_chunk.html#a9a923c2c54b4f6f78933e3c1b8990ca5">setChunkType</a>(chunkType);
                chunk-&gt;setBitLength(cLen*8);
                dest-&gt;<a class="code" href="class_s_c_t_p_message.html#a46c6cc49994da66b04d2ab9eadc564b7" title="Adds a message object to the SCTP packet.">addChunk</a>(chunk);
                <span class="keywordflow">break</span>;
            }
            <span class="keywordflow">case</span> <a class="code" href="_s_c_t_p_association_8h.html#a8886377ab3f4b4ef217558f2b83b7b12a1ac9ae29771c5095efe16ce822d561d7">SHUTDOWN_COMPLETE</a>:
            {
                ev&lt;&lt;<span class="stringliteral">&quot;SCTPMessage: ShutdownComplete received\n&quot;</span>;
                <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1shutdown__complete__chunk.html">shutdown_complete_chunk</a> *scc = (<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1shutdown__complete__chunk.html">shutdown_complete_chunk</a>*) (chunks + chunkPtr);
                <a class="code" href="class_s_c_t_p_shutdown_complete_chunk.html" title="Class generated from transport/sctp/SCTPMessage.msg by opp_msgc.">SCTPShutdownCompleteChunk</a> *chunk = <span class="keyword">new</span> <a class="code" href="class_s_c_t_p_shutdown_complete_chunk.html" title="Class generated from transport/sctp/SCTPMessage.msg by opp_msgc.">SCTPShutdownCompleteChunk</a>(<span class="stringliteral">&quot;SHUTDOWN_COMPLETE&quot;</span>);
                chunk-&gt;<a class="code" href="class_s_c_t_p_chunk.html#a9a923c2c54b4f6f78933e3c1b8990ca5">setChunkType</a>(chunkType);
                chunk-&gt;<a class="code" href="class_s_c_t_p_shutdown_complete_chunk.html#adfd34e3d24c8a7e4a0a521dafc9186af">setTBit</a>(scc-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1shutdown__complete__chunk.html#a234c2bbc04b3655058a07315144f5dc8">flags</a> &amp; T_BIT);
                chunk-&gt;setBitLength(cLen*8);
                dest-&gt;<a class="code" href="class_s_c_t_p_message.html#a46c6cc49994da66b04d2ab9eadc564b7" title="Adds a message object to the SCTP packet.">addChunk</a>(chunk);
                <span class="keywordflow">break</span>;
            }
            <span class="keywordflow">case</span> <a class="code" href="_s_c_t_p_association_8h.html#a8886377ab3f4b4ef217558f2b83b7b12a511842f389362e9f11f52a88556455f1">ERRORTYPE</a>:
            {
                <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1error__chunk.html">error_chunk</a> *error;
                error = (<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1error__chunk.html">error_chunk</a>*) (chunks + chunkPtr);
                <a class="code" href="class_s_c_t_p_error_chunk.html">SCTPErrorChunk</a> *errorchunk;
                errorchunk = <span class="keyword">new</span> <a class="code" href="class_s_c_t_p_error_chunk.html">SCTPErrorChunk</a>(<span class="stringliteral">&quot;ERROR&quot;</span>);
                errorchunk-&gt;<a class="code" href="class_s_c_t_p_chunk.html#a9a923c2c54b4f6f78933e3c1b8990ca5">setChunkType</a>(chunkType);
                errorchunk-&gt;setBitLength(<a class="code" href="_s_c_t_p_association_8h.html#aabfb8449670ea3f037420cabb853b8fa">SCTP_ERROR_CHUNK_LENGTH</a>*8);
                parptr = 0;
                dest-&gt;<a class="code" href="class_s_c_t_p_message.html#a46c6cc49994da66b04d2ab9eadc564b7" title="Adds a message object to the SCTP packet.">addChunk</a>(errorchunk);
                <span class="keywordflow">break</span>;
            }
            <span class="keywordflow">default</span>:
                <span class="comment">//printf(&quot;TODO: Implement chunk type %d, found in chunk array on %d!\n&quot;, chunkType, ct);</span>
                <a class="code" href="_s_c_t_p_socket_8cc.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a> &lt;&lt; <span class="stringliteral">&quot;Parser: Unknown SCTP chunk type &quot;</span> &lt;&lt; chunkType;

                <span class="comment">/*throw new cRuntimeError(&quot;TODO: unknown chunktype in incoming packet from external interface! Implement it!&quot;);*/</span>

                <span class="keywordflow">break</span>;
        }   <span class="comment">// end of switch(chunkType)</span>
        chunkPtr += cLen;
    }   <span class="comment">// end of while()</span>
}
</pre></div>
</div>
</div>
<a class="anchor" id="ab955e6ade690a1a3332ec8827af55ddf"></a><!-- doxytag: member="SCTPSerializer::serialize" ref="ab955e6ade690a1a3332ec8827af55ddf" args="(const SCTPMessage *msg, uint8 *buf, uint32 bufsize)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int32 <a class="el" href="class_s_c_t_p_serializer.html#ab955e6ade690a1a3332ec8827af55ddf">SCTPSerializer::serialize</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_s_c_t_p_message.html">SCTPMessage</a> *&#160;</td>
          <td class="paramname"><em>msg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8 *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32&#160;</td>
          <td class="paramname"><em>bufsize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Serializes an <a class="el" href="class_s_c_t_p_message.html" title="Represents a SCTP Message.">SCTPMessage</a> for transmission on the wire. </p>
<p>The checksum is NOT filled in. (The kernel does that when sending the frame over a raw socket.) Returns the length of data written into buffer. </p>
<div class="fragment"><pre class="fragment">{
    int32 size_init_chunk = <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1init__chunk.html">init_chunk</a>);
    int32 size_sack_chunk = <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1sack__chunk.html">sack_chunk</a>);
    int32 size_heartbeat_chunk = <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1heartbeat__chunk.html">heartbeat_chunk</a>);
    int32 size_heartbeat_ack_chunk = <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1heartbeat__ack__chunk.html">heartbeat_ack_chunk</a>);
    int32 size_chunk = <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1chunk.html">chunk</a>);


    <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1common__header.html">common_header</a> *ch = (<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1common__header.html">common_header</a>*) (buf);
    uint32 writtenbytes = <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1common__header.html">common_header</a>);

    <span class="comment">// fill SCTP common header structure</span>
    ch-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1common__header.html#a16df1d45094b56d46256db05ebb39fc3">source_port</a> = <a class="code" href="aodv__uu__omnet_8h.html#a51799f5ebb4c7228ef7e95c247030f42">htons</a>(msg-&gt;<a class="code" href="class_s_c_t_p_message___base.html#a558f8691efac42febdfd422ce52a762c">getSrcPort</a>());
    ch-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1common__header.html#a6b69320aeac29fa21ad450b2104336c1">destination_port</a> = <a class="code" href="aodv__uu__omnet_8h.html#a51799f5ebb4c7228ef7e95c247030f42">htons</a>(msg-&gt;<a class="code" href="class_s_c_t_p_message___base.html#a813a5ab9db3e1c4ae354bf44de934a5b">getDestPort</a>());
    ch-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1common__header.html#a7405e47d14a91f6fa6558a25770b94b2">verification_tag</a> = <a class="code" href="aodv__uu__omnet_8h.html#ae4027a6ad07f13aa12eab285a1b46019">htonl</a>(msg-&gt;<a class="code" href="class_s_c_t_p_message___base.html#acdebc18b6064656d372b86198736dd67">getTag</a>());


    <span class="comment">// SCTP chunks:</span>
    int32 noChunks = msg-&gt;<a class="code" href="class_s_c_t_p_message.html#a6f20de2280586794996c56c77bf5c479" title="Returns the number of chunks in this SCTP packet.">getChunksArraySize</a>();
        <span class="keywordflow">for</span> (int32 cc = 0; cc &lt; noChunks; cc++)
        {
            <span class="keyword">const</span> <a class="code" href="class_s_c_t_p_chunk.html" title="Class generated from transport/sctp/SCTPMessage.msg by opp_msgc.">SCTPChunk</a> *<a class="code" href="struct_i_n_e_t_fw_1_1chunk.html">chunk</a> = check_and_cast&lt;<a class="code" href="class_s_c_t_p_chunk.html" title="Class generated from transport/sctp/SCTPMessage.msg by opp_msgc.">SCTPChunk</a> *&gt;(((<a class="code" href="class_s_c_t_p_message.html" title="Represents a SCTP Message.">SCTPMessage</a> *)msg)-&gt;getChunks(cc));
            <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> chunkType = <a class="code" href="struct_i_n_e_t_fw_1_1chunk.html">chunk</a>-&gt;getChunkType();
            <span class="keywordflow">switch</span> (chunkType)
            {
                <span class="keywordflow">case</span> <a class="code" href="_s_c_t_p_association_8h.html#a8886377ab3f4b4ef217558f2b83b7b12a9d7d6f31868d66330397c967c4afd2d2">DATA</a>:
                {
                    <span class="comment">//sctpEV3&lt;&lt;simulation.simTime()&lt;&lt;&quot; SCTPAssociation:: Data sent \n&quot;;</span>
                    <a class="code" href="class_s_c_t_p_data_chunk.html" title="Class generated from transport/sctp/SCTPMessage.msg by opp_msgc.">SCTPDataChunk</a> *dataChunk = check_and_cast&lt;<a class="code" href="class_s_c_t_p_data_chunk.html" title="Class generated from transport/sctp/SCTPMessage.msg by opp_msgc.">SCTPDataChunk</a> *&gt;(<a class="code" href="struct_i_n_e_t_fw_1_1chunk.html">chunk</a>);
                    <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1data__chunk.html">data_chunk</a> *dc = (<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1data__chunk.html">data_chunk</a>*) (buf + writtenbytes); <span class="comment">// append data to buffer</span>
                    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="structdata__chunk.html#aa705d8bf5f389d647f322aa875f12fb6">flags</a> = 0;

                    <span class="comment">// fill buffer with data from SCTP data chunk structure</span>
                    dc-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1data__chunk.html#a109e8b0a1dcbe8922d54aa7a1e959e33">type</a> = dataChunk-&gt;<a class="code" href="class_s_c_t_p_chunk.html#a752caf91430fcd3157a12e7e91361471">getChunkType</a>();
                    <span class="keywordflow">if</span> (dataChunk-&gt;<a class="code" href="class_s_c_t_p_data_chunk.html#a7e5d0159206e00474d6d19ca7d67c871">getUBit</a>())
                        flags |= UNORDERED_BIT;
                    <span class="keywordflow">if</span> (dataChunk-&gt;<a class="code" href="class_s_c_t_p_data_chunk.html#a09be0795444196f77657d82cfc0a1e8e">getBBit</a>())
                        flags |= BEGIN_BIT;
                    <span class="keywordflow">if</span> (dataChunk-&gt;<a class="code" href="class_s_c_t_p_data_chunk.html#a53ca18ab3a98a501cdc5800c1037afe2">getEBit</a>())
                        flags |= END_BIT;
                    dc-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1data__chunk.html#a41dcf9feaa1ad2f81414ca7eab15e3b8">flags</a> = <a class="code" href="structdata__chunk.html#aa705d8bf5f389d647f322aa875f12fb6">flags</a>;
                    dc-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1data__chunk.html#a0ab55ad1c1ba0ab2aa4082aed1ccf537">length</a> = <a class="code" href="aodv__uu__omnet_8h.html#a51799f5ebb4c7228ef7e95c247030f42">htons</a>(dataChunk-&gt;getByteLength());
                    dc-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1data__chunk.html#a25db3ec53867059f7ffe5b050a43ae14">tsn</a> = <a class="code" href="aodv__uu__omnet_8h.html#ae4027a6ad07f13aa12eab285a1b46019">htonl</a>(dataChunk-&gt;<a class="code" href="class_s_c_t_p_data_chunk.html#a3b70fe8e5afc376f25caa199b117c9f2">getTsn</a>());
                    dc-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1data__chunk.html#a22aace84bd5e2295d4e706a55437cc1d">sid</a> = <a class="code" href="aodv__uu__omnet_8h.html#a51799f5ebb4c7228ef7e95c247030f42">htons</a>(dataChunk-&gt;<a class="code" href="class_s_c_t_p_data_chunk.html#a8e381b0653e3fc6a34ae896e040b30bf">getSid</a>());
                    dc-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1data__chunk.html#a240c6255e13bad8f6a7d41f5ec3559ef">ssn</a> = <a class="code" href="aodv__uu__omnet_8h.html#a51799f5ebb4c7228ef7e95c247030f42">htons</a>(dataChunk-&gt;<a class="code" href="class_s_c_t_p_data_chunk.html#a1473a86a339c6d1821a42ee85da6b792">getSsn</a>());
                    dc-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1data__chunk.html#a379ae5a1ddc385ee44d98cffd39632ee">ppi</a> = <a class="code" href="aodv__uu__omnet_8h.html#ae4027a6ad07f13aa12eab285a1b46019">htonl</a>(dataChunk-&gt;<a class="code" href="class_s_c_t_p_data_chunk.html#af0daf8b4cbb2620106d449c065ac4a4d">getPpid</a>());
                    writtenbytes += <a class="code" href="_s_c_t_p_association_8h.html#aad0be78d1352b9d9fa6a695ed18c9d65">SCTP_DATA_CHUNK_LENGTH</a>;

                    <a class="code" href="class_s_c_t_p_simple_message.html" title="Class generated from transport/sctp/SCTPMessage.msg by opp_msgc.">SCTPSimpleMessage</a> *smsg = check_and_cast&lt;<a class="code" href="class_s_c_t_p_simple_message.html" title="Class generated from transport/sctp/SCTPMessage.msg by opp_msgc.">SCTPSimpleMessage</a> *&gt;(dataChunk-&gt;getEncapsulatedPacket());
                        <span class="comment">// T.D. 09.02.2010: Only copy data when there is something to copy!</span>
                        <span class="keyword">const</span> uint32 datalen = smsg-&gt;<a class="code" href="class_s_c_t_p_simple_message.html#a4838827e65f3ed85291583a6b629852f">getDataLen</a>();
                        <span class="keywordflow">if</span> ( smsg-&gt;<a class="code" href="class_s_c_t_p_simple_message.html#a622610c3483c746bcdb2873d2c31bb5e">getDataArraySize</a>() &gt;= datalen) {
                            <span class="keywordflow">for</span> (uint32 i = 0; i &lt; datalen; i++) {
                                dc-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1data__chunk.html#a3747c423ac3fa73c5954351d1e38ded0">user_data</a>[i] = smsg-&gt;<a class="code" href="class_s_c_t_p_simple_message.html#a0a498c322e58707458a0ab5b33b80ff8">getData</a>(i);
                            }
                        }
                        writtenbytes += <a class="code" href="_s_c_t_p_association_8h.html#a34c6101299ca6658c48834e679883867">ADD_PADDING</a>(datalen);
                    <span class="keywordflow">break</span>;
                }
                <span class="keywordflow">case</span> <a class="code" href="_s_c_t_p_association_8h.html#a8886377ab3f4b4ef217558f2b83b7b12a0cb1b2c6a7db1f1084886c98909a3f36">INIT</a>:
                {
                    <span class="comment">//sctpEV3&lt;&lt;&quot;serialize INIT sizeKeyVector=&quot;&lt;&lt;sizeKeyVector&lt;&lt;&quot;\n&quot;;</span>
                    <span class="comment">// source data from internal struct:</span>
                    <a class="code" href="class_s_c_t_p_init_chunk.html" title="Class generated from transport/sctp/SCTPMessage.msg by opp_msgc.">SCTPInitChunk</a> *initChunk = check_and_cast&lt;<a class="code" href="class_s_c_t_p_init_chunk.html" title="Class generated from transport/sctp/SCTPMessage.msg by opp_msgc.">SCTPInitChunk</a> *&gt;(<a class="code" href="struct_i_n_e_t_fw_1_1chunk.html">chunk</a>);
                    <span class="comment">//sctpEV3&lt;&lt;simulation.simTime()&lt;&lt;&quot; SCTPAssociation:: Init sent \n&quot;;</span>
                    <span class="comment">// destination is send buffer:</span>
                    <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1init__chunk.html">init_chunk</a> *ic = (<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1init__chunk.html">init_chunk</a>*) (buf + writtenbytes); <span class="comment">// append data to buffer</span>
                    <span class="comment">//buflen += (initChunk-&gt;getBitLength() / 8);</span>

                    <span class="comment">// fill buffer with data from SCTP init chunk structure</span>
                    ic-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1init__chunk.html#a9cdebf76f678051b3692f14e6d92aae0">type</a> = initChunk-&gt;<a class="code" href="class_s_c_t_p_chunk.html#a752caf91430fcd3157a12e7e91361471">getChunkType</a>();
                    ic-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1init__chunk.html#a8b0d56d06d49b51197d6200cddba834a">flags</a> = 0; <span class="comment">// no flags available in this type of SCTPChunk</span>
                    ic-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1init__chunk.html#a7315d4164cc15995adf0bdec0511af1c">initiate_tag</a> = <a class="code" href="aodv__uu__omnet_8h.html#ae4027a6ad07f13aa12eab285a1b46019">htonl</a>(initChunk-&gt;<a class="code" href="class_s_c_t_p_init_chunk.html#afa1021475befe8c6a1c6916c71409458">getInitTag</a>());
                    ic-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1init__chunk.html#a54cf1029a7b2d050336e4c76cd197654">a_rwnd</a> = <a class="code" href="aodv__uu__omnet_8h.html#ae4027a6ad07f13aa12eab285a1b46019">htonl</a>(initChunk-&gt;<a class="code" href="class_s_c_t_p_init_chunk.html#ac3e3b0bfb2f205d91a1c0f451f214fde">getA_rwnd</a>());
                    ic-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1init__chunk.html#a947a36c02bac8bb6549ad270fe51714e">mos</a> = <a class="code" href="aodv__uu__omnet_8h.html#a51799f5ebb4c7228ef7e95c247030f42">htons</a>(initChunk-&gt;<a class="code" href="class_s_c_t_p_init_chunk.html#a9216f42a96bd384ccd5fc7efbe429646">getNoOutStreams</a>());
                    ic-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1init__chunk.html#ae3094436bd6843ba61ab9b20f44e87f9">mis</a> = <a class="code" href="aodv__uu__omnet_8h.html#a51799f5ebb4c7228ef7e95c247030f42">htons</a>(initChunk-&gt;<a class="code" href="class_s_c_t_p_init_chunk.html#a7d5b4ee8a00cd330a724936d3ad0403d">getNoInStreams</a>());
                    ic-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1init__chunk.html#ad0e25ef59a88465391ed7ed5608f9b70">initial_tsn</a> = <a class="code" href="aodv__uu__omnet_8h.html#ae4027a6ad07f13aa12eab285a1b46019">htonl</a>(initChunk-&gt;<a class="code" href="class_s_c_t_p_init_chunk.html#ae4065b9263e0e1fb023fa04cfbdf25d3">getInitTSN</a>());
                    int32 parPtr = 0;
                    <span class="comment">// Var.-Len. Parameters</span>
                    <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1supported__address__types__parameter.html">supported_address_types_parameter</a>* sup_addr = (<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1supported__address__types__parameter.html">supported_address_types_parameter</a>*) (((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)ic) + size_init_chunk + parPtr);
                    sup_addr-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1supported__address__types__parameter.html#a149ee2f7dad36d74724e488903940246">type</a> = <a class="code" href="aodv__uu__omnet_8h.html#a51799f5ebb4c7228ef7e95c247030f42">htons</a>(INIT_SUPPORTED_ADDRESS);
                    sup_addr-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1supported__address__types__parameter.html#a51610238a939c7fd088bf7a795d70357">length</a> = <a class="code" href="aodv__uu__omnet_8h.html#a51799f5ebb4c7228ef7e95c247030f42">htons</a>(6);
                    sup_addr-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1supported__address__types__parameter.html#a11dffde51b23deb764cd03e2f340db26">address_type</a> = <a class="code" href="aodv__uu__omnet_8h.html#a51799f5ebb4c7228ef7e95c247030f42">htons</a>(INIT_PARAM_IPV4);
                    parPtr += 8;
                    int32 numaddr = initChunk-&gt;<a class="code" href="class_s_c_t_p_init_chunk.html#ab8d75b13425628af279f244c43e17637">getAddressesArraySize</a>();
                    <span class="keywordflow">for</span> (int32 i=0; i&lt;numaddr; i++)
                    {
                            <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1init__ipv4__address__parameter.html">init_ipv4_address_parameter</a> *ipv4addr = (<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1init__ipv4__address__parameter.html">init_ipv4_address_parameter</a>*) (((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)ic) + size_init_chunk + parPtr);
                            ipv4addr-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1init__ipv4__address__parameter.html#ae6f54209bc788f8225512e9caf290da0">type</a> = <a class="code" href="aodv__uu__omnet_8h.html#a51799f5ebb4c7228ef7e95c247030f42">htons</a>(INIT_PARAM_IPV4);
                            ipv4addr-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1init__ipv4__address__parameter.html#a823367d591586e1469d57df9a3278d30">length</a> = <a class="code" href="aodv__uu__omnet_8h.html#a51799f5ebb4c7228ef7e95c247030f42">htons</a>(8);
                            ipv4addr-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1init__ipv4__address__parameter.html#a9538c188df90d12ec2860698be2d2368">address</a> = <a class="code" href="aodv__uu__omnet_8h.html#ae4027a6ad07f13aa12eab285a1b46019">htonl</a>(initChunk-&gt;<a class="code" href="class_s_c_t_p_init_chunk.html#a959b2cb8375fd157035cad0b4e37c00e">getAddresses</a>(i).<a class="code" href="class_i_pv_x_address.html#a961b38a74371d8aa29d8e6906a071d64" title="Get IPv4 address.">get4</a>().<a class="code" href="class_i_pv4_address.html#ac4abdd5df9c86071f13af7a3f0931237" title="Returns the address as an int.">getInt</a>());
                            parPtr += <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1init__ipv4__address__parameter.html">init_ipv4_address_parameter</a>);
                    }
                    ic-&gt;length = <a class="code" href="aodv__uu__omnet_8h.html#a51799f5ebb4c7228ef7e95c247030f42">htons</a>(<a class="code" href="_s_c_t_p_association_8h.html#a685f1682f68294dbb12e7953e02748a0">SCTP_INIT_CHUNK_LENGTH</a>+parPtr);
                    writtenbytes += <a class="code" href="_s_c_t_p_association_8h.html#a685f1682f68294dbb12e7953e02748a0">SCTP_INIT_CHUNK_LENGTH</a>+parPtr;
                    <span class="keywordflow">break</span>;
                }
                <span class="keywordflow">case</span> <a class="code" href="_s_c_t_p_association_8h.html#a8886377ab3f4b4ef217558f2b83b7b12abb473557985d30fdf16d2525388e3a22">INIT_ACK</a>:
                {
                    <span class="comment">//sctpEV3&lt;&lt;&quot;serialize INIT_ACK sizeKeyVector=&quot;&lt;&lt;sizeKeyVector&lt;&lt;&quot;\n&quot;;</span>
                    <a class="code" href="class_s_c_t_p_init_ack_chunk.html" title="Class generated from transport/sctp/SCTPMessage.msg by opp_msgc.">SCTPInitAckChunk</a> *initAckChunk = check_and_cast&lt;<a class="code" href="class_s_c_t_p_init_ack_chunk.html" title="Class generated from transport/sctp/SCTPMessage.msg by opp_msgc.">SCTPInitAckChunk</a> *&gt;(<a class="code" href="struct_i_n_e_t_fw_1_1chunk.html">chunk</a>);
                    <span class="comment">//sctpEV3&lt;&lt;simulation.simTime()&lt;&lt;&quot; SCTPAssociation:: InitAck sent \n&quot;;</span>
                    <span class="comment">// destination is send buffer:</span>
                    <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1init__ack__chunk.html">init_ack_chunk</a> *iac = (<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1init__ack__chunk.html">init_ack_chunk</a>*) (buf + writtenbytes); <span class="comment">// append data to buffer</span>
                    <span class="comment">// fill buffer with data from SCTP init ack chunk structure</span>
                    iac-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1init__ack__chunk.html#a0b3250c76a08f6fa3363814b5f91f25c">type</a> = initAckChunk-&gt;<a class="code" href="class_s_c_t_p_chunk.html#a752caf91430fcd3157a12e7e91361471">getChunkType</a>();
<span class="comment">//                  iac-&gt;flags = initAckChunk-&gt;getFlags(); // no flags available in this type of SCTPChunk</span>
                    iac-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1init__ack__chunk.html#a7a54bd2ed88345cdb5c902f56bc8d3c7">initiate_tag</a> = <a class="code" href="aodv__uu__omnet_8h.html#ae4027a6ad07f13aa12eab285a1b46019">htonl</a>(initAckChunk-&gt;<a class="code" href="class_s_c_t_p_init_ack_chunk.html#a067000126a6938965bc9deaeed4f33d2">getInitTag</a>());
                    iac-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1init__ack__chunk.html#aa95033ee21e5290df42be51a8b696679">a_rwnd</a> = <a class="code" href="aodv__uu__omnet_8h.html#ae4027a6ad07f13aa12eab285a1b46019">htonl</a>(initAckChunk-&gt;<a class="code" href="class_s_c_t_p_init_ack_chunk.html#aa625f04bffd8ec87bb7226eb3ed1abb8">getA_rwnd</a>());
                    iac-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1init__ack__chunk.html#af32685d03e6d9489916b3e6824261ac5">mos</a> = <a class="code" href="aodv__uu__omnet_8h.html#a51799f5ebb4c7228ef7e95c247030f42">htons</a>(initAckChunk-&gt;<a class="code" href="class_s_c_t_p_init_ack_chunk.html#a64b761b71a09ea953f5bce83fd97ffdd">getNoOutStreams</a>());
                    iac-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1init__ack__chunk.html#af18c98e1baef7393f88d5141b17e0c91">mis</a> = <a class="code" href="aodv__uu__omnet_8h.html#a51799f5ebb4c7228ef7e95c247030f42">htons</a>(initAckChunk-&gt;<a class="code" href="class_s_c_t_p_init_ack_chunk.html#ad5c6481930be3268165af4939b911bd3">getNoInStreams</a>());
                    iac-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1init__ack__chunk.html#af9294b9a9ff18b46973e93b122b74413">initial_tsn</a> = <a class="code" href="aodv__uu__omnet_8h.html#ae4027a6ad07f13aa12eab285a1b46019">htonl</a>(initAckChunk-&gt;<a class="code" href="class_s_c_t_p_init_ack_chunk.html#ab0621aa5ef96b63f7a2660c421149179">getInitTSN</a>());
                    <span class="comment">// Var.-Len. Parameters</span>
                    int32 parPtr = 0;

                    <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1supported__address__types__parameter.html">supported_address_types_parameter</a>* sup_addr = (<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1supported__address__types__parameter.html">supported_address_types_parameter</a>*) (((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)iac) + size_init_chunk + parPtr);
                    sup_addr-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1supported__address__types__parameter.html#a149ee2f7dad36d74724e488903940246">type</a> = <a class="code" href="aodv__uu__omnet_8h.html#a51799f5ebb4c7228ef7e95c247030f42">htons</a>(INIT_SUPPORTED_ADDRESS);
                    sup_addr-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1supported__address__types__parameter.html#a51610238a939c7fd088bf7a795d70357">length</a> = <a class="code" href="aodv__uu__omnet_8h.html#a51799f5ebb4c7228ef7e95c247030f42">htons</a>(6);
                    sup_addr-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1supported__address__types__parameter.html#a11dffde51b23deb764cd03e2f340db26">address_type</a> = <a class="code" href="aodv__uu__omnet_8h.html#a51799f5ebb4c7228ef7e95c247030f42">htons</a>(INIT_PARAM_IPV4);
                    parPtr += 8;


                    int32 numaddr = initAckChunk-&gt;<a class="code" href="class_s_c_t_p_init_ack_chunk.html#a5c7c883d19db47b99bc1549fb5000a2f">getAddressesArraySize</a>();
                    <span class="keywordflow">for</span> (int32 i=0; i&lt;numaddr; i++)
                    {
                        <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1init__ipv4__address__parameter.html">init_ipv4_address_parameter</a> *ipv4addr = (<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1init__ipv4__address__parameter.html">init_ipv4_address_parameter</a>*) (((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)iac) + size_init_chunk + parPtr);
                        ipv4addr-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1init__ipv4__address__parameter.html#ae6f54209bc788f8225512e9caf290da0">type</a> = <a class="code" href="aodv__uu__omnet_8h.html#a51799f5ebb4c7228ef7e95c247030f42">htons</a>(INIT_PARAM_IPV4);
                        ipv4addr-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1init__ipv4__address__parameter.html#a823367d591586e1469d57df9a3278d30">length</a> = <a class="code" href="aodv__uu__omnet_8h.html#a51799f5ebb4c7228ef7e95c247030f42">htons</a>(8);
                        ipv4addr-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1init__ipv4__address__parameter.html#a9538c188df90d12ec2860698be2d2368">address</a> = <a class="code" href="aodv__uu__omnet_8h.html#ae4027a6ad07f13aa12eab285a1b46019">htonl</a>(initAckChunk-&gt;<a class="code" href="class_s_c_t_p_init_ack_chunk.html#ab0b54784a3ce7250ea7319d06c2c1d51">getAddresses</a>(i).<a class="code" href="class_i_pv_x_address.html#a961b38a74371d8aa29d8e6906a071d64" title="Get IPv4 address.">get4</a>().<a class="code" href="class_i_pv4_address.html#ac4abdd5df9c86071f13af7a3f0931237" title="Returns the address as an int.">getInt</a>());
                        parPtr += 8;
                    }
                    uint32 uLen = initAckChunk-&gt;<a class="code" href="class_s_c_t_p_init_ack_chunk.html#a782f1937ded9a07b427f13c9a6a22330">getUnrecognizedParametersArraySize</a>();
                    <span class="keywordflow">if</span> (uLen&gt;0)
                    {
                        <span class="comment">//sctpEV3&lt;&lt;&quot;uLen=&quot;&lt;&lt;uLen&lt;&lt;&quot;\n&quot;;</span>
                        int32 k = 0;
                        uint32 pLen = 0;
                        <span class="keywordflow">while</span> (uLen&gt;0)
                        {
                            <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1tlv.html">tlv</a>* unknown = (<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1tlv.html">tlv</a>*) (((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)iac) + size_init_chunk + parPtr);
                            unknown-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1tlv.html#a0376609c5b5aeb16ae4840581987d033">type</a> = <a class="code" href="aodv__uu__omnet_8h.html#a51799f5ebb4c7228ef7e95c247030f42">htons</a>(<a class="code" href="_s_c_t_p_association_8h.html#a8d59686e974f326f12076166b80dcad1a84eff3c1951655fd6a05c80649382f6b">UNRECOGNIZED_PARAMETER</a>);
                            pLen = initAckChunk-&gt;<a class="code" href="class_s_c_t_p_init_ack_chunk.html#a5e151d257e5adafe3ca326f57e7df6e9">getUnrecognizedParameters</a>(k+2)*16+initAckChunk-&gt;<a class="code" href="class_s_c_t_p_init_ack_chunk.html#a5e151d257e5adafe3ca326f57e7df6e9">getUnrecognizedParameters</a>(k+3);
                            unknown-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1tlv.html#ad8504a2c0218d4213b377e2ddb240a9c">length</a> = <a class="code" href="aodv__uu__omnet_8h.html#a51799f5ebb4c7228ef7e95c247030f42">htons</a>(pLen+4);
                            <span class="comment">//sctpEV3&lt;&lt;&quot;unknown-&gt;length=&quot;&lt;&lt;pLen&lt;&lt;&quot;\n&quot;;</span>
                            <span class="keywordflow">for</span> (uint32 i=0; i&lt;<a class="code" href="_s_c_t_p_association_8h.html#a34c6101299ca6658c48834e679883867">ADD_PADDING</a>(pLen); i++, k++)
                                unknown-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1tlv.html#ab0de063235e7569ee8c41a4d3f94312c">value</a>[i] = initAckChunk-&gt;<a class="code" href="class_s_c_t_p_init_ack_chunk.html#a5e151d257e5adafe3ca326f57e7df6e9">getUnrecognizedParameters</a>(k);
                            parPtr += <a class="code" href="_s_c_t_p_association_8h.html#a34c6101299ca6658c48834e679883867">ADD_PADDING</a>(pLen+4);
                            uLen -= <a class="code" href="_s_c_t_p_association_8h.html#a34c6101299ca6658c48834e679883867">ADD_PADDING</a>(pLen);
                        }
                    }

                    <span class="comment">/*if(cookielen == 0)</span>
<span class="comment">                    {</span>
<span class="comment">                        cookielen = 4;</span>
<span class="comment">                        initAckChunk-&gt;setCookieArraySize(cookielen);</span>
<span class="comment">                        initAckChunk-&gt;setCookie(0, &#39;1&#39;);</span>
<span class="comment">                        initAckChunk-&gt;setCookie(1, &#39;3&#39;);</span>
<span class="comment">                        initAckChunk-&gt;setCookie(2, &#39;3&#39;);</span>
<span class="comment">                        initAckChunk-&gt;setCookie(3, &#39;7&#39;);</span>
<span class="comment">                        iac-&gt;length = htons(ntohs(iac-&gt;length) + 8);</span>
<span class="comment">                    }*/</span>
                    int32 cookielen = initAckChunk-&gt;<a class="code" href="class_s_c_t_p_init_ack_chunk.html#a24e8f6d8289e0f9df13cb0b009591865">getCookieArraySize</a>();
                    <span class="keywordflow">if</span> (cookielen == 0)
                    {
                        <a class="code" href="class_s_c_t_p_cookie.html" title="Class generated from transport/sctp/SCTPMessage.msg by opp_msgc.">SCTPCookie</a>* stateCookie = check_and_cast&lt;<a class="code" href="class_s_c_t_p_cookie.html" title="Class generated from transport/sctp/SCTPMessage.msg by opp_msgc.">SCTPCookie</a>*&gt;(initAckChunk-&gt;<a class="code" href="class_s_c_t_p_init_ack_chunk.html#a18e03b3bbea7b90f09d94bc1c24c97bc">getStateCookie</a>());
                        <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1init__cookie__parameter.html">init_cookie_parameter</a> *cookie = (<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1init__cookie__parameter.html">init_cookie_parameter</a>*) (((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)iac) + size_init_chunk + parPtr);
                        cookie-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1init__cookie__parameter.html#a14e5be998afe475f8ff332622f3bfc5f">type</a> = <a class="code" href="aodv__uu__omnet_8h.html#a51799f5ebb4c7228ef7e95c247030f42">htons</a>(INIT_PARAM_COOKIE);
                        cookie-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1init__cookie__parameter.html#aca52f335a966cd309357456ebdffdd73">length</a> = <a class="code" href="aodv__uu__omnet_8h.html#a51799f5ebb4c7228ef7e95c247030f42">htons</a>(<a class="code" href="_s_c_t_p_association_8h.html#a3aeb03eaba88c9681ecb920f24c689d2">SCTP_COOKIE_LENGTH</a> + 4);
                        cookie-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1init__cookie__parameter.html#aebe858a7bbcb4e6993ce77152b5fdd2a">creationTime</a> = <a class="code" href="aodv__uu__omnet_8h.html#ae4027a6ad07f13aa12eab285a1b46019">htonl</a>((uint32)stateCookie-&gt;<a class="code" href="class_s_c_t_p_cookie.html#a7179eff47c800dd97c0f37e7947f595b">getCreationTime</a>().dbl());
                        cookie-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1init__cookie__parameter.html#ab2cae663323b64da289760e11bf97a29">localTag</a> = <a class="code" href="aodv__uu__omnet_8h.html#ae4027a6ad07f13aa12eab285a1b46019">htonl</a>(stateCookie-&gt;<a class="code" href="class_s_c_t_p_cookie.html#a58e344ded6300ff9e53918bdfc9aaf71">getLocalTag</a>());
                        cookie-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1init__cookie__parameter.html#af89b5edd30a497adb8d1236173653c16">peerTag</a> = <a class="code" href="aodv__uu__omnet_8h.html#ae4027a6ad07f13aa12eab285a1b46019">htonl</a>(stateCookie-&gt;<a class="code" href="class_s_c_t_p_cookie.html#ab0b4b413af3d743f9fc768dbf3634f0f">getPeerTag</a>());
                        <span class="keywordflow">for</span> (int32 i=0; i&lt;32; i++)
                        {
                            cookie-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1init__cookie__parameter.html#aa289cc30d97125318f42cb82346cb042">localTieTag</a>[i] = stateCookie-&gt;<a class="code" href="class_s_c_t_p_cookie.html#a8e219a869570afe5d5bc7dd6c89b38c8">getLocalTieTag</a>(i);
                            cookie-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1init__cookie__parameter.html#a4ef1c054d13571f1aa5c827596f18989">peerTieTag</a>[i] = stateCookie-&gt;<a class="code" href="class_s_c_t_p_cookie.html#ae49d49fe8c5bb9734f8b2fc2ba9f40c4">getPeerTieTag</a>(i);
                        }
                        parPtr += (<a class="code" href="_s_c_t_p_association_8h.html#a3aeb03eaba88c9681ecb920f24c689d2">SCTP_COOKIE_LENGTH</a> + 4);
                    }
                    <span class="keywordflow">else</span>
                    {
                        <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1tlv.html">tlv</a> *cookie = (<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1tlv.html">tlv</a>*) (((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)iac) + size_init_chunk + parPtr);
                        cookie-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1tlv.html#a0376609c5b5aeb16ae4840581987d033">type</a> = <a class="code" href="aodv__uu__omnet_8h.html#a51799f5ebb4c7228ef7e95c247030f42">htons</a>(INIT_PARAM_COOKIE);
                        cookie-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1tlv.html#ad8504a2c0218d4213b377e2ddb240a9c">length</a> = <a class="code" href="aodv__uu__omnet_8h.html#a51799f5ebb4c7228ef7e95c247030f42">htons</a>(cookielen+4);
                        <span class="keywordflow">for</span> (int32 i=0; i&lt;cookielen; i++)
                            cookie-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1tlv.html#ab0de063235e7569ee8c41a4d3f94312c">value</a>[i] = initAckChunk-&gt;<a class="code" href="class_s_c_t_p_init_ack_chunk.html#a8d62a78b87a356c3effaf9f90e3bf86a">getCookie</a>(i);
                        parPtr += cookielen + 4;
                    }
                    iac-&gt;length = <a class="code" href="aodv__uu__omnet_8h.html#a51799f5ebb4c7228ef7e95c247030f42">htons</a>(<a class="code" href="_s_c_t_p_association_8h.html#a685f1682f68294dbb12e7953e02748a0">SCTP_INIT_CHUNK_LENGTH</a>+parPtr);
                    writtenbytes += <a class="code" href="_s_c_t_p_association_8h.html#a685f1682f68294dbb12e7953e02748a0">SCTP_INIT_CHUNK_LENGTH</a>+parPtr;
                    <span class="keywordflow">break</span>;
                }
                <span class="keywordflow">case</span> <a class="code" href="_s_c_t_p_association_8h.html#a8886377ab3f4b4ef217558f2b83b7b12a689bf9c7470080fd0180eb7f5c293bd4">SACK</a>:
                {
                    <a class="code" href="class_s_c_t_p_sack_chunk.html" title="Class generated from transport/sctp/SCTPMessage.msg by opp_msgc.">SCTPSackChunk</a> *sackChunk = check_and_cast&lt;<a class="code" href="class_s_c_t_p_sack_chunk.html" title="Class generated from transport/sctp/SCTPMessage.msg by opp_msgc.">SCTPSackChunk</a> *&gt;(<a class="code" href="struct_i_n_e_t_fw_1_1chunk.html">chunk</a>);

                    <span class="comment">// destination is send buffer:</span>
                    <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1sack__chunk.html">sack_chunk</a> *sac = (<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1sack__chunk.html">sack_chunk</a>*) (buf + writtenbytes); <span class="comment">// append data to buffer</span>
                    writtenbytes += (sackChunk-&gt;getBitLength() / 8);

                    <span class="comment">// fill buffer with data from SCTP init ack chunk structure</span>
                    sac-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1sack__chunk.html#a82a5148eb8f2d054a93bc15b01f90ed0">type</a> = sackChunk-&gt;<a class="code" href="class_s_c_t_p_chunk.html#a752caf91430fcd3157a12e7e91361471">getChunkType</a>();
<span class="comment">//                  sac-&gt;flags = sackChunk-&gt;getFlags(); // no flags available in this type of SCTPChunk</span>
                    sac-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1sack__chunk.html#a00b437d0173221e4f0962cecaafbe7e9">length</a> = <a class="code" href="aodv__uu__omnet_8h.html#a51799f5ebb4c7228ef7e95c247030f42">htons</a>(sackChunk-&gt;getBitLength() / 8);
                    uint32 cumtsnack = sackChunk-&gt;<a class="code" href="class_s_c_t_p_sack_chunk.html#a7ecb9662687cd4a5a86b6a2757785aa0">getCumTsnAck</a>();
                    sac-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1sack__chunk.html#a561d6bef13b80381e25a0712b3b283a0">cum_tsn_ack</a> = <a class="code" href="aodv__uu__omnet_8h.html#ae4027a6ad07f13aa12eab285a1b46019">htonl</a>(cumtsnack);
                    sac-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1sack__chunk.html#a9d989ff6f677f8d5afcbbe2d73ece439">a_rwnd</a> = <a class="code" href="aodv__uu__omnet_8h.html#ae4027a6ad07f13aa12eab285a1b46019">htonl</a>(sackChunk-&gt;<a class="code" href="class_s_c_t_p_sack_chunk.html#a0029266b1d7d234f37e26e9d9ff40be8">getA_rwnd</a>());
                    sac-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1sack__chunk.html#addf4a98ed2d76970afe2a63340a95f00">nr_of_gaps</a> = <a class="code" href="aodv__uu__omnet_8h.html#a51799f5ebb4c7228ef7e95c247030f42">htons</a>(sackChunk-&gt;<a class="code" href="class_s_c_t_p_sack_chunk.html#aae89c128c7dabd5515ad02ca30523761">getNumGaps</a>());
                    sac-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1sack__chunk.html#a36b9ecced9fc135bc8906b8d5a58c7ed">nr_of_dups</a> = <a class="code" href="aodv__uu__omnet_8h.html#a51799f5ebb4c7228ef7e95c247030f42">htons</a>(sackChunk-&gt;<a class="code" href="class_s_c_t_p_sack_chunk.html#a5f155c6389f26807fb5626cf96a8d8c7">getNumDupTsns</a>());

                    <span class="comment">// GAPs and Dup. TSNs:</span>
                    int32 numgaps = sackChunk-&gt;<a class="code" href="class_s_c_t_p_sack_chunk.html#aae89c128c7dabd5515ad02ca30523761">getNumGaps</a>();
                    int32 numdups = sackChunk-&gt;<a class="code" href="class_s_c_t_p_sack_chunk.html#a5f155c6389f26807fb5626cf96a8d8c7">getNumDupTsns</a>();
                    <span class="keywordflow">for</span> (int32 i=0; i&lt;numgaps; i++)
                    {
                        <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1sack__gap.html">sack_gap</a> *gap = (<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1sack__gap.html">sack_gap</a>*) (((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)sac) + size_sack_chunk + i*<span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1sack__gap.html">sack_gap</a>));
                        gap-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1sack__gap.html#a06092a86c2ef2a22d5412e2d7096563f">start</a> = <a class="code" href="aodv__uu__omnet_8h.html#a51799f5ebb4c7228ef7e95c247030f42">htons</a>(sackChunk-&gt;<a class="code" href="class_s_c_t_p_sack_chunk.html#ae4b982717b7ea8c7274eeeed36ebc893">getGapStart</a>(i) - cumtsnack);
                        gap-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1sack__gap.html#aff0a1d1c21dd6d36e7b0fff135c93e23">stop</a> = <a class="code" href="aodv__uu__omnet_8h.html#a51799f5ebb4c7228ef7e95c247030f42">htons</a>(sackChunk-&gt;<a class="code" href="class_s_c_t_p_sack_chunk.html#aaef7b2cb13cfc88decd207a37d3be7f7">getGapStop</a>(i) - cumtsnack);
                    }
                    <span class="keywordflow">for</span> (int32 i=0; i&lt;numdups; i++)
                    {
                        <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1sack__duptsn.html">sack_duptsn</a> *dup = (<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1sack__duptsn.html">sack_duptsn</a>*) (((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)sac) + size_sack_chunk + numgaps*<span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="struct_i_n_e_t_fw_1_1sack__gap.html">sack_gap</a>) + i*<span class="keyword">sizeof</span>(<a class="code" href="struct_i_n_e_t_fw_1_1sack__duptsn.html">sack_duptsn</a>));
                        dup-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1sack__duptsn.html#a264c16210059305d5716d62f3f44366e">tsn</a> = <a class="code" href="aodv__uu__omnet_8h.html#ae4027a6ad07f13aa12eab285a1b46019">htonl</a>(sackChunk-&gt;<a class="code" href="class_s_c_t_p_sack_chunk.html#a55e6793cd5de44f59b093debeeae6596">getDupTsns</a>(i));
                    }
                    <span class="keywordflow">break</span>;
                }
                <span class="keywordflow">case</span> <a class="code" href="_s_c_t_p_association_8h.html#a8886377ab3f4b4ef217558f2b83b7b12a0f286b0bbc1ee4f20be5136a55cf8923">HEARTBEAT</a>:
                {
                    <span class="comment">//sctpEV3&lt;&lt;simulation.simTime()&lt;&lt;&quot;  SCTPAssociation:: Heartbeat sent \n&quot;;</span>
                    <a class="code" href="class_s_c_t_p_heartbeat_chunk.html" title="Class generated from transport/sctp/SCTPMessage.msg by opp_msgc.">SCTPHeartbeatChunk</a> *heartbeatChunk = check_and_cast&lt;<a class="code" href="class_s_c_t_p_heartbeat_chunk.html" title="Class generated from transport/sctp/SCTPMessage.msg by opp_msgc.">SCTPHeartbeatChunk</a> *&gt;(<a class="code" href="struct_i_n_e_t_fw_1_1chunk.html">chunk</a>);

                    <span class="comment">// destination is send buffer:</span>
                    <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1heartbeat__chunk.html">heartbeat_chunk</a> *hbc = (<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1heartbeat__chunk.html">heartbeat_chunk</a>*) (buf + writtenbytes); <span class="comment">// append data to buffer</span>
                    writtenbytes += (heartbeatChunk-&gt;getBitLength() / 8);

                    <span class="comment">// fill buffer with data from SCTP init ack chunk structure</span>
                    hbc-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1heartbeat__chunk.html#a024a36abc0874b6ec935c82aa1c09e45">type</a> = heartbeatChunk-&gt;<a class="code" href="class_s_c_t_p_chunk.html#a752caf91430fcd3157a12e7e91361471">getChunkType</a>();
<span class="comment">//                  hbc-&gt;flags = heartbeatChunk-&gt;getFlags(); // no flags available in this type of SCTPChunk</span>
                    hbc-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1heartbeat__chunk.html#a4417dfe66d15d64507e259dc533adead">length</a> = <a class="code" href="aodv__uu__omnet_8h.html#a51799f5ebb4c7228ef7e95c247030f42">htons</a>(heartbeatChunk-&gt;getBitLength() / 8);

                    <span class="comment">// deliver info:</span>
                    <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1heartbeat__info.html">heartbeat_info</a> *hbi = (<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1heartbeat__info.html">heartbeat_info</a>*) (((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*)hbc) + size_heartbeat_chunk);
                    <a class="code" href="class_i_pv_x_address.html" title="Stores an IPv4 or an IPv6 address.">IPvXAddress</a> <a class="code" href="structheartbeat__info.html#aa18d6fa900626bccabebca79a2fe2284">addr</a> = heartbeatChunk-&gt;<a class="code" href="class_s_c_t_p_heartbeat_chunk.html#a671948890fb3346480996dfcd2b16e9c">getRemoteAddr</a>();
                    simtime_t <a class="code" href="structheartbeat__info.html#a42185fa571bdbaf64e6f2697f9fb45a1">time</a> = heartbeatChunk-&gt;<a class="code" href="class_s_c_t_p_heartbeat_chunk.html#a9c0553f66439a5818d86e84e8704feb1">getTimeField</a>();
                    int32 infolen = <span class="keyword">sizeof</span>(addr.<a class="code" href="class_i_pv_x_address.html#a961b38a74371d8aa29d8e6906a071d64" title="Get IPv4 address.">get4</a>().<a class="code" href="class_i_pv4_address.html#ac4abdd5df9c86071f13af7a3f0931237" title="Returns the address as an int.">getInt</a>()) + <span class="keyword">sizeof</span>(uint32);
                    hbi-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1heartbeat__info.html#a9c496e01fb626983dd7449c4d299c4dd">type</a> = <a class="code" href="aodv__uu__omnet_8h.html#a51799f5ebb4c7228ef7e95c247030f42">htons</a>(1);   <span class="comment">// mandatory</span>
                    hbi-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1heartbeat__info.html#a165225a4bed745a098ebc07d514b0a62">length</a> = <a class="code" href="aodv__uu__omnet_8h.html#a51799f5ebb4c7228ef7e95c247030f42">htons</a>(infolen+4);
                    <a class="code" href="sctp_8h.html#aed9342dc5ddcea1e525b7b449fab35a3">HBI_ADDR</a>(hbi) = <a class="code" href="aodv__uu__omnet_8h.html#ae4027a6ad07f13aa12eab285a1b46019">htonl</a>(addr.<a class="code" href="class_i_pv_x_address.html#a961b38a74371d8aa29d8e6906a071d64" title="Get IPv4 address.">get4</a>().<a class="code" href="class_i_pv4_address.html#ac4abdd5df9c86071f13af7a3f0931237" title="Returns the address as an int.">getInt</a>());
                    <a class="code" href="sctp_8h.html#a350cf5878ce2f8cb42cca735e0f99c1d">HBI_TIME</a>(hbi) = <a class="code" href="aodv__uu__omnet_8h.html#ae4027a6ad07f13aa12eab285a1b46019">htonl</a>((uint32)time.dbl());
                    <span class="keywordflow">break</span>;
                }
                <span class="keywordflow">case</span> <a class="code" href="_s_c_t_p_association_8h.html#a8886377ab3f4b4ef217558f2b83b7b12a5621dd83f6f32ee90c0d505867c67b71">HEARTBEAT_ACK</a>:
                {
                    <span class="comment">//sctpEV3&lt;&lt;simulation.simTime()&lt;&lt;&quot; SCTPAssociation:: HeartbeatAck sent \n&quot;;</span>
                    <a class="code" href="class_s_c_t_p_heartbeat_ack_chunk.html" title="Class generated from transport/sctp/SCTPMessage.msg by opp_msgc.">SCTPHeartbeatAckChunk</a> *heartbeatAckChunk = check_and_cast&lt;<a class="code" href="class_s_c_t_p_heartbeat_ack_chunk.html" title="Class generated from transport/sctp/SCTPMessage.msg by opp_msgc.">SCTPHeartbeatAckChunk</a> *&gt;(<a class="code" href="struct_i_n_e_t_fw_1_1chunk.html">chunk</a>);

                    <span class="comment">// destination is send buffer:</span>
                    <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1heartbeat__ack__chunk.html">heartbeat_ack_chunk</a> *hbac = (<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1heartbeat__ack__chunk.html">heartbeat_ack_chunk</a>*) (buf + writtenbytes); <span class="comment">// append data to buffer</span>
                    writtenbytes += (heartbeatAckChunk-&gt;getBitLength() / 8);

                    <span class="comment">// fill buffer with data from SCTP init ack chunk structure</span>
                    hbac-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1heartbeat__ack__chunk.html#aaef8cb3cb98d2936416619092e1409de">type</a> = heartbeatAckChunk-&gt;<a class="code" href="class_s_c_t_p_chunk.html#a752caf91430fcd3157a12e7e91361471">getChunkType</a>();
<span class="comment">//                  hbac-&gt;flags = heartbeatAckChunk-&gt;getFlags(); // no flags available in this type of SCTPChunk</span>
                    hbac-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1heartbeat__ack__chunk.html#af05e4e0ce777bc2ce5272709d26bfb1e">length</a> = <a class="code" href="aodv__uu__omnet_8h.html#a51799f5ebb4c7228ef7e95c247030f42">htons</a>(heartbeatAckChunk-&gt;getBitLength() / 8);

                    <span class="comment">// deliver info:</span>
                    <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1heartbeat__info.html">heartbeat_info</a> *hbi = (<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1heartbeat__info.html">heartbeat_info</a>*) (((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*)hbac) + size_heartbeat_ack_chunk);
                    int32 infolen = heartbeatAckChunk-&gt;<a class="code" href="class_s_c_t_p_heartbeat_ack_chunk.html#a4239007b703f906e770471ca6757fefb">getInfoArraySize</a>();
                    hbi-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1heartbeat__info.html#a9c496e01fb626983dd7449c4d299c4dd">type</a> = <a class="code" href="aodv__uu__omnet_8h.html#a51799f5ebb4c7228ef7e95c247030f42">htons</a>(1); <span class="comment">//mandatory</span>
                    <span class="keywordflow">if</span> (infolen &gt; 0)
                    {
                        hbi-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1heartbeat__info.html#a165225a4bed745a098ebc07d514b0a62">length</a> = <a class="code" href="aodv__uu__omnet_8h.html#a51799f5ebb4c7228ef7e95c247030f42">htons</a>(infolen+4);
                        <span class="keywordflow">for</span> (int32 i=0; i&lt;infolen; i++)
                        {
                            <a class="code" href="sctp_8h.html#a35a07f4d1137779b208b608ac62f7561">HBI_INFO</a>(hbi)[i] = heartbeatAckChunk-&gt;<a class="code" href="class_s_c_t_p_heartbeat_ack_chunk.html#a6a665db7ff1af98f5b61b0789952a32d">getInfo</a>(i);
                        }
                    }
                    <span class="keywordflow">else</span>
                    {
                        <a class="code" href="class_i_pv_x_address.html" title="Stores an IPv4 or an IPv6 address.">IPvXAddress</a> addr = heartbeatAckChunk-&gt;<a class="code" href="class_s_c_t_p_heartbeat_ack_chunk.html#a59638fa6af7a15845301f38dc49145d9">getRemoteAddr</a>();
                        infolen = <span class="keyword">sizeof</span>(addr.<a class="code" href="class_i_pv_x_address.html#a961b38a74371d8aa29d8e6906a071d64" title="Get IPv4 address.">get4</a>().<a class="code" href="class_i_pv4_address.html#ac4abdd5df9c86071f13af7a3f0931237" title="Returns the address as an int.">getInt</a>()) + <span class="keyword">sizeof</span>(uint32);
                        hbi-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1heartbeat__info.html#a9c496e01fb626983dd7449c4d299c4dd">type</a> = <a class="code" href="aodv__uu__omnet_8h.html#a51799f5ebb4c7228ef7e95c247030f42">htons</a>(1);   <span class="comment">// mandatory</span>
                        hbi-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1heartbeat__info.html#a165225a4bed745a098ebc07d514b0a62">length</a> = <a class="code" href="aodv__uu__omnet_8h.html#a51799f5ebb4c7228ef7e95c247030f42">htons</a>(infolen+4);

                        simtime_t time = heartbeatAckChunk-&gt;<a class="code" href="class_s_c_t_p_heartbeat_ack_chunk.html#ad42968f09a2532b8fa4dfdb1fd58bb69">getTimeField</a>();
                        <a class="code" href="sctp_8h.html#aed9342dc5ddcea1e525b7b449fab35a3">HBI_ADDR</a>(hbi) = <a class="code" href="aodv__uu__omnet_8h.html#ae4027a6ad07f13aa12eab285a1b46019">htonl</a>(addr.<a class="code" href="class_i_pv_x_address.html#a961b38a74371d8aa29d8e6906a071d64" title="Get IPv4 address.">get4</a>().<a class="code" href="class_i_pv4_address.html#ac4abdd5df9c86071f13af7a3f0931237" title="Returns the address as an int.">getInt</a>());
                        <a class="code" href="sctp_8h.html#a350cf5878ce2f8cb42cca735e0f99c1d">HBI_TIME</a>(hbi) = <a class="code" href="aodv__uu__omnet_8h.html#ae4027a6ad07f13aa12eab285a1b46019">htonl</a>((uint32)time.dbl());
                    }
                    <span class="keywordflow">break</span>;
                }
                <span class="keywordflow">case</span> <a class="code" href="_s_c_t_p_association_8h.html#a8886377ab3f4b4ef217558f2b83b7b12a781ad2788df9e25c59a70894c7832096">ABORT</a>:
                {
                    <span class="comment">//sctpEV3&lt;&lt;simulation.simTime()&lt;&lt;&quot; SCTPAssociation:: Abort sent \n&quot;;</span>
                    <a class="code" href="class_s_c_t_p_abort_chunk.html" title="Class generated from transport/sctp/SCTPMessage.msg by opp_msgc.">SCTPAbortChunk</a> *abortChunk = check_and_cast&lt;<a class="code" href="class_s_c_t_p_abort_chunk.html" title="Class generated from transport/sctp/SCTPMessage.msg by opp_msgc.">SCTPAbortChunk</a> *&gt;(<a class="code" href="struct_i_n_e_t_fw_1_1chunk.html">chunk</a>);

                    <span class="comment">// destination is send buffer:</span>
                    <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1abort__chunk.html">abort_chunk</a> *ac = (<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1abort__chunk.html">abort_chunk</a>*) (buf + writtenbytes); <span class="comment">// append data to buffer</span>
                    writtenbytes += (abortChunk-&gt;getBitLength() / 8);

                    <span class="comment">// fill buffer with data from SCTP init ack chunk structure</span>
                    ac-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1abort__chunk.html#afd7b4ac79c01f4f7daf23664cd483832">type</a> = abortChunk-&gt;<a class="code" href="class_s_c_t_p_chunk.html#a752caf91430fcd3157a12e7e91361471">getChunkType</a>();
                    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> flags = 0;
                    <span class="keywordflow">if</span> (abortChunk-&gt;<a class="code" href="class_s_c_t_p_abort_chunk.html#adc385c709185844a9d2104026c41f835">getT_Bit</a>())
                        flags |= T_BIT;
                    ac-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1abort__chunk.html#af7c6588f89c568b6ca8dcf40cb32daf7">flags</a> = <a class="code" href="structabort__chunk.html#a992b83b08e484d47b508e12fb6c38bc8">flags</a>;
                    ac-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1abort__chunk.html#ac0550cef90bd35ba1bf8430ee783743d">length</a> = <a class="code" href="aodv__uu__omnet_8h.html#a51799f5ebb4c7228ef7e95c247030f42">htons</a>(abortChunk-&gt;getBitLength() / 8);
                    <span class="keywordflow">break</span>;
                }
                <span class="keywordflow">case</span> <a class="code" href="_s_c_t_p_association_8h.html#a8886377ab3f4b4ef217558f2b83b7b12ac6c3901afa866152be0e645c2c38f471">COOKIE_ECHO</a>:
                {
                    <span class="comment">//sctpEV3&lt;&lt;simulation.simTime()&lt;&lt;&quot; SCTPAssociation:: CookieEcho sent \n&quot;;</span>
                    <a class="code" href="class_s_c_t_p_cookie_echo_chunk.html" title="Class generated from transport/sctp/SCTPMessage.msg by opp_msgc.">SCTPCookieEchoChunk</a> *cookieChunk = check_and_cast&lt;<a class="code" href="class_s_c_t_p_cookie_echo_chunk.html" title="Class generated from transport/sctp/SCTPMessage.msg by opp_msgc.">SCTPCookieEchoChunk</a> *&gt;(<a class="code" href="struct_i_n_e_t_fw_1_1chunk.html">chunk</a>);

                    <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1cookie__echo__chunk.html">cookie_echo_chunk</a> *cec = (<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1cookie__echo__chunk.html">cookie_echo_chunk</a>*) (buf + writtenbytes);


                    cec-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1cookie__echo__chunk.html#aacca81a316c96b6a54ea6d7d6daedc97">type</a> = cookieChunk-&gt;<a class="code" href="class_s_c_t_p_chunk.html#a752caf91430fcd3157a12e7e91361471">getChunkType</a>();
                    cec-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1cookie__echo__chunk.html#a952814830fb2a5568b7a0b540ae8841e">length</a> = <a class="code" href="aodv__uu__omnet_8h.html#a51799f5ebb4c7228ef7e95c247030f42">htons</a>(cookieChunk-&gt;getBitLength() / 8);
                    int32 cookielen = cookieChunk-&gt;<a class="code" href="class_s_c_t_p_cookie_echo_chunk.html#a25f09010d055ab8d1eff2dcbfed08611">getCookieArraySize</a>();
                    <span class="keywordflow">if</span> (cookielen&gt;0)
                    {
                        <span class="keywordflow">for</span> (int32 i=0; i&lt;cookielen; i++)
                            cec-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1cookie__echo__chunk.html#aef00e45b7a6273712cb7c75b4b459c10">state_cookie</a>[i] = cookieChunk-&gt;<a class="code" href="class_s_c_t_p_cookie_echo_chunk.html#aed9f912e0b7c694f865e20e1163e1877">getCookie</a>(i);
                    }
                    <span class="keywordflow">else</span>
                    {
                        <a class="code" href="class_s_c_t_p_cookie.html" title="Class generated from transport/sctp/SCTPMessage.msg by opp_msgc.">SCTPCookie</a>* stateCookie = check_and_cast&lt;<a class="code" href="class_s_c_t_p_cookie.html" title="Class generated from transport/sctp/SCTPMessage.msg by opp_msgc.">SCTPCookie</a>*&gt;(cookieChunk-&gt;<a class="code" href="class_s_c_t_p_cookie_echo_chunk.html#a08fee47c7a7d7f89a49949156069e267">getStateCookie</a>());
                        <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1cookie__parameter.html">cookie_parameter</a> *cookie = (<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1cookie__parameter.html">cookie_parameter</a>*) (buf + writtenbytes+4);
                        cookie-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1cookie__parameter.html#a96b0f36a38c9886943c75ba5b29c0ef0">creationTime</a> = <a class="code" href="aodv__uu__omnet_8h.html#ae4027a6ad07f13aa12eab285a1b46019">htonl</a>((uint32)stateCookie-&gt;<a class="code" href="class_s_c_t_p_cookie.html#a7179eff47c800dd97c0f37e7947f595b">getCreationTime</a>().dbl());
                        cookie-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1cookie__parameter.html#a023a4299beb2cfb28dd2ef1dfd0478c7">localTag</a> = <a class="code" href="aodv__uu__omnet_8h.html#ae4027a6ad07f13aa12eab285a1b46019">htonl</a>(stateCookie-&gt;<a class="code" href="class_s_c_t_p_cookie.html#a58e344ded6300ff9e53918bdfc9aaf71">getLocalTag</a>());
                        cookie-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1cookie__parameter.html#a648153b48ec8424e1f72ff921b8a644d">peerTag</a> = <a class="code" href="aodv__uu__omnet_8h.html#ae4027a6ad07f13aa12eab285a1b46019">htonl</a>(stateCookie-&gt;<a class="code" href="class_s_c_t_p_cookie.html#ab0b4b413af3d743f9fc768dbf3634f0f">getPeerTag</a>());
                        <span class="keywordflow">for</span> (int32 i=0; i&lt;32; i++)
                        {
                            cookie-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1cookie__parameter.html#ad99c0071b11d8dfd434ec386226611f7">localTieTag</a>[i] = stateCookie-&gt;<a class="code" href="class_s_c_t_p_cookie.html#a8e219a869570afe5d5bc7dd6c89b38c8">getLocalTieTag</a>(i);
                            cookie-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1cookie__parameter.html#a34286a6e985ef4527a947f4199333dc0">peerTieTag</a>[i] = stateCookie-&gt;<a class="code" href="class_s_c_t_p_cookie.html#ae49d49fe8c5bb9734f8b2fc2ba9f40c4">getPeerTieTag</a>(i);
                        }
                    }
                    writtenbytes += (<a class="code" href="_s_c_t_p_association_8h.html#a34c6101299ca6658c48834e679883867">ADD_PADDING</a>(cookieChunk-&gt;getBitLength() / 8));
                    <span class="comment">//sctpEV3&lt;&lt;&quot;buflen cookie_echo=&quot;&lt;&lt;buflen&lt;&lt;&quot;\n&quot;;</span>
                    uint32 uLen = cookieChunk-&gt;<a class="code" href="class_s_c_t_p_cookie_echo_chunk.html#a66537a5a996ca8113360105d3c59e8b9">getUnrecognizedParametersArraySize</a>();
                    <span class="keywordflow">if</span> (uLen&gt;0)
                    {
                        <span class="comment">//sctpEV3&lt;&lt;&quot;uLen=&quot;&lt;&lt;uLen&lt;&lt;&quot;\n&quot;;</span>
                        <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1error__chunk.html">error_chunk</a>* error = (<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1error__chunk.html">error_chunk</a>*)(buf + writtenbytes);
                        error-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1error__chunk.html#a3ba5d36bfe9d3c3b41b6fe6ebb94a87e">type</a> = <a class="code" href="_s_c_t_p_association_8h.html#a8886377ab3f4b4ef217558f2b83b7b12a511842f389362e9f11f52a88556455f1">ERRORTYPE</a>;
                        error-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1error__chunk.html#a8a289af1659045a9b902cf5c6334fc59">flags</a> = 0;
                        int32 k = 0;
                        uint32 pLen = 0;
                        uint32 ecLen = <a class="code" href="_s_c_t_p_association_8h.html#aabfb8449670ea3f037420cabb853b8fa">SCTP_ERROR_CHUNK_LENGTH</a>;
                        uint32 ecParPtr = 0;
                        <span class="keywordflow">while</span> (uLen&gt;0)
                        {
                            <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1tlv.html">tlv</a>* unknown = (<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1tlv.html">tlv</a>*) (((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)error) + <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="struct_i_n_e_t_fw_1_1error__chunk.html">error_chunk</a>) + ecParPtr);
                            unknown-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1tlv.html#a0376609c5b5aeb16ae4840581987d033">type</a> = <a class="code" href="aodv__uu__omnet_8h.html#a51799f5ebb4c7228ef7e95c247030f42">htons</a>(<a class="code" href="_s_c_t_p_association_8h.html#a8d59686e974f326f12076166b80dcad1a84eff3c1951655fd6a05c80649382f6b">UNRECOGNIZED_PARAMETER</a>);
                            pLen = cookieChunk-&gt;<a class="code" href="class_s_c_t_p_cookie_echo_chunk.html#a1788f700ec4fffac57bda9ca3e42c8eb">getUnrecognizedParameters</a>(k+2)*16+cookieChunk-&gt;<a class="code" href="class_s_c_t_p_cookie_echo_chunk.html#a1788f700ec4fffac57bda9ca3e42c8eb">getUnrecognizedParameters</a>(k+3);
                            unknown-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1tlv.html#ad8504a2c0218d4213b377e2ddb240a9c">length</a> = <a class="code" href="aodv__uu__omnet_8h.html#a51799f5ebb4c7228ef7e95c247030f42">htons</a>(pLen+4);
                            ecLen += pLen+4;
                            <span class="comment">//sctpEV3&lt;&lt;&quot;plength=&quot;&lt;&lt;pLen&lt;&lt;&quot; ecLen=&quot;&lt;&lt;ecLen&lt;&lt;&quot;\n&quot;;</span>
                            <span class="keywordflow">for</span> (uint32 i=0; i&lt;<a class="code" href="_s_c_t_p_association_8h.html#a34c6101299ca6658c48834e679883867">ADD_PADDING</a>(pLen); i++, k++)
                                unknown-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1tlv.html#ab0de063235e7569ee8c41a4d3f94312c">value</a>[i] = cookieChunk-&gt;<a class="code" href="class_s_c_t_p_cookie_echo_chunk.html#a1788f700ec4fffac57bda9ca3e42c8eb">getUnrecognizedParameters</a>(k);
                            ecParPtr += <a class="code" href="_s_c_t_p_association_8h.html#a34c6101299ca6658c48834e679883867">ADD_PADDING</a>(pLen+4);
                            <span class="comment">//sctpEV3&lt;&lt;&quot;ecParPtr=&quot;&lt;&lt;ecParPtr&lt;&lt;&quot;\n&quot;;</span>
                            uLen -= <a class="code" href="_s_c_t_p_association_8h.html#a34c6101299ca6658c48834e679883867">ADD_PADDING</a>(pLen);
                        }
                        error-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1error__chunk.html#ab5bfa384fe76de61e158ddde3d148fc4">length</a> = <a class="code" href="aodv__uu__omnet_8h.html#a51799f5ebb4c7228ef7e95c247030f42">htons</a>(ecLen);
                        writtenbytes += <a class="code" href="_s_c_t_p_association_8h.html#aabfb8449670ea3f037420cabb853b8fa">SCTP_ERROR_CHUNK_LENGTH</a>+ecParPtr;
                    }

                    <span class="keywordflow">break</span>;
                }
                <span class="keywordflow">case</span> <a class="code" href="_s_c_t_p_association_8h.html#a8886377ab3f4b4ef217558f2b83b7b12a8cb5544ff09ee0b2ae1f1171de9597bd">COOKIE_ACK</a>:
                {
                    <span class="comment">//sctpEV3&lt;&lt;simulation.simTime()&lt;&lt;&quot; SCTPAssociation:: CookieAck sent \n&quot;;</span>
                    <a class="code" href="class_s_c_t_p_cookie_ack_chunk.html" title="Class generated from transport/sctp/SCTPMessage.msg by opp_msgc.">SCTPCookieAckChunk</a> *cookieAckChunk = check_and_cast&lt;<a class="code" href="class_s_c_t_p_cookie_ack_chunk.html" title="Class generated from transport/sctp/SCTPMessage.msg by opp_msgc.">SCTPCookieAckChunk</a> *&gt;(<a class="code" href="struct_i_n_e_t_fw_1_1chunk.html">chunk</a>);

                    <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1cookie__ack__chunk.html">cookie_ack_chunk</a> *cac = (<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1cookie__ack__chunk.html">cookie_ack_chunk</a>*) (buf + writtenbytes);
                    writtenbytes += (cookieAckChunk-&gt;getBitLength() / 8);

                    cac-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1cookie__ack__chunk.html#a908232d2d65b3f327c8a8e7712f0ed2c">type</a> = cookieAckChunk-&gt;<a class="code" href="class_s_c_t_p_chunk.html#a752caf91430fcd3157a12e7e91361471">getChunkType</a>();
                    cac-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1cookie__ack__chunk.html#a95acfc6cbf8dfc2f783f2523f071f7f7">length</a> = <a class="code" href="aodv__uu__omnet_8h.html#a51799f5ebb4c7228ef7e95c247030f42">htons</a>(cookieAckChunk-&gt;getBitLength() / 8);

                    <span class="keywordflow">break</span>;
                }
                <span class="keywordflow">case</span> <a class="code" href="_s_c_t_p_association_8h.html#a8886377ab3f4b4ef217558f2b83b7b12a7690b021f467450541d8d89123429d40">SHUTDOWN</a>:
                {
                    <span class="comment">//sctpEV3&lt;&lt;simulation.simTime()&lt;&lt;&quot; SCTPAssociation:: ShutdownAck sent \n&quot;;</span>
                    <a class="code" href="class_s_c_t_p_shutdown_chunk.html" title="Class generated from transport/sctp/SCTPMessage.msg by opp_msgc.">SCTPShutdownChunk</a> *shutdownChunk = check_and_cast&lt;<a class="code" href="class_s_c_t_p_shutdown_chunk.html" title="Class generated from transport/sctp/SCTPMessage.msg by opp_msgc.">SCTPShutdownChunk</a> *&gt;(<a class="code" href="struct_i_n_e_t_fw_1_1chunk.html">chunk</a>);

                    <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1shutdown__chunk.html">shutdown_chunk</a> *sac = (<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1shutdown__chunk.html">shutdown_chunk</a>*) (buf + writtenbytes);
                    writtenbytes += (shutdownChunk-&gt;getBitLength() / 8);

                    sac-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1shutdown__chunk.html#af51d4366e493acaeda6614987c7572ac">type</a> = shutdownChunk-&gt;<a class="code" href="class_s_c_t_p_chunk.html#a752caf91430fcd3157a12e7e91361471">getChunkType</a>();
                    sac-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1shutdown__chunk.html#a294183dee80de069c3e9583ff376b791">cumulative_tsn_ack</a> = <a class="code" href="aodv__uu__omnet_8h.html#ae4027a6ad07f13aa12eab285a1b46019">htonl</a>(shutdownChunk-&gt;<a class="code" href="class_s_c_t_p_shutdown_chunk.html#a0df1b527aee57a52d2275d061cfb3091">getCumTsnAck</a>());
                    sac-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1shutdown__chunk.html#a3ec4f8285d54892e78ec52507e542f96">length</a> = <a class="code" href="aodv__uu__omnet_8h.html#a51799f5ebb4c7228ef7e95c247030f42">htons</a>(shutdownChunk-&gt;getBitLength() / 8);

                    <span class="keywordflow">break</span>;
                }
                <span class="keywordflow">case</span> <a class="code" href="_s_c_t_p_association_8h.html#a8886377ab3f4b4ef217558f2b83b7b12a7f11b152058ba8f4656266d735a50c4b">SHUTDOWN_ACK</a>:
                {
                    <span class="comment">//sctpEV3&lt;&lt;simulation.simTime()&lt;&lt;&quot; SCTPAssociation:: ShutdownAck sent \n&quot;;</span>
                    <a class="code" href="class_s_c_t_p_shutdown_ack_chunk.html" title="Class generated from transport/sctp/SCTPMessage.msg by opp_msgc.">SCTPShutdownAckChunk</a> *shutdownAckChunk = check_and_cast&lt;<a class="code" href="class_s_c_t_p_shutdown_ack_chunk.html" title="Class generated from transport/sctp/SCTPMessage.msg by opp_msgc.">SCTPShutdownAckChunk</a> *&gt;(<a class="code" href="struct_i_n_e_t_fw_1_1chunk.html">chunk</a>);

                    <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1shutdown__ack__chunk.html">shutdown_ack_chunk</a> *sac = (<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1shutdown__ack__chunk.html">shutdown_ack_chunk</a>*) (buf + writtenbytes);
                    writtenbytes += (shutdownAckChunk-&gt;getBitLength() / 8);

                    sac-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1shutdown__ack__chunk.html#ae746b496e56ae3c2b8855f7ef4f04975">type</a> = shutdownAckChunk-&gt;<a class="code" href="class_s_c_t_p_chunk.html#a752caf91430fcd3157a12e7e91361471">getChunkType</a>();
                    sac-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1shutdown__ack__chunk.html#a5bb998c2808be3907aa9b5475b1c56ce">length</a> = <a class="code" href="aodv__uu__omnet_8h.html#a51799f5ebb4c7228ef7e95c247030f42">htons</a>(shutdownAckChunk-&gt;getBitLength() / 8);

                    <span class="keywordflow">break</span>;
                }
                <span class="keywordflow">case</span> <a class="code" href="_s_c_t_p_association_8h.html#a8886377ab3f4b4ef217558f2b83b7b12a1ac9ae29771c5095efe16ce822d561d7">SHUTDOWN_COMPLETE</a>:
                {
                    <span class="comment">//sctpEV3&lt;&lt;simulation.simTime()&lt;&lt;&quot; SCTPAssociation:: ShutdownAck sent \n&quot;;</span>
                    <a class="code" href="class_s_c_t_p_shutdown_complete_chunk.html" title="Class generated from transport/sctp/SCTPMessage.msg by opp_msgc.">SCTPShutdownCompleteChunk</a> *shutdownCompleteChunk = check_and_cast&lt;<a class="code" href="class_s_c_t_p_shutdown_complete_chunk.html" title="Class generated from transport/sctp/SCTPMessage.msg by opp_msgc.">SCTPShutdownCompleteChunk</a> *&gt;(<a class="code" href="struct_i_n_e_t_fw_1_1chunk.html">chunk</a>);

                    <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1shutdown__complete__chunk.html">shutdown_complete_chunk</a> *sac = (<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1shutdown__complete__chunk.html">shutdown_complete_chunk</a>*) (buf + writtenbytes);
                    writtenbytes += (shutdownCompleteChunk-&gt;getBitLength() / 8);

                    sac-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1shutdown__complete__chunk.html#a8f6c99af679dd511647d2747bf0a630d">type</a> = shutdownCompleteChunk-&gt;<a class="code" href="class_s_c_t_p_chunk.html#a752caf91430fcd3157a12e7e91361471">getChunkType</a>();
                    sac-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1shutdown__complete__chunk.html#a81f2f464f168ed2650f5cf162ba95072">length</a> = <a class="code" href="aodv__uu__omnet_8h.html#a51799f5ebb4c7228ef7e95c247030f42">htons</a>(shutdownCompleteChunk-&gt;getBitLength() / 8);
                    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> flags = 0;
                    <span class="keywordflow">if</span> (shutdownCompleteChunk-&gt;<a class="code" href="class_s_c_t_p_shutdown_complete_chunk.html#a3d0a9e1ee2b63b81970e086fa7c1349f">getTBit</a>())
                        flags |= T_BIT;
                    sac-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1shutdown__complete__chunk.html#a234c2bbc04b3655058a07315144f5dc8">flags</a> = <a class="code" href="structshutdown__complete__chunk.html#a0469d3f4be480b7e55f37255b70b84be">flags</a>;
                    <span class="keywordflow">break</span>;
                }
                <span class="keywordflow">case</span> <a class="code" href="_s_c_t_p_association_8h.html#a8886377ab3f4b4ef217558f2b83b7b12a511842f389362e9f11f52a88556455f1">ERRORTYPE</a>:
                {
                    <a class="code" href="class_s_c_t_p_error_chunk.html">SCTPErrorChunk</a>* errorchunk = check_and_cast&lt;<a class="code" href="class_s_c_t_p_error_chunk.html">SCTPErrorChunk</a>*&gt;(<a class="code" href="struct_i_n_e_t_fw_1_1chunk.html">chunk</a>);
                    <span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1error__chunk.html">error_chunk</a>* error = (<span class="keyword">struct </span><a class="code" href="struct_i_n_e_t_fw_1_1error__chunk.html">error_chunk</a>*)(buf + writtenbytes);
                    error-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1error__chunk.html#a3ba5d36bfe9d3c3b41b6fe6ebb94a87e">type</a> = errorchunk-&gt;<a class="code" href="class_s_c_t_p_chunk.html#a752caf91430fcd3157a12e7e91361471">getChunkType</a>();
                    error-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1error__chunk.html#a8a289af1659045a9b902cf5c6334fc59">flags</a> = 0;

                    <span class="keywordflow">if</span> (errorchunk-&gt;<a class="code" href="class_s_c_t_p_error_chunk.html#a7b3588b447bfe205e5ef507e509e5ff0">getParametersArraySize</a>()&gt;0)
                    {
                        writtenbytes += size_chunk;
                    }
                    <span class="keywordflow">else</span>
                        writtenbytes += <a class="code" href="_s_c_t_p_association_8h.html#a34c6101299ca6658c48834e679883867">ADD_PADDING</a>(error-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1error__chunk.html#ab5bfa384fe76de61e158ddde3d148fc4">length</a>);
                    <span class="keywordflow">break</span>;
                }
                <span class="keywordflow">default</span>:
                    printf(<span class="stringliteral">&quot;Serialize TODO: Implement for outgoing chunk type %d!\n&quot;</span>, chunkType);
                    <span class="keywordflow">throw</span> <span class="keyword">new</span> cRuntimeError(<span class="stringliteral">&quot;TODO: unknown chunktype in outgoing packet on external interface! Implement it!&quot;</span>);
                <span class="comment">// break;</span>

            }

            <span class="comment">/*drop(chunk);</span>
<span class="comment">            delete chunk;*/</span>

        }
    <span class="comment">// finally, set the CRC32 checksum field in the SCTP common header</span>

    <span class="comment">/*sctpEV3&lt;&lt;&quot;srcport=&quot;&lt;&lt;msg-&gt;getSrcPort() &lt;&lt;&quot;destport=&quot;&lt;&lt;msg-&gt;getDestPort() &lt;&lt;&quot;writtenbytes vor checksum=&quot;&lt;&lt;writtenbytes&lt;&lt;&quot;\n&quot;;*/</span>

    ch-&gt;<a class="code" href="struct_i_n_e_t_fw_1_1common__header.html#ad9a0af9b8746c7819868702a962fabea">checksum</a> = <a class="code" href="class_s_c_t_p_serializer.html#afc95affdb742652c06ca52fdd86da488">checksum</a>((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*)ch, writtenbytes);
    <span class="keywordflow">return</span> writtenbytes;
}
</pre></div>
</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="_s_c_t_p_serializer_8h.html">SCTPSerializer.h</a></li>
<li><a class="el" href="_s_c_t_p_serializer_8cc.html">SCTPSerializer.cc</a></li>
</ul>
</div><!-- contents -->
</div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="class_s_c_t_p_serializer.html">SCTPSerializer</a>      </li>

    <li class="footer">Generated on Tue Aug 7 2012 16:01:30 for INET Framework for OMNeT++/OMNEST by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.6.1 </li>
   </ul>
 </div>


</body>
</html>
