<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>INET Framework for OMNeT++/OMNEST: OSPF::InterfaceState Class Reference</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>


</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">INET Framework for OMNeT++/OMNEST
   
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('class_o_s_p_f_1_1_interface_state.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a>  </div>
  <div class="headertitle">
<div class="title">OSPF::InterfaceState Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<!-- doxytag: class="OSPF::InterfaceState" -->
<p><code>#include &lt;OSPFInterfaceState.h&gt;</code></p>
<div class="dynheader">
Inheritance diagram for OSPF::InterfaceState:</div>
<div class="dyncontent">
 <div class="center">
  <img src="class_o_s_p_f_1_1_interface_state.png" usemap="#OSPF::InterfaceState_map" alt=""/>
  <map id="OSPF::InterfaceState_map" name="OSPF::InterfaceState_map">
<area href="class_o_s_p_f_1_1_interface_state_backup.html" alt="OSPF::InterfaceStateBackup" shape="rect" coords="0,56,249,80"/>
<area href="class_o_s_p_f_1_1_interface_state_designated_router.html" alt="OSPF::InterfaceStateDesignatedRouter" shape="rect" coords="259,56,508,80"/>
<area href="class_o_s_p_f_1_1_interface_state_down.html" alt="OSPF::InterfaceStateDown" shape="rect" coords="518,56,767,80"/>
<area href="class_o_s_p_f_1_1_interface_state_loopback.html" alt="OSPF::InterfaceStateLoopback" shape="rect" coords="777,56,1026,80"/>
<area href="class_o_s_p_f_1_1_interface_state_not_designated_router.html" alt="OSPF::InterfaceStateNotDesignatedRouter" shape="rect" coords="1036,56,1285,80"/>
<area href="class_o_s_p_f_1_1_interface_state_point_to_point.html" alt="OSPF::InterfaceStatePointToPoint" shape="rect" coords="1295,56,1544,80"/>
<area href="class_o_s_p_f_1_1_interface_state_waiting.html" alt="OSPF::InterfaceStateWaiting" shape="rect" coords="1554,56,1803,80"/>
</map>
 </div></div>

<p><a href="class_o_s_p_f_1_1_interface_state-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_s_p_f_1_1_interface_state.html#a4ea64d4cf5a613899ca35a61760e4d78">~InterfaceState</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="timer__queue_8h.html#a07640d68b3fdfaa5c48a36265e8f10b8">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_s_p_f_1_1_interface_state.html#a0949f7d2b10c7537c2468b42ab30f77a">processEvent</a> (<a class="el" href="class_o_s_p_f_1_1_interface.html">Interface</a> *intf, <a class="el" href="class_o_s_p_f_1_1_interface.html#ae0aca9ab8ca338c25d9afa6e65fc8824">Interface::InterfaceEventType</a> event)=0</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual <br class="typebreak"/>
<a class="el" href="class_o_s_p_f_1_1_interface.html#a68805ad1115c7149d5f8a139437e6249">Interface::InterfaceStateType</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_s_p_f_1_1_interface_state.html#a8ac70ec19096b5cc66827982a80540fb">getState</a> () const =0</td></tr>
<tr><td colspan="2"><h2><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="timer__queue_8h.html#a07640d68b3fdfaa5c48a36265e8f10b8">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_s_p_f_1_1_interface_state.html#a9f94bc7735d2a404e05eb7e26a38d033">changeState</a> (<a class="el" href="class_o_s_p_f_1_1_interface.html">Interface</a> *intf, <a class="el" href="class_o_s_p_f_1_1_interface_state.html">InterfaceState</a> *newState, <a class="el" href="class_o_s_p_f_1_1_interface_state.html">InterfaceState</a> *currentState)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="timer__queue_8h.html#a07640d68b3fdfaa5c48a36265e8f10b8">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_s_p_f_1_1_interface_state.html#a6a9592a636f20c163e3af0f27bfedcb2">calculateDesignatedRouter</a> (<a class="el" href="class_o_s_p_f_1_1_interface.html">Interface</a> *intf)</td></tr>
</table>
<hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a4ea64d4cf5a613899ca35a61760e4d78"></a><!-- doxytag: member="OSPF::InterfaceState::~InterfaceState" ref="a4ea64d4cf5a613899ca35a61760e4d78" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="class_o_s_p_f_1_1_interface_state.html#a4ea64d4cf5a613899ca35a61760e4d78">OSPF::InterfaceState::~InterfaceState</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [inline, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<div class="fragment"><pre class="fragment">{}
</pre></div>
</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="a6a9592a636f20c163e3af0f27bfedcb2"></a><!-- doxytag: member="OSPF::InterfaceState::calculateDesignatedRouter" ref="a6a9592a636f20c163e3af0f27bfedcb2" args="(Interface *intf)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="timer__queue_8h.html#a07640d68b3fdfaa5c48a36265e8f10b8">void</a> <a class="el" href="class_o_s_p_f_1_1_interface_state.html#a6a9592a636f20c163e3af0f27bfedcb2">OSPF::InterfaceState::calculateDesignatedRouter</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_o_s_p_f_1_1_interface.html">OSPF::Interface</a> *&#160;</td>
          <td class="paramname"><em>intf</em></td><td>)</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="class_o_s_p_f_1_1_interface_state_backup.html#a59ab622efe7e53d1679397906685e632">OSPF::InterfaceStateBackup::processEvent()</a>, <a class="el" href="class_o_s_p_f_1_1_interface_state_waiting.html#a70f72d26276984f9fc7b039364b9e8e1">OSPF::InterfaceStateWaiting::processEvent()</a>, <a class="el" href="class_o_s_p_f_1_1_interface_state_not_designated_router.html#a83973c35e252746c3b730e8dddf4bd45">OSPF::InterfaceStateNotDesignatedRouter::processEvent()</a>, and <a class="el" href="class_o_s_p_f_1_1_interface_state_designated_router.html#a438e79d72ff2fcde354fdfe8283aa71f">OSPF::InterfaceStateDesignatedRouter::processEvent()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="class_i_pv4_address.html" title="IPv4 address.">OSPF::RouterID</a> routerID = intf-&gt;<a class="code" href="class_o_s_p_f_1_1_interface.html#a7a0c392cb0be636208fc0c2bc3ae520f">parentArea</a>-&gt;<a class="code" href="class_o_s_p_f_1_1_area.html#a040af0c880f8a8bcc0e09b1ade647be1">getRouter</a>()-&gt;<a class="code" href="class_o_s_p_f_1_1_router.html#abf4855bc5ad7dfb4a47d1aae3b003751">getRouterID</a>();
    <a class="code" href="struct_o_s_p_f_1_1_designated_router_i_d.html">OSPF::DesignatedRouterID</a> currentDesignatedRouter = intf-&gt;<a class="code" href="class_o_s_p_f_1_1_interface.html#a2aa7970a1a4f77bbe3718c1669e0f9a9">designatedRouter</a>;
    <a class="code" href="struct_o_s_p_f_1_1_designated_router_i_d.html">OSPF::DesignatedRouterID</a> currentBackupRouter = intf-&gt;<a class="code" href="class_o_s_p_f_1_1_interface.html#a1c438d26ca9d60a131c2040f20376334">backupDesignatedRouter</a>;

    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> neighborCount = intf-&gt;<a class="code" href="class_o_s_p_f_1_1_interface.html#a7435ebb20414f378a2b5a12f06b7572a">neighboringRouters</a>.size();
    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> repeatCount = 0;
    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i;

    <a class="code" href="struct_o_s_p_f_1_1_designated_router_i_d.html">OSPF::DesignatedRouterID</a> declaredBackup;
    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> declaredBackupPriority;
    <a class="code" href="class_i_pv4_address.html" title="IPv4 address.">OSPF::RouterID</a> declaredBackupID;
    <span class="keywordtype">bool</span> backupDeclared;

    <a class="code" href="struct_o_s_p_f_1_1_designated_router_i_d.html">OSPF::DesignatedRouterID</a> declaredDesignatedRouter;
    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> declaredDesignatedRouterPriority;
    <a class="code" href="class_i_pv4_address.html" title="IPv4 address.">OSPF::RouterID</a> declaredDesignatedRouterID;
    <span class="keywordtype">bool</span> designatedRouterDeclared;

    <span class="keywordflow">do</span> {
        <span class="comment">// calculating backup designated router</span>
        declaredBackup = <a class="code" href="namespace_o_s_p_f.html#a29d73750cc11d3ebb94d7faf67bd7ff1">OSPF::NULL_DESIGNATEDROUTERID</a>;
        declaredBackupPriority = 0;
        declaredBackupID = <a class="code" href="namespace_o_s_p_f.html#a956b5218ee8f3f18d3391ac99f9635dd">OSPF::NULL_ROUTERID</a>;
        backupDeclared = <span class="keyword">false</span>;

        <a class="code" href="struct_o_s_p_f_1_1_designated_router_i_d.html">OSPF::DesignatedRouterID</a> highestRouter = <a class="code" href="namespace_o_s_p_f.html#a29d73750cc11d3ebb94d7faf67bd7ff1">OSPF::NULL_DESIGNATEDROUTERID</a>;
        <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> highestPriority = 0;
        <a class="code" href="class_i_pv4_address.html" title="IPv4 address.">OSPF::RouterID</a> highestID = <a class="code" href="namespace_o_s_p_f.html#a956b5218ee8f3f18d3391ac99f9635dd">OSPF::NULL_ROUTERID</a>;

        <span class="keywordflow">for</span> (i = 0; i &lt; neighborCount; i++) {
            <a class="code" href="class_o_s_p_f_1_1_neighbor.html">OSPF::Neighbor</a>* <a class="code" href="structneighbor.html">neighbor</a> = intf-&gt;<a class="code" href="class_o_s_p_f_1_1_interface.html#a7435ebb20414f378a2b5a12f06b7572a">neighboringRouters</a>[i];
            <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> neighborPriority = neighbor-&gt;<a class="code" href="class_o_s_p_f_1_1_neighbor.html#a8f7e17d374d3bc20e79f071e9bc59d28">getPriority</a>();

            <span class="keywordflow">if</span> (neighbor-&gt;<a class="code" href="class_o_s_p_f_1_1_neighbor.html#a8402e724645d205d658bb9d166d99aa6">getState</a>() &lt; <a class="code" href="class_o_s_p_f_1_1_neighbor.html#abe30518a64009a9ae44944c1036a4c0aaf5543ef8ca00f37422262f68442867c8">OSPF::Neighbor::TWOWAY_STATE</a>) {
                <span class="keywordflow">continue</span>;
            }
            <span class="keywordflow">if</span> (neighborPriority == 0) {
                <span class="keywordflow">continue</span>;
            }

            <a class="code" href="class_i_pv4_address.html" title="IPv4 address.">OSPF::RouterID</a> neighborID = neighbor-&gt;<a class="code" href="class_o_s_p_f_1_1_neighbor.html#a9eb1e9184a0a45fe4c33870faf19e62f">getNeighborID</a>();
            <a class="code" href="struct_o_s_p_f_1_1_designated_router_i_d.html">OSPF::DesignatedRouterID</a> neighborsDesignatedRouter = neighbor-&gt;<a class="code" href="class_o_s_p_f_1_1_neighbor.html#a4c01d848a5c55edaa4bfb56831bc30f2">getDesignatedRouter</a>();
            <a class="code" href="struct_o_s_p_f_1_1_designated_router_i_d.html">OSPF::DesignatedRouterID</a> neighborsBackupDesignatedRouter = neighbor-&gt;<a class="code" href="class_o_s_p_f_1_1_neighbor.html#a2a7f945525d41fe20b4e7e75363ed552">getBackupDesignatedRouter</a>();

            <span class="keywordflow">if</span> (neighborsDesignatedRouter.<a class="code" href="struct_o_s_p_f_1_1_designated_router_i_d.html#a7132bdabe0f15493518622d1b9e84f0f">routerID</a> != neighborID) {
                <span class="keywordflow">if</span> (neighborsBackupDesignatedRouter.<a class="code" href="struct_o_s_p_f_1_1_designated_router_i_d.html#a7132bdabe0f15493518622d1b9e84f0f">routerID</a> == neighborID) {
                    <span class="keywordflow">if</span> ((neighborPriority &gt; declaredBackupPriority) ||
                        ((neighborPriority == declaredBackupPriority) &amp;&amp;
                         (neighborID &gt; declaredBackupID)))
                    {
                        declaredBackup = neighborsBackupDesignatedRouter;
                        declaredBackupPriority = neighborPriority;
                        declaredBackupID = neighborID;
                        backupDeclared = <span class="keyword">true</span>;
                    }
                }
                <span class="keywordflow">if</span> (!backupDeclared) {
                    <span class="keywordflow">if</span> ((neighborPriority &gt; highestPriority) ||
                        ((neighborPriority == highestPriority) &amp;&amp;
                         (neighborID &gt; highestID)))
                    {
                        highestRouter.<a class="code" href="struct_o_s_p_f_1_1_designated_router_i_d.html#a7132bdabe0f15493518622d1b9e84f0f">routerID</a> = neighborID;
                        highestRouter.<a class="code" href="struct_o_s_p_f_1_1_designated_router_i_d.html#a3e44bfb89c52a2179bfe69cbd73fc30e">ipInterfaceAddress</a> = neighbor-&gt;<a class="code" href="class_o_s_p_f_1_1_neighbor.html#a5de77058501383c2655be390494f1b92">getAddress</a>();
                        highestPriority = neighborPriority;
                        highestID = neighborID;
                    }
                }
            }
        }
        <span class="comment">// also include the router itself in the calculations</span>
        <span class="keywordflow">if</span> (intf-&gt;<a class="code" href="class_o_s_p_f_1_1_interface.html#acf81bf9cd0a68e514565465f8ca63bb9">routerPriority</a> &gt; 0) {
            <span class="keywordflow">if</span> (currentDesignatedRouter.<a class="code" href="struct_o_s_p_f_1_1_designated_router_i_d.html#a7132bdabe0f15493518622d1b9e84f0f">routerID</a> != routerID) {
                <span class="keywordflow">if</span> (currentBackupRouter.<a class="code" href="struct_o_s_p_f_1_1_designated_router_i_d.html#a7132bdabe0f15493518622d1b9e84f0f">routerID</a> == routerID) {
                    <span class="keywordflow">if</span> ((intf-&gt;<a class="code" href="class_o_s_p_f_1_1_interface.html#acf81bf9cd0a68e514565465f8ca63bb9">routerPriority</a> &gt; declaredBackupPriority) ||
                        ((intf-&gt;<a class="code" href="class_o_s_p_f_1_1_interface.html#acf81bf9cd0a68e514565465f8ca63bb9">routerPriority</a> == declaredBackupPriority) &amp;&amp;
                         (routerID &gt; declaredBackupID)))
                    {
                        declaredBackup.<a class="code" href="struct_o_s_p_f_1_1_designated_router_i_d.html#a7132bdabe0f15493518622d1b9e84f0f">routerID</a> = routerID;
                        declaredBackup.<a class="code" href="struct_o_s_p_f_1_1_designated_router_i_d.html#a3e44bfb89c52a2179bfe69cbd73fc30e">ipInterfaceAddress</a> = intf-&gt;<a class="code" href="class_o_s_p_f_1_1_interface.html#a834f58c4cc265ce24378a70ea4d6964b">interfaceAddressRange</a>.<a class="code" href="struct_o_s_p_f_1_1_i_pv4_address_range.html#a74993d6571119644535ac918c4240722">address</a>;
                        declaredBackupPriority = intf-&gt;<a class="code" href="class_o_s_p_f_1_1_interface.html#acf81bf9cd0a68e514565465f8ca63bb9">routerPriority</a>;
                        declaredBackupID = routerID;
                        backupDeclared = <span class="keyword">true</span>;
                    }

                }
                <span class="keywordflow">if</span> (!backupDeclared) {
                    <span class="keywordflow">if</span> ((intf-&gt;<a class="code" href="class_o_s_p_f_1_1_interface.html#acf81bf9cd0a68e514565465f8ca63bb9">routerPriority</a> &gt; highestPriority) ||
                        ((intf-&gt;<a class="code" href="class_o_s_p_f_1_1_interface.html#acf81bf9cd0a68e514565465f8ca63bb9">routerPriority</a> == highestPriority) &amp;&amp;
                         (routerID &gt; highestID)))
                    {
                        declaredBackup.<a class="code" href="struct_o_s_p_f_1_1_designated_router_i_d.html#a7132bdabe0f15493518622d1b9e84f0f">routerID</a> = routerID;
                        declaredBackup.<a class="code" href="struct_o_s_p_f_1_1_designated_router_i_d.html#a3e44bfb89c52a2179bfe69cbd73fc30e">ipInterfaceAddress</a> = intf-&gt;<a class="code" href="class_o_s_p_f_1_1_interface.html#a834f58c4cc265ce24378a70ea4d6964b">interfaceAddressRange</a>.<a class="code" href="struct_o_s_p_f_1_1_i_pv4_address_range.html#a74993d6571119644535ac918c4240722">address</a>;
                        declaredBackupPriority = intf-&gt;<a class="code" href="class_o_s_p_f_1_1_interface.html#acf81bf9cd0a68e514565465f8ca63bb9">routerPriority</a>;
                        declaredBackupID = routerID;
                        backupDeclared = <span class="keyword">true</span>;
                    } <span class="keywordflow">else</span> {
                        declaredBackup = highestRouter;
                        declaredBackupPriority = highestPriority;
                        declaredBackupID = highestID;
                        backupDeclared = <span class="keyword">true</span>;
                    }
                }
            }
        }

        <span class="comment">// calculating backup designated router</span>
        declaredDesignatedRouter = <a class="code" href="namespace_o_s_p_f.html#a29d73750cc11d3ebb94d7faf67bd7ff1">OSPF::NULL_DESIGNATEDROUTERID</a>;
        declaredDesignatedRouterPriority = 0;
        declaredDesignatedRouterID = <a class="code" href="namespace_o_s_p_f.html#a956b5218ee8f3f18d3391ac99f9635dd">OSPF::NULL_ROUTERID</a>;
        designatedRouterDeclared = <span class="keyword">false</span>;

        <span class="keywordflow">for</span> (i = 0; i &lt; neighborCount; i++) {
            <a class="code" href="class_o_s_p_f_1_1_neighbor.html">OSPF::Neighbor</a>* neighbor = intf-&gt;<a class="code" href="class_o_s_p_f_1_1_interface.html#a7435ebb20414f378a2b5a12f06b7572a">neighboringRouters</a>[i];
            <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> neighborPriority = neighbor-&gt;<a class="code" href="class_o_s_p_f_1_1_neighbor.html#a8f7e17d374d3bc20e79f071e9bc59d28">getPriority</a>();

            <span class="keywordflow">if</span> (neighbor-&gt;<a class="code" href="class_o_s_p_f_1_1_neighbor.html#a8402e724645d205d658bb9d166d99aa6">getState</a>() &lt; <a class="code" href="class_o_s_p_f_1_1_neighbor.html#abe30518a64009a9ae44944c1036a4c0aaf5543ef8ca00f37422262f68442867c8">OSPF::Neighbor::TWOWAY_STATE</a>) {
                <span class="keywordflow">continue</span>;
            }
            <span class="keywordflow">if</span> (neighborPriority == 0) {
                <span class="keywordflow">continue</span>;
            }

            <a class="code" href="class_i_pv4_address.html" title="IPv4 address.">OSPF::RouterID</a> neighborID = neighbor-&gt;<a class="code" href="class_o_s_p_f_1_1_neighbor.html#a9eb1e9184a0a45fe4c33870faf19e62f">getNeighborID</a>();
            <a class="code" href="struct_o_s_p_f_1_1_designated_router_i_d.html">OSPF::DesignatedRouterID</a> neighborsDesignatedRouter = neighbor-&gt;<a class="code" href="class_o_s_p_f_1_1_neighbor.html#a4c01d848a5c55edaa4bfb56831bc30f2">getDesignatedRouter</a>();
            <a class="code" href="struct_o_s_p_f_1_1_designated_router_i_d.html">OSPF::DesignatedRouterID</a> neighborsBackupDesignatedRouter = neighbor-&gt;<a class="code" href="class_o_s_p_f_1_1_neighbor.html#a2a7f945525d41fe20b4e7e75363ed552">getBackupDesignatedRouter</a>();

            <span class="keywordflow">if</span> (neighborsDesignatedRouter.<a class="code" href="struct_o_s_p_f_1_1_designated_router_i_d.html#a7132bdabe0f15493518622d1b9e84f0f">routerID</a> == neighborID) {
                <span class="keywordflow">if</span> ((neighborPriority &gt; declaredDesignatedRouterPriority) ||
                    ((neighborPriority == declaredDesignatedRouterPriority) &amp;&amp;
                     (neighborID &gt; declaredDesignatedRouterID)))
                {
                    declaredDesignatedRouter = neighborsDesignatedRouter;
                    declaredDesignatedRouterPriority = neighborPriority;
                    declaredDesignatedRouterID = neighborID;
                    designatedRouterDeclared = <span class="keyword">true</span>;
                }
            }
        }
        <span class="comment">// also include the router itself in the calculations</span>
        <span class="keywordflow">if</span> (intf-&gt;<a class="code" href="class_o_s_p_f_1_1_interface.html#acf81bf9cd0a68e514565465f8ca63bb9">routerPriority</a> &gt; 0) {
            <span class="keywordflow">if</span> (currentDesignatedRouter.<a class="code" href="struct_o_s_p_f_1_1_designated_router_i_d.html#a7132bdabe0f15493518622d1b9e84f0f">routerID</a> == routerID) {
                <span class="keywordflow">if</span> ((intf-&gt;<a class="code" href="class_o_s_p_f_1_1_interface.html#acf81bf9cd0a68e514565465f8ca63bb9">routerPriority</a> &gt; declaredDesignatedRouterPriority) ||
                    ((intf-&gt;<a class="code" href="class_o_s_p_f_1_1_interface.html#acf81bf9cd0a68e514565465f8ca63bb9">routerPriority</a> == declaredDesignatedRouterPriority) &amp;&amp;
                     (routerID &gt; declaredDesignatedRouterID)))
                {
                    declaredDesignatedRouter.<a class="code" href="struct_o_s_p_f_1_1_designated_router_i_d.html#a7132bdabe0f15493518622d1b9e84f0f">routerID</a> = routerID;
                    declaredDesignatedRouter.<a class="code" href="struct_o_s_p_f_1_1_designated_router_i_d.html#a3e44bfb89c52a2179bfe69cbd73fc30e">ipInterfaceAddress</a> = intf-&gt;<a class="code" href="class_o_s_p_f_1_1_interface.html#a834f58c4cc265ce24378a70ea4d6964b">interfaceAddressRange</a>.<a class="code" href="struct_o_s_p_f_1_1_i_pv4_address_range.html#a74993d6571119644535ac918c4240722">address</a>;
                    declaredDesignatedRouterPriority = intf-&gt;<a class="code" href="class_o_s_p_f_1_1_interface.html#acf81bf9cd0a68e514565465f8ca63bb9">routerPriority</a>;
                    declaredDesignatedRouterID = routerID;
                    designatedRouterDeclared = <span class="keyword">true</span>;
                }

            }
        }
        <span class="keywordflow">if</span> (!designatedRouterDeclared) {
            declaredDesignatedRouter = declaredBackup;
            declaredDesignatedRouterPriority = declaredBackupPriority;
            declaredDesignatedRouterID = declaredBackupID;
            designatedRouterDeclared = <span class="keyword">true</span>;
        }

        <span class="comment">// if the router is any kind of DR or is no longer one of them, then repeat</span>
        <span class="keywordflow">if</span> (
            (
                (declaredDesignatedRouter.<a class="code" href="struct_o_s_p_f_1_1_designated_router_i_d.html#a7132bdabe0f15493518622d1b9e84f0f">routerID</a> != <a class="code" href="namespace_o_s_p_f.html#a956b5218ee8f3f18d3391ac99f9635dd">OSPF::NULL_ROUTERID</a>) &amp;&amp;
                ((
                    (currentDesignatedRouter.<a class="code" href="struct_o_s_p_f_1_1_designated_router_i_d.html#a7132bdabe0f15493518622d1b9e84f0f">routerID</a> == routerID) &amp;&amp;
                    (declaredDesignatedRouter.<a class="code" href="struct_o_s_p_f_1_1_designated_router_i_d.html#a7132bdabe0f15493518622d1b9e84f0f">routerID</a> != routerID)
                ) ||
                (
                    (currentDesignatedRouter.<a class="code" href="struct_o_s_p_f_1_1_designated_router_i_d.html#a7132bdabe0f15493518622d1b9e84f0f">routerID</a> != routerID) &amp;&amp;
                    (declaredDesignatedRouter.<a class="code" href="struct_o_s_p_f_1_1_designated_router_i_d.html#a7132bdabe0f15493518622d1b9e84f0f">routerID</a> == routerID)
                ))
            ) ||
            (
                (declaredBackup.<a class="code" href="struct_o_s_p_f_1_1_designated_router_i_d.html#a7132bdabe0f15493518622d1b9e84f0f">routerID</a> != <a class="code" href="namespace_o_s_p_f.html#a956b5218ee8f3f18d3391ac99f9635dd">OSPF::NULL_ROUTERID</a>) &amp;&amp;
                ((
                    (currentBackupRouter.<a class="code" href="struct_o_s_p_f_1_1_designated_router_i_d.html#a7132bdabe0f15493518622d1b9e84f0f">routerID</a> == routerID) &amp;&amp;
                    (declaredBackup.<a class="code" href="struct_o_s_p_f_1_1_designated_router_i_d.html#a7132bdabe0f15493518622d1b9e84f0f">routerID</a> != routerID)
                ) ||
                (
                    (currentBackupRouter.<a class="code" href="struct_o_s_p_f_1_1_designated_router_i_d.html#a7132bdabe0f15493518622d1b9e84f0f">routerID</a> != routerID) &amp;&amp;
                    (declaredBackup.<a class="code" href="struct_o_s_p_f_1_1_designated_router_i_d.html#a7132bdabe0f15493518622d1b9e84f0f">routerID</a> == routerID)
                ))
            )
        )
        {
            currentDesignatedRouter = declaredDesignatedRouter;
            currentBackupRouter = declaredBackup;
            repeatCount++;
        } <span class="keywordflow">else</span> {
            repeatCount += 2;
        }

    } <span class="keywordflow">while</span> (repeatCount &lt; 2);

    <a class="code" href="class_i_pv4_address.html" title="IPv4 address.">OSPF::RouterID</a> routersOldDesignatedRouterID = intf-&gt;<a class="code" href="class_o_s_p_f_1_1_interface.html#a2aa7970a1a4f77bbe3718c1669e0f9a9">designatedRouter</a>.<a class="code" href="struct_o_s_p_f_1_1_designated_router_i_d.html#a7132bdabe0f15493518622d1b9e84f0f">routerID</a>;
    <a class="code" href="class_i_pv4_address.html" title="IPv4 address.">OSPF::RouterID</a> routersOldBackupID = intf-&gt;<a class="code" href="class_o_s_p_f_1_1_interface.html#a1c438d26ca9d60a131c2040f20376334">backupDesignatedRouter</a>.<a class="code" href="struct_o_s_p_f_1_1_designated_router_i_d.html#a7132bdabe0f15493518622d1b9e84f0f">routerID</a>;

    intf-&gt;<a class="code" href="class_o_s_p_f_1_1_interface.html#a2aa7970a1a4f77bbe3718c1669e0f9a9">designatedRouter</a> = declaredDesignatedRouter;
    intf-&gt;<a class="code" href="class_o_s_p_f_1_1_interface.html#a1c438d26ca9d60a131c2040f20376334">backupDesignatedRouter</a> = declaredBackup;

    <span class="keywordtype">bool</span> wasBackupDesignatedRouter = (routersOldBackupID == routerID);
    <span class="keywordtype">bool</span> wasDesignatedRouter = (routersOldDesignatedRouterID == routerID);
    <span class="keywordtype">bool</span> wasOther = (intf-&gt;<a class="code" href="class_o_s_p_f_1_1_interface.html#ad414101ce155a1956a4fe8a22be6d69f">getState</a>() == <a class="code" href="class_o_s_p_f_1_1_interface.html#a68805ad1115c7149d5f8a139437e6249a8b9c4a7d8222563b7a720cf1052f13c9">OSPF::Interface::NOT_DESIGNATED_ROUTER_STATE</a>);
    <span class="keywordtype">bool</span> wasWaiting = (!wasBackupDesignatedRouter &amp;&amp; !wasDesignatedRouter &amp;&amp; !wasOther);
    <span class="keywordtype">bool</span> isBackupDesignatedRouter = (declaredBackup.<a class="code" href="struct_o_s_p_f_1_1_designated_router_i_d.html#a7132bdabe0f15493518622d1b9e84f0f">routerID</a> == routerID);
    <span class="keywordtype">bool</span> isDesignatedRouter = (declaredDesignatedRouter.<a class="code" href="struct_o_s_p_f_1_1_designated_router_i_d.html#a7132bdabe0f15493518622d1b9e84f0f">routerID</a> == routerID);
    <span class="keywordtype">bool</span> isOther = (!isBackupDesignatedRouter &amp;&amp; !isDesignatedRouter);

    <span class="keywordflow">if</span> (wasBackupDesignatedRouter) {
        <span class="keywordflow">if</span> (isDesignatedRouter) {
            <a class="code" href="class_o_s_p_f_1_1_interface_state.html#a9f94bc7735d2a404e05eb7e26a38d033">changeState</a>(intf, <span class="keyword">new</span> <a class="code" href="class_o_s_p_f_1_1_interface_state_designated_router.html">OSPF::InterfaceStateDesignatedRouter</a>, <span class="keyword">this</span>);
        }
        <span class="keywordflow">if</span> (isOther) {
            <a class="code" href="class_o_s_p_f_1_1_interface_state.html#a9f94bc7735d2a404e05eb7e26a38d033">changeState</a>(intf, <span class="keyword">new</span> <a class="code" href="class_o_s_p_f_1_1_interface_state_not_designated_router.html">OSPF::InterfaceStateNotDesignatedRouter</a>, <span class="keyword">this</span>);
        }
    }
    <span class="keywordflow">if</span> (wasDesignatedRouter) {
        <span class="keywordflow">if</span> (isBackupDesignatedRouter) {
            <a class="code" href="class_o_s_p_f_1_1_interface_state.html#a9f94bc7735d2a404e05eb7e26a38d033">changeState</a>(intf, <span class="keyword">new</span> <a class="code" href="class_o_s_p_f_1_1_interface_state_backup.html">OSPF::InterfaceStateBackup</a>, <span class="keyword">this</span>);
        }
        <span class="keywordflow">if</span> (isOther) {
            <a class="code" href="class_o_s_p_f_1_1_interface_state.html#a9f94bc7735d2a404e05eb7e26a38d033">changeState</a>(intf, <span class="keyword">new</span> <a class="code" href="class_o_s_p_f_1_1_interface_state_not_designated_router.html">OSPF::InterfaceStateNotDesignatedRouter</a>, <span class="keyword">this</span>);
        }
    }
    <span class="keywordflow">if</span> (wasOther) {
        <span class="keywordflow">if</span> (isDesignatedRouter) {
            <a class="code" href="class_o_s_p_f_1_1_interface_state.html#a9f94bc7735d2a404e05eb7e26a38d033">changeState</a>(intf, <span class="keyword">new</span> <a class="code" href="class_o_s_p_f_1_1_interface_state_designated_router.html">OSPF::InterfaceStateDesignatedRouter</a>, <span class="keyword">this</span>);
        }
        <span class="keywordflow">if</span> (isBackupDesignatedRouter) {
            <a class="code" href="class_o_s_p_f_1_1_interface_state.html#a9f94bc7735d2a404e05eb7e26a38d033">changeState</a>(intf, <span class="keyword">new</span> <a class="code" href="class_o_s_p_f_1_1_interface_state_backup.html">OSPF::InterfaceStateBackup</a>, <span class="keyword">this</span>);
        }
    }
    <span class="keywordflow">if</span> (wasWaiting) {
        <span class="keywordflow">if</span> (isDesignatedRouter) {
            <a class="code" href="class_o_s_p_f_1_1_interface_state.html#a9f94bc7735d2a404e05eb7e26a38d033">changeState</a>(intf, <span class="keyword">new</span> <a class="code" href="class_o_s_p_f_1_1_interface_state_designated_router.html">OSPF::InterfaceStateDesignatedRouter</a>, <span class="keyword">this</span>);
        }
        <span class="keywordflow">if</span> (isBackupDesignatedRouter) {
            <a class="code" href="class_o_s_p_f_1_1_interface_state.html#a9f94bc7735d2a404e05eb7e26a38d033">changeState</a>(intf, <span class="keyword">new</span> <a class="code" href="class_o_s_p_f_1_1_interface_state_backup.html">OSPF::InterfaceStateBackup</a>, <span class="keyword">this</span>);
        }
        <span class="keywordflow">if</span> (isOther) {
            <a class="code" href="class_o_s_p_f_1_1_interface_state.html#a9f94bc7735d2a404e05eb7e26a38d033">changeState</a>(intf, <span class="keyword">new</span> <a class="code" href="class_o_s_p_f_1_1_interface_state_not_designated_router.html">OSPF::InterfaceStateNotDesignatedRouter</a>, <span class="keyword">this</span>);
        }
    }

    <span class="keywordflow">for</span> (i = 0; i &lt; neighborCount; i++) {
        <span class="keywordflow">if</span> ((intf-&gt;<a class="code" href="class_o_s_p_f_1_1_interface.html#a8d7ae4be845b975503eb1178c4a3d749">interfaceType</a> == <a class="code" href="class_o_s_p_f_1_1_interface.html#a558b3988a38b079460b57f092eacf4acae26d6f3ee5ee0f7c1ed2f2196c1dfe07">OSPF::Interface::NBMA</a>) &amp;&amp;
            ((!wasBackupDesignatedRouter &amp;&amp; isBackupDesignatedRouter) ||
             (!wasDesignatedRouter &amp;&amp; isDesignatedRouter)))
        {
            <span class="keywordflow">if</span> (intf-&gt;<a class="code" href="class_o_s_p_f_1_1_interface.html#a7435ebb20414f378a2b5a12f06b7572a">neighboringRouters</a>[i]-&gt;getPriority() == 0) {
                intf-&gt;<a class="code" href="class_o_s_p_f_1_1_interface.html#a7435ebb20414f378a2b5a12f06b7572a">neighboringRouters</a>[i]-&gt;processEvent(<a class="code" href="class_o_s_p_f_1_1_neighbor.html#aa11c941b2bc4a36c36fba1cb453a4172ac3b51b116280a6acb3321c203c6d69f0">OSPF::Neighbor::START</a>);
            }
        }
        <span class="keywordflow">if</span> ((declaredDesignatedRouter.<a class="code" href="struct_o_s_p_f_1_1_designated_router_i_d.html#a7132bdabe0f15493518622d1b9e84f0f">routerID</a> != routersOldDesignatedRouterID) ||
            (declaredBackup.<a class="code" href="struct_o_s_p_f_1_1_designated_router_i_d.html#a7132bdabe0f15493518622d1b9e84f0f">routerID</a> != routersOldBackupID))
        {
            <span class="keywordflow">if</span> (intf-&gt;<a class="code" href="class_o_s_p_f_1_1_interface.html#a7435ebb20414f378a2b5a12f06b7572a">neighboringRouters</a>[i]-&gt;getState() &gt;= <a class="code" href="class_o_s_p_f_1_1_neighbor.html#abe30518a64009a9ae44944c1036a4c0aaf5543ef8ca00f37422262f68442867c8">OSPF::Neighbor::TWOWAY_STATE</a>) {
                intf-&gt;<a class="code" href="class_o_s_p_f_1_1_interface.html#a7435ebb20414f378a2b5a12f06b7572a">neighboringRouters</a>[i]-&gt;processEvent(<a class="code" href="class_o_s_p_f_1_1_neighbor.html#aa11c941b2bc4a36c36fba1cb453a4172ab7b2ca2341e15042b11d882361e75538">OSPF::Neighbor::IS_ADJACENCY_OK</a>);
            }
        }
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a9f94bc7735d2a404e05eb7e26a38d033"></a><!-- doxytag: member="OSPF::InterfaceState::changeState" ref="a9f94bc7735d2a404e05eb7e26a38d033" args="(Interface *intf, InterfaceState *newState, InterfaceState *currentState)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="timer__queue_8h.html#a07640d68b3fdfaa5c48a36265e8f10b8">void</a> <a class="el" href="class_o_s_p_f_1_1_interface_state.html#a9f94bc7735d2a404e05eb7e26a38d033">OSPF::InterfaceState::changeState</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_o_s_p_f_1_1_interface.html">OSPF::Interface</a> *&#160;</td>
          <td class="paramname"><em>intf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_o_s_p_f_1_1_interface_state.html">OSPF::InterfaceState</a> *&#160;</td>
          <td class="paramname"><em>newState</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_o_s_p_f_1_1_interface_state.html">OSPF::InterfaceState</a> *&#160;</td>
          <td class="paramname"><em>currentState</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="class_o_s_p_f_1_1_interface_state_backup.html#a59ab622efe7e53d1679397906685e632">OSPF::InterfaceStateBackup::processEvent()</a>, <a class="el" href="class_o_s_p_f_1_1_interface_state_waiting.html#a70f72d26276984f9fc7b039364b9e8e1">OSPF::InterfaceStateWaiting::processEvent()</a>, <a class="el" href="class_o_s_p_f_1_1_interface_state_point_to_point.html#aa284d9d617fc3e6c1b6d582137c0ba3a">OSPF::InterfaceStatePointToPoint::processEvent()</a>, <a class="el" href="class_o_s_p_f_1_1_interface_state_not_designated_router.html#a83973c35e252746c3b730e8dddf4bd45">OSPF::InterfaceStateNotDesignatedRouter::processEvent()</a>, <a class="el" href="class_o_s_p_f_1_1_interface_state_loopback.html#ad63d7657e970844fd6081e6fd8d99d5c">OSPF::InterfaceStateLoopback::processEvent()</a>, <a class="el" href="class_o_s_p_f_1_1_interface_state_down.html#a80191cf50c52d0f032e20b556410e09c">OSPF::InterfaceStateDown::processEvent()</a>, and <a class="el" href="class_o_s_p_f_1_1_interface_state_designated_router.html#a438e79d72ff2fcde354fdfe8283aa71f">OSPF::InterfaceStateDesignatedRouter::processEvent()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="class_o_s_p_f_1_1_interface.html#a68805ad1115c7149d5f8a139437e6249">OSPF::Interface::InterfaceStateType</a> oldState = currentState-&gt;<a class="code" href="class_o_s_p_f_1_1_interface_state.html#a8ac70ec19096b5cc66827982a80540fb">getState</a>();
    <a class="code" href="class_o_s_p_f_1_1_interface.html#a68805ad1115c7149d5f8a139437e6249">OSPF::Interface::InterfaceStateType</a> nextState = newState-&gt;<a class="code" href="class_o_s_p_f_1_1_interface_state.html#a8ac70ec19096b5cc66827982a80540fb">getState</a>();
    <a class="code" href="class_o_s_p_f_1_1_interface.html#a558b3988a38b079460b57f092eacf4ac">OSPF::Interface::OSPFInterfaceType</a> intfType = intf-&gt;<a class="code" href="class_o_s_p_f_1_1_interface.html#a29189950efe0c6411fb5181175d57310">getType</a>();
    <span class="keywordtype">bool</span> shouldRebuildRoutingTable = <span class="keyword">false</span>;

    intf-&gt;<a class="code" href="class_o_s_p_f_1_1_interface.html#acd40508455381249a16c5f7eed751298">changeState</a>(newState, currentState);

    <span class="keywordflow">if</span> ((oldState == <a class="code" href="class_o_s_p_f_1_1_interface.html#a68805ad1115c7149d5f8a139437e6249af213eee9dfb19b220d1310dd0c84f496">OSPF::Interface::DOWN_STATE</a>) ||
        (nextState == <a class="code" href="class_o_s_p_f_1_1_interface.html#a68805ad1115c7149d5f8a139437e6249af213eee9dfb19b220d1310dd0c84f496">OSPF::Interface::DOWN_STATE</a>) ||
        (oldState == <a class="code" href="class_o_s_p_f_1_1_interface.html#a68805ad1115c7149d5f8a139437e6249a6a027e8b0c39b0f9a879dc9fb76bdcf1">OSPF::Interface::LOOPBACK_STATE</a>) ||
        (nextState == <a class="code" href="class_o_s_p_f_1_1_interface.html#a68805ad1115c7149d5f8a139437e6249a6a027e8b0c39b0f9a879dc9fb76bdcf1">OSPF::Interface::LOOPBACK_STATE</a>) ||
        (oldState == <a class="code" href="class_o_s_p_f_1_1_interface.html#a68805ad1115c7149d5f8a139437e6249a95589231f8e97343f94c3bd98dca00f4">OSPF::Interface::DESIGNATED_ROUTER_STATE</a>) ||
        (nextState == <a class="code" href="class_o_s_p_f_1_1_interface.html#a68805ad1115c7149d5f8a139437e6249a95589231f8e97343f94c3bd98dca00f4">OSPF::Interface::DESIGNATED_ROUTER_STATE</a>) ||
        ((intfType == <a class="code" href="class_o_s_p_f_1_1_interface.html#a558b3988a38b079460b57f092eacf4acaa57573e6fff63738e0f342ee1d5d760f">OSPF::Interface::POINTTOPOINT</a>) &amp;&amp;
         ((oldState == <a class="code" href="class_o_s_p_f_1_1_interface.html#a68805ad1115c7149d5f8a139437e6249a79ab94e68f4e40b39c6c6e3e72a48844">OSPF::Interface::POINTTOPOINT_STATE</a>) ||
          (nextState == <a class="code" href="class_o_s_p_f_1_1_interface.html#a68805ad1115c7149d5f8a139437e6249a79ab94e68f4e40b39c6c6e3e72a48844">OSPF::Interface::POINTTOPOINT_STATE</a>))) ||
        (((intfType == <a class="code" href="class_o_s_p_f_1_1_interface.html#a558b3988a38b079460b57f092eacf4aca237bd0e7c65b27bf1d75ddeccf7f67f9">OSPF::Interface::BROADCAST</a>) ||
          (intfType == <a class="code" href="class_o_s_p_f_1_1_interface.html#a558b3988a38b079460b57f092eacf4acae26d6f3ee5ee0f7c1ed2f2196c1dfe07">OSPF::Interface::NBMA</a>)) &amp;&amp;
         ((oldState == <a class="code" href="class_o_s_p_f_1_1_interface.html#a68805ad1115c7149d5f8a139437e6249a466fb613028467b9186db98b2a7e958c">OSPF::Interface::WAITING_STATE</a>) ||
          (nextState == <a class="code" href="class_o_s_p_f_1_1_interface.html#a68805ad1115c7149d5f8a139437e6249a466fb613028467b9186db98b2a7e958c">OSPF::Interface::WAITING_STATE</a>))))
    {
        <a class="code" href="class_o_s_p_f_1_1_router_l_s_a.html">OSPF::RouterLSA</a>* routerLSA = intf-&gt;<a class="code" href="class_o_s_p_f_1_1_interface.html#a42decc255df2e2adb5619f0d1cd52bc0">getArea</a>()-&gt;<a class="code" href="class_o_s_p_f_1_1_area.html#adec82108c63b9b87d47d4ad3ccb0bfb0">findRouterLSA</a>(intf-&gt;<a class="code" href="class_o_s_p_f_1_1_interface.html#a42decc255df2e2adb5619f0d1cd52bc0">getArea</a>()-&gt;<a class="code" href="class_o_s_p_f_1_1_area.html#a040af0c880f8a8bcc0e09b1ade647be1">getRouter</a>()-&gt;<a class="code" href="class_o_s_p_f_1_1_router.html#abf4855bc5ad7dfb4a47d1aae3b003751">getRouterID</a>());

        <span class="keywordflow">if</span> (routerLSA != <a class="code" href="def_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {
            <span class="keywordtype">long</span> sequenceNumber = routerLSA-&gt;<a class="code" href="class_o_s_p_f_l_s_a.html#a2c9acdc68e5e66deb1826ee41a07b7d1">getHeader</a>().<a class="code" href="class_o_s_p_f_l_s_a_header.html#aa1fa1df57d84e20fef93e765a587ff1c">getLsSequenceNumber</a>();
            <span class="keywordflow">if</span> (sequenceNumber == <a class="code" href="_o_s_p_fcommon_8h.html#a35f49b34e56993fe20d3a21d144c16d3">MAX_SEQUENCE_NUMBER</a>) {
                routerLSA-&gt;<a class="code" href="class_o_s_p_f_l_s_a.html#a2c9acdc68e5e66deb1826ee41a07b7d1">getHeader</a>().<a class="code" href="class_o_s_p_f_l_s_a_header.html#a9851dc72d585835bfcffa08412c33f99">setLsAge</a>(<a class="code" href="_o_s_p_fcommon_8h.html#a22c87c874ff5382c5d082b860110e363">MAX_AGE</a>);
                intf-&gt;<a class="code" href="class_o_s_p_f_1_1_interface.html#a42decc255df2e2adb5619f0d1cd52bc0">getArea</a>()-&gt;<a class="code" href="class_o_s_p_f_1_1_area.html#ad734e45bd64c8095f971c777005f28bb">floodLSA</a>(routerLSA);
                routerLSA-&gt;<a class="code" href="class_o_s_p_f_1_1_l_s_a_tracking_info.html#a2a9bb2304005f0e95c44dfa3472efe48">incrementInstallTime</a>();
            } <span class="keywordflow">else</span> {
                <a class="code" href="class_o_s_p_f_1_1_router_l_s_a.html">OSPF::RouterLSA</a>* newLSA = intf-&gt;<a class="code" href="class_o_s_p_f_1_1_interface.html#a42decc255df2e2adb5619f0d1cd52bc0">getArea</a>()-&gt;<a class="code" href="class_o_s_p_f_1_1_area.html#af1287abae6d4623984fe95892c3dc514">originateRouterLSA</a>();

                newLSA-&gt;<a class="code" href="class_o_s_p_f_l_s_a.html#a2c9acdc68e5e66deb1826ee41a07b7d1">getHeader</a>().<a class="code" href="class_o_s_p_f_l_s_a_header.html#ad1dd1ce9ff9b1c59f8638cdbb26b2d57">setLsSequenceNumber</a>(sequenceNumber + 1);
                shouldRebuildRoutingTable |= routerLSA-&gt;<a class="code" href="class_o_s_p_f_1_1_router_l_s_a.html#a9ccbb9b6cb8f662db04d38e8154f3cf3">update</a>(newLSA);
                <span class="keyword">delete</span> newLSA;

                intf-&gt;<a class="code" href="class_o_s_p_f_1_1_interface.html#a42decc255df2e2adb5619f0d1cd52bc0">getArea</a>()-&gt;<a class="code" href="class_o_s_p_f_1_1_area.html#ad734e45bd64c8095f971c777005f28bb">floodLSA</a>(routerLSA);
            }
        } <span class="keywordflow">else</span> {  <span class="comment">// (lsa == NULL) -&gt; This must be the first time any interface is up...</span>
            <a class="code" href="class_o_s_p_f_1_1_router_l_s_a.html">OSPF::RouterLSA</a>* newLSA = intf-&gt;<a class="code" href="class_o_s_p_f_1_1_interface.html#a42decc255df2e2adb5619f0d1cd52bc0">getArea</a>()-&gt;<a class="code" href="class_o_s_p_f_1_1_area.html#af1287abae6d4623984fe95892c3dc514">originateRouterLSA</a>();

            shouldRebuildRoutingTable |= intf-&gt;<a class="code" href="class_o_s_p_f_1_1_interface.html#a42decc255df2e2adb5619f0d1cd52bc0">getArea</a>()-&gt;<a class="code" href="class_o_s_p_f_1_1_area.html#afbd23cc4637e8de914cbd0fb962dcc7b">installRouterLSA</a>(newLSA);

            routerLSA = intf-&gt;<a class="code" href="class_o_s_p_f_1_1_interface.html#a42decc255df2e2adb5619f0d1cd52bc0">getArea</a>()-&gt;<a class="code" href="class_o_s_p_f_1_1_area.html#adec82108c63b9b87d47d4ad3ccb0bfb0">findRouterLSA</a>(intf-&gt;<a class="code" href="class_o_s_p_f_1_1_interface.html#a42decc255df2e2adb5619f0d1cd52bc0">getArea</a>()-&gt;<a class="code" href="class_o_s_p_f_1_1_area.html#a040af0c880f8a8bcc0e09b1ade647be1">getRouter</a>()-&gt;<a class="code" href="class_o_s_p_f_1_1_router.html#abf4855bc5ad7dfb4a47d1aae3b003751">getRouterID</a>());

            intf-&gt;<a class="code" href="class_o_s_p_f_1_1_interface.html#a42decc255df2e2adb5619f0d1cd52bc0">getArea</a>()-&gt;<a class="code" href="class_o_s_p_f_1_1_area.html#a49e5ed6e7c70fc77d7678ae19d1acf3b">setSPFTreeRoot</a>(routerLSA);
            intf-&gt;<a class="code" href="class_o_s_p_f_1_1_interface.html#a42decc255df2e2adb5619f0d1cd52bc0">getArea</a>()-&gt;<a class="code" href="class_o_s_p_f_1_1_area.html#ad734e45bd64c8095f971c777005f28bb">floodLSA</a>(newLSA);
            <span class="keyword">delete</span> newLSA;
        }
    }

    <span class="keywordflow">if</span> (nextState == <a class="code" href="class_o_s_p_f_1_1_interface.html#a68805ad1115c7149d5f8a139437e6249a95589231f8e97343f94c3bd98dca00f4">OSPF::Interface::DESIGNATED_ROUTER_STATE</a>) {
        <a class="code" href="class_o_s_p_f_1_1_network_l_s_a.html">OSPF::NetworkLSA</a>* newLSA = intf-&gt;<a class="code" href="class_o_s_p_f_1_1_interface.html#a42decc255df2e2adb5619f0d1cd52bc0">getArea</a>()-&gt;<a class="code" href="class_o_s_p_f_1_1_area.html#af5d1d8065403a2359f3ce59b49759766">originateNetworkLSA</a>(intf);
        <span class="keywordflow">if</span> (newLSA != <a class="code" href="def_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {
            shouldRebuildRoutingTable |= intf-&gt;<a class="code" href="class_o_s_p_f_1_1_interface.html#a42decc255df2e2adb5619f0d1cd52bc0">getArea</a>()-&gt;<a class="code" href="class_o_s_p_f_1_1_area.html#a855fa674222d819e5936d60ad469607e">installNetworkLSA</a>(newLSA);

            intf-&gt;<a class="code" href="class_o_s_p_f_1_1_interface.html#a42decc255df2e2adb5619f0d1cd52bc0">getArea</a>()-&gt;<a class="code" href="class_o_s_p_f_1_1_area.html#ad734e45bd64c8095f971c777005f28bb">floodLSA</a>(newLSA);
            <span class="keyword">delete</span> newLSA;
        } <span class="keywordflow">else</span> {    <span class="comment">// no neighbors on the network -&gt; old NetworkLSA must be flushed</span>
            <a class="code" href="class_o_s_p_f_1_1_network_l_s_a.html">OSPF::NetworkLSA</a>* oldLSA = intf-&gt;<a class="code" href="class_o_s_p_f_1_1_interface.html#a42decc255df2e2adb5619f0d1cd52bc0">getArea</a>()-&gt;<a class="code" href="class_o_s_p_f_1_1_area.html#a11dd2dff6df4544dae82ea03100f12e5">findNetworkLSA</a>(intf-&gt;<a class="code" href="class_o_s_p_f_1_1_interface.html#a19ed3a9f8223ee7339bf3cef15c16b61">getAddressRange</a>().<a class="code" href="struct_o_s_p_f_1_1_i_pv4_address_range.html#a74993d6571119644535ac918c4240722">address</a>);

            <span class="keywordflow">if</span> (oldLSA != <a class="code" href="def_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {
                oldLSA-&gt;<a class="code" href="class_o_s_p_f_l_s_a.html#a2c9acdc68e5e66deb1826ee41a07b7d1">getHeader</a>().<a class="code" href="class_o_s_p_f_l_s_a_header.html#a9851dc72d585835bfcffa08412c33f99">setLsAge</a>(<a class="code" href="_o_s_p_fcommon_8h.html#a22c87c874ff5382c5d082b860110e363">MAX_AGE</a>);
                intf-&gt;<a class="code" href="class_o_s_p_f_1_1_interface.html#a42decc255df2e2adb5619f0d1cd52bc0">getArea</a>()-&gt;<a class="code" href="class_o_s_p_f_1_1_area.html#ad734e45bd64c8095f971c777005f28bb">floodLSA</a>(oldLSA);
                oldLSA-&gt;<a class="code" href="class_o_s_p_f_1_1_l_s_a_tracking_info.html#a2a9bb2304005f0e95c44dfa3472efe48">incrementInstallTime</a>();
            }
        }
    }

    <span class="keywordflow">if</span> (oldState == <a class="code" href="class_o_s_p_f_1_1_interface.html#a68805ad1115c7149d5f8a139437e6249a95589231f8e97343f94c3bd98dca00f4">OSPF::Interface::DESIGNATED_ROUTER_STATE</a>) {
        <a class="code" href="class_o_s_p_f_1_1_network_l_s_a.html">OSPF::NetworkLSA</a>* networkLSA = intf-&gt;<a class="code" href="class_o_s_p_f_1_1_interface.html#a42decc255df2e2adb5619f0d1cd52bc0">getArea</a>()-&gt;<a class="code" href="class_o_s_p_f_1_1_area.html#a11dd2dff6df4544dae82ea03100f12e5">findNetworkLSA</a>(intf-&gt;<a class="code" href="class_o_s_p_f_1_1_interface.html#a19ed3a9f8223ee7339bf3cef15c16b61">getAddressRange</a>().<a class="code" href="struct_o_s_p_f_1_1_i_pv4_address_range.html#a74993d6571119644535ac918c4240722">address</a>);

        <span class="keywordflow">if</span> (networkLSA != <a class="code" href="def_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {
            networkLSA-&gt;<a class="code" href="class_o_s_p_f_l_s_a.html#a2c9acdc68e5e66deb1826ee41a07b7d1">getHeader</a>().<a class="code" href="class_o_s_p_f_l_s_a_header.html#a9851dc72d585835bfcffa08412c33f99">setLsAge</a>(<a class="code" href="_o_s_p_fcommon_8h.html#a22c87c874ff5382c5d082b860110e363">MAX_AGE</a>);
            intf-&gt;<a class="code" href="class_o_s_p_f_1_1_interface.html#a42decc255df2e2adb5619f0d1cd52bc0">getArea</a>()-&gt;<a class="code" href="class_o_s_p_f_1_1_area.html#ad734e45bd64c8095f971c777005f28bb">floodLSA</a>(networkLSA);
            networkLSA-&gt;<a class="code" href="class_o_s_p_f_1_1_l_s_a_tracking_info.html#a2a9bb2304005f0e95c44dfa3472efe48">incrementInstallTime</a>();
        }
    }

    <span class="keywordflow">if</span> (shouldRebuildRoutingTable) {
        intf-&gt;<a class="code" href="class_o_s_p_f_1_1_interface.html#a42decc255df2e2adb5619f0d1cd52bc0">getArea</a>()-&gt;<a class="code" href="class_o_s_p_f_1_1_area.html#a040af0c880f8a8bcc0e09b1ade647be1">getRouter</a>()-&gt;<a class="code" href="class_o_s_p_f_1_1_router.html#af849f36506ebf49917f4a7f4ebdbcf53" title="Rebuilds the routing table from scratch(based on the LSA database).">rebuildRoutingTable</a>();
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a8ac70ec19096b5cc66827982a80540fb"></a><!-- doxytag: member="OSPF::InterfaceState::getState" ref="a8ac70ec19096b5cc66827982a80540fb" args="() const =0" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="class_o_s_p_f_1_1_interface.html#a68805ad1115c7149d5f8a139437e6249">Interface::InterfaceStateType</a> <a class="el" href="class_o_s_p_f_1_1_interface_state.html#a8ac70ec19096b5cc66827982a80540fb">OSPF::InterfaceState::getState</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [pure virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Implemented in <a class="el" href="class_o_s_p_f_1_1_interface_state_backup.html#a03fc078ac6ac9a6cb7c8e78ce4605f0a">OSPF::InterfaceStateBackup</a>, <a class="el" href="class_o_s_p_f_1_1_interface_state_designated_router.html#a0d27db5cec55a0313b21f6af44959bd7">OSPF::InterfaceStateDesignatedRouter</a>, <a class="el" href="class_o_s_p_f_1_1_interface_state_down.html#af57bf4873d7ab15beb18de0a7c49319d">OSPF::InterfaceStateDown</a>, <a class="el" href="class_o_s_p_f_1_1_interface_state_loopback.html#a50f5fb6acf69661e475ceb23b7128c20">OSPF::InterfaceStateLoopback</a>, <a class="el" href="class_o_s_p_f_1_1_interface_state_not_designated_router.html#a1484a732e1149d38be5c4af36196861e">OSPF::InterfaceStateNotDesignatedRouter</a>, <a class="el" href="class_o_s_p_f_1_1_interface_state_point_to_point.html#aea03e33a7492a43bc0f53897158d0db8">OSPF::InterfaceStatePointToPoint</a>, and <a class="el" href="class_o_s_p_f_1_1_interface_state_waiting.html#aba0235cbde4e4c8b07eafb3e5e561bda">OSPF::InterfaceStateWaiting</a>.</p>

<p>Referenced by <a class="el" href="class_o_s_p_f_1_1_interface_state.html#a9f94bc7735d2a404e05eb7e26a38d033">changeState()</a>.</p>

</div>
</div>
<a class="anchor" id="a0949f7d2b10c7537c2468b42ab30f77a"></a><!-- doxytag: member="OSPF::InterfaceState::processEvent" ref="a0949f7d2b10c7537c2468b42ab30f77a" args="(Interface *intf, Interface::InterfaceEventType event)=0" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="timer__queue_8h.html#a07640d68b3fdfaa5c48a36265e8f10b8">void</a> <a class="el" href="class_o_s_p_f_1_1_interface_state.html#a0949f7d2b10c7537c2468b42ab30f77a">OSPF::InterfaceState::processEvent</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_o_s_p_f_1_1_interface.html">Interface</a> *&#160;</td>
          <td class="paramname"><em>intf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_o_s_p_f_1_1_interface.html#ae0aca9ab8ca338c25d9afa6e65fc8824">Interface::InterfaceEventType</a>&#160;</td>
          <td class="paramname"><em>event</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [pure virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Implemented in <a class="el" href="class_o_s_p_f_1_1_interface_state_backup.html#a59ab622efe7e53d1679397906685e632">OSPF::InterfaceStateBackup</a>, <a class="el" href="class_o_s_p_f_1_1_interface_state_designated_router.html#a438e79d72ff2fcde354fdfe8283aa71f">OSPF::InterfaceStateDesignatedRouter</a>, <a class="el" href="class_o_s_p_f_1_1_interface_state_down.html#a80191cf50c52d0f032e20b556410e09c">OSPF::InterfaceStateDown</a>, <a class="el" href="class_o_s_p_f_1_1_interface_state_loopback.html#ad63d7657e970844fd6081e6fd8d99d5c">OSPF::InterfaceStateLoopback</a>, <a class="el" href="class_o_s_p_f_1_1_interface_state_not_designated_router.html#a83973c35e252746c3b730e8dddf4bd45">OSPF::InterfaceStateNotDesignatedRouter</a>, <a class="el" href="class_o_s_p_f_1_1_interface_state_point_to_point.html#aa284d9d617fc3e6c1b6d582137c0ba3a">OSPF::InterfaceStatePointToPoint</a>, and <a class="el" href="class_o_s_p_f_1_1_interface_state_waiting.html#a70f72d26276984f9fc7b039364b9e8e1">OSPF::InterfaceStateWaiting</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="_o_s_p_f_interface_state_8h.html">OSPFInterfaceState.h</a></li>
<li><a class="el" href="_o_s_p_f_interface_state_8cc.html">OSPFInterfaceState.cc</a></li>
</ul>
</div><!-- contents -->
</div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="namespace_o_s_p_f.html">OSPF</a>      </li>
      <li class="navelem"><a class="el" href="class_o_s_p_f_1_1_interface_state.html">InterfaceState</a>      </li>

    <li class="footer">Generated on Tue Aug 7 2012 16:01:32 for INET Framework for OMNeT++/OMNEST by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.6.1 </li>
   </ul>
 </div>


</body>
</html>
