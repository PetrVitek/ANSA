<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>INET Framework for OMNeT++/OMNEST: tcp_old::TCPConnection Class Reference</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>


</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">INET Framework for OMNeT++/OMNEST
   
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('classtcp__old_1_1_t_c_p_connection.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-static-methods">Static Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a>  </div>
  <div class="headertitle">
<div class="title">tcp_old::TCPConnection Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<!-- doxytag: class="tcp_old::TCPConnection" -->
<p><code>#include &lt;<a class="el" href="_t_c_p_connection__old_8h_source.html">TCPConnection_old.h</a>&gt;</code></p>

<p><a href="classtcp__old_1_1_t_c_p_connection-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a60ee5bc5b391d621e7e684857e195151">sendAck</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtcp__old_1_1_t_c_p_connection.html#ab2cbccc16b2f006369a83c51426e4bc5">sendData</a> (bool fullSegmentsOnly, int congestionWindow=-1)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtcp__old_1_1_t_c_p_connection.html#ab07a8b0ce79c80e9baf75c3e82f56937">sendProbe</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a8ae68910942bd1ea6558ae7849ae22ea">retransmitOneSegment</a> (bool called_at_rto)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtcp__old_1_1_t_c_p_connection.html#ab2c57b0ff79eb111ca6840b8d7003b04">retransmitData</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtcp__old_1_1_t_c_p_connection.html#afa03f88fc4589249aefe6f828eed9dd6">sendRst</a> (uint32 seqNo)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a3dc25263bb2f0b1013ee398c1587b128">sendRst</a> (uint32 seq, <a class="el" href="class_i_pv_x_address.html">IPvXAddress</a> src, <a class="el" href="class_i_pv_x_address.html">IPvXAddress</a> dest, int srcPort, int destPort)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtcp__old_1_1_t_c_p_connection.html#ade3c9c38be0aa758b4eb448d5c1169b9">sendRstAck</a> (uint32 seq, uint32 ack, <a class="el" href="class_i_pv_x_address.html">IPvXAddress</a> src, <a class="el" href="class_i_pv_x_address.html">IPvXAddress</a> dest, int srcPort, int destPort)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a70acf513d8461c73bfd06037036b1682">sendFin</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtcp__old_1_1_t_c_p_connection.html#af71155c4fad49ea52907d840463a06d5">sendSegment</a> (uint32 bytes)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a86143cf35f957006c5fe17c506be21c7">sendToIP</a> (<a class="el" href="class_t_c_p_segment.html">TCPSegment</a> *tcpseg)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="class_t_c_p_segment.html">TCPSegment</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a462206e0bc50ae521a47a797552a0057">createTCPSegment</a> (const char *name)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtcp__old_1_1_t_c_p_connection.html#aa58f44bc38ec0af46aca654f9403771f">startSynRexmitTimer</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a264eb196b44591ed68422a9e70dab680">signalConnectionTimeout</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtcp__old_1_1_t_c_p_connection.html#ae1ff44c73d20293a446adc091842bedd">scheduleTimeout</a> (cMessage *msg, simtime_t <a class="el" href="_r_i_p_timer__m_8h.html#a8c453bfd16599e8a0b20f94bdc7c7506a51a69776ef0949e2b87cdae793625906">timeout</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a8aaec47dd8098dbaa015f2e3e7b16442">printConnBrief</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtcp__old_1_1_t_c_p_connection.html#aab510bb961623a41ade36bfbda9f86b6">TCPConnection</a> (<a class="el" href="classtcp__old_1_1_t_c_p.html">TCP</a> *mod, int <a class="el" href="classtcp__old_1_1_t_c_p_connection.html#ad04d1e9fb23f48cd53dcd7c411caea80">appGateIndex</a>, int <a class="el" href="classtcp__old_1_1_t_c_p_connection.html#ae6ce2bfc0b9aa9d110db13efe08b7a0e">connId</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a11a3cccb118b0b66bee1a07929510e4c">TCPConnection</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a0b79ac9c31e99766954c9cca733a362d">~TCPConnection</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a82f6b7680530f0f784e9d8efa78fa5a5">segmentArrivalWhileClosed</a> (<a class="el" href="class_t_c_p_segment.html">TCPSegment</a> *tcpseg, <a class="el" href="class_i_pv_x_address.html">IPvXAddress</a> src, <a class="el" href="class_i_pv_x_address.html">IPvXAddress</a> dest)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a6f9e1e7a0cabaf710f2d37a19eea0caf">processTimer</a> (cMessage *msg)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a7f5f8ddb99114615c77fe0ccf16424e7">processTCPSegment</a> (<a class="el" href="class_t_c_p_segment.html">TCPSegment</a> *tcpSeg, <a class="el" href="class_i_pv_x_address.html">IPvXAddress</a> srcAddr, <a class="el" href="class_i_pv_x_address.html">IPvXAddress</a> destAddr)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtcp__old_1_1_t_c_p_connection.html#aebf3e44d104151c83a84a1efbae3f312">processAppCommand</a> (cMessage *msg)</td></tr>
<tr><td colspan="2"><div class="groupHeader"></div></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a55abadf8c9f66428b7f6db8fa90d1af3">getFsmState</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classtcp__old_1_1_t_c_p_state_variables.html">TCPStateVariables</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a1704500b72eb201d9119192ebb9b4923">getState</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classtcp__old_1_1_t_c_p_send_queue.html">TCPSendQueue</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a15a684dc0613b455e92c0ae57a00f177">getSendQueue</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classtcp__old_1_1_t_c_p_receive_queue.html">TCPReceiveQueue</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtcp__old_1_1_t_c_p_connection.html#ab9c0058b4df0583d36fd462e71c3120d">getReceiveQueue</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classtcp__old_1_1_t_c_p_algorithm.html">TCPAlgorithm</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a11c0933a5657daacb6cbc27de282187f">getTcpAlgorithm</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classtcp__old_1_1_t_c_p.html">TCP</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a5ba299a7999e64fe67e8fef5f62c2402">getTcpMain</a> ()</td></tr>
<tr><td colspan="2"><h2><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a188549e7c936c8cad622c180d3200c69">printSegmentBrief</a> (<a class="el" href="class_t_c_p_segment.html">TCPSegment</a> *tcpseg)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtcp__old_1_1_t_c_p_connection.html#ab991cf2680a63832310a4a56ac17972e">stateName</a> (int <a class="el" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtcp__old_1_1_t_c_p_connection.html#af199cd53f71f27341684145c3bdab306">eventName</a> (int event)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtcp__old_1_1_t_c_p_connection.html#adeef1c0b8f04a744168a107f68c397ba">indicationName</a> (int code)</td></tr>
<tr><td colspan="2"><h2><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtcp__old_1_1_t_c_p_connection.html#ad04d1e9fb23f48cd53dcd7c411caea80">appGateIndex</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtcp__old_1_1_t_c_p_connection.html#ae6ce2bfc0b9aa9d110db13efe08b7a0e">connId</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_i_pv_x_address.html">IPvXAddress</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtcp__old_1_1_t_c_p_connection.html#adc50d816f66c74441b608b01ed4800c7">localAddr</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_i_pv_x_address.html">IPvXAddress</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtcp__old_1_1_t_c_p_connection.html#ad54931b7375eb7b6e51ca9862cb0a714">remoteAddr</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a3af4312fbe2cd46bb1be1daf65715258">localPort</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtcp__old_1_1_t_c_p_connection.html#aece396520a4675f35694895f37b35f88">remotePort</a></td></tr>
<tr><td colspan="2"><h2><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classtcp__old_1_1_t_c_p_connection.html">TCPConnection</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a1d5624dcbc77e79d142f6a886b3e788d">cloneListeningConnection</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a69caa8ea0ffbe8d9f73f935aac1b29d9">initConnection</a> (<a class="el" href="class_t_c_p_open_command.html">TCPOpenCommand</a> *openCmd)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a8ddd3d422b9d6e00ad15cf99f9870ef4">configureStateVariables</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a585bbcdd70565eb01b6bfe17a1487c78">selectInitialSeqNum</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtcp__old_1_1_t_c_p_connection.html#acceb561b23349d06b298858e39433435">isSegmentAcceptable</a> (<a class="el" href="class_t_c_p_segment.html">TCPSegment</a> *tcpseg)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtcp__old_1_1_t_c_p_connection.html#abcd8f7efecc7c0077050184d3384b493">sendSyn</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a675b131a43de7429552a574cabcc12dd">sendSynAck</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">cMessage *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtcp__old_1_1_t_c_p_connection.html#ad06a2b75a619021592db07ab486f0fed">cancelEvent</a> (cMessage *msg)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a6aa48826843116a0f5c4e0fa37a69cfc">sendToApp</a> (cMessage *msg)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a65a8dc93c08a685f145248d0fb327428">sendIndicationToApp</a> (int code)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtcp__old_1_1_t_c_p_connection.html#ab04a91abde05d21293c30a78ab968eef">sendEstabIndicationToApp</a> ()</td></tr>
<tr><td colspan="2"><div class="groupHeader">FSM transitions: analysing events and executing state transitions</div></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32">TCPEventCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a792d9159b4e64b344cac79d0716c907a">preanalyseAppCommandEvent</a> (int commandCode)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtcp__old_1_1_t_c_p_connection.html#aa1fe5fa359d4063c984d686e4166b798">performStateTransition</a> (const <a class="el" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32">TCPEventCode</a> &amp;event)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a1be68d20f98e68b01ef9267a8dd2088a">stateEntered</a> (int <a class="el" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>)</td></tr>
<tr><td colspan="2"><div class="groupHeader">Processing app commands. Invoked from processAppCommand().</div></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a6ef625498d593ac11744aa92a404e06d">process_OPEN_ACTIVE</a> (<a class="el" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32">TCPEventCode</a> &amp;event, <a class="el" href="class_t_c_p_command.html">TCPCommand</a> *tcpCommand, cMessage *msg)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a26e4a86dfbc1efaf02e99ea14d410ae3">process_OPEN_PASSIVE</a> (<a class="el" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32">TCPEventCode</a> &amp;event, <a class="el" href="class_t_c_p_command.html">TCPCommand</a> *tcpCommand, cMessage *msg)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a65fa8d6570761c63cdab5cef7f5df685">process_SEND</a> (<a class="el" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32">TCPEventCode</a> &amp;event, <a class="el" href="class_t_c_p_command.html">TCPCommand</a> *tcpCommand, cMessage *msg)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a5aa9b20651a4c1f90772a7c02eacbf05">process_CLOSE</a> (<a class="el" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32">TCPEventCode</a> &amp;event, <a class="el" href="class_t_c_p_command.html">TCPCommand</a> *tcpCommand, cMessage *msg)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtcp__old_1_1_t_c_p_connection.html#afb2189f1428627dcde1d1b0bfbc50833">process_ABORT</a> (<a class="el" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32">TCPEventCode</a> &amp;event, <a class="el" href="class_t_c_p_command.html">TCPCommand</a> *tcpCommand, cMessage *msg)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a519a2b6612737fbdbd5641dfa33833e8">process_STATUS</a> (<a class="el" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32">TCPEventCode</a> &amp;event, <a class="el" href="class_t_c_p_command.html">TCPCommand</a> *tcpCommand, cMessage *msg)</td></tr>
<tr><td colspan="2"><div class="groupHeader">Processing TCP segment arrivals. Invoked from processTCPSegment().</div></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a9b7d3f811eab0367d3826dfb20c8d931">tryFastRoute</a> (<a class="el" href="class_t_c_p_segment.html">TCPSegment</a> *tcpseg)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32">TCPEventCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a46ac1b09624942471db2eb76ef991143">process_RCV_SEGMENT</a> (<a class="el" href="class_t_c_p_segment.html">TCPSegment</a> *tcpseg, <a class="el" href="class_i_pv_x_address.html">IPvXAddress</a> src, <a class="el" href="class_i_pv_x_address.html">IPvXAddress</a> dest)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32">TCPEventCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a4d034577df86997140d627feeda66a1f">processSegmentInListen</a> (<a class="el" href="class_t_c_p_segment.html">TCPSegment</a> *tcpseg, <a class="el" href="class_i_pv_x_address.html">IPvXAddress</a> src, <a class="el" href="class_i_pv_x_address.html">IPvXAddress</a> dest)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32">TCPEventCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a12b903f9e148f5c26f926dcdc8107c86">processSegmentInSynSent</a> (<a class="el" href="class_t_c_p_segment.html">TCPSegment</a> *tcpseg, <a class="el" href="class_i_pv_x_address.html">IPvXAddress</a> src, <a class="el" href="class_i_pv_x_address.html">IPvXAddress</a> dest)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32">TCPEventCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtcp__old_1_1_t_c_p_connection.html#aa0758284e5bd6bd162b6ff267add2e2d">processSegment1stThru8th</a> (<a class="el" href="class_t_c_p_segment.html">TCPSegment</a> *tcpseg)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32">TCPEventCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a4d240ca8f36aa37a29b8bcc44ec052cd">processRstInSynReceived</a> (<a class="el" href="class_t_c_p_segment.html">TCPSegment</a> *tcpseg)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtcp__old_1_1_t_c_p_connection.html#ac1144f5ca6e960176d6e623998cb7456">processAckInEstabEtc</a> (<a class="el" href="class_t_c_p_segment.html">TCPSegment</a> *tcpseg)</td></tr>
<tr><td colspan="2"><div class="groupHeader">Processing timeouts. Invoked from processTimer().</div></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtcp__old_1_1_t_c_p_connection.html#ae29072ef963e593c4c3053827ebbec6e">process_TIMEOUT_2MSL</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a7b47d21fa8a97f13cab52097f3332ea6">process_TIMEOUT_CONN_ESTAB</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a53d62d237307ad56bae8d320ff557e48">process_TIMEOUT_FIN_WAIT_2</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a33c6fe420de8b7fc6c09761f70118ed0">process_TIMEOUT_SYN_REXMIT</a> (<a class="el" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32">TCPEventCode</a> &amp;event)</td></tr>
<tr><td colspan="2"><h2><a name="pro-static-methods"></a>
Static Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a8763146770969da7d0a1196efe23615c">sendToIP</a> (<a class="el" href="class_t_c_p_segment.html">TCPSegment</a> *tcpseg, <a class="el" href="class_i_pv_x_address.html">IPvXAddress</a> src, <a class="el" href="class_i_pv_x_address.html">IPvXAddress</a> dest)</td></tr>
<tr><td colspan="2"><h2><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classtcp__old_1_1_t_c_p.html">TCP</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a6f9eb8f2af118d2f1fcd90df3c87249e">tcpMain</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">cFSM&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classtcp__old_1_1_t_c_p_state_variables.html">TCPStateVariables</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classtcp__old_1_1_t_c_p_send_queue.html">TCPSendQueue</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a7bd9b6b2b4422771b92e00d307983d19">sendQueue</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classtcp__old_1_1_t_c_p_receive_queue.html">TCPReceiveQueue</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a2602ec64d45270793076abe5938d16ac">receiveQueue</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classtcp__old_1_1_t_c_p_algorithm.html">TCPAlgorithm</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a2212cb0deb11d2b1c5826cab57b3f42e">tcpAlgorithm</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">cMessage *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a67c3fa718ee0542b4bd93eda8785c0fc">the2MSLTimer</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">cMessage *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a757386355261e95064b75f2dfec3788e">connEstabTimer</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">cMessage *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a2a3d3f1792941e08c490795d1d2a4bc0">finWait2Timer</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">cMessage *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtcp__old_1_1_t_c_p_connection.html#ad70c187b499189b370f99433eb825dcd">synRexmitTimer</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">cOutVector *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtcp__old_1_1_t_c_p_connection.html#ab58ab42e2f19a58edcfa549b51a7179b">sndWndVector</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">cOutVector *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a946bf6fc849e9554b489e5fff58be513">sndNxtVector</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">cOutVector *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtcp__old_1_1_t_c_p_connection.html#afe2cc9a34e2074f95626e4085236d561">sndAckVector</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">cOutVector *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtcp__old_1_1_t_c_p_connection.html#acb4230bb789e0bf3e413479e26316d60">rcvSeqVector</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">cOutVector *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a7b6c1fcdd10a035c035dea350420286d">rcvAckVector</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">cOutVector *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a529775c184153f33ff75a91bacc8b0fc">unackedVector</a></td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>Manages a <a class="el" href="classtcp__old_1_1_t_c_p.html">TCP</a> connection. This class itself implements the <a class="el" href="classtcp__old_1_1_t_c_p.html">TCP</a> state machine as well as handling control PDUs (SYN, SYN+ACK, RST, FIN, etc.), timers (2MSL, CONN-ESTAB, FIN-WAIT-2) and events (OPEN, SEND, etc) associated with <a class="el" href="classtcp__old_1_1_t_c_p.html">TCP</a> state changes.</p>
<p>The implementation largely follows the functional specification at the end of RFC 793. Code comments extensively quote RFC 793 to make it easier to understand.</p>
<p><a class="el" href="classtcp__old_1_1_t_c_p_connection.html">TCPConnection</a> objects are not used alone -- they are instantiated and managed by a <a class="el" href="classtcp__old_1_1_t_c_p.html">TCP</a> module.</p>
<p><a class="el" href="classtcp__old_1_1_t_c_p_connection.html">TCPConnection</a> "outsources" several tasks to objects subclassed from <a class="el" href="classtcp__old_1_1_t_c_p_send_queue.html">TCPSendQueue</a>, <a class="el" href="classtcp__old_1_1_t_c_p_receive_queue.html">TCPReceiveQueue</a> and <a class="el" href="classtcp__old_1_1_t_c_p_algorithm.html">TCPAlgorithm</a>; see overview of this with <a class="el" href="classtcp__old_1_1_t_c_p.html">TCP</a> documentation.</p>
<p>Connection variables (TCB) are kept in <a class="el" href="classtcp__old_1_1_t_c_p_state_variables.html">TCPStateVariables</a>. <a class="el" href="classtcp__old_1_1_t_c_p_algorithm.html">TCPAlgorithm</a> implementations can extend <a class="el" href="classtcp__old_1_1_t_c_p_state_variables.html">TCPStateVariables</a> to add their own stuff (see <a class="el" href="classtcp__old_1_1_t_c_p_algorithm.html#ae8fdb9d455dc62709aa52ef616fb9ad9">TCPAlgorithm::createStateVariables()</a> factory method.)</p>
<p>The "entry points" of TCPConnnection from <a class="el" href="classtcp__old_1_1_t_c_p.html">TCP</a> are:</p>
<ul>
<li><a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a6f9e1e7a0cabaf710f2d37a19eea0caf">processTimer(cMessage *msg)</a>: handle self-messages which belong to the connection</li>
<li><a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a7f5f8ddb99114615c77fe0ccf16424e7">processTCPSegment(TCPSegment *tcpSeg, IPvXAddress srcAddr, IPvXAddress destAddr)</a>: handle segment arrivals</li>
<li><a class="el" href="classtcp__old_1_1_t_c_p_connection.html#aebf3e44d104151c83a84a1efbae3f312">processAppCommand(cMessage *msg)</a>: process commands which arrive from the application (TCP_C_xxx)</li>
</ul>
<p>All three methods follow a common structure:</p>
<ol type="1">
<li>dispatch to specific methods. For example, <a class="el" href="classtcp__old_1_1_t_c_p_connection.html#aebf3e44d104151c83a84a1efbae3f312">processAppCommand()</a> invokes one of <a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a6ef625498d593ac11744aa92a404e06d">process_OPEN_ACTIVE()</a>, <a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a26e4a86dfbc1efaf02e99ea14d410ae3">process_OPEN_PASSIVE()</a> or <a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a65fa8d6570761c63cdab5cef7f5df685">process_SEND()</a>, etc., and <a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a7f5f8ddb99114615c77fe0ccf16424e7">processTCPSegment()</a> dispatches to <a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a4d034577df86997140d627feeda66a1f">processSegmentInListen()</a>, <a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a12b903f9e148f5c26f926dcdc8107c86">processSegmentInSynSent()</a> or <a class="el" href="classtcp__old_1_1_t_c_p_connection.html#aa0758284e5bd6bd162b6ff267add2e2d">processSegment1stThru8th()</a>. Those methods will do the REAL JOB.</li>
<li>after they return, we'll know the state machine event (TCPEventCode, TCP_E_xxx) for sure, so we can:</li>
<li>invoke <a class="el" href="classtcp__old_1_1_t_c_p_connection.html#aa1fe5fa359d4063c984d686e4166b798">performStateTransition()</a> which executes the necessary state transition (for example, TCP_E_RCV_SYN will take the state machine from TCP_S_LISTEN to TCP_S_SYN_RCVD). No other actions are taken in this step.</li>
<li>if there was a state change (for example, we entered the TCP_S_ESTABLISHED state), <a class="el" href="classtcp__old_1_1_t_c_p_connection.html#aa1fe5fa359d4063c984d686e4166b798">performStateTransition()</a> invokes <a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a1be68d20f98e68b01ef9267a8dd2088a">stateEntered()</a>, which performs some necessary housekeeping (cancel the CONN-ESTAB timer).</li>
</ol>
<p>When the CLOSED state is reached, <a class="el" href="classtcp__old_1_1_t_c_p.html">TCP</a> will delete the <a class="el" href="classtcp__old_1_1_t_c_p_connection.html">TCPConnection</a> object. </p>

<p>Definition at line <a class="el" href="_t_c_p_connection__old_8h_source.html#l00256">256</a> of file <a class="el" href="_t_c_p_connection__old_8h_source.html">TCPConnection_old.h</a>.</p>
</div><hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="aab510bb961623a41ade36bfbda9f86b6"></a><!-- doxytag: member="tcp_old::TCPConnection::TCPConnection" ref="aab510bb961623a41ade36bfbda9f86b6" args="(TCP *mod, int appGateIndex, int connId)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classtcp__old_1_1_t_c_p_connection.html#aab510bb961623a41ade36bfbda9f86b6">TCPConnection::TCPConnection</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classtcp__old_1_1_t_c_p.html">TCP</a> *&#160;</td>
          <td class="paramname"><em>mod</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>appGateIndex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>connId</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>The "normal" constructor. </p>

<p>Definition at line <a class="el" href="old_2_t_c_p_connection_base_8cc_source.html#l00114">114</a> of file <a class="el" href="old_2_t_c_p_connection_base_8cc_source.html">old/TCPConnectionBase.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a6f9eb8f2af118d2f1fcd90df3c87249e">tcpMain</a> = _mod;
    <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ad04d1e9fb23f48cd53dcd7c411caea80">appGateIndex</a> = _appGateIndex;
    <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae6ce2bfc0b9aa9d110db13efe08b7a0e">connId</a> = _connId;

    <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3af4312fbe2cd46bb1be1daf65715258">localPort</a> = <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#aece396520a4675f35694895f37b35f88">remotePort</a> = -1;

    <span class="keywordtype">char</span> fsmname[24];
    sprintf(fsmname, <span class="stringliteral">&quot;fsm-%d&quot;</span>, <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae6ce2bfc0b9aa9d110db13efe08b7a0e">connId</a>);
    <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>.setName(fsmname);
    <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>.setState(<a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaa8b6438b06a8e3cd7537e09f9fb2f0d03">TCP_S_INIT</a>);


    <span class="comment">// queues and algorithm will be created on active or passive open</span>
    <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a7bd9b6b2b4422771b92e00d307983d19">sendQueue</a> = NULL;
    <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a2602ec64d45270793076abe5938d16ac">receiveQueue</a> = NULL;
    <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a2212cb0deb11d2b1c5826cab57b3f42e">tcpAlgorithm</a> = NULL;
    <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a> = NULL;

    <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a67c3fa718ee0542b4bd93eda8785c0fc">the2MSLTimer</a> = <span class="keyword">new</span> cMessage(<span class="stringliteral">&quot;2MSL&quot;</span>);
    <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a757386355261e95064b75f2dfec3788e">connEstabTimer</a> = <span class="keyword">new</span> cMessage(<span class="stringliteral">&quot;CONN-ESTAB&quot;</span>);
    <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a2a3d3f1792941e08c490795d1d2a4bc0">finWait2Timer</a> = <span class="keyword">new</span> cMessage(<span class="stringliteral">&quot;FIN-WAIT-2&quot;</span>);
    <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ad70c187b499189b370f99433eb825dcd">synRexmitTimer</a> = <span class="keyword">new</span> cMessage(<span class="stringliteral">&quot;SYN-REXMIT&quot;</span>);

    <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a67c3fa718ee0542b4bd93eda8785c0fc">the2MSLTimer</a>-&gt;setContextPointer(<span class="keyword">this</span>);
    <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a757386355261e95064b75f2dfec3788e">connEstabTimer</a>-&gt;setContextPointer(<span class="keyword">this</span>);
    <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a2a3d3f1792941e08c490795d1d2a4bc0">finWait2Timer</a>-&gt;setContextPointer(<span class="keyword">this</span>);
    <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ad70c187b499189b370f99433eb825dcd">synRexmitTimer</a>-&gt;setContextPointer(<span class="keyword">this</span>);

    <span class="comment">// statistics</span>
    <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ab58ab42e2f19a58edcfa549b51a7179b">sndWndVector</a> = NULL;
    <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a946bf6fc849e9554b489e5fff58be513">sndNxtVector</a> = NULL;
    <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#afe2cc9a34e2074f95626e4085236d561">sndAckVector</a> = NULL;
    <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#acb4230bb789e0bf3e413479e26316d60">rcvSeqVector</a> = NULL;
    <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a7b6c1fcdd10a035c035dea350420286d">rcvAckVector</a> = NULL;
    <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a529775c184153f33ff75a91bacc8b0fc">unackedVector</a> = NULL;

    <span class="keywordflow">if</span> (<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a5ba299a7999e64fe67e8fef5f62c2402">getTcpMain</a>()-&gt;recordStatistics)
    {
        <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ab58ab42e2f19a58edcfa549b51a7179b">sndWndVector</a> = <span class="keyword">new</span> cOutVector(<span class="stringliteral">&quot;send window&quot;</span>);
        <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a946bf6fc849e9554b489e5fff58be513">sndNxtVector</a> = <span class="keyword">new</span> cOutVector(<span class="stringliteral">&quot;send seq&quot;</span>);
        <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#afe2cc9a34e2074f95626e4085236d561">sndAckVector</a> = <span class="keyword">new</span> cOutVector(<span class="stringliteral">&quot;sent ack&quot;</span>);
        <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#acb4230bb789e0bf3e413479e26316d60">rcvSeqVector</a> = <span class="keyword">new</span> cOutVector(<span class="stringliteral">&quot;rcvd seq&quot;</span>);
        <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a7b6c1fcdd10a035c035dea350420286d">rcvAckVector</a> = <span class="keyword">new</span> cOutVector(<span class="stringliteral">&quot;rcvd ack&quot;</span>);
        <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a529775c184153f33ff75a91bacc8b0fc">unackedVector</a> = <span class="keyword">new</span> cOutVector(<span class="stringliteral">&quot;unacked bytes&quot;</span>);
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a11a3cccb118b0b66bee1a07929510e4c"></a><!-- doxytag: member="tcp_old::TCPConnection::TCPConnection" ref="a11a3cccb118b0b66bee1a07929510e4c" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classtcp__old_1_1_t_c_p_connection.html#aab510bb961623a41ade36bfbda9f86b6">TCPConnection::TCPConnection</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Note: this default ctor is NOT used to create live connections, only temporary ones so that TCPMain can invoke their <a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a82f6b7680530f0f784e9d8efa78fa5a5">segmentArrivalWhileClosed()</a>. </p>

<p>Definition at line <a class="el" href="old_2_t_c_p_connection_base_8cc_source.html#l00098">98</a> of file <a class="el" href="old_2_t_c_p_connection_base_8cc_source.html">old/TCPConnectionBase.cc</a>.</p>

<p>Referenced by <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00138">cloneListeningConnection()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="comment">// Note: this ctor is NOT used to create live connections, only</span>
    <span class="comment">// temporary ones to invoke segmentArrivalWhileClosed() on</span>
    <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a7bd9b6b2b4422771b92e00d307983d19">sendQueue</a> = NULL;
    <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a2602ec64d45270793076abe5938d16ac">receiveQueue</a> = NULL;
    <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a2212cb0deb11d2b1c5826cab57b3f42e">tcpAlgorithm</a> = NULL;
    <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a> = NULL;
    <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a67c3fa718ee0542b4bd93eda8785c0fc">the2MSLTimer</a> = <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a757386355261e95064b75f2dfec3788e">connEstabTimer</a> = <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a2a3d3f1792941e08c490795d1d2a4bc0">finWait2Timer</a> = <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ad70c187b499189b370f99433eb825dcd">synRexmitTimer</a> = NULL;
    <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ab58ab42e2f19a58edcfa549b51a7179b">sndWndVector</a> = <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a946bf6fc849e9554b489e5fff58be513">sndNxtVector</a> = <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#afe2cc9a34e2074f95626e4085236d561">sndAckVector</a> = <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#acb4230bb789e0bf3e413479e26316d60">rcvSeqVector</a> = <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a7b6c1fcdd10a035c035dea350420286d">rcvAckVector</a> = <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a529775c184153f33ff75a91bacc8b0fc">unackedVector</a> = NULL;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a0b79ac9c31e99766954c9cca733a362d"></a><!-- doxytag: member="tcp_old::TCPConnection::~TCPConnection" ref="a0b79ac9c31e99766954c9cca733a362d" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a0b79ac9c31e99766954c9cca733a362d">TCPConnection::~TCPConnection</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Destructor. </p>

<p>Definition at line <a class="el" href="old_2_t_c_p_connection_base_8cc_source.html#l00163">163</a> of file <a class="el" href="old_2_t_c_p_connection_base_8cc_source.html">old/TCPConnectionBase.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keyword">delete</span> <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a7bd9b6b2b4422771b92e00d307983d19">sendQueue</a>;
    <span class="keyword">delete</span> <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a2602ec64d45270793076abe5938d16ac">receiveQueue</a>;
    <span class="keyword">delete</span> <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a2212cb0deb11d2b1c5826cab57b3f42e">tcpAlgorithm</a>;
    <span class="keyword">delete</span> <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>;

    <span class="keywordflow">if</span> (<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a67c3fa718ee0542b4bd93eda8785c0fc">the2MSLTimer</a>)   <span class="keyword">delete</span> <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ad06a2b75a619021592db07ab486f0fed">cancelEvent</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a67c3fa718ee0542b4bd93eda8785c0fc">the2MSLTimer</a>);
    <span class="keywordflow">if</span> (<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a757386355261e95064b75f2dfec3788e">connEstabTimer</a>) <span class="keyword">delete</span> <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ad06a2b75a619021592db07ab486f0fed">cancelEvent</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a757386355261e95064b75f2dfec3788e">connEstabTimer</a>);
    <span class="keywordflow">if</span> (<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a2a3d3f1792941e08c490795d1d2a4bc0">finWait2Timer</a>)  <span class="keyword">delete</span> <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ad06a2b75a619021592db07ab486f0fed">cancelEvent</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a2a3d3f1792941e08c490795d1d2a4bc0">finWait2Timer</a>);
    <span class="keywordflow">if</span> (<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ad70c187b499189b370f99433eb825dcd">synRexmitTimer</a>) <span class="keyword">delete</span> <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ad06a2b75a619021592db07ab486f0fed">cancelEvent</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ad70c187b499189b370f99433eb825dcd">synRexmitTimer</a>);

    <span class="comment">// statistics</span>
    <span class="keyword">delete</span> <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ab58ab42e2f19a58edcfa549b51a7179b">sndWndVector</a>;
    <span class="keyword">delete</span> <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a946bf6fc849e9554b489e5fff58be513">sndNxtVector</a>;
    <span class="keyword">delete</span> <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#afe2cc9a34e2074f95626e4085236d561">sndAckVector</a>;
    <span class="keyword">delete</span> <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#acb4230bb789e0bf3e413479e26316d60">rcvSeqVector</a>;
    <span class="keyword">delete</span> <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a7b6c1fcdd10a035c035dea350420286d">rcvAckVector</a>;
    <span class="keyword">delete</span> <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a529775c184153f33ff75a91bacc8b0fc">unackedVector</a>;
}
</pre></div>
</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="ad06a2b75a619021592db07ab486f0fed"></a><!-- doxytag: member="tcp_old::TCPConnection::cancelEvent" ref="ad06a2b75a619021592db07ab486f0fed" args="(cMessage *msg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">cMessage* <a class="el" href="classtcp__old_1_1_t_c_p_connection.html#ad06a2b75a619021592db07ab486f0fed">tcp_old::TCPConnection::cancelEvent</a> </td>
          <td>(</td>
          <td class="paramtype">cMessage *&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td><code> [inline, protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Utility: cancel a timer </p>

<p>Definition at line <a class="el" href="_t_c_p_connection__old_8h_source.html#l00425">425</a> of file <a class="el" href="_t_c_p_connection__old_8h_source.html">TCPConnection_old.h</a>.</p>

<p>Referenced by <a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html#l00114">processSegment1stThru8th()</a>, <a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html#l01115">startSynRexmitTimer()</a>, <a class="el" href="old_2_t_c_p_connection_base_8cc_source.html#l00449">stateEntered()</a>, and <a class="el" href="old_2_t_c_p_connection_base_8cc_source.html#l00163">~TCPConnection()</a>.</p>
<div class="fragment"><pre class="fragment">{<span class="keywordflow">return</span> <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a6f9eb8f2af118d2f1fcd90df3c87249e">tcpMain</a>-&gt;cancelEvent(msg);}
</pre></div>
</div>
</div>
<a class="anchor" id="a1d5624dcbc77e79d142f6a886b3e788d"></a><!-- doxytag: member="tcp_old::TCPConnection::cloneListeningConnection" ref="a1d5624dcbc77e79d142f6a886b3e788d" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classtcp__old_1_1_t_c_p_connection.html">TCPConnection</a> * <a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a1d5624dcbc77e79d142f6a886b3e788d">TCPConnection::cloneListeningConnection</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Utility: clone a listening connection. Used for forking. </p>

<p>Definition at line <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00138">138</a> of file <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html">old/TCPConnectionUtil.cc</a>.</p>

<p>Referenced by <a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html#l00622">processSegmentInListen()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="classtcp__old_1_1_t_c_p_connection.html">TCPConnection</a> *conn = <span class="keyword">new</span> <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a11a3cccb118b0b66bee1a07929510e4c">TCPConnection</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a6f9eb8f2af118d2f1fcd90df3c87249e">tcpMain</a>,<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ad04d1e9fb23f48cd53dcd7c411caea80">appGateIndex</a>,<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae6ce2bfc0b9aa9d110db13efe08b7a0e">connId</a>);

    <span class="comment">// following code to be kept consistent with initConnection()</span>
    <span class="keyword">const</span> <span class="keywordtype">char</span> *sendQueueClass = <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a7bd9b6b2b4422771b92e00d307983d19">sendQueue</a>-&gt;getClassName();
    conn-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a7bd9b6b2b4422771b92e00d307983d19">sendQueue</a> = check_and_cast&lt;<a class="code" href="classtcp__old_1_1_t_c_p_send_queue.html">TCPSendQueue</a> *&gt;(createOne(sendQueueClass));
    conn-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a7bd9b6b2b4422771b92e00d307983d19">sendQueue</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_send_queue.html#a6580be23b72c3b6afd33532555cc165a">setConnection</a>(conn);

    <span class="keyword">const</span> <span class="keywordtype">char</span> *receiveQueueClass = <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a2602ec64d45270793076abe5938d16ac">receiveQueue</a>-&gt;getClassName();
    conn-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a2602ec64d45270793076abe5938d16ac">receiveQueue</a> = check_and_cast&lt;<a class="code" href="classtcp__old_1_1_t_c_p_receive_queue.html">TCPReceiveQueue</a> *&gt;(createOne(receiveQueueClass));
    conn-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a2602ec64d45270793076abe5938d16ac">receiveQueue</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_receive_queue.html#ad9e22f581f6cc50d43611b5bc723638c">setConnection</a>(conn);

    <span class="keyword">const</span> <span class="keywordtype">char</span> *tcpAlgorithmClass = <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a2212cb0deb11d2b1c5826cab57b3f42e">tcpAlgorithm</a>-&gt;getClassName();
    conn-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a2212cb0deb11d2b1c5826cab57b3f42e">tcpAlgorithm</a> = check_and_cast&lt;<a class="code" href="classtcp__old_1_1_t_c_p_algorithm.html">TCPAlgorithm</a> *&gt;(createOne(tcpAlgorithmClass));
    conn-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a2212cb0deb11d2b1c5826cab57b3f42e">tcpAlgorithm</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_algorithm.html#a2b019306b6e6a3984bd2c81b2713c3f4">setConnection</a>(conn);

    conn-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a> = conn-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a2212cb0deb11d2b1c5826cab57b3f42e">tcpAlgorithm</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_algorithm.html#aa1d2b17e15a2c8f339174cf5fd70fc0d">getStateVariables</a>();
    <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a8ddd3d422b9d6e00ad15cf99f9870ef4">configureStateVariables</a>();
    conn-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a2212cb0deb11d2b1c5826cab57b3f42e">tcpAlgorithm</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_algorithm.html#adbd27ed1bccde3db4924db7393ef60ee">initialize</a>();

    <span class="comment">// put it into LISTEN, with our localAddr/localPort</span>
    conn-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#afba4a9f34c546c37533eb5311c1da682">active</a> = <span class="keyword">false</span>;
    conn-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a4f418e2320cca13bdf3a673ae74989ac">fork</a> = <span class="keyword">true</span>;
    conn-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#adc50d816f66c74441b608b01ed4800c7">localAddr</a> = <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#adc50d816f66c74441b608b01ed4800c7">localAddr</a>;
    conn-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3af4312fbe2cd46bb1be1daf65715258">localPort</a> = <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3af4312fbe2cd46bb1be1daf65715258">localPort</a>;
    FSM_Goto(conn-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>, <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaa8a809324e3edea6ff6800a639d7bcea2">TCP_S_LISTEN</a>);

    <span class="keywordflow">return</span> conn;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a8ddd3d422b9d6e00ad15cf99f9870ef4"></a><!-- doxytag: member="tcp_old::TCPConnection::configureStateVariables" ref="a8ddd3d422b9d6e00ad15cf99f9870ef4" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a8ddd3d422b9d6e00ad15cf99f9870ef4">TCPConnection::configureStateVariables</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Utility: set snd_mss and rcv_wnd in newly created state variables block </p>

<p>Definition at line <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00311">311</a> of file <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html">old/TCPConnectionUtil.cc</a>.</p>

<p>Referenced by <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00138">cloneListeningConnection()</a>, and <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00283">initConnection()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#aa63003ec3568a869469e95d848e836b7">snd_mss</a> = <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a6f9eb8f2af118d2f1fcd90df3c87249e">tcpMain</a>-&gt;par(<span class="stringliteral">&quot;mss&quot;</span>).longValue(); <span class="comment">// TODO: mss=-1 should mean autodetect</span>
    <span class="keywordtype">long</span> advertisedWindowPar = <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a6f9eb8f2af118d2f1fcd90df3c87249e">tcpMain</a>-&gt;par(<span class="stringliteral">&quot;advertisedWindow&quot;</span>).longValue();
    <span class="keywordflow">if</span> (advertisedWindowPar &gt; <a class="code" href="_t_c_p_connection_8h.html#a45fb301bd71c5637907f72760c563002">TCP_MAX_WIN</a> || advertisedWindowPar &lt;= 0)
        <span class="keywordflow">throw</span> cRuntimeError(<span class="stringliteral">&quot;Invalid advertisedWindow parameter: %d&quot;</span>, advertisedWindowPar);
    <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#ab26a1e5c5f13a245ef7578dc87e81cfe">rcv_wnd</a> = advertisedWindowPar;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a462206e0bc50ae521a47a797552a0057"></a><!-- doxytag: member="tcp_old::TCPConnection::createTCPSegment" ref="a462206e0bc50ae521a47a797552a0057" args="(const char *name)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_t_c_p_segment.html">TCPSegment</a> * <a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a462206e0bc50ae521a47a797552a0057">TCPConnection::createTCPSegment</a> </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Utility: This factory method gets invoked throughout the <a class="el" href="classtcp__old_1_1_t_c_p.html">TCP</a> model to create a <a class="el" href="class_t_c_p_segment.html">TCPSegment</a>. Override it if you need to subclass <a class="el" href="class_t_c_p_segment.html">TCPSegment</a>. </p>

<p>Definition at line <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00240">240</a> of file <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html">old/TCPConnectionUtil.cc</a>.</p>

<p>Referenced by <a class="el" href="old_2queues_2_t_c_p_virtual_data_send_queue_8cc_source.html#l00064">tcp_old::TCPVirtualDataSendQueue::createSegmentWithBytes()</a>, <a class="el" href="old_2queues_2_t_c_p_msg_based_send_queue_8cc_source.html#l00070">tcp_old::TCPMsgBasedSendQueue::createSegmentWithBytes()</a>, <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00414">sendAck()</a>, <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00430">sendFin()</a>, <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00381">sendRst()</a>, <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00395">sendRstAck()</a>, <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00338">sendSyn()</a>, and <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00357">sendSynAck()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="class_t_c_p_segment.html">TCPSegment</a>(name);
}
</pre></div>
</div>
</div>
<a class="anchor" id="af199cd53f71f27341684145c3bdab306"></a><!-- doxytag: member="tcp_old::TCPConnection::eventName" ref="af199cd53f71f27341684145c3bdab306" args="(int event)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char * <a class="el" href="classtcp__old_1_1_t_c_p_connection.html#af199cd53f71f27341684145c3bdab306">TCPConnection::eventName</a> </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>event</em></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Utility: returns name of TCP_E_xxx constants </p>

<p>Definition at line <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00060">60</a> of file <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html">old/TCPConnectionUtil.cc</a>.</p>

<p>Referenced by <a class="el" href="old_2_t_c_p_connection_base_8cc_source.html#l00284">performStateTransition()</a>, and <a class="el" href="old_2_t_c_p_connection_base_8cc_source.html#l00245">processAppCommand()</a>.</p>
<div class="fragment"><pre class="fragment">{
<span class="preprocessor">#define CASE(x) case x: s=#x+6; break</span>
<span class="preprocessor"></span>    <span class="keyword">const</span> <span class="keywordtype">char</span> *s = <span class="stringliteral">&quot;unknown&quot;</span>;
    <span class="keywordflow">switch</span> (<a class="code" href="namespacecesnet.html#a56e29c69128db750fc49a508a16cf7ba">event</a>)
    {
        <a class="code" href="_ansa_ether_m_a_c_8cc.html#a60cc06bef97da802b8522d258ac4fe89">CASE</a>(<a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32acd405552b4f4c9973d5d5b7e8aae88f5">TCP_E_IGNORE</a>);
        <a class="code" href="_ansa_ether_m_a_c_8cc.html#a60cc06bef97da802b8522d258ac4fe89">CASE</a>(<a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32a6179df5a4a1f3314be52f5789f5f0bb6">TCP_E_OPEN_ACTIVE</a>);
        <a class="code" href="_ansa_ether_m_a_c_8cc.html#a60cc06bef97da802b8522d258ac4fe89">CASE</a>(<a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32a11dd6ccbd9b9bbb145b64fb99981b530">TCP_E_OPEN_PASSIVE</a>);
        <a class="code" href="_ansa_ether_m_a_c_8cc.html#a60cc06bef97da802b8522d258ac4fe89">CASE</a>(<a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32af5e9f1961ac4c76e49f568d8fd304063">TCP_E_SEND</a>);
        <a class="code" href="_ansa_ether_m_a_c_8cc.html#a60cc06bef97da802b8522d258ac4fe89">CASE</a>(<a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32a2c5c582787e0b87a4a913e34c4d20d1b">TCP_E_CLOSE</a>);
        <a class="code" href="_ansa_ether_m_a_c_8cc.html#a60cc06bef97da802b8522d258ac4fe89">CASE</a>(<a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32a1fd07d5de8615b02fe30cc7159af37af">TCP_E_ABORT</a>);
        <a class="code" href="_ansa_ether_m_a_c_8cc.html#a60cc06bef97da802b8522d258ac4fe89">CASE</a>(<a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32adea9b33ab4047345817fb7d8066a8ae2">TCP_E_STATUS</a>);
        <a class="code" href="_ansa_ether_m_a_c_8cc.html#a60cc06bef97da802b8522d258ac4fe89">CASE</a>(<a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32a1e5b9fcdbbaae24327c007914ad57a7f">TCP_E_RCV_DATA</a>);
        <a class="code" href="_ansa_ether_m_a_c_8cc.html#a60cc06bef97da802b8522d258ac4fe89">CASE</a>(<a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32a823e4834ff13aaff8408c38ac1b0f350">TCP_E_RCV_ACK</a>);
        <a class="code" href="_ansa_ether_m_a_c_8cc.html#a60cc06bef97da802b8522d258ac4fe89">CASE</a>(<a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32a6769520e2e41d511462d3608d18326ed">TCP_E_RCV_SYN</a>);
        <a class="code" href="_ansa_ether_m_a_c_8cc.html#a60cc06bef97da802b8522d258ac4fe89">CASE</a>(<a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32a3239eea5ba6edf6850289914cfac51c8">TCP_E_RCV_SYN_ACK</a>);
        <a class="code" href="_ansa_ether_m_a_c_8cc.html#a60cc06bef97da802b8522d258ac4fe89">CASE</a>(<a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32a59323c4bb3247640d61362e7f6ba824e">TCP_E_RCV_FIN</a>);
        <a class="code" href="_ansa_ether_m_a_c_8cc.html#a60cc06bef97da802b8522d258ac4fe89">CASE</a>(<a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32a2f4afa3cc8122b708143ae335b542179">TCP_E_RCV_FIN_ACK</a>);
        <a class="code" href="_ansa_ether_m_a_c_8cc.html#a60cc06bef97da802b8522d258ac4fe89">CASE</a>(<a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32a050c79add513afca8554e29b61fd5389">TCP_E_RCV_RST</a>);
        <a class="code" href="_ansa_ether_m_a_c_8cc.html#a60cc06bef97da802b8522d258ac4fe89">CASE</a>(<a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32a55dbf4b3147f64f1baeac365b019dea6">TCP_E_RCV_UNEXP_SYN</a>);
        <a class="code" href="_ansa_ether_m_a_c_8cc.html#a60cc06bef97da802b8522d258ac4fe89">CASE</a>(<a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32a358c0a11572a1131e318543e4b64764a">TCP_E_TIMEOUT_2MSL</a>);
        <a class="code" href="_ansa_ether_m_a_c_8cc.html#a60cc06bef97da802b8522d258ac4fe89">CASE</a>(<a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32a6ba25d81f0bcad8dbc3f1f59ce2f08ed">TCP_E_TIMEOUT_CONN_ESTAB</a>);
        <a class="code" href="_ansa_ether_m_a_c_8cc.html#a60cc06bef97da802b8522d258ac4fe89">CASE</a>(<a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32a3d31d30a7eca2a0655da0b2c16df9500">TCP_E_TIMEOUT_FIN_WAIT_2</a>);
    }
    <span class="keywordflow">return</span> s;
<span class="preprocessor">#undef CASE</span>
<span class="preprocessor"></span>}
</pre></div>
</div>
</div>
<a class="anchor" id="a55abadf8c9f66428b7f6db8fa90d1af3"></a><!-- doxytag: member="tcp_old::TCPConnection::getFsmState" ref="a55abadf8c9f66428b7f6db8fa90d1af3" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a55abadf8c9f66428b7f6db8fa90d1af3">tcp_old::TCPConnection::getFsmState</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_t_c_p_connection__old_8h_source.html#l00478">478</a> of file <a class="el" href="_t_c_p_connection__old_8h_source.html">TCPConnection_old.h</a>.</p>
<div class="fragment"><pre class="fragment">{<span class="keywordflow">return</span> <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>.getState();}
</pre></div>
</div>
</div>
<a class="anchor" id="ab9c0058b4df0583d36fd462e71c3120d"></a><!-- doxytag: member="tcp_old::TCPConnection::getReceiveQueue" ref="ab9c0058b4df0583d36fd462e71c3120d" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classtcp__old_1_1_t_c_p_receive_queue.html">TCPReceiveQueue</a>* <a class="el" href="classtcp__old_1_1_t_c_p_connection.html#ab9c0058b4df0583d36fd462e71c3120d">tcp_old::TCPConnection::getReceiveQueue</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_t_c_p_connection__old_8h_source.html#l00481">481</a> of file <a class="el" href="_t_c_p_connection__old_8h_source.html">TCPConnection_old.h</a>.</p>
<div class="fragment"><pre class="fragment">{<span class="keywordflow">return</span> <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a2602ec64d45270793076abe5938d16ac">receiveQueue</a>;}
</pre></div>
</div>
</div>
<a class="anchor" id="a15a684dc0613b455e92c0ae57a00f177"></a><!-- doxytag: member="tcp_old::TCPConnection::getSendQueue" ref="a15a684dc0613b455e92c0ae57a00f177" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classtcp__old_1_1_t_c_p_send_queue.html">TCPSendQueue</a>* <a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a15a684dc0613b455e92c0ae57a00f177">tcp_old::TCPConnection::getSendQueue</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_t_c_p_connection__old_8h_source.html#l00480">480</a> of file <a class="el" href="_t_c_p_connection__old_8h_source.html">TCPConnection_old.h</a>.</p>
<div class="fragment"><pre class="fragment">{<span class="keywordflow">return</span> <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a7bd9b6b2b4422771b92e00d307983d19">sendQueue</a>;}
</pre></div>
</div>
</div>
<a class="anchor" id="a1704500b72eb201d9119192ebb9b4923"></a><!-- doxytag: member="tcp_old::TCPConnection::getState" ref="a1704500b72eb201d9119192ebb9b4923" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classtcp__old_1_1_t_c_p_state_variables.html">TCPStateVariables</a>* <a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a1704500b72eb201d9119192ebb9b4923">tcp_old::TCPConnection::getState</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_t_c_p_connection__old_8h_source.html#l00479">479</a> of file <a class="el" href="_t_c_p_connection__old_8h_source.html">TCPConnection_old.h</a>.</p>
<div class="fragment"><pre class="fragment">{<span class="keywordflow">return</span> <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>;}
</pre></div>
</div>
</div>
<a class="anchor" id="a11c0933a5657daacb6cbc27de282187f"></a><!-- doxytag: member="tcp_old::TCPConnection::getTcpAlgorithm" ref="a11c0933a5657daacb6cbc27de282187f" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classtcp__old_1_1_t_c_p_algorithm.html">TCPAlgorithm</a>* <a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a11c0933a5657daacb6cbc27de282187f">tcp_old::TCPConnection::getTcpAlgorithm</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_t_c_p_connection__old_8h_source.html#l00482">482</a> of file <a class="el" href="_t_c_p_connection__old_8h_source.html">TCPConnection_old.h</a>.</p>
<div class="fragment"><pre class="fragment">{<span class="keywordflow">return</span> <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a2212cb0deb11d2b1c5826cab57b3f42e">tcpAlgorithm</a>;}
</pre></div>
</div>
</div>
<a class="anchor" id="a5ba299a7999e64fe67e8fef5f62c2402"></a><!-- doxytag: member="tcp_old::TCPConnection::getTcpMain" ref="a5ba299a7999e64fe67e8fef5f62c2402" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classtcp__old_1_1_t_c_p.html">TCP</a>* <a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a5ba299a7999e64fe67e8fef5f62c2402">tcp_old::TCPConnection::getTcpMain</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_t_c_p_connection__old_8h_source.html#l00483">483</a> of file <a class="el" href="_t_c_p_connection__old_8h_source.html">TCPConnection_old.h</a>.</p>

<p>Referenced by <a class="el" href="old_2flavours_2_dumb_t_c_p_8cc_source.html#l00061">tcp_old::DumbTCP::connectionClosed()</a>, <a class="el" href="old_2flavours_2_dumb_t_c_p_8cc_source.html#l00117">tcp_old::DumbTCP::dataSent()</a>, <a class="el" href="old_2flavours_2_t_c_p_base_alg_8cc_source.html#l00116">tcp_old::TCPBaseAlg::initialize()</a>, <a class="el" href="old_2_t_c_p_connection_base_8cc_source.html#l00114">TCPConnection()</a>, and <a class="el" href="old_2flavours_2_dumb_t_c_p_8cc_source.html#l00035">tcp_old::DumbTCP::~DumbTCP()</a>.</p>
<div class="fragment"><pre class="fragment">{<span class="keywordflow">return</span> <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a6f9eb8f2af118d2f1fcd90df3c87249e">tcpMain</a>;}
</pre></div>
</div>
</div>
<a class="anchor" id="adeef1c0b8f04a744168a107f68c397ba"></a><!-- doxytag: member="tcp_old::TCPConnection::indicationName" ref="adeef1c0b8f04a744168a107f68c397ba" args="(int code)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char * <a class="el" href="classtcp__old_1_1_t_c_p_connection.html#adeef1c0b8f04a744168a107f68c397ba">TCPConnection::indicationName</a> </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>code</em></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Utility: returns name of TCP_I_xxx constants </p>

<p>Definition at line <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00089">89</a> of file <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html">old/TCPConnectionUtil.cc</a>.</p>

<p>Referenced by <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00261">sendEstabIndicationToApp()</a>, and <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00250">sendIndicationToApp()</a>.</p>
<div class="fragment"><pre class="fragment">{
<span class="preprocessor">#define CASE(x) case x: s=#x+6; break</span>
<span class="preprocessor"></span>    <span class="keyword">const</span> <span class="keywordtype">char</span> *s = <span class="stringliteral">&quot;unknown&quot;</span>;
    <span class="keywordflow">switch</span> (code)
    {
        <a class="code" href="_ansa_ether_m_a_c_8cc.html#a60cc06bef97da802b8522d258ac4fe89">CASE</a>(<a class="code" href="_t_c_p_command__m_8h.html#a68611fc79dbc74e8744d74b746cd956ba78bce3d41e158816c5212ed2fc959b06">TCP_I_DATA</a>);
        <a class="code" href="_ansa_ether_m_a_c_8cc.html#a60cc06bef97da802b8522d258ac4fe89">CASE</a>(<a class="code" href="_t_c_p_command__m_8h.html#a68611fc79dbc74e8744d74b746cd956ba9b994384633a16021eef2cbb604d6ac7">TCP_I_URGENT_DATA</a>);
        <a class="code" href="_ansa_ether_m_a_c_8cc.html#a60cc06bef97da802b8522d258ac4fe89">CASE</a>(<a class="code" href="_t_c_p_command__m_8h.html#a68611fc79dbc74e8744d74b746cd956ba778d635f284e560631e2b6ce594e3323">TCP_I_ESTABLISHED</a>);
        <a class="code" href="_ansa_ether_m_a_c_8cc.html#a60cc06bef97da802b8522d258ac4fe89">CASE</a>(<a class="code" href="_t_c_p_command__m_8h.html#a68611fc79dbc74e8744d74b746cd956ba98ff9f82c08b1d7ae58049835c47368a">TCP_I_PEER_CLOSED</a>);
        <a class="code" href="_ansa_ether_m_a_c_8cc.html#a60cc06bef97da802b8522d258ac4fe89">CASE</a>(<a class="code" href="_t_c_p_command__m_8h.html#a68611fc79dbc74e8744d74b746cd956ba994690e6a29c6e7c3eedc8fbb29d7a8c">TCP_I_CLOSED</a>);
        <a class="code" href="_ansa_ether_m_a_c_8cc.html#a60cc06bef97da802b8522d258ac4fe89">CASE</a>(<a class="code" href="_t_c_p_command__m_8h.html#a68611fc79dbc74e8744d74b746cd956ba21824d5a95e3b86c41f35775bb5f23ab">TCP_I_CONNECTION_REFUSED</a>);
        <a class="code" href="_ansa_ether_m_a_c_8cc.html#a60cc06bef97da802b8522d258ac4fe89">CASE</a>(<a class="code" href="_t_c_p_command__m_8h.html#a68611fc79dbc74e8744d74b746cd956ba4e8f4551a34a27e607201754b36fdbe0">TCP_I_CONNECTION_RESET</a>);
        <a class="code" href="_ansa_ether_m_a_c_8cc.html#a60cc06bef97da802b8522d258ac4fe89">CASE</a>(<a class="code" href="_t_c_p_command__m_8h.html#a68611fc79dbc74e8744d74b746cd956ba06629e44a0aef5201b4cd424596127bf">TCP_I_TIMED_OUT</a>);
        <a class="code" href="_ansa_ether_m_a_c_8cc.html#a60cc06bef97da802b8522d258ac4fe89">CASE</a>(<a class="code" href="_t_c_p_command__m_8h.html#a68611fc79dbc74e8744d74b746cd956babe4b456d5340a1c5d9ed0b0384409159">TCP_I_STATUS</a>);
    }
    <span class="keywordflow">return</span> s;
<span class="preprocessor">#undef CASE</span>
<span class="preprocessor"></span>}
</pre></div>
</div>
</div>
<a class="anchor" id="a69caa8ea0ffbe8d9f73f935aac1b29d9"></a><!-- doxytag: member="tcp_old::TCPConnection::initConnection" ref="a69caa8ea0ffbe8d9f73f935aac1b29d9" args="(TCPOpenCommand *openCmd)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a69caa8ea0ffbe8d9f73f935aac1b29d9">TCPConnection::initConnection</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_t_c_p_open_command.html">TCPOpenCommand</a> *&#160;</td>
          <td class="paramname"><em>openCmd</em></td><td>)</td>
          <td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Utility: creates send/receive queues and tcpAlgorithm </p>

<p>Definition at line <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00283">283</a> of file <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html">old/TCPConnectionUtil.cc</a>.</p>

<p>Referenced by <a class="el" href="old_2_t_c_p_connection_event_proc_8cc_source.html#l00034">process_OPEN_ACTIVE()</a>, and <a class="el" href="old_2_t_c_p_connection_event_proc_8cc_source.html#l00080">process_OPEN_PASSIVE()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="comment">// create send/receive queues</span>
    <span class="keyword">const</span> <span class="keywordtype">char</span> *sendQueueClass = openCmd-&gt;<a class="code" href="class_t_c_p_open_command.html#ac93aa56190dd09b5a957043766a057b7">getSendQueueClass</a>();
    <span class="keywordflow">if</span> (!sendQueueClass || !sendQueueClass[0])
        sendQueueClass = <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a6f9eb8f2af118d2f1fcd90df3c87249e">tcpMain</a>-&gt;par(<span class="stringliteral">&quot;sendQueueClass&quot;</span>);
    <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a7bd9b6b2b4422771b92e00d307983d19">sendQueue</a> = check_and_cast&lt;<a class="code" href="classtcp__old_1_1_t_c_p_send_queue.html">TCPSendQueue</a> *&gt;(createOne(sendQueueClass));
    <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a7bd9b6b2b4422771b92e00d307983d19">sendQueue</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_send_queue.html#a6580be23b72c3b6afd33532555cc165a">setConnection</a>(<span class="keyword">this</span>);

    <span class="keyword">const</span> <span class="keywordtype">char</span> *receiveQueueClass = openCmd-&gt;<a class="code" href="class_t_c_p_open_command.html#af13ad188ff7db724d703a097cd5827f2">getReceiveQueueClass</a>();
    <span class="keywordflow">if</span> (!receiveQueueClass || !receiveQueueClass[0])
        receiveQueueClass = <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a6f9eb8f2af118d2f1fcd90df3c87249e">tcpMain</a>-&gt;par(<span class="stringliteral">&quot;receiveQueueClass&quot;</span>);
    <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a2602ec64d45270793076abe5938d16ac">receiveQueue</a> = check_and_cast&lt;<a class="code" href="classtcp__old_1_1_t_c_p_receive_queue.html">TCPReceiveQueue</a> *&gt;(createOne(receiveQueueClass));
    <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a2602ec64d45270793076abe5938d16ac">receiveQueue</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_receive_queue.html#ad9e22f581f6cc50d43611b5bc723638c">setConnection</a>(<span class="keyword">this</span>);

    <span class="comment">// create algorithm</span>
    <span class="keyword">const</span> <span class="keywordtype">char</span> *tcpAlgorithmClass = openCmd-&gt;<a class="code" href="class_t_c_p_open_command.html#a6405afe94b3bd1915952553a1117e819">getTcpAlgorithmClass</a>();
    <span class="keywordflow">if</span> (!tcpAlgorithmClass || !tcpAlgorithmClass[0])
        tcpAlgorithmClass = <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a6f9eb8f2af118d2f1fcd90df3c87249e">tcpMain</a>-&gt;par(<span class="stringliteral">&quot;tcpAlgorithmClass&quot;</span>);
    <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a2212cb0deb11d2b1c5826cab57b3f42e">tcpAlgorithm</a> = check_and_cast&lt;<a class="code" href="classtcp__old_1_1_t_c_p_algorithm.html">TCPAlgorithm</a> *&gt;(createOne(tcpAlgorithmClass));
    <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a2212cb0deb11d2b1c5826cab57b3f42e">tcpAlgorithm</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_algorithm.html#a2b019306b6e6a3984bd2c81b2713c3f4">setConnection</a>(<span class="keyword">this</span>);

    <span class="comment">// create state block</span>
    <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a> = <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a2212cb0deb11d2b1c5826cab57b3f42e">tcpAlgorithm</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_algorithm.html#aa1d2b17e15a2c8f339174cf5fd70fc0d">getStateVariables</a>();
    <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a8ddd3d422b9d6e00ad15cf99f9870ef4">configureStateVariables</a>();
    <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a2212cb0deb11d2b1c5826cab57b3f42e">tcpAlgorithm</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_algorithm.html#adbd27ed1bccde3db4924db7393ef60ee">initialize</a>();
}
</pre></div>
</div>
</div>
<a class="anchor" id="acceb561b23349d06b298858e39433435"></a><!-- doxytag: member="tcp_old::TCPConnection::isSegmentAcceptable" ref="acceb561b23349d06b298858e39433435" args="(TCPSegment *tcpseg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classtcp__old_1_1_t_c_p_connection.html#acceb561b23349d06b298858e39433435">TCPConnection::isSegmentAcceptable</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_t_c_p_segment.html">TCPSegment</a> *&#160;</td>
          <td class="paramname"><em>tcpseg</em></td><td>)</td>
          <td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Utility: check if segment is acceptable (all bytes are in receive window) </p>

<p>Definition at line <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00330">330</a> of file <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html">old/TCPConnectionUtil.cc</a>.</p>

<p>Referenced by <a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html#l00114">processSegment1stThru8th()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="comment">// check that segment entirely falls in receive window</span>
    <span class="comment">//FIXME probably not this simple, see old code segAccept() below...</span>
    <span class="keywordflow">return</span> <a class="code" href="namespacetcp__old.html#a0012c6f2a0631480574729efd85a05c9">seqGE</a>(tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a0dafe41ef5a4306a4106fdb1e22b19e8">getSequenceNo</a>(),<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a18b8a2c7e52c332378bd9f70b1d91b29">rcv_nxt</a>) &amp;&amp;
           <a class="code" href="namespacetcp__old.html#a2a4d76c437a6e0eb1e1440c02153e5db">seqLE</a>(tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a0dafe41ef5a4306a4106fdb1e22b19e8">getSequenceNo</a>()+tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a7d9f010b71e3bfa267873ab21195fb73">getPayloadLength</a>(),<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a18b8a2c7e52c332378bd9f70b1d91b29">rcv_nxt</a>+<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#ab26a1e5c5f13a245ef7578dc87e81cfe">rcv_wnd</a>);
}
</pre></div>
</div>
</div>
<a class="anchor" id="aa1fe5fa359d4063c984d686e4166b798"></a><!-- doxytag: member="tcp_old::TCPConnection::performStateTransition" ref="aa1fe5fa359d4063c984d686e4166b798" args="(const TCPEventCode &amp;event)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classtcp__old_1_1_t_c_p_connection.html#aa1fe5fa359d4063c984d686e4166b798">TCPConnection::performStateTransition</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32">TCPEventCode</a> &amp;&#160;</td>
          <td class="paramname"><em>event</em></td><td>)</td>
          <td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Implemements the pure <a class="el" href="classtcp__old_1_1_t_c_p.html">TCP</a> state machine </p>

<p>Definition at line <a class="el" href="old_2_t_c_p_connection_base_8cc_source.html#l00284">284</a> of file <a class="el" href="old_2_t_c_p_connection_base_8cc_source.html">old/TCPConnectionBase.cc</a>.</p>

<p>Referenced by <a class="el" href="old_2_t_c_p_connection_base_8cc_source.html#l00245">processAppCommand()</a>, <a class="el" href="old_2_t_c_p_connection_base_8cc_source.html#l00221">processTCPSegment()</a>, and <a class="el" href="old_2_t_c_p_connection_base_8cc_source.html#l00184">processTimer()</a>.</p>
<div class="fragment"><pre class="fragment">{
    ASSERT(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>.getState()!=<a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaaae392e6982b73d95ab4e48e3a27ce552">TCP_S_CLOSED</a>); <span class="comment">// closed connections should be deleted immediately</span>

    <span class="keywordflow">if</span> (<a class="code" href="namespacecesnet.html#a56e29c69128db750fc49a508a16cf7ba">event</a>==<a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32acd405552b4f4c9973d5d5b7e8aae88f5">TCP_E_IGNORE</a>)  <span class="comment">// e.g. discarded segment</span>
    {
        <a class="code" href="_t_c_p_8h.html#a601325e92d65fe658c80eab711e12304">tcpEV</a> &lt;&lt; <span class="stringliteral">&quot;Staying in state: &quot;</span> &lt;&lt; <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ab991cf2680a63832310a4a56ac17972e">stateName</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>.getState()) &lt;&lt; <span class="stringliteral">&quot; (no FSM event)\n&quot;</span>;
        <span class="keywordflow">return</span> <span class="keyword">true</span>;
    }

    <span class="comment">// state machine</span>
    <span class="comment">// TBD add handling of connection timeout event (keepalive), with transition to CLOSED</span>
    <span class="comment">// Note: empty &quot;default:&quot; lines are for gcc&#39;s benefit which would otherwise spit warnings</span>
    <span class="keywordtype">int</span> oldState = <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>.getState();
    <span class="keywordflow">switch</span> (<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>.getState())
    {
        <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaa8b6438b06a8e3cd7537e09f9fb2f0d03">TCP_S_INIT</a>:
            <span class="keywordflow">switch</span> (<a class="code" href="namespacecesnet.html#a56e29c69128db750fc49a508a16cf7ba">event</a>)
            {
                <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32a11dd6ccbd9b9bbb145b64fb99981b530">TCP_E_OPEN_PASSIVE</a>:FSM_Goto(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>, <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaa8a809324e3edea6ff6800a639d7bcea2">TCP_S_LISTEN</a>); <span class="keywordflow">break</span>;
                <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32a6179df5a4a1f3314be52f5789f5f0bb6">TCP_E_OPEN_ACTIVE</a>: FSM_Goto(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>, <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaafde4b4cc43d59d14ba2cbf0bc3adb525">TCP_S_SYN_SENT</a>); <span class="keywordflow">break</span>;
                <span class="keywordflow">default</span>:;
            }
            <span class="keywordflow">break</span>;

        <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaa8a809324e3edea6ff6800a639d7bcea2">TCP_S_LISTEN</a>:
            <span class="keywordflow">switch</span> (<a class="code" href="namespacecesnet.html#a56e29c69128db750fc49a508a16cf7ba">event</a>)
            {
                <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32a6179df5a4a1f3314be52f5789f5f0bb6">TCP_E_OPEN_ACTIVE</a>: FSM_Goto(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>, <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaafde4b4cc43d59d14ba2cbf0bc3adb525">TCP_S_SYN_SENT</a>); <span class="keywordflow">break</span>;
                <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32af5e9f1961ac4c76e49f568d8fd304063">TCP_E_SEND</a>:        FSM_Goto(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>, <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaafde4b4cc43d59d14ba2cbf0bc3adb525">TCP_S_SYN_SENT</a>); <span class="keywordflow">break</span>;
                <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32a2c5c582787e0b87a4a913e34c4d20d1b">TCP_E_CLOSE</a>:       FSM_Goto(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>, <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaaae392e6982b73d95ab4e48e3a27ce552">TCP_S_CLOSED</a>); <span class="keywordflow">break</span>;
                <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32a1fd07d5de8615b02fe30cc7159af37af">TCP_E_ABORT</a>:       FSM_Goto(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>, <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaaae392e6982b73d95ab4e48e3a27ce552">TCP_S_CLOSED</a>); <span class="keywordflow">break</span>;
                <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32a6769520e2e41d511462d3608d18326ed">TCP_E_RCV_SYN</a>:     FSM_Goto(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>, <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaaf96abc23364b3cdd51216d5cc9a4f3fc">TCP_S_SYN_RCVD</a>);<span class="keywordflow">break</span>;
                <span class="keywordflow">default</span>:;
            }
            <span class="keywordflow">break</span>;

        <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaaf96abc23364b3cdd51216d5cc9a4f3fc">TCP_S_SYN_RCVD</a>:
            <span class="keywordflow">switch</span> (<a class="code" href="namespacecesnet.html#a56e29c69128db750fc49a508a16cf7ba">event</a>)
            {
                <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32a2c5c582787e0b87a4a913e34c4d20d1b">TCP_E_CLOSE</a>:       FSM_Goto(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>, <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaa1366e9fbbf862cd3fdfa3ea08e641cb0">TCP_S_FIN_WAIT_1</a>); <span class="keywordflow">break</span>;
                <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32a1fd07d5de8615b02fe30cc7159af37af">TCP_E_ABORT</a>:       FSM_Goto(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>, <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaaae392e6982b73d95ab4e48e3a27ce552">TCP_S_CLOSED</a>); <span class="keywordflow">break</span>;
                <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32a6ba25d81f0bcad8dbc3f1f59ce2f08ed">TCP_E_TIMEOUT_CONN_ESTAB</a>: FSM_Goto(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>, <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#afba4a9f34c546c37533eb5311c1da682">active</a> ? <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaaae392e6982b73d95ab4e48e3a27ce552">TCP_S_CLOSED</a> : <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaa8a809324e3edea6ff6800a639d7bcea2">TCP_S_LISTEN</a>); <span class="keywordflow">break</span>;
                <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32a050c79add513afca8554e29b61fd5389">TCP_E_RCV_RST</a>:     FSM_Goto(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>, <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#afba4a9f34c546c37533eb5311c1da682">active</a> ? <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaaae392e6982b73d95ab4e48e3a27ce552">TCP_S_CLOSED</a> : <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaa8a809324e3edea6ff6800a639d7bcea2">TCP_S_LISTEN</a>); <span class="keywordflow">break</span>;
                <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32a823e4834ff13aaff8408c38ac1b0f350">TCP_E_RCV_ACK</a>:     FSM_Goto(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>, <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaa3b4387f45a765235dfda0bf3111ba1c6">TCP_S_ESTABLISHED</a>); <span class="keywordflow">break</span>;
                <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32a59323c4bb3247640d61362e7f6ba824e">TCP_E_RCV_FIN</a>:     FSM_Goto(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>, <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaa3395b6fd6b4cf5d6165b37929d44eaa1">TCP_S_CLOSE_WAIT</a>); <span class="keywordflow">break</span>;
                <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32a55dbf4b3147f64f1baeac365b019dea6">TCP_E_RCV_UNEXP_SYN</a>: FSM_Goto(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>, <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaaae392e6982b73d95ab4e48e3a27ce552">TCP_S_CLOSED</a>); <span class="keywordflow">break</span>;
                <span class="keywordflow">default</span>:;
            }
            <span class="keywordflow">break</span>;

        <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaafde4b4cc43d59d14ba2cbf0bc3adb525">TCP_S_SYN_SENT</a>:
            <span class="keywordflow">switch</span> (<a class="code" href="namespacecesnet.html#a56e29c69128db750fc49a508a16cf7ba">event</a>)
            {
                <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32a2c5c582787e0b87a4a913e34c4d20d1b">TCP_E_CLOSE</a>:       FSM_Goto(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>, <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaaae392e6982b73d95ab4e48e3a27ce552">TCP_S_CLOSED</a>); <span class="keywordflow">break</span>;
                <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32a1fd07d5de8615b02fe30cc7159af37af">TCP_E_ABORT</a>:       FSM_Goto(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>, <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaaae392e6982b73d95ab4e48e3a27ce552">TCP_S_CLOSED</a>); <span class="keywordflow">break</span>;
                <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32a6ba25d81f0bcad8dbc3f1f59ce2f08ed">TCP_E_TIMEOUT_CONN_ESTAB</a>: FSM_Goto(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>, <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaaae392e6982b73d95ab4e48e3a27ce552">TCP_S_CLOSED</a>); <span class="keywordflow">break</span>;
                <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32a050c79add513afca8554e29b61fd5389">TCP_E_RCV_RST</a>:     FSM_Goto(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>, <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaaae392e6982b73d95ab4e48e3a27ce552">TCP_S_CLOSED</a>); <span class="keywordflow">break</span>;
                <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32a3239eea5ba6edf6850289914cfac51c8">TCP_E_RCV_SYN_ACK</a>: FSM_Goto(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>, <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaa3b4387f45a765235dfda0bf3111ba1c6">TCP_S_ESTABLISHED</a>); <span class="keywordflow">break</span>;
                <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32a6769520e2e41d511462d3608d18326ed">TCP_E_RCV_SYN</a>:     FSM_Goto(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>, <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaaf96abc23364b3cdd51216d5cc9a4f3fc">TCP_S_SYN_RCVD</a>); <span class="keywordflow">break</span>;
                <span class="keywordflow">default</span>:;
            }
            <span class="keywordflow">break</span>;

        <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaa3b4387f45a765235dfda0bf3111ba1c6">TCP_S_ESTABLISHED</a>:
            <span class="keywordflow">switch</span> (<a class="code" href="namespacecesnet.html#a56e29c69128db750fc49a508a16cf7ba">event</a>)
            {
                <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32a2c5c582787e0b87a4a913e34c4d20d1b">TCP_E_CLOSE</a>:       FSM_Goto(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>, <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaa1366e9fbbf862cd3fdfa3ea08e641cb0">TCP_S_FIN_WAIT_1</a>); <span class="keywordflow">break</span>;
                <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32a1fd07d5de8615b02fe30cc7159af37af">TCP_E_ABORT</a>:       FSM_Goto(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>, <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaaae392e6982b73d95ab4e48e3a27ce552">TCP_S_CLOSED</a>); <span class="keywordflow">break</span>;
                <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32a59323c4bb3247640d61362e7f6ba824e">TCP_E_RCV_FIN</a>:     FSM_Goto(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>, <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaa3395b6fd6b4cf5d6165b37929d44eaa1">TCP_S_CLOSE_WAIT</a>); <span class="keywordflow">break</span>;
                <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32a050c79add513afca8554e29b61fd5389">TCP_E_RCV_RST</a>:     FSM_Goto(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>, <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaaae392e6982b73d95ab4e48e3a27ce552">TCP_S_CLOSED</a>); <span class="keywordflow">break</span>;
                <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32a55dbf4b3147f64f1baeac365b019dea6">TCP_E_RCV_UNEXP_SYN</a>: FSM_Goto(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>, <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaaae392e6982b73d95ab4e48e3a27ce552">TCP_S_CLOSED</a>); <span class="keywordflow">break</span>;
                <span class="keywordflow">default</span>:;
            }
            <span class="keywordflow">break</span>;

        <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaa3395b6fd6b4cf5d6165b37929d44eaa1">TCP_S_CLOSE_WAIT</a>:
            <span class="keywordflow">switch</span> (<a class="code" href="namespacecesnet.html#a56e29c69128db750fc49a508a16cf7ba">event</a>)
            {
                <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32a2c5c582787e0b87a4a913e34c4d20d1b">TCP_E_CLOSE</a>:       FSM_Goto(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>, <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaaac5147b505ddf6bb15d84853242bcfdf">TCP_S_LAST_ACK</a>); <span class="keywordflow">break</span>;
                <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32a1fd07d5de8615b02fe30cc7159af37af">TCP_E_ABORT</a>:       FSM_Goto(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>, <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaaae392e6982b73d95ab4e48e3a27ce552">TCP_S_CLOSED</a>); <span class="keywordflow">break</span>;
                <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32a050c79add513afca8554e29b61fd5389">TCP_E_RCV_RST</a>:     FSM_Goto(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>, <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaaae392e6982b73d95ab4e48e3a27ce552">TCP_S_CLOSED</a>); <span class="keywordflow">break</span>;
                <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32a55dbf4b3147f64f1baeac365b019dea6">TCP_E_RCV_UNEXP_SYN</a>: FSM_Goto(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>, <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaaae392e6982b73d95ab4e48e3a27ce552">TCP_S_CLOSED</a>); <span class="keywordflow">break</span>;
                <span class="keywordflow">default</span>:;
            }
            <span class="keywordflow">break</span>;

        <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaaac5147b505ddf6bb15d84853242bcfdf">TCP_S_LAST_ACK</a>:
            <span class="keywordflow">switch</span> (<a class="code" href="namespacecesnet.html#a56e29c69128db750fc49a508a16cf7ba">event</a>)
            {
                <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32a1fd07d5de8615b02fe30cc7159af37af">TCP_E_ABORT</a>:       FSM_Goto(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>, <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaaae392e6982b73d95ab4e48e3a27ce552">TCP_S_CLOSED</a>); <span class="keywordflow">break</span>;
                <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32a823e4834ff13aaff8408c38ac1b0f350">TCP_E_RCV_ACK</a>:     FSM_Goto(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>, <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaaae392e6982b73d95ab4e48e3a27ce552">TCP_S_CLOSED</a>); <span class="keywordflow">break</span>;
                <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32a050c79add513afca8554e29b61fd5389">TCP_E_RCV_RST</a>:     FSM_Goto(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>, <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaaae392e6982b73d95ab4e48e3a27ce552">TCP_S_CLOSED</a>); <span class="keywordflow">break</span>;
                <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32a55dbf4b3147f64f1baeac365b019dea6">TCP_E_RCV_UNEXP_SYN</a>: FSM_Goto(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>, <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaaae392e6982b73d95ab4e48e3a27ce552">TCP_S_CLOSED</a>); <span class="keywordflow">break</span>;
                <span class="keywordflow">default</span>:;
            }
            <span class="keywordflow">break</span>;

        <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaa1366e9fbbf862cd3fdfa3ea08e641cb0">TCP_S_FIN_WAIT_1</a>:
            <span class="keywordflow">switch</span> (<a class="code" href="namespacecesnet.html#a56e29c69128db750fc49a508a16cf7ba">event</a>)
            {
                <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32a1fd07d5de8615b02fe30cc7159af37af">TCP_E_ABORT</a>:       FSM_Goto(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>, <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaaae392e6982b73d95ab4e48e3a27ce552">TCP_S_CLOSED</a>); <span class="keywordflow">break</span>;
                <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32a59323c4bb3247640d61362e7f6ba824e">TCP_E_RCV_FIN</a>:     FSM_Goto(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>, <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaacdbad950a89de6fc964c3257d45e07a9">TCP_S_CLOSING</a>); <span class="keywordflow">break</span>;
                <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32a823e4834ff13aaff8408c38ac1b0f350">TCP_E_RCV_ACK</a>:     FSM_Goto(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>, <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaaea07c6aa092a0b2e9141385fb4734797">TCP_S_FIN_WAIT_2</a>); <span class="keywordflow">break</span>;
                <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32a2f4afa3cc8122b708143ae335b542179">TCP_E_RCV_FIN_ACK</a>: FSM_Goto(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>, <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaa8a4fa6fa69c727999ad6b8fe056a6fd1">TCP_S_TIME_WAIT</a>); <span class="keywordflow">break</span>;
                <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32a050c79add513afca8554e29b61fd5389">TCP_E_RCV_RST</a>:     FSM_Goto(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>, <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaaae392e6982b73d95ab4e48e3a27ce552">TCP_S_CLOSED</a>); <span class="keywordflow">break</span>;
                <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32a55dbf4b3147f64f1baeac365b019dea6">TCP_E_RCV_UNEXP_SYN</a>: FSM_Goto(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>, <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaaae392e6982b73d95ab4e48e3a27ce552">TCP_S_CLOSED</a>); <span class="keywordflow">break</span>;
                <span class="keywordflow">default</span>:;
            }
            <span class="keywordflow">break</span>;

        <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaaea07c6aa092a0b2e9141385fb4734797">TCP_S_FIN_WAIT_2</a>:
            <span class="keywordflow">switch</span> (<a class="code" href="namespacecesnet.html#a56e29c69128db750fc49a508a16cf7ba">event</a>)
            {
                <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32a1fd07d5de8615b02fe30cc7159af37af">TCP_E_ABORT</a>:       FSM_Goto(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>, <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaaae392e6982b73d95ab4e48e3a27ce552">TCP_S_CLOSED</a>); <span class="keywordflow">break</span>;
                <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32a59323c4bb3247640d61362e7f6ba824e">TCP_E_RCV_FIN</a>:     FSM_Goto(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>, <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaa8a4fa6fa69c727999ad6b8fe056a6fd1">TCP_S_TIME_WAIT</a>); <span class="keywordflow">break</span>;
                <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32a3d31d30a7eca2a0655da0b2c16df9500">TCP_E_TIMEOUT_FIN_WAIT_2</a>: FSM_Goto(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>, <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaaae392e6982b73d95ab4e48e3a27ce552">TCP_S_CLOSED</a>); <span class="keywordflow">break</span>;
                <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32a050c79add513afca8554e29b61fd5389">TCP_E_RCV_RST</a>:     FSM_Goto(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>, <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaaae392e6982b73d95ab4e48e3a27ce552">TCP_S_CLOSED</a>); <span class="keywordflow">break</span>;
                <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32a55dbf4b3147f64f1baeac365b019dea6">TCP_E_RCV_UNEXP_SYN</a>: FSM_Goto(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>, <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaaae392e6982b73d95ab4e48e3a27ce552">TCP_S_CLOSED</a>); <span class="keywordflow">break</span>;
                <span class="keywordflow">default</span>:;
            }
            <span class="keywordflow">break</span>;

        <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaacdbad950a89de6fc964c3257d45e07a9">TCP_S_CLOSING</a>:
            <span class="keywordflow">switch</span> (<a class="code" href="namespacecesnet.html#a56e29c69128db750fc49a508a16cf7ba">event</a>)
            {
                <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32a1fd07d5de8615b02fe30cc7159af37af">TCP_E_ABORT</a>:       FSM_Goto(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>, <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaaae392e6982b73d95ab4e48e3a27ce552">TCP_S_CLOSED</a>); <span class="keywordflow">break</span>;
                <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32a823e4834ff13aaff8408c38ac1b0f350">TCP_E_RCV_ACK</a>:     FSM_Goto(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>, <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaa8a4fa6fa69c727999ad6b8fe056a6fd1">TCP_S_TIME_WAIT</a>); <span class="keywordflow">break</span>;
                <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32a050c79add513afca8554e29b61fd5389">TCP_E_RCV_RST</a>:     FSM_Goto(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>, <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaaae392e6982b73d95ab4e48e3a27ce552">TCP_S_CLOSED</a>); <span class="keywordflow">break</span>;
                <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32a55dbf4b3147f64f1baeac365b019dea6">TCP_E_RCV_UNEXP_SYN</a>: FSM_Goto(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>, <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaaae392e6982b73d95ab4e48e3a27ce552">TCP_S_CLOSED</a>); <span class="keywordflow">break</span>;
                <span class="keywordflow">default</span>:;
            }
            <span class="keywordflow">break</span>;

        <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaa8a4fa6fa69c727999ad6b8fe056a6fd1">TCP_S_TIME_WAIT</a>:
            <span class="keywordflow">switch</span> (<a class="code" href="namespacecesnet.html#a56e29c69128db750fc49a508a16cf7ba">event</a>)
            {
                <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32a1fd07d5de8615b02fe30cc7159af37af">TCP_E_ABORT</a>:       FSM_Goto(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>, <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaaae392e6982b73d95ab4e48e3a27ce552">TCP_S_CLOSED</a>); <span class="keywordflow">break</span>;
                <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32a358c0a11572a1131e318543e4b64764a">TCP_E_TIMEOUT_2MSL</a>: FSM_Goto(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>, <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaaae392e6982b73d95ab4e48e3a27ce552">TCP_S_CLOSED</a>); <span class="keywordflow">break</span>;
                <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32a050c79add513afca8554e29b61fd5389">TCP_E_RCV_RST</a>:     FSM_Goto(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>, <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaaae392e6982b73d95ab4e48e3a27ce552">TCP_S_CLOSED</a>); <span class="keywordflow">break</span>;
                <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32a55dbf4b3147f64f1baeac365b019dea6">TCP_E_RCV_UNEXP_SYN</a>: FSM_Goto(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>, <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaaae392e6982b73d95ab4e48e3a27ce552">TCP_S_CLOSED</a>); <span class="keywordflow">break</span>;
                <span class="keywordflow">default</span>:;
            }
            <span class="keywordflow">break</span>;

        <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaaae392e6982b73d95ab4e48e3a27ce552">TCP_S_CLOSED</a>:
            <span class="keywordflow">break</span>;
    }

    <span class="keywordflow">if</span> (oldState!=<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>.getState())
    {
        <a class="code" href="_t_c_p_8h.html#a601325e92d65fe658c80eab711e12304">tcpEV</a> &lt;&lt; <span class="stringliteral">&quot;Transition: &quot;</span> &lt;&lt; <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ab991cf2680a63832310a4a56ac17972e">stateName</a>(oldState) &lt;&lt; <span class="stringliteral">&quot; --&gt; &quot;</span> &lt;&lt; <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ab991cf2680a63832310a4a56ac17972e">stateName</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>.getState()) &lt;&lt; <span class="stringliteral">&quot;  (event was: &quot;</span> &lt;&lt; <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#af199cd53f71f27341684145c3bdab306">eventName</a>(<a class="code" href="namespacecesnet.html#a56e29c69128db750fc49a508a16cf7ba">event</a>) &lt;&lt; <span class="stringliteral">&quot;)\n&quot;</span>;
        <a class="code" href="_t_c_p_8h.html#a85ddacbb6727d1260826a130068eef15">testingEV</a> &lt;&lt; <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a6f9eb8f2af118d2f1fcd90df3c87249e">tcpMain</a>-&gt;getName() &lt;&lt; <span class="stringliteral">&quot;: &quot;</span> &lt;&lt; <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ab991cf2680a63832310a4a56ac17972e">stateName</a>(oldState) &lt;&lt; <span class="stringliteral">&quot; --&gt; &quot;</span> &lt;&lt; <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ab991cf2680a63832310a4a56ac17972e">stateName</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>.getState()) &lt;&lt; <span class="stringliteral">&quot;  (on &quot;</span> &lt;&lt; <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#af199cd53f71f27341684145c3bdab306">eventName</a>(<a class="code" href="namespacecesnet.html#a56e29c69128db750fc49a508a16cf7ba">event</a>) &lt;&lt; <span class="stringliteral">&quot;)\n&quot;</span>;

        <span class="comment">// cancel timers, etc.</span>
        <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a1be68d20f98e68b01ef9267a8dd2088a">stateEntered</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>.getState());
    }
    <span class="keywordflow">else</span>
    {
        <a class="code" href="_t_c_p_8h.html#a601325e92d65fe658c80eab711e12304">tcpEV</a> &lt;&lt; <span class="stringliteral">&quot;Staying in state: &quot;</span> &lt;&lt; <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ab991cf2680a63832310a4a56ac17972e">stateName</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>.getState()) &lt;&lt; <span class="stringliteral">&quot; (event was: &quot;</span> &lt;&lt; <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#af199cd53f71f27341684145c3bdab306">eventName</a>(<a class="code" href="namespacecesnet.html#a56e29c69128db750fc49a508a16cf7ba">event</a>) &lt;&lt; <span class="stringliteral">&quot;)\n&quot;</span>;
    }

    <span class="keywordflow">return</span> <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>.getState()!=<a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaaae392e6982b73d95ab4e48e3a27ce552">TCP_S_CLOSED</a>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a792d9159b4e64b344cac79d0716c907a"></a><!-- doxytag: member="tcp_old::TCPConnection::preanalyseAppCommandEvent" ref="a792d9159b4e64b344cac79d0716c907a" args="(int commandCode)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32">TCPEventCode</a> <a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a792d9159b4e64b344cac79d0716c907a">TCPConnection::preanalyseAppCommandEvent</a> </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>commandCode</em></td><td>)</td>
          <td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Maps app command codes (msg kind of app command msgs) to TCP_E_xxx event codes </p>

<p>Definition at line <a class="el" href="old_2_t_c_p_connection_base_8cc_source.html#l00269">269</a> of file <a class="el" href="old_2_t_c_p_connection_base_8cc_source.html">old/TCPConnectionBase.cc</a>.</p>

<p>Referenced by <a class="el" href="old_2_t_c_p_connection_base_8cc_source.html#l00245">processAppCommand()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordflow">switch</span> (commandCode)
    {
        <span class="keywordflow">case</span> <a class="code" href="_t_c_p_command__m_8h.html#a3a8aac9b74215a1768eeaa375c3cc7d6a9cf8b93f6f9a392ec92dc8c0735d0099">TCP_C_OPEN_ACTIVE</a>:  <span class="keywordflow">return</span> <a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32a6179df5a4a1f3314be52f5789f5f0bb6">TCP_E_OPEN_ACTIVE</a>;
        <span class="keywordflow">case</span> <a class="code" href="_t_c_p_command__m_8h.html#a3a8aac9b74215a1768eeaa375c3cc7d6a973f05e12deb1f283795b6eedc476cb8">TCP_C_OPEN_PASSIVE</a>: <span class="keywordflow">return</span> <a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32a11dd6ccbd9b9bbb145b64fb99981b530">TCP_E_OPEN_PASSIVE</a>;
        <span class="keywordflow">case</span> <a class="code" href="_t_c_p_command__m_8h.html#a3a8aac9b74215a1768eeaa375c3cc7d6a5551d7ad54c2f8afd61355444ec620a6">TCP_C_SEND</a>:         <span class="keywordflow">return</span> <a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32af5e9f1961ac4c76e49f568d8fd304063">TCP_E_SEND</a>;
        <span class="keywordflow">case</span> <a class="code" href="_t_c_p_command__m_8h.html#a3a8aac9b74215a1768eeaa375c3cc7d6aa18cb807579ad3b72293d3023883ba0a">TCP_C_CLOSE</a>:        <span class="keywordflow">return</span> <a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32a2c5c582787e0b87a4a913e34c4d20d1b">TCP_E_CLOSE</a>;
        <span class="keywordflow">case</span> <a class="code" href="_t_c_p_command__m_8h.html#a3a8aac9b74215a1768eeaa375c3cc7d6a50eccd3eb23bdd7758a5e67a5e36c533">TCP_C_ABORT</a>:        <span class="keywordflow">return</span> <a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32a1fd07d5de8615b02fe30cc7159af37af">TCP_E_ABORT</a>;
        <span class="keywordflow">case</span> <a class="code" href="_t_c_p_command__m_8h.html#a3a8aac9b74215a1768eeaa375c3cc7d6a77c74858a4d11f1ac6bcfc26e20a44e2">TCP_C_STATUS</a>:       <span class="keywordflow">return</span> <a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32adea9b33ab4047345817fb7d8066a8ae2">TCP_E_STATUS</a>;
        <span class="keywordflow">default</span>: opp_error(<span class="stringliteral">&quot;Unknown message kind in app command&quot;</span>);
                 <span class="keywordflow">return</span> (<a class="code" href="_t_c_p_connection_8h.html#a9187fb8d597fec5e53124ffe46c7e85e">TCPEventCode</a>)0; <span class="comment">// to satisfy compiler</span>
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a8aaec47dd8098dbaa015f2e3e7b16442"></a><!-- doxytag: member="tcp_old::TCPConnection::printConnBrief" ref="a8aaec47dd8098dbaa015f2e3e7b16442" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a8aaec47dd8098dbaa015f2e3e7b16442">TCPConnection::printConnBrief</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Utility: prints local/remote addr/port and app gate index/connId </p>

<p>Definition at line <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00109">109</a> of file <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html">old/TCPConnectionUtil.cc</a>.</p>

<p>Referenced by <a class="el" href="old_2_t_c_p_connection_base_8cc_source.html#l00245">processAppCommand()</a>, <a class="el" href="old_2_t_c_p_connection_base_8cc_source.html#l00221">processTCPSegment()</a>, and <a class="el" href="old_2_t_c_p_connection_base_8cc_source.html#l00184">processTimer()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="_t_c_p_8h.html#a601325e92d65fe658c80eab711e12304">tcpEV</a> &lt;&lt; <span class="stringliteral">&quot;Connection &quot;</span>;
    <a class="code" href="_t_c_p_8h.html#a601325e92d65fe658c80eab711e12304">tcpEV</a> &lt;&lt; <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#adc50d816f66c74441b608b01ed4800c7">localAddr</a> &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3af4312fbe2cd46bb1be1daf65715258">localPort</a> &lt;&lt; <span class="stringliteral">&quot; to &quot;</span> &lt;&lt; <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ad54931b7375eb7b6e51ca9862cb0a714">remoteAddr</a> &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#aece396520a4675f35694895f37b35f88">remotePort</a>;
    <a class="code" href="_t_c_p_8h.html#a601325e92d65fe658c80eab711e12304">tcpEV</a> &lt;&lt; <span class="stringliteral">&quot;  on app[&quot;</span> &lt;&lt; <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ad04d1e9fb23f48cd53dcd7c411caea80">appGateIndex</a> &lt;&lt; <span class="stringliteral">&quot;],connId=&quot;</span> &lt;&lt; <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae6ce2bfc0b9aa9d110db13efe08b7a0e">connId</a>;
    <a class="code" href="_t_c_p_8h.html#a601325e92d65fe658c80eab711e12304">tcpEV</a> &lt;&lt; <span class="stringliteral">&quot;  in &quot;</span> &lt;&lt; <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ab991cf2680a63832310a4a56ac17972e">stateName</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>.getState());
    <a class="code" href="_t_c_p_8h.html#a601325e92d65fe658c80eab711e12304">tcpEV</a> &lt;&lt; <span class="stringliteral">&quot;  (ptr=0x&quot;</span> &lt;&lt; <span class="keyword">this</span> &lt;&lt; <span class="stringliteral">&quot;)\n&quot;</span>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a188549e7c936c8cad622c180d3200c69"></a><!-- doxytag: member="tcp_old::TCPConnection::printSegmentBrief" ref="a188549e7c936c8cad622c180d3200c69" args="(TCPSegment *tcpseg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a188549e7c936c8cad622c180d3200c69">TCPConnection::printSegmentBrief</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_t_c_p_segment.html">TCPSegment</a> *&#160;</td>
          <td class="paramname"><em>tcpseg</em></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Utility: prints important header fields </p>

<p>Definition at line <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00118">118</a> of file <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html">old/TCPConnectionUtil.cc</a>.</p>

<p>Referenced by <a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html#l00083">process_RCV_SEGMENT()</a>, <a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html#l00037">segmentArrivalWhileClosed()</a>, and <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00169">sendToIP()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="_t_c_p_8h.html#a601325e92d65fe658c80eab711e12304">tcpEV</a> &lt;&lt; <span class="stringliteral">&quot;.&quot;</span> &lt;&lt; tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#aca825ab6ff9fc98f52315c36254a66be">getSrcPort</a>() &lt;&lt; <span class="stringliteral">&quot; &gt; &quot;</span>;
    <a class="code" href="_t_c_p_8h.html#a601325e92d65fe658c80eab711e12304">tcpEV</a> &lt;&lt; <span class="stringliteral">&quot;.&quot;</span> &lt;&lt; tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a9120715e275fdb4745fa15b300236d9a">getDestPort</a>() &lt;&lt; <span class="stringliteral">&quot;: &quot;</span>;

    <span class="keywordflow">if</span> (tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#affebf261c9d4fc303151a484d61d8bb7">getSynBit</a>())  <a class="code" href="_t_c_p_8h.html#a601325e92d65fe658c80eab711e12304">tcpEV</a> &lt;&lt; (tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a8415708f568387985da223286a9e5bfa">getAckBit</a>() ? <span class="stringliteral">&quot;SYN+ACK &quot;</span> : <span class="stringliteral">&quot;SYN &quot;</span>);
    <span class="keywordflow">if</span> (tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#aa7615b353254cbd11ea14f03e80c55f6">getFinBit</a>())  <a class="code" href="_t_c_p_8h.html#a601325e92d65fe658c80eab711e12304">tcpEV</a> &lt;&lt; <span class="stringliteral">&quot;FIN(+ACK) &quot;</span>;
    <span class="keywordflow">if</span> (tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a606da99a84d95c74bb1626436b6e5e12">getRstBit</a>())  <a class="code" href="_t_c_p_8h.html#a601325e92d65fe658c80eab711e12304">tcpEV</a> &lt;&lt; (tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a8415708f568387985da223286a9e5bfa">getAckBit</a>() ? <span class="stringliteral">&quot;RST+ACK &quot;</span> : <span class="stringliteral">&quot;RST &quot;</span>);
    <span class="keywordflow">if</span> (tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a951517b397bea146bb642976521469d7">getPshBit</a>())  <a class="code" href="_t_c_p_8h.html#a601325e92d65fe658c80eab711e12304">tcpEV</a> &lt;&lt; <span class="stringliteral">&quot;PSH &quot;</span>;

    <span class="keywordflow">if</span> (tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a7d9f010b71e3bfa267873ab21195fb73">getPayloadLength</a>()&gt;0 || tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#affebf261c9d4fc303151a484d61d8bb7">getSynBit</a>())
    {
        <a class="code" href="_t_c_p_8h.html#a601325e92d65fe658c80eab711e12304">tcpEV</a> &lt;&lt; tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a0dafe41ef5a4306a4106fdb1e22b19e8">getSequenceNo</a>() &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a0dafe41ef5a4306a4106fdb1e22b19e8">getSequenceNo</a>()+tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a7d9f010b71e3bfa267873ab21195fb73">getPayloadLength</a>();
        <a class="code" href="_t_c_p_8h.html#a601325e92d65fe658c80eab711e12304">tcpEV</a> &lt;&lt; <span class="stringliteral">&quot;(&quot;</span> &lt;&lt; tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a7d9f010b71e3bfa267873ab21195fb73">getPayloadLength</a>() &lt;&lt; <span class="stringliteral">&quot;) &quot;</span>;
    }
    <span class="keywordflow">if</span> (tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a8415708f568387985da223286a9e5bfa">getAckBit</a>())  <a class="code" href="_t_c_p_8h.html#a601325e92d65fe658c80eab711e12304">tcpEV</a> &lt;&lt; <span class="stringliteral">&quot;ack &quot;</span> &lt;&lt; tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a853ab8ce8acfb5da053fa9ca24592ce8">getAckNo</a>() &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;
    <a class="code" href="_t_c_p_8h.html#a601325e92d65fe658c80eab711e12304">tcpEV</a> &lt;&lt; <span class="stringliteral">&quot;win &quot;</span> &lt;&lt; tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a8ef1b3d7dceadd931a331c121e55c556">getWindow</a>() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;
    <span class="keywordflow">if</span> (tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a31028187ac8cf1f844d389b0e56baf8b">getUrgBit</a>())  <a class="code" href="_t_c_p_8h.html#a601325e92d65fe658c80eab711e12304">tcpEV</a> &lt;&lt; <span class="stringliteral">&quot;urg &quot;</span> &lt;&lt; tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a03ba1de6fcc042310e77da13885ce0d0">getUrgentPointer</a>() &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="afb2189f1428627dcde1d1b0bfbc50833"></a><!-- doxytag: member="tcp_old::TCPConnection::process_ABORT" ref="afb2189f1428627dcde1d1b0bfbc50833" args="(TCPEventCode &amp;event, TCPCommand *tcpCommand, cMessage *msg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classtcp__old_1_1_t_c_p_connection.html#afb2189f1428627dcde1d1b0bfbc50833">TCPConnection::process_ABORT</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32">TCPEventCode</a> &amp;&#160;</td>
          <td class="paramname"><em>event</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_t_c_p_command.html">TCPCommand</a> *&#160;</td>
          <td class="paramname"><em>tcpCommand</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">cMessage *&#160;</td>
          <td class="paramname"><em>msg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="old_2_t_c_p_connection_event_proc_8cc_source.html#l00222">222</a> of file <a class="el" href="old_2_t_c_p_connection_event_proc_8cc_source.html">old/TCPConnectionEventProc.cc</a>.</p>

<p>Referenced by <a class="el" href="old_2_t_c_p_connection_base_8cc_source.html#l00245">processAppCommand()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keyword">delete</span> tcpCommand;
    <span class="keyword">delete</span> msg;

    <span class="comment">//</span>
    <span class="comment">// The ABORT event will automatically take the connection to the CLOSED</span>
    <span class="comment">// state, flush queues etc -- no need to do it here. Also, we don&#39;t need to</span>
    <span class="comment">// send notification to the user, they know what&#39;s going on.</span>
    <span class="comment">//</span>
    <span class="keywordflow">switch</span>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>.getState())
    {
        <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaa8b6438b06a8e3cd7537e09f9fb2f0d03">TCP_S_INIT</a>:
            opp_error(<span class="stringliteral">&quot;Error processing command ABORT: connection not open&quot;</span>);

        <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaaf96abc23364b3cdd51216d5cc9a4f3fc">TCP_S_SYN_RCVD</a>:
        <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaa3b4387f45a765235dfda0bf3111ba1c6">TCP_S_ESTABLISHED</a>:
        <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaa1366e9fbbf862cd3fdfa3ea08e641cb0">TCP_S_FIN_WAIT_1</a>:
        <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaaea07c6aa092a0b2e9141385fb4734797">TCP_S_FIN_WAIT_2</a>:
        <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaa3395b6fd6b4cf5d6165b37929d44eaa1">TCP_S_CLOSE_WAIT</a>:
            <span class="comment">//&quot;</span>
            <span class="comment">// Send a reset segment:</span>
            <span class="comment">//</span>
            <span class="comment">//   &lt;SEQ=SND.NXT&gt;&lt;CTL=RST&gt;</span>
            <span class="comment">//&quot;</span>
            <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#afa03f88fc4589249aefe6f828eed9dd6">sendRst</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#acab59efee35f446ab6310db804cd164d">snd_nxt</a>);
            <span class="keywordflow">break</span>;
    }

}
</pre></div>
</div>
</div>
<a class="anchor" id="a5aa9b20651a4c1f90772a7c02eacbf05"></a><!-- doxytag: member="tcp_old::TCPConnection::process_CLOSE" ref="a5aa9b20651a4c1f90772a7c02eacbf05" args="(TCPEventCode &amp;event, TCPCommand *tcpCommand, cMessage *msg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a5aa9b20651a4c1f90772a7c02eacbf05">TCPConnection::process_CLOSE</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32">TCPEventCode</a> &amp;&#160;</td>
          <td class="paramname"><em>event</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_t_c_p_command.html">TCPCommand</a> *&#160;</td>
          <td class="paramname"><em>tcpCommand</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">cMessage *&#160;</td>
          <td class="paramname"><em>msg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="old_2_t_c_p_connection_event_proc_8cc_source.html#l00161">161</a> of file <a class="el" href="old_2_t_c_p_connection_event_proc_8cc_source.html">old/TCPConnectionEventProc.cc</a>.</p>

<p>Referenced by <a class="el" href="old_2_t_c_p_connection_base_8cc_source.html#l00245">processAppCommand()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keyword">delete</span> tcpCommand;
    <span class="keyword">delete</span> msg;

    <span class="keywordflow">switch</span>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>.getState())
    {
        <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaa8b6438b06a8e3cd7537e09f9fb2f0d03">TCP_S_INIT</a>:
            opp_error(<span class="stringliteral">&quot;Error processing command CLOSE: connection not open&quot;</span>);

        <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaa8a809324e3edea6ff6800a639d7bcea2">TCP_S_LISTEN</a>:
            <span class="comment">// Nothing to do here</span>
            <span class="keywordflow">break</span>;

        <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaafde4b4cc43d59d14ba2cbf0bc3adb525">TCP_S_SYN_SENT</a>:
            <span class="comment">// Delete the TCB and return &quot;error:  closing&quot; responses to any</span>
            <span class="comment">// queued SENDs, or RECEIVEs.</span>
            <span class="keywordflow">break</span>;

        <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaaf96abc23364b3cdd51216d5cc9a4f3fc">TCP_S_SYN_RCVD</a>:
        <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaa3b4387f45a765235dfda0bf3111ba1c6">TCP_S_ESTABLISHED</a>:
        <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaa3395b6fd6b4cf5d6165b37929d44eaa1">TCP_S_CLOSE_WAIT</a>:
            <span class="comment">//</span>
            <span class="comment">// SYN_RCVD processing (ESTABLISHED and CLOSE_WAIT are similar):</span>
            <span class="comment">//&quot;</span>
            <span class="comment">// If no SENDs have been issued and there is no pending data to send,</span>
            <span class="comment">// then form a FIN segment and send it, and enter FIN-WAIT-1 state;</span>
            <span class="comment">// otherwise queue for processing after entering ESTABLISHED state.</span>
            <span class="comment">//&quot;</span>
            <span class="keywordflow">if</span> (<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a7589e90fe54f9579ab547d55760b4d17">snd_max</a>==<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a7bd9b6b2b4422771b92e00d307983d19">sendQueue</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_send_queue.html#addf53d15d095b683486ca61554dccae3">getBufferEndSeq</a>())
            {
                <a class="code" href="_t_c_p_8h.html#a601325e92d65fe658c80eab711e12304">tcpEV</a> &lt;&lt; <span class="stringliteral">&quot;No outstanding SENDs, sending FIN right away, advancing snd_nxt over the FIN\n&quot;</span>;
                <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#acab59efee35f446ab6310db804cd164d">snd_nxt</a> = <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a7589e90fe54f9579ab547d55760b4d17">snd_max</a>;
                <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a70acf513d8461c73bfd06037036b1682">sendFin</a>();
                <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a2212cb0deb11d2b1c5826cab57b3f42e">tcpAlgorithm</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_algorithm.html#aceb0701fa06010324266e6a8192cce9f">restartRexmitTimer</a>();
                <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a7589e90fe54f9579ab547d55760b4d17">snd_max</a> = ++<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#acab59efee35f446ab6310db804cd164d">snd_nxt</a>;
                <span class="keywordflow">if</span> (<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a529775c184153f33ff75a91bacc8b0fc">unackedVector</a>) <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a529775c184153f33ff75a91bacc8b0fc">unackedVector</a>-&gt;record(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a7589e90fe54f9579ab547d55760b4d17">snd_max</a> - <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#ace4a453b30bdffb99c1c0646fba597dc">snd_una</a>);

                <span class="comment">// state transition will automatically take us to FIN_WAIT_1 (or LAST_ACK)</span>
            }
            <span class="keywordflow">else</span>
            {
                <a class="code" href="_t_c_p_8h.html#a601325e92d65fe658c80eab711e12304">tcpEV</a> &lt;&lt; <span class="stringliteral">&quot;SEND of &quot;</span> &lt;&lt; (<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a7bd9b6b2b4422771b92e00d307983d19">sendQueue</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_send_queue.html#addf53d15d095b683486ca61554dccae3">getBufferEndSeq</a>()-<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a7589e90fe54f9579ab547d55760b4d17">snd_max</a>) &lt;&lt;
                      <span class="stringliteral">&quot; bytes pending, deferring sending of FIN\n&quot;</span>;
                <span class="keyword">event</span> = <a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32acd405552b4f4c9973d5d5b7e8aae88f5">TCP_E_IGNORE</a>;
            }
            <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a2a8d544b5707071afcc5402e6318e245">send_fin</a> = <span class="keyword">true</span>;
            <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a1156c4cdd71d0e83c9bb401a68e9f606">snd_fin_seq</a> = <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a7bd9b6b2b4422771b92e00d307983d19">sendQueue</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_send_queue.html#addf53d15d095b683486ca61554dccae3">getBufferEndSeq</a>();
            <span class="keywordflow">break</span>;

        <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaa1366e9fbbf862cd3fdfa3ea08e641cb0">TCP_S_FIN_WAIT_1</a>:
        <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaaea07c6aa092a0b2e9141385fb4734797">TCP_S_FIN_WAIT_2</a>:
        <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaacdbad950a89de6fc964c3257d45e07a9">TCP_S_CLOSING</a>:
        <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaaac5147b505ddf6bb15d84853242bcfdf">TCP_S_LAST_ACK</a>:
        <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaa8a4fa6fa69c727999ad6b8fe056a6fd1">TCP_S_TIME_WAIT</a>:
            <span class="comment">// RFC 793 is not entirely clear on how to handle a duplicate close request.</span>
            <span class="comment">// Here we treat it as an error.</span>
            opp_error(<span class="stringliteral">&quot;Duplicate CLOSE command: connection already closing&quot;</span>);
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a6ef625498d593ac11744aa92a404e06d"></a><!-- doxytag: member="tcp_old::TCPConnection::process_OPEN_ACTIVE" ref="a6ef625498d593ac11744aa92a404e06d" args="(TCPEventCode &amp;event, TCPCommand *tcpCommand, cMessage *msg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a6ef625498d593ac11744aa92a404e06d">TCPConnection::process_OPEN_ACTIVE</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32">TCPEventCode</a> &amp;&#160;</td>
          <td class="paramname"><em>event</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_t_c_p_command.html">TCPCommand</a> *&#160;</td>
          <td class="paramname"><em>tcpCommand</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">cMessage *&#160;</td>
          <td class="paramname"><em>msg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="old_2_t_c_p_connection_event_proc_8cc_source.html#l00034">34</a> of file <a class="el" href="old_2_t_c_p_connection_event_proc_8cc_source.html">old/TCPConnectionEventProc.cc</a>.</p>

<p>Referenced by <a class="el" href="old_2_t_c_p_connection_base_8cc_source.html#l00245">processAppCommand()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="class_t_c_p_open_command.html">TCPOpenCommand</a> *openCmd = check_and_cast&lt;<a class="code" href="class_t_c_p_open_command.html">TCPOpenCommand</a> *&gt;(tcpCommand);
    <a class="code" href="class_i_pv_x_address.html">IPvXAddress</a> <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#adc50d816f66c74441b608b01ed4800c7">localAddr</a>, <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ad54931b7375eb7b6e51ca9862cb0a714">remoteAddr</a>;
    <span class="keywordtype">int</span> <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3af4312fbe2cd46bb1be1daf65715258">localPort</a>, <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#aece396520a4675f35694895f37b35f88">remotePort</a>;

    <span class="keywordflow">switch</span>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>.getState())
    {
        <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaa8b6438b06a8e3cd7537e09f9fb2f0d03">TCP_S_INIT</a>:
            <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a69caa8ea0ffbe8d9f73f935aac1b29d9">initConnection</a>(openCmd);

            <span class="comment">// store local/remote socket</span>
            <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#afba4a9f34c546c37533eb5311c1da682">active</a> = <span class="keyword">true</span>;
            localAddr = openCmd-&gt;<a class="code" href="class_t_c_p_open_command.html#a8df2394c15fc7fb872491275d9db03b4">getLocalAddr</a>();
            remoteAddr = openCmd-&gt;<a class="code" href="class_t_c_p_open_command.html#a9e602467cc21c7c3a2ea9aae64f1319e">getRemoteAddr</a>();
            localPort = openCmd-&gt;<a class="code" href="class_t_c_p_open_command.html#a8d1ced9e8f5355c77266673e7a2fc35f">getLocalPort</a>();
            remotePort = openCmd-&gt;<a class="code" href="class_t_c_p_open_command.html#a4d1170bbd04519d8b8f37677ba512f35">getRemotePort</a>();

            <span class="keywordflow">if</span> (remoteAddr.isUnspecified() || remotePort==-1)
                opp_error(<span class="stringliteral">&quot;Error processing command OPEN_ACTIVE: remote address and port must be specified&quot;</span>);

            <span class="keywordflow">if</span> (localPort==-1)
            {
                localPort = <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a6f9eb8f2af118d2f1fcd90df3c87249e">tcpMain</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p.html#af6a465c04eb9301ac7627d6922564e72">getEphemeralPort</a>();
                <a class="code" href="_t_c_p_8h.html#a601325e92d65fe658c80eab711e12304">tcpEV</a> &lt;&lt; <span class="stringliteral">&quot;Assigned ephemeral port &quot;</span> &lt;&lt; localPort &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;
            }

            <a class="code" href="_t_c_p_8h.html#a601325e92d65fe658c80eab711e12304">tcpEV</a> &lt;&lt; <span class="stringliteral">&quot;OPEN: &quot;</span> &lt;&lt; localAddr &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; localPort &lt;&lt; <span class="stringliteral">&quot; --&gt; &quot;</span> &lt;&lt; remoteAddr &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; remotePort &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;

            <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a6f9eb8f2af118d2f1fcd90df3c87249e">tcpMain</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p.html#a0521bf14a4f31786b1869f417d56eecb">addSockPair</a>(<span class="keyword">this</span>, localAddr, remoteAddr, localPort, remotePort);

            <span class="comment">// send initial SYN</span>
            <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a585bbcdd70565eb01b6bfe17a1487c78">selectInitialSeqNum</a>();
            <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#abcd8f7efecc7c0077050184d3384b493">sendSyn</a>();
            <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#aa58f44bc38ec0af46aca654f9403771f">startSynRexmitTimer</a>();
            <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae1ff44c73d20293a446adc091842bedd">scheduleTimeout</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a757386355261e95064b75f2dfec3788e">connEstabTimer</a>, <a class="code" href="_t_c_p_connection_8h.html#a512458671be6d68703cc89178b0b35f0">TCP_TIMEOUT_CONN_ESTAB</a>);
            <span class="keywordflow">break</span>;

        <span class="keywordflow">default</span>:
            opp_error(<span class="stringliteral">&quot;Error processing command OPEN_ACTIVE: connection already exists&quot;</span>);
    }

    <span class="keyword">delete</span> openCmd;
    <span class="keyword">delete</span> msg;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a26e4a86dfbc1efaf02e99ea14d410ae3"></a><!-- doxytag: member="tcp_old::TCPConnection::process_OPEN_PASSIVE" ref="a26e4a86dfbc1efaf02e99ea14d410ae3" args="(TCPEventCode &amp;event, TCPCommand *tcpCommand, cMessage *msg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a26e4a86dfbc1efaf02e99ea14d410ae3">TCPConnection::process_OPEN_PASSIVE</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32">TCPEventCode</a> &amp;&#160;</td>
          <td class="paramname"><em>event</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_t_c_p_command.html">TCPCommand</a> *&#160;</td>
          <td class="paramname"><em>tcpCommand</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">cMessage *&#160;</td>
          <td class="paramname"><em>msg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="old_2_t_c_p_connection_event_proc_8cc_source.html#l00080">80</a> of file <a class="el" href="old_2_t_c_p_connection_event_proc_8cc_source.html">old/TCPConnectionEventProc.cc</a>.</p>

<p>Referenced by <a class="el" href="old_2_t_c_p_connection_base_8cc_source.html#l00245">processAppCommand()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="class_t_c_p_open_command.html">TCPOpenCommand</a> *openCmd = check_and_cast&lt;<a class="code" href="class_t_c_p_open_command.html">TCPOpenCommand</a> *&gt;(tcpCommand);
    <a class="code" href="class_i_pv_x_address.html">IPvXAddress</a> <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#adc50d816f66c74441b608b01ed4800c7">localAddr</a>;
    <span class="keywordtype">int</span> <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3af4312fbe2cd46bb1be1daf65715258">localPort</a>;

    <span class="keywordflow">switch</span>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>.getState())
    {
        <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaa8b6438b06a8e3cd7537e09f9fb2f0d03">TCP_S_INIT</a>:
            <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a69caa8ea0ffbe8d9f73f935aac1b29d9">initConnection</a>(openCmd);

            <span class="comment">// store local/remote socket</span>
            <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#afba4a9f34c546c37533eb5311c1da682">active</a> = <span class="keyword">false</span>;
            <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a4f418e2320cca13bdf3a673ae74989ac">fork</a> = openCmd-&gt;<a class="code" href="class_t_c_p_open_command.html#a719c5eb06ab9b7a819285fd2052aac9c">getFork</a>();
            localAddr = openCmd-&gt;<a class="code" href="class_t_c_p_open_command.html#a8df2394c15fc7fb872491275d9db03b4">getLocalAddr</a>();
            localPort = openCmd-&gt;<a class="code" href="class_t_c_p_open_command.html#a8d1ced9e8f5355c77266673e7a2fc35f">getLocalPort</a>();

            <span class="keywordflow">if</span> (localPort==-1)
                opp_error(<span class="stringliteral">&quot;Error processing command OPEN_PASSIVE: local port must be specified&quot;</span>);

            <a class="code" href="_t_c_p_8h.html#a601325e92d65fe658c80eab711e12304">tcpEV</a> &lt;&lt; <span class="stringliteral">&quot;Starting to listen on: &quot;</span> &lt;&lt; localAddr &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; localPort &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;

            <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a6f9eb8f2af118d2f1fcd90df3c87249e">tcpMain</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p.html#a0521bf14a4f31786b1869f417d56eecb">addSockPair</a>(<span class="keyword">this</span>, localAddr, <a class="code" href="class_i_pv_x_address.html">IPvXAddress</a>(), localPort, -1);
            <span class="keywordflow">break</span>;

        <span class="keywordflow">default</span>:
            opp_error(<span class="stringliteral">&quot;Error processing command OPEN_PASSIVE: connection already exists&quot;</span>);
    }

    <span class="keyword">delete</span> openCmd;
    <span class="keyword">delete</span> msg;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a46ac1b09624942471db2eb76ef991143"></a><!-- doxytag: member="tcp_old::TCPConnection::process_RCV_SEGMENT" ref="a46ac1b09624942471db2eb76ef991143" args="(TCPSegment *tcpseg, IPvXAddress src, IPvXAddress dest)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32">TCPEventCode</a> <a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a46ac1b09624942471db2eb76ef991143">TCPConnection::process_RCV_SEGMENT</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_t_c_p_segment.html">TCPSegment</a> *&#160;</td>
          <td class="paramname"><em>tcpseg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_i_pv_x_address.html">IPvXAddress</a>&#160;</td>
          <td class="paramname"><em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_i_pv_x_address.html">IPvXAddress</a>&#160;</td>
          <td class="paramname"><em>dest</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Process incoming <a class="el" href="classtcp__old_1_1_t_c_p.html">TCP</a> segment. Returns a specific event code (e.g. TCP_E_RCV_SYN) which will drive the state machine. </p>

<p>Definition at line <a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html#l00083">83</a> of file <a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html">old/TCPConnectionRcvSegment.cc</a>.</p>

<p>Referenced by <a class="el" href="old_2_t_c_p_connection_base_8cc_source.html#l00221">processTCPSegment()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="_t_c_p_8h.html#a601325e92d65fe658c80eab711e12304">tcpEV</a> &lt;&lt; <span class="stringliteral">&quot;Seg arrived: &quot;</span>;
    <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a188549e7c936c8cad622c180d3200c69">printSegmentBrief</a>(tcpseg);
    <a class="code" href="_t_c_p_8h.html#a601325e92d65fe658c80eab711e12304">tcpEV</a> &lt;&lt; <span class="stringliteral">&quot;TCB: &quot;</span> &lt;&lt; <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a93fbf3558fe0e1dfa27bdbab25c36aff">info</a>() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;

    <span class="keywordflow">if</span> (<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#acb4230bb789e0bf3e413479e26316d60">rcvSeqVector</a>) <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#acb4230bb789e0bf3e413479e26316d60">rcvSeqVector</a>-&gt;record(tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a0dafe41ef5a4306a4106fdb1e22b19e8">getSequenceNo</a>());
    <span class="keywordflow">if</span> (<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a7b6c1fcdd10a035c035dea350420286d">rcvAckVector</a>) <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a7b6c1fcdd10a035c035dea350420286d">rcvAckVector</a>-&gt;record(tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a853ab8ce8acfb5da053fa9ca24592ce8">getAckNo</a>());

    <span class="comment">//</span>
    <span class="comment">// Note: this code is organized exactly as RFC 793, section &quot;3.9 Event</span>
    <span class="comment">// Processing&quot;, subsection &quot;SEGMENT ARRIVES&quot;.</span>
    <span class="comment">//</span>
    <a class="code" href="_t_c_p_connection_8h.html#a9187fb8d597fec5e53124ffe46c7e85e">TCPEventCode</a> <a class="code" href="namespacecesnet.html#a56e29c69128db750fc49a508a16cf7ba">event</a>;
    <span class="keywordflow">if</span> (<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>.getState()==<a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaa8a809324e3edea6ff6800a639d7bcea2">TCP_S_LISTEN</a>)
    {
        <span class="keyword">event</span> = <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a4d034577df86997140d627feeda66a1f">processSegmentInListen</a>(tcpseg, src, dest);
    }
    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>.getState()==<a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaafde4b4cc43d59d14ba2cbf0bc3adb525">TCP_S_SYN_SENT</a>)
    {
        <span class="keyword">event</span> = <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a12b903f9e148f5c26f926dcdc8107c86">processSegmentInSynSent</a>(tcpseg, src, dest);
    }
    <span class="keywordflow">else</span>
    {
        <span class="comment">// RFC 793 steps &quot;first check sequence number&quot;, &quot;second check the RST bit&quot;, etc</span>
        <span class="keyword">event</span> = <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#aa0758284e5bd6bd162b6ff267add2e2d">processSegment1stThru8th</a>(tcpseg);
    }
    <span class="keyword">delete</span> tcpseg;
    <span class="keywordflow">return</span> <a class="code" href="namespacecesnet.html#a56e29c69128db750fc49a508a16cf7ba">event</a>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a65fa8d6570761c63cdab5cef7f5df685"></a><!-- doxytag: member="tcp_old::TCPConnection::process_SEND" ref="a65fa8d6570761c63cdab5cef7f5df685" args="(TCPEventCode &amp;event, TCPCommand *tcpCommand, cMessage *msg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a65fa8d6570761c63cdab5cef7f5df685">TCPConnection::process_SEND</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32">TCPEventCode</a> &amp;&#160;</td>
          <td class="paramname"><em>event</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_t_c_p_command.html">TCPCommand</a> *&#160;</td>
          <td class="paramname"><em>tcpCommand</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">cMessage *&#160;</td>
          <td class="paramname"><em>msg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="old_2_t_c_p_connection_event_proc_8cc_source.html#l00113">113</a> of file <a class="el" href="old_2_t_c_p_connection_event_proc_8cc_source.html">old/TCPConnectionEventProc.cc</a>.</p>

<p>Referenced by <a class="el" href="old_2_t_c_p_connection_base_8cc_source.html#l00245">processAppCommand()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="class_t_c_p_send_command.html">TCPSendCommand</a> *sendCommand = check_and_cast&lt;<a class="code" href="class_t_c_p_send_command.html">TCPSendCommand</a> *&gt;(tcpCommand);

    <span class="comment">// FIXME how to support PUSH? One option is to treat each SEND as a unit of data,</span>
    <span class="comment">// and set PSH at SEND boundaries</span>
    <span class="keywordflow">switch</span>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>.getState())
    {
        <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaa8b6438b06a8e3cd7537e09f9fb2f0d03">TCP_S_INIT</a>:
            opp_error(<span class="stringliteral">&quot;Error processing command SEND: connection not open&quot;</span>);

        <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaa8a809324e3edea6ff6800a639d7bcea2">TCP_S_LISTEN</a>:
            <a class="code" href="_t_c_p_8h.html#a601325e92d65fe658c80eab711e12304">tcpEV</a> &lt;&lt; <span class="stringliteral">&quot;SEND command turns passive open into active open, sending initial SYN\n&quot;</span>;
            <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#afba4a9f34c546c37533eb5311c1da682">active</a> = <span class="keyword">true</span>;
            <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a585bbcdd70565eb01b6bfe17a1487c78">selectInitialSeqNum</a>();
            <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#abcd8f7efecc7c0077050184d3384b493">sendSyn</a>();
            <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#aa58f44bc38ec0af46aca654f9403771f">startSynRexmitTimer</a>();
            <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae1ff44c73d20293a446adc091842bedd">scheduleTimeout</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a757386355261e95064b75f2dfec3788e">connEstabTimer</a>, <a class="code" href="_t_c_p_connection_8h.html#a512458671be6d68703cc89178b0b35f0">TCP_TIMEOUT_CONN_ESTAB</a>);
            <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a7bd9b6b2b4422771b92e00d307983d19">sendQueue</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_send_queue.html#a8f1b685a3f9020032805d119adb3089a">enqueueAppData</a>(<a class="code" href="_i_n_e_t_defs_8h.html#ae5b816f7de3c5248c812bdb6920f4e06">PK</a>(msg));  <span class="comment">// queue up for later</span>
            <a class="code" href="_t_c_p_8h.html#a601325e92d65fe658c80eab711e12304">tcpEV</a> &lt;&lt; <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a7bd9b6b2b4422771b92e00d307983d19">sendQueue</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_send_queue.html#acf03e0bbf6565ae7df7afa656d97ca18">getBytesAvailable</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#ace4a453b30bdffb99c1c0646fba597dc">snd_una</a>) &lt;&lt; <span class="stringliteral">&quot; bytes in queue\n&quot;</span>;
            <span class="keywordflow">break</span>;

        <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaaf96abc23364b3cdd51216d5cc9a4f3fc">TCP_S_SYN_RCVD</a>:
        <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaafde4b4cc43d59d14ba2cbf0bc3adb525">TCP_S_SYN_SENT</a>:
            <a class="code" href="_t_c_p_8h.html#a601325e92d65fe658c80eab711e12304">tcpEV</a> &lt;&lt; <span class="stringliteral">&quot;Queueing up data for sending later.\n&quot;</span>;
            <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a7bd9b6b2b4422771b92e00d307983d19">sendQueue</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_send_queue.html#a8f1b685a3f9020032805d119adb3089a">enqueueAppData</a>(<a class="code" href="_i_n_e_t_defs_8h.html#ae5b816f7de3c5248c812bdb6920f4e06">PK</a>(msg)); <span class="comment">// queue up for later</span>
            <a class="code" href="_t_c_p_8h.html#a601325e92d65fe658c80eab711e12304">tcpEV</a> &lt;&lt; <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a7bd9b6b2b4422771b92e00d307983d19">sendQueue</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_send_queue.html#acf03e0bbf6565ae7df7afa656d97ca18">getBytesAvailable</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#ace4a453b30bdffb99c1c0646fba597dc">snd_una</a>) &lt;&lt; <span class="stringliteral">&quot; bytes in queue\n&quot;</span>;
            <span class="keywordflow">break</span>;

        <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaa3b4387f45a765235dfda0bf3111ba1c6">TCP_S_ESTABLISHED</a>:
        <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaa3395b6fd6b4cf5d6165b37929d44eaa1">TCP_S_CLOSE_WAIT</a>:
            <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a7bd9b6b2b4422771b92e00d307983d19">sendQueue</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_send_queue.html#a8f1b685a3f9020032805d119adb3089a">enqueueAppData</a>(<a class="code" href="_i_n_e_t_defs_8h.html#ae5b816f7de3c5248c812bdb6920f4e06">PK</a>(msg));
            <a class="code" href="_t_c_p_8h.html#a601325e92d65fe658c80eab711e12304">tcpEV</a> &lt;&lt; <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a7bd9b6b2b4422771b92e00d307983d19">sendQueue</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_send_queue.html#acf03e0bbf6565ae7df7afa656d97ca18">getBytesAvailable</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#ace4a453b30bdffb99c1c0646fba597dc">snd_una</a>) &lt;&lt; <span class="stringliteral">&quot; bytes in queue, plus &quot;</span>
                  &lt;&lt; (<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a7589e90fe54f9579ab547d55760b4d17">snd_max</a>-<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#ace4a453b30bdffb99c1c0646fba597dc">snd_una</a>) &lt;&lt; <span class="stringliteral">&quot; bytes unacknowledged\n&quot;</span>;
            <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a2212cb0deb11d2b1c5826cab57b3f42e">tcpAlgorithm</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_algorithm.html#ae85b3610dd8b6f93018265812e9eaa74">sendCommandInvoked</a>();
            <span class="keywordflow">break</span>;

        <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaaac5147b505ddf6bb15d84853242bcfdf">TCP_S_LAST_ACK</a>:
        <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaa1366e9fbbf862cd3fdfa3ea08e641cb0">TCP_S_FIN_WAIT_1</a>:
        <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaaea07c6aa092a0b2e9141385fb4734797">TCP_S_FIN_WAIT_2</a>:
        <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaacdbad950a89de6fc964c3257d45e07a9">TCP_S_CLOSING</a>:
        <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaa8a4fa6fa69c727999ad6b8fe056a6fd1">TCP_S_TIME_WAIT</a>:
            opp_error(<span class="stringliteral">&quot;Error processing command SEND: connection closing&quot;</span>);
    }

    <span class="keyword">delete</span> sendCommand; <span class="comment">// msg itself has been taken by the sendQueue</span>
}
</pre></div>
</div>
</div>
<a class="anchor" id="a519a2b6612737fbdbd5641dfa33833e8"></a><!-- doxytag: member="tcp_old::TCPConnection::process_STATUS" ref="a519a2b6612737fbdbd5641dfa33833e8" args="(TCPEventCode &amp;event, TCPCommand *tcpCommand, cMessage *msg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a519a2b6612737fbdbd5641dfa33833e8">TCPConnection::process_STATUS</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32">TCPEventCode</a> &amp;&#160;</td>
          <td class="paramname"><em>event</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_t_c_p_command.html">TCPCommand</a> *&#160;</td>
          <td class="paramname"><em>tcpCommand</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">cMessage *&#160;</td>
          <td class="paramname"><em>msg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="old_2_t_c_p_connection_event_proc_8cc_source.html#l00253">253</a> of file <a class="el" href="old_2_t_c_p_connection_event_proc_8cc_source.html">old/TCPConnectionEventProc.cc</a>.</p>

<p>Referenced by <a class="el" href="old_2_t_c_p_connection_base_8cc_source.html#l00245">processAppCommand()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keyword">delete</span> tcpCommand; <span class="comment">// but reuse msg for reply</span>

    <span class="keywordflow">if</span> (<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>.getState()==<a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaa8b6438b06a8e3cd7537e09f9fb2f0d03">TCP_S_INIT</a>)
        opp_error(<span class="stringliteral">&quot;Error processing command STATUS: connection not open&quot;</span>);

    <a class="code" href="class_t_c_p_status_info.html">TCPStatusInfo</a> *statusInfo = <span class="keyword">new</span> <a class="code" href="class_t_c_p_status_info.html">TCPStatusInfo</a>();

    statusInfo-&gt;<a class="code" href="class_t_c_p_status_info.html#a24f027e8f8c828d07ba34a9d1ee1237d">setState</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>.getState());
    statusInfo-&gt;<a class="code" href="class_t_c_p_status_info.html#a12cfc90b941d5215043a291413e8277f">setStateName</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ab991cf2680a63832310a4a56ac17972e">stateName</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>.getState()));

    statusInfo-&gt;<a class="code" href="class_t_c_p_status_info.html#a7ff9fc644d45db5c26bf9f4fdc4ab3d2">setLocalAddr</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#adc50d816f66c74441b608b01ed4800c7">localAddr</a>);
    statusInfo-&gt;<a class="code" href="class_t_c_p_status_info.html#aa47c84165605360f5201d75f374dc5a7">setRemoteAddr</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ad54931b7375eb7b6e51ca9862cb0a714">remoteAddr</a>);
    statusInfo-&gt;<a class="code" href="class_t_c_p_status_info.html#a22548d30e15e8a6fecef3a829c1e1800">setLocalPort</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3af4312fbe2cd46bb1be1daf65715258">localPort</a>);
    statusInfo-&gt;<a class="code" href="class_t_c_p_status_info.html#abfa134c8b8cab03ddef409b590fc9d9f">setRemotePort</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#aece396520a4675f35694895f37b35f88">remotePort</a>);

    statusInfo-&gt;<a class="code" href="class_t_c_p_status_info.html#a38901692bd10d24cae1f72162afa4bc8">setSnd_mss</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#aa63003ec3568a869469e95d848e836b7">snd_mss</a>);
    statusInfo-&gt;<a class="code" href="class_t_c_p_status_info.html#a7226f3ca5e71329f278a6364d1c8100b">setSnd_una</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#ace4a453b30bdffb99c1c0646fba597dc">snd_una</a>);
    statusInfo-&gt;<a class="code" href="class_t_c_p_status_info.html#a38d0282195369206c8ab212fbe4a89d8">setSnd_nxt</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#acab59efee35f446ab6310db804cd164d">snd_nxt</a>);
    statusInfo-&gt;<a class="code" href="class_t_c_p_status_info.html#a0cd1d87e26cab29a9e58c23b3db75b24">setSnd_max</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a7589e90fe54f9579ab547d55760b4d17">snd_max</a>);
    statusInfo-&gt;<a class="code" href="class_t_c_p_status_info.html#a7bad64c3d88a5150d2309feb6b84e98d">setSnd_wnd</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a98ce75b56709cdf80549bf95b9b02023">snd_wnd</a>);
    statusInfo-&gt;<a class="code" href="class_t_c_p_status_info.html#a8b2febc07fbbe25974a55cbed3cbaaab">setSnd_up</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a21d3e1fb8154ba3b4fc42e7f5dcbb784">snd_up</a>);
    statusInfo-&gt;<a class="code" href="class_t_c_p_status_info.html#a59db66f7500966c34a9d592bc6a0f55e">setSnd_wl1</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a4ddf055ba61bab9723814bfb1f55cfe5">snd_wl1</a>);
    statusInfo-&gt;<a class="code" href="class_t_c_p_status_info.html#a22bd2fcc4560b841e34457dc30a0ca92">setSnd_wl2</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#aae32069f7798da55852c7244d816b9a1">snd_wl2</a>);
    statusInfo-&gt;<a class="code" href="class_t_c_p_status_info.html#a54c26e74c8766835c2cd72c859b495ab">setIss</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a74b7f93c1777b2428f37a7b8d2d8a5a4">iss</a>);
    statusInfo-&gt;<a class="code" href="class_t_c_p_status_info.html#ac69f0974fe88c92a3bf1341516bbdcf5">setRcv_nxt</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a18b8a2c7e52c332378bd9f70b1d91b29">rcv_nxt</a>);
    statusInfo-&gt;<a class="code" href="class_t_c_p_status_info.html#a352dcfb92726d2d563697b4fe1c25b2c">setRcv_wnd</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#ab26a1e5c5f13a245ef7578dc87e81cfe">rcv_wnd</a>);
    statusInfo-&gt;<a class="code" href="class_t_c_p_status_info.html#ae359dc5ba84dd6d3ca6e0402f5fb0e41">setRcv_up</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a9ac465cf0b2699f5b5ec86d7b2811b33">rcv_up</a>);
    statusInfo-&gt;<a class="code" href="class_t_c_p_status_info.html#ae3fbfa1d1069884033f622354b0fb9e5">setIrs</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#af9fc103c0361bcaffc4c894627abfc2d">irs</a>);
    statusInfo-&gt;<a class="code" href="class_t_c_p_status_info.html#acddbd320182fcf2385938df79b9d0190">setFin_ack_rcvd</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#ad2deb1000d47f2e1524f1f5dee059b34">fin_ack_rcvd</a>);

    msg-&gt;setControlInfo(statusInfo);
    <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a6aa48826843116a0f5c4e0fa37a69cfc">sendToApp</a>(msg);
}
</pre></div>
</div>
</div>
<a class="anchor" id="ae29072ef963e593c4c3053827ebbec6e"></a><!-- doxytag: member="tcp_old::TCPConnection::process_TIMEOUT_2MSL" ref="ae29072ef963e593c4c3053827ebbec6e" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classtcp__old_1_1_t_c_p_connection.html#ae29072ef963e593c4c3053827ebbec6e">TCPConnection::process_TIMEOUT_2MSL</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html#l01079">1079</a> of file <a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html">old/TCPConnectionRcvSegment.cc</a>.</p>

<p>Referenced by <a class="el" href="old_2_t_c_p_connection_base_8cc_source.html#l00184">processTimer()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="comment">//&quot;</span>
    <span class="comment">// If the time-wait timeout expires on a connection delete the TCB,</span>
    <span class="comment">// enter the CLOSED state and return.</span>
    <span class="comment">//&quot;</span>
    <span class="keywordflow">switch</span>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>.getState())
    {
        <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaa8a4fa6fa69c727999ad6b8fe056a6fd1">TCP_S_TIME_WAIT</a>:
            <span class="comment">// Nothing to do here. The TIMEOUT_2MSL event will automatically take</span>
            <span class="comment">// the connection to CLOSED. We already notified the user</span>
            <span class="comment">// (TCP_I_CLOSED) when we entered the TIME_WAIT state from CLOSING,</span>
            <span class="comment">// FIN_WAIT_1 or FIN_WAIT_2.</span>
            <span class="keywordflow">break</span>;
        <span class="keywordflow">default</span>:
            <span class="comment">// We should not receive this timeout in this state.</span>
            opp_error(<span class="stringliteral">&quot;Internal error: received time-wait (2MSL) timeout in state %s&quot;</span>, <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ab991cf2680a63832310a4a56ac17972e">stateName</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>.getState()));
    }

}
</pre></div>
</div>
</div>
<a class="anchor" id="a7b47d21fa8a97f13cab52097f3332ea6"></a><!-- doxytag: member="tcp_old::TCPConnection::process_TIMEOUT_CONN_ESTAB" ref="a7b47d21fa8a97f13cab52097f3332ea6" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a7b47d21fa8a97f13cab52097f3332ea6">TCPConnection::process_TIMEOUT_CONN_ESTAB</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html#l01059">1059</a> of file <a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html">old/TCPConnectionRcvSegment.cc</a>.</p>

<p>Referenced by <a class="el" href="old_2_t_c_p_connection_base_8cc_source.html#l00184">processTimer()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordflow">switch</span>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>.getState())
    {
        <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaaf96abc23364b3cdd51216d5cc9a4f3fc">TCP_S_SYN_RCVD</a>:
        <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaafde4b4cc43d59d14ba2cbf0bc3adb525">TCP_S_SYN_SENT</a>:
            <span class="comment">// Nothing to do here. TIMEOUT_CONN_ESTAB event will automatically</span>
            <span class="comment">// take the connection to LISTEN or CLOSED, and cancel SYN-REXMIT timer.</span>
            <span class="keywordflow">if</span> (<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#afba4a9f34c546c37533eb5311c1da682">active</a>)
            {
                <span class="comment">// notify user if we&#39;re on the active side</span>
                <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a65a8dc93c08a685f145248d0fb327428">sendIndicationToApp</a>(<a class="code" href="_t_c_p_command__m_8h.html#a68611fc79dbc74e8744d74b746cd956ba06629e44a0aef5201b4cd424596127bf">TCP_I_TIMED_OUT</a>);
            }
            <span class="keywordflow">break</span>;
        <span class="keywordflow">default</span>:
            <span class="comment">// We should not receive this timeout in this state.</span>
            opp_error(<span class="stringliteral">&quot;Internal error: received CONN_ESTAB timeout in state %s&quot;</span>, <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ab991cf2680a63832310a4a56ac17972e">stateName</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>.getState()));
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a53d62d237307ad56bae8d320ff557e48"></a><!-- doxytag: member="tcp_old::TCPConnection::process_TIMEOUT_FIN_WAIT_2" ref="a53d62d237307ad56bae8d320ff557e48" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a53d62d237307ad56bae8d320ff557e48">TCPConnection::process_TIMEOUT_FIN_WAIT_2</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html#l01100">1100</a> of file <a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html">old/TCPConnectionRcvSegment.cc</a>.</p>

<p>Referenced by <a class="el" href="old_2_t_c_p_connection_base_8cc_source.html#l00184">processTimer()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordflow">switch</span>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>.getState())
    {
        <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaaea07c6aa092a0b2e9141385fb4734797">TCP_S_FIN_WAIT_2</a>:
            <span class="comment">// Nothing to do here. The TIMEOUT_FIN_WAIT_2 event will automatically take</span>
            <span class="comment">// the connection to CLOSED.</span>
            <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a65a8dc93c08a685f145248d0fb327428">sendIndicationToApp</a>(<a class="code" href="_t_c_p_command__m_8h.html#a68611fc79dbc74e8744d74b746cd956ba994690e6a29c6e7c3eedc8fbb29d7a8c">TCP_I_CLOSED</a>);
            <span class="keywordflow">break</span>;
        <span class="keywordflow">default</span>:
            <span class="comment">// We should not receive this timeout in this state.</span>
            opp_error(<span class="stringliteral">&quot;Internal error: received FIN_WAIT_2 timeout in state %s&quot;</span>, <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ab991cf2680a63832310a4a56ac17972e">stateName</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>.getState()));
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a33c6fe420de8b7fc6c09761f70118ed0"></a><!-- doxytag: member="tcp_old::TCPConnection::process_TIMEOUT_SYN_REXMIT" ref="a33c6fe420de8b7fc6c09761f70118ed0" args="(TCPEventCode &amp;event)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a33c6fe420de8b7fc6c09761f70118ed0">TCPConnection::process_TIMEOUT_SYN_REXMIT</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32">TCPEventCode</a> &amp;&#160;</td>
          <td class="paramname"><em>event</em></td><td>)</td>
          <td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html#l01125">1125</a> of file <a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html">old/TCPConnectionRcvSegment.cc</a>.</p>

<p>Referenced by <a class="el" href="old_2_t_c_p_connection_base_8cc_source.html#l00184">processTimer()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordflow">if</span> (++<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#add0426103a74138a0599e58049526e8a">syn_rexmit_count</a>&gt;<a class="code" href="_t_c_p_connection_8h.html#acd69c7cf1d3622b1d7aa706d7f9b97f9">MAX_SYN_REXMIT_COUNT</a>)
    {
        <a class="code" href="_t_c_p_8h.html#a601325e92d65fe658c80eab711e12304">tcpEV</a> &lt;&lt; <span class="stringliteral">&quot;Retransmission count during connection setup exceeds &quot;</span> &lt;&lt; <a class="code" href="_t_c_p_connection_8h.html#acd69c7cf1d3622b1d7aa706d7f9b97f9">MAX_SYN_REXMIT_COUNT</a> &lt;&lt; <span class="stringliteral">&quot;, giving up\n&quot;</span>;
        <span class="comment">// Note ABORT will take the connection to closed, and cancel CONN-ESTAB timer as well</span>
        <span class="keyword">event</span> = <a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32a1fd07d5de8615b02fe30cc7159af37af">TCP_E_ABORT</a>;
        <span class="keywordflow">return</span>;
    }

    <a class="code" href="_t_c_p_8h.html#a601325e92d65fe658c80eab711e12304">tcpEV</a> &lt;&lt; <span class="stringliteral">&quot;Performing retransmission #&quot;</span> &lt;&lt; <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#add0426103a74138a0599e58049526e8a">syn_rexmit_count</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;

    <span class="comment">// resend what&#39;s needed</span>
    <span class="keywordflow">switch</span>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>.getState())
    {
        <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaafde4b4cc43d59d14ba2cbf0bc3adb525">TCP_S_SYN_SENT</a>: <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#abcd8f7efecc7c0077050184d3384b493">sendSyn</a>(); <span class="keywordflow">break</span>;
        <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaaf96abc23364b3cdd51216d5cc9a4f3fc">TCP_S_SYN_RCVD</a>: <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a675b131a43de7429552a574cabcc12dd">sendSynAck</a>(); <span class="keywordflow">break</span>;
        <span class="keywordflow">default</span>:  opp_error(<span class="stringliteral">&quot;Internal error: SYN-REXMIT timer expired while in state %s&quot;</span>, <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ab991cf2680a63832310a4a56ac17972e">stateName</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>.getState()));
    }

    <span class="comment">// reschedule timer</span>
    <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a9aec9c42959150643d39bde968908d39">syn_rexmit_timeout</a> *= 2;

    <span class="keywordflow">if</span> (<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a9aec9c42959150643d39bde968908d39">syn_rexmit_timeout</a> &gt; <a class="code" href="_t_c_p_connection_8h.html#a0b48410b2bd35dbc6509568bfb1842aa">TCP_TIMEOUT_SYN_REXMIT_MAX</a>)
        <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a9aec9c42959150643d39bde968908d39">syn_rexmit_timeout</a> = <a class="code" href="_t_c_p_connection_8h.html#a0b48410b2bd35dbc6509568bfb1842aa">TCP_TIMEOUT_SYN_REXMIT_MAX</a>;
    <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae1ff44c73d20293a446adc091842bedd">scheduleTimeout</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ad70c187b499189b370f99433eb825dcd">synRexmitTimer</a>, <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a9aec9c42959150643d39bde968908d39">syn_rexmit_timeout</a>);
}
</pre></div>
</div>
</div>
<a class="anchor" id="ac1144f5ca6e960176d6e623998cb7456"></a><!-- doxytag: member="tcp_old::TCPConnection::processAckInEstabEtc" ref="ac1144f5ca6e960176d6e623998cb7456" args="(TCPSegment *tcpseg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classtcp__old_1_1_t_c_p_connection.html#ac1144f5ca6e960176d6e623998cb7456">TCPConnection::processAckInEstabEtc</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_t_c_p_segment.html">TCPSegment</a> *&#160;</td>
          <td class="paramname"><em>tcpseg</em></td><td>)</td>
          <td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html#l00937">937</a> of file <a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html">old/TCPConnectionRcvSegment.cc</a>.</p>

<p>Referenced by <a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html#l00114">processSegment1stThru8th()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="_t_c_p_8h.html#a5eb334f5e4b6d6bb414d16141aca18af">tcpEV2</a> &lt;&lt; <span class="stringliteral">&quot;Processing ACK in a data transfer state\n&quot;</span>;

    <span class="comment">//</span>
    <span class="comment">//&quot;</span>
    <span class="comment">//  If SND.UNA &lt; SEG.ACK =&lt; SND.NXT then, set SND.UNA &lt;- SEG.ACK.</span>
    <span class="comment">//  Any segments on the retransmission queue which are thereby</span>
    <span class="comment">//  entirely acknowledged are removed.  Users should receive</span>
    <span class="comment">//  positive acknowledgments for buffers which have been SENT and</span>
    <span class="comment">//  fully acknowledged (i.e., SEND buffer should be returned with</span>
    <span class="comment">//  &quot;ok&quot; response).  If the ACK is a duplicate</span>
    <span class="comment">//  (SEG.ACK &lt; SND.UNA), it can be ignored.  If the ACK acks</span>
    <span class="comment">//  something not yet sent (SEG.ACK &gt; SND.NXT) then send an ACK,</span>
    <span class="comment">//  drop the segment, and return.</span>
    <span class="comment">//</span>
    <span class="comment">//  If SND.UNA &lt; SEG.ACK =&lt; SND.NXT, the send window should be</span>
    <span class="comment">//  updated.  If (SND.WL1 &lt; SEG.SEQ or (SND.WL1 = SEG.SEQ and</span>
    <span class="comment">//  SND.WL2 =&lt; SEG.ACK)), set SND.WND &lt;- SEG.WND, set</span>
    <span class="comment">//  SND.WL1 &lt;- SEG.SEQ, and set SND.WL2 &lt;- SEG.ACK.</span>
    <span class="comment">//</span>
    <span class="comment">//  Note that SND.WND is an offset from SND.UNA, that SND.WL1</span>
    <span class="comment">//  records the sequence number of the last segment used to update</span>
    <span class="comment">//  SND.WND, and that SND.WL2 records the acknowledgment number of</span>
    <span class="comment">//  the last segment used to update SND.WND.  The check here</span>
    <span class="comment">//  prevents using old segments to update the window.</span>
    <span class="comment">//&quot;</span>
    <span class="comment">// Note: should use SND.MAX instead of SND.NXT in above checks</span>
    <span class="comment">//</span>
    <span class="keywordflow">if</span> (<a class="code" href="namespacetcp__old.html#a0012c6f2a0631480574729efd85a05c9">seqGE</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#ace4a453b30bdffb99c1c0646fba597dc">snd_una</a>, tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a853ab8ce8acfb5da053fa9ca24592ce8">getAckNo</a>()))
    {
        <span class="comment">//</span>
        <span class="comment">// duplicate ACK? A received TCP segment is a duplicate ACK if all of</span>
        <span class="comment">// the following apply:</span>
        <span class="comment">//    (1) snd_una==ackNo</span>
        <span class="comment">//    (2) segment contains no data</span>
        <span class="comment">//    (3) there&#39;s unacked data (snd_una!=snd_max)</span>
        <span class="comment">//</span>
        <span class="comment">// Note: ssfnet uses additional constraint &quot;window is the same as last</span>
        <span class="comment">// received (not an update)&quot; -- we don&#39;t do that because window updates</span>
        <span class="comment">// are ignored anyway if neither seqNo nor ackNo has changed.</span>
        <span class="comment">//</span>
        <span class="keywordflow">if</span> (<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#ace4a453b30bdffb99c1c0646fba597dc">snd_una</a>==tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a853ab8ce8acfb5da053fa9ca24592ce8">getAckNo</a>() &amp;&amp; tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a7d9f010b71e3bfa267873ab21195fb73">getPayloadLength</a>()==0 &amp;&amp;
            <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#ace4a453b30bdffb99c1c0646fba597dc">snd_una</a>!=<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a7589e90fe54f9579ab547d55760b4d17">snd_max</a>)
        {
            <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a74cb98612a9fa541a2682e33f3991582">dupacks</a>++;
            <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a2212cb0deb11d2b1c5826cab57b3f42e">tcpAlgorithm</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_algorithm.html#a7ea85ca6cca058d942c83cb76eb3109a">receivedDuplicateAck</a>();
        }
        <span class="keywordflow">else</span>
        {
            <span class="comment">// if doesn&#39;t qualify as duplicate ACK, just ignore it.</span>
            <span class="keywordflow">if</span> (tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a7d9f010b71e3bfa267873ab21195fb73">getPayloadLength</a>()==0)
            {
                <span class="keywordflow">if</span> (<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#ace4a453b30bdffb99c1c0646fba597dc">snd_una</a>!=tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a853ab8ce8acfb5da053fa9ca24592ce8">getAckNo</a>())
                    <a class="code" href="_t_c_p_8h.html#a601325e92d65fe658c80eab711e12304">tcpEV</a> &lt;&lt; <span class="stringliteral">&quot;Old ACK: ackNo&lt;snd_una\n&quot;</span>;
                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#ace4a453b30bdffb99c1c0646fba597dc">snd_una</a>==<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a7589e90fe54f9579ab547d55760b4d17">snd_max</a>)
                    <a class="code" href="_t_c_p_8h.html#a601325e92d65fe658c80eab711e12304">tcpEV</a> &lt;&lt; <span class="stringliteral">&quot;ACK looks duplicate but we have currently no unacked data (snd_una==snd_max)\n&quot;</span>;
            }

            <span class="comment">// reset counter</span>
            <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a74cb98612a9fa541a2682e33f3991582">dupacks</a> = 0;
        }
    }
    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacetcp__old.html#a2a4d76c437a6e0eb1e1440c02153e5db">seqLE</a>(tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a853ab8ce8acfb5da053fa9ca24592ce8">getAckNo</a>(), <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a7589e90fe54f9579ab547d55760b4d17">snd_max</a>))
    {
        <span class="comment">// ack in window.</span>
        uint32 old_snd_una = <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#ace4a453b30bdffb99c1c0646fba597dc">snd_una</a>;
        <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#ace4a453b30bdffb99c1c0646fba597dc">snd_una</a> = tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a853ab8ce8acfb5da053fa9ca24592ce8">getAckNo</a>();
        <span class="keywordflow">if</span> (<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a529775c184153f33ff75a91bacc8b0fc">unackedVector</a>) <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a529775c184153f33ff75a91bacc8b0fc">unackedVector</a>-&gt;record(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a7589e90fe54f9579ab547d55760b4d17">snd_max</a> - <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#ace4a453b30bdffb99c1c0646fba597dc">snd_una</a>);

        <span class="comment">// after retransmitting a lost segment, we may get an ack well ahead of snd_nxt</span>
        <span class="keywordflow">if</span> (<a class="code" href="namespacetcp__old.html#a17c7a0744a549bb90de7d1bc6b8b72ad">seqLess</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#acab59efee35f446ab6310db804cd164d">snd_nxt</a>, <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#ace4a453b30bdffb99c1c0646fba597dc">snd_una</a>))
            <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#acab59efee35f446ab6310db804cd164d">snd_nxt</a> = <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#ace4a453b30bdffb99c1c0646fba597dc">snd_una</a>;

        uint32 discardUpToSeq = <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#ace4a453b30bdffb99c1c0646fba597dc">snd_una</a>;

        <span class="comment">// our FIN acked?</span>
        <span class="keywordflow">if</span> (<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a2a8d544b5707071afcc5402e6318e245">send_fin</a> &amp;&amp; tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a853ab8ce8acfb5da053fa9ca24592ce8">getAckNo</a>()==<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a1156c4cdd71d0e83c9bb401a68e9f606">snd_fin_seq</a>+1)
        {
            <span class="comment">// set flag that our FIN has been acked</span>
            <a class="code" href="_t_c_p_8h.html#a601325e92d65fe658c80eab711e12304">tcpEV</a> &lt;&lt; <span class="stringliteral">&quot;ACK acks our FIN\n&quot;</span>;
            <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#ad2deb1000d47f2e1524f1f5dee059b34">fin_ack_rcvd</a> = <span class="keyword">true</span>;
            discardUpToSeq--; <span class="comment">// the FIN sequence number is not real data</span>
        }

        <span class="comment">// acked data no longer needed in send queue</span>
        <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a7bd9b6b2b4422771b92e00d307983d19">sendQueue</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_send_queue.html#aced2fde7fde0ec8f6a32b1e16d6bbda9">discardUpTo</a>(discardUpToSeq);

        <span class="keywordflow">if</span> (<a class="code" href="namespacetcp__old.html#a17c7a0744a549bb90de7d1bc6b8b72ad">seqLess</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a4ddf055ba61bab9723814bfb1f55cfe5">snd_wl1</a>, tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a0dafe41ef5a4306a4106fdb1e22b19e8">getSequenceNo</a>()) ||
            (<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a4ddf055ba61bab9723814bfb1f55cfe5">snd_wl1</a>==tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a0dafe41ef5a4306a4106fdb1e22b19e8">getSequenceNo</a>() &amp;&amp; <a class="code" href="namespacetcp__old.html#a2a4d76c437a6e0eb1e1440c02153e5db">seqLE</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#aae32069f7798da55852c7244d816b9a1">snd_wl2</a>, tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a853ab8ce8acfb5da053fa9ca24592ce8">getAckNo</a>())))
        {
            <span class="comment">// send window should be updated</span>
            <a class="code" href="_t_c_p_8h.html#a601325e92d65fe658c80eab711e12304">tcpEV</a> &lt;&lt; <span class="stringliteral">&quot;Updating send window from segment: new wnd=&quot;</span> &lt;&lt; tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a8ef1b3d7dceadd931a331c121e55c556">getWindow</a>() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;
            <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a98ce75b56709cdf80549bf95b9b02023">snd_wnd</a> = tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a8ef1b3d7dceadd931a331c121e55c556">getWindow</a>();
            <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a4ddf055ba61bab9723814bfb1f55cfe5">snd_wl1</a> = tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a0dafe41ef5a4306a4106fdb1e22b19e8">getSequenceNo</a>();
            <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#aae32069f7798da55852c7244d816b9a1">snd_wl2</a> = tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a853ab8ce8acfb5da053fa9ca24592ce8">getAckNo</a>();
            <span class="keywordflow">if</span> (<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ab58ab42e2f19a58edcfa549b51a7179b">sndWndVector</a>) <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ab58ab42e2f19a58edcfa549b51a7179b">sndWndVector</a>-&gt;record(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a98ce75b56709cdf80549bf95b9b02023">snd_wnd</a>);
        }

        <span class="keywordflow">if</span> (tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a7d9f010b71e3bfa267873ab21195fb73">getPayloadLength</a>() == 0 &amp;&amp; <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>.getState()!=<a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaaf96abc23364b3cdd51216d5cc9a4f3fc">TCP_S_SYN_RCVD</a>) <span class="comment">// if segment contains data, wait until data has been forwarded to app before sending ACK, otherwise we would use an old ACKNo</span>
        {
            <span class="comment">// notify</span>
            <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a2212cb0deb11d2b1c5826cab57b3f42e">tcpAlgorithm</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_algorithm.html#aca06733ab569ab16f026d31a3bfe5077">receivedDataAck</a>(old_snd_una);

            <span class="comment">// in the receivedDataAck we need the old value</span>
            <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a74cb98612a9fa541a2682e33f3991582">dupacks</a> = 0;
        }
    }
    <span class="keywordflow">else</span>
    {
        ASSERT(<a class="code" href="namespacetcp__old.html#a91800c1929091c104e787a01f5955a9f">seqGreater</a>(tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a853ab8ce8acfb5da053fa9ca24592ce8">getAckNo</a>(), <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a7589e90fe54f9579ab547d55760b4d17">snd_max</a>)); <span class="comment">// from if-ladder</span>

        <span class="comment">// send an ACK, drop the segment, and return.</span>
        <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a2212cb0deb11d2b1c5826cab57b3f42e">tcpAlgorithm</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_algorithm.html#a9f6805c97af24ed1cfe2b94adf983a64">receivedAckForDataNotYetSent</a>(tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a853ab8ce8acfb5da053fa9ca24592ce8">getAckNo</a>());
        <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a74cb98612a9fa541a2682e33f3991582">dupacks</a> = 0;
        <span class="keywordflow">return</span> <span class="keyword">false</span>;  <span class="comment">// means &quot;drop&quot;</span>
    }
    <span class="keywordflow">return</span> <span class="keyword">true</span>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="aebf3e44d104151c83a84a1efbae3f312"></a><!-- doxytag: member="tcp_old::TCPConnection::processAppCommand" ref="aebf3e44d104151c83a84a1efbae3f312" args="(cMessage *msg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classtcp__old_1_1_t_c_p_connection.html#aebf3e44d104151c83a84a1efbae3f312">TCPConnection::processAppCommand</a> </td>
          <td>(</td>
          <td class="paramtype">cMessage *&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Process commands from the application. Normally returns true. A return value of false means that the connection structure must be deleted by the caller (<a class="el" href="classtcp__old_1_1_t_c_p.html">TCP</a>). </p>

<p>Definition at line <a class="el" href="old_2_t_c_p_connection_base_8cc_source.html#l00245">245</a> of file <a class="el" href="old_2_t_c_p_connection_base_8cc_source.html">old/TCPConnectionBase.cc</a>.</p>

<p>Referenced by <a class="el" href="old_2_t_c_p_8cc_source.html#l00084">tcp_old::TCP::handleMessage()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a8aaec47dd8098dbaa015f2e3e7b16442">printConnBrief</a>();

    <span class="comment">// first do actions</span>
    <a class="code" href="class_t_c_p_command.html">TCPCommand</a> *tcpCommand = (<a class="code" href="class_t_c_p_command.html">TCPCommand</a> *)(msg-&gt;removeControlInfo());
    <a class="code" href="_t_c_p_connection_8h.html#a9187fb8d597fec5e53124ffe46c7e85e">TCPEventCode</a> <span class="keyword">event</span> = <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a792d9159b4e64b344cac79d0716c907a">preanalyseAppCommandEvent</a>(msg-&gt;getKind());
    <a class="code" href="_t_c_p_8h.html#a601325e92d65fe658c80eab711e12304">tcpEV</a> &lt;&lt; <span class="stringliteral">&quot;App command: &quot;</span> &lt;&lt; <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#af199cd53f71f27341684145c3bdab306">eventName</a>(<a class="code" href="namespacecesnet.html#a56e29c69128db750fc49a508a16cf7ba">event</a>) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;
    <span class="keywordflow">switch</span> (<a class="code" href="namespacecesnet.html#a56e29c69128db750fc49a508a16cf7ba">event</a>)
    {
        <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32a6179df5a4a1f3314be52f5789f5f0bb6">TCP_E_OPEN_ACTIVE</a>: <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a6ef625498d593ac11744aa92a404e06d">process_OPEN_ACTIVE</a>(<a class="code" href="namespacecesnet.html#a56e29c69128db750fc49a508a16cf7ba">event</a>, tcpCommand, msg); <span class="keywordflow">break</span>;
        <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32a11dd6ccbd9b9bbb145b64fb99981b530">TCP_E_OPEN_PASSIVE</a>: <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a26e4a86dfbc1efaf02e99ea14d410ae3">process_OPEN_PASSIVE</a>(<a class="code" href="namespacecesnet.html#a56e29c69128db750fc49a508a16cf7ba">event</a>, tcpCommand, msg); <span class="keywordflow">break</span>;
        <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32af5e9f1961ac4c76e49f568d8fd304063">TCP_E_SEND</a>: <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a65fa8d6570761c63cdab5cef7f5df685">process_SEND</a>(<a class="code" href="namespacecesnet.html#a56e29c69128db750fc49a508a16cf7ba">event</a>, tcpCommand, msg); <span class="keywordflow">break</span>;
        <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32a2c5c582787e0b87a4a913e34c4d20d1b">TCP_E_CLOSE</a>: <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a5aa9b20651a4c1f90772a7c02eacbf05">process_CLOSE</a>(<a class="code" href="namespacecesnet.html#a56e29c69128db750fc49a508a16cf7ba">event</a>, tcpCommand, msg); <span class="keywordflow">break</span>;
        <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32a1fd07d5de8615b02fe30cc7159af37af">TCP_E_ABORT</a>: <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#afb2189f1428627dcde1d1b0bfbc50833">process_ABORT</a>(<a class="code" href="namespacecesnet.html#a56e29c69128db750fc49a508a16cf7ba">event</a>, tcpCommand, msg); <span class="keywordflow">break</span>;
        <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32adea9b33ab4047345817fb7d8066a8ae2">TCP_E_STATUS</a>: <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a519a2b6612737fbdbd5641dfa33833e8">process_STATUS</a>(<a class="code" href="namespacecesnet.html#a56e29c69128db750fc49a508a16cf7ba">event</a>, tcpCommand, msg); <span class="keywordflow">break</span>;
        <span class="keywordflow">default</span>: opp_error(<span class="stringliteral">&quot;wrong event code&quot;</span>);
    }

    <span class="comment">// then state transitions</span>
    <span class="keywordflow">return</span> <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#aa1fe5fa359d4063c984d686e4166b798">performStateTransition</a>(<a class="code" href="namespacecesnet.html#a56e29c69128db750fc49a508a16cf7ba">event</a>);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a4d240ca8f36aa37a29b8bcc44ec052cd"></a><!-- doxytag: member="tcp_old::TCPConnection::processRstInSynReceived" ref="a4d240ca8f36aa37a29b8bcc44ec052cd" args="(TCPSegment *tcpseg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32">TCPEventCode</a> <a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a4d240ca8f36aa37a29b8bcc44ec052cd">TCPConnection::processRstInSynReceived</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_t_c_p_segment.html">TCPSegment</a> *&#160;</td>
          <td class="paramname"><em>tcpseg</em></td><td>)</td>
          <td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html#l00909">909</a> of file <a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html">old/TCPConnectionRcvSegment.cc</a>.</p>

<p>Referenced by <a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html#l00114">processSegment1stThru8th()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="_t_c_p_8h.html#a5eb334f5e4b6d6bb414d16141aca18af">tcpEV2</a> &lt;&lt; <span class="stringliteral">&quot;Processing RST in SYN_RCVD\n&quot;</span>;

    <span class="comment">//&quot;</span>
    <span class="comment">// If this connection was initiated with a passive OPEN (i.e.,</span>
    <span class="comment">// came from the LISTEN state), then return this connection to</span>
    <span class="comment">// LISTEN state and return.  The user need not be informed.  If</span>
    <span class="comment">// this connection was initiated with an active OPEN (i.e., came</span>
    <span class="comment">// from SYN-SENT state) then the connection was refused, signal</span>
    <span class="comment">// the user &quot;connection refused&quot;.  In either case, all segments</span>
    <span class="comment">// on the retransmission queue should be removed.  And in the</span>
    <span class="comment">// active OPEN case, enter the CLOSED state and delete the TCB,</span>
    <span class="comment">// and return.</span>
    <span class="comment">//&quot;</span>

    <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a7bd9b6b2b4422771b92e00d307983d19">sendQueue</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_send_queue.html#aced2fde7fde0ec8f6a32b1e16d6bbda9">discardUpTo</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a7bd9b6b2b4422771b92e00d307983d19">sendQueue</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_send_queue.html#addf53d15d095b683486ca61554dccae3">getBufferEndSeq</a>()); <span class="comment">// flush send queue</span>

    <span class="keywordflow">if</span> (<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#afba4a9f34c546c37533eb5311c1da682">active</a>)
    {
        <span class="comment">// signal &quot;connection refused&quot;</span>
        <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a65a8dc93c08a685f145248d0fb327428">sendIndicationToApp</a>(<a class="code" href="_t_c_p_command__m_8h.html#a68611fc79dbc74e8744d74b746cd956ba21824d5a95e3b86c41f35775bb5f23ab">TCP_I_CONNECTION_REFUSED</a>);
    }

    <span class="comment">// on RCV_RST, FSM will go either to LISTEN or to CLOSED, depending on state-&gt;active</span>
    <span class="keywordflow">return</span> <a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32a050c79add513afca8554e29b61fd5389">TCP_E_RCV_RST</a>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="aa0758284e5bd6bd162b6ff267add2e2d"></a><!-- doxytag: member="tcp_old::TCPConnection::processSegment1stThru8th" ref="aa0758284e5bd6bd162b6ff267add2e2d" args="(TCPSegment *tcpseg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32">TCPEventCode</a> <a class="el" href="classtcp__old_1_1_t_c_p_connection.html#aa0758284e5bd6bd162b6ff267add2e2d">TCPConnection::processSegment1stThru8th</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_t_c_p_segment.html">TCPSegment</a> *&#160;</td>
          <td class="paramname"><em>tcpseg</em></td><td>)</td>
          <td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html#l00114">114</a> of file <a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html">old/TCPConnectionRcvSegment.cc</a>.</p>

<p>Referenced by <a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html#l00083">process_RCV_SEGMENT()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="comment">//</span>
    <span class="comment">// RFC 793: first check sequence number</span>
    <span class="comment">//</span>
    <span class="keywordtype">bool</span> acceptable = <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#acceb561b23349d06b298858e39433435">isSegmentAcceptable</a>(tcpseg);
    <span class="keywordflow">if</span> (!acceptable)
    {
        <span class="comment">//&quot;</span>
        <span class="comment">// If an incoming segment is not acceptable, an acknowledgment</span>
        <span class="comment">// should be sent in reply (unless the RST bit is set, if so drop</span>
        <span class="comment">// the segment and return):</span>
        <span class="comment">//</span>
        <span class="comment">//  &lt;SEQ=SND.NXT&gt;&lt;ACK=RCV.NXT&gt;&lt;CTL=ACK&gt;</span>
        <span class="comment">//&quot;</span>
        <span class="keywordflow">if</span> (tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a606da99a84d95c74bb1626436b6e5e12">getRstBit</a>())
        {
            <a class="code" href="_t_c_p_8h.html#a601325e92d65fe658c80eab711e12304">tcpEV</a> &lt;&lt; <span class="stringliteral">&quot;RST with unacceptable seqNum: dropping\n&quot;</span>;
        }
        <span class="keywordflow">else</span>
        {
            <a class="code" href="_t_c_p_8h.html#a601325e92d65fe658c80eab711e12304">tcpEV</a> &lt;&lt; <span class="stringliteral">&quot;Segment seqNum not acceptable, sending ACK with current receive seq\n&quot;</span>;
            <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a60ee5bc5b391d621e7e684857e195151">sendAck</a>();
        }
        <span class="keywordflow">return</span> <a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32acd405552b4f4c9973d5d5b7e8aae88f5">TCP_E_IGNORE</a>;
    }

    <span class="comment">//</span>
    <span class="comment">// RFC 793: second check the RST bit,</span>
    <span class="comment">//</span>
    <span class="keywordflow">if</span> (tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a606da99a84d95c74bb1626436b6e5e12">getRstBit</a>())
    {
        <span class="comment">// Note: if we come from LISTEN, processSegmentInListen() has already handled RST.</span>
        <span class="keywordflow">switch</span> (<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>.getState())
        {
            <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaaf96abc23364b3cdd51216d5cc9a4f3fc">TCP_S_SYN_RCVD</a>:
                <span class="comment">//&quot;</span>
                <span class="comment">// If this connection was initiated with a passive OPEN (i.e.,</span>
                <span class="comment">// came from the LISTEN state), then return this connection to</span>
                <span class="comment">// LISTEN state and return.  The user need not be informed.  If</span>
                <span class="comment">// this connection was initiated with an active OPEN (i.e., came</span>
                <span class="comment">// from SYN-SENT state) then the connection was refused, signal</span>
                <span class="comment">// the user &quot;connection refused&quot;.  In either case, all segments</span>
                <span class="comment">// on the retransmission queue should be removed.  And in the</span>
                <span class="comment">// active OPEN case, enter the CLOSED state and delete the TCB,</span>
                <span class="comment">// and return.</span>
                <span class="comment">//&quot;</span>
                <span class="keywordflow">return</span> <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a4d240ca8f36aa37a29b8bcc44ec052cd">processRstInSynReceived</a>(tcpseg);

            <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaa3b4387f45a765235dfda0bf3111ba1c6">TCP_S_ESTABLISHED</a>:
            <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaa1366e9fbbf862cd3fdfa3ea08e641cb0">TCP_S_FIN_WAIT_1</a>:
            <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaaea07c6aa092a0b2e9141385fb4734797">TCP_S_FIN_WAIT_2</a>:
            <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaa3395b6fd6b4cf5d6165b37929d44eaa1">TCP_S_CLOSE_WAIT</a>:
                <span class="comment">//&quot;</span>
                <span class="comment">// If the RST bit is set then, any outstanding RECEIVEs and SEND</span>
                <span class="comment">// should receive &quot;reset&quot; responses.  All segment queues should be</span>
                <span class="comment">// flushed.  Users should also receive an unsolicited general</span>
                <span class="comment">// &quot;connection reset&quot; signal.</span>
                <span class="comment">//</span>
                <span class="comment">// Enter the CLOSED state, delete the TCB, and return.</span>
                <span class="comment">//&quot;</span>
                <a class="code" href="_t_c_p_8h.html#a601325e92d65fe658c80eab711e12304">tcpEV</a> &lt;&lt; <span class="stringliteral">&quot;RST: performing connection reset, closing connection\n&quot;</span>;
                <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a65a8dc93c08a685f145248d0fb327428">sendIndicationToApp</a>(<a class="code" href="_t_c_p_command__m_8h.html#a68611fc79dbc74e8744d74b746cd956ba4e8f4551a34a27e607201754b36fdbe0">TCP_I_CONNECTION_RESET</a>);
                <span class="keywordflow">return</span> <a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32a050c79add513afca8554e29b61fd5389">TCP_E_RCV_RST</a>;  <span class="comment">// this will trigger state transition</span>

            <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaacdbad950a89de6fc964c3257d45e07a9">TCP_S_CLOSING</a>:
            <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaaac5147b505ddf6bb15d84853242bcfdf">TCP_S_LAST_ACK</a>:
            <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaa8a4fa6fa69c727999ad6b8fe056a6fd1">TCP_S_TIME_WAIT</a>:
                <span class="comment">//&quot;</span>
                <span class="comment">// enter the CLOSED state, delete the TCB, and return.</span>
                <span class="comment">//&quot;</span>
                <a class="code" href="_t_c_p_8h.html#a601325e92d65fe658c80eab711e12304">tcpEV</a> &lt;&lt; <span class="stringliteral">&quot;RST: closing connection\n&quot;</span>;
                <span class="keywordflow">if</span> (<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>.getState()!=<a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaa8a4fa6fa69c727999ad6b8fe056a6fd1">TCP_S_TIME_WAIT</a>)
                    <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a65a8dc93c08a685f145248d0fb327428">sendIndicationToApp</a>(<a class="code" href="_t_c_p_command__m_8h.html#a68611fc79dbc74e8744d74b746cd956ba994690e6a29c6e7c3eedc8fbb29d7a8c">TCP_I_CLOSED</a>); <span class="comment">// in TIME_WAIT, we&#39;ve already sent it</span>
                <span class="keywordflow">return</span> <a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32a050c79add513afca8554e29b61fd5389">TCP_E_RCV_RST</a>; <span class="comment">// this will trigger state transition</span>

            <span class="keywordflow">default</span>: ASSERT(0);
        }
    }

    <span class="comment">// RFC 793: third check security and precedence</span>
    <span class="comment">// This step is ignored.</span>

    <span class="comment">//</span>
    <span class="comment">// RFC 793: fourth, check the SYN bit,</span>
    <span class="comment">//</span>
    <span class="keywordflow">if</span> (tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#affebf261c9d4fc303151a484d61d8bb7">getSynBit</a>())
    {
        <span class="comment">//&quot;</span>
        <span class="comment">// If the SYN is in the window it is an error, send a reset, any</span>
        <span class="comment">// outstanding RECEIVEs and SEND should receive &quot;reset&quot; responses,</span>
        <span class="comment">// all segment queues should be flushed, the user should also</span>
        <span class="comment">// receive an unsolicited general &quot;connection reset&quot; signal, enter</span>
        <span class="comment">// the CLOSED state, delete the TCB, and return.</span>
        <span class="comment">//</span>
        <span class="comment">// If the SYN is not in the window this step would not be reached</span>
        <span class="comment">// and an ack would have been sent in the first step (sequence</span>
        <span class="comment">// number check).</span>
        <span class="comment">//&quot;</span>

        ASSERT(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#acceb561b23349d06b298858e39433435">isSegmentAcceptable</a>(tcpseg));  <span class="comment">// assert SYN is in the window</span>
        <a class="code" href="_t_c_p_8h.html#a601325e92d65fe658c80eab711e12304">tcpEV</a> &lt;&lt; <span class="stringliteral">&quot;SYN is in the window: performing connection reset, closing connection\n&quot;</span>;
        <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a65a8dc93c08a685f145248d0fb327428">sendIndicationToApp</a>(<a class="code" href="_t_c_p_command__m_8h.html#a68611fc79dbc74e8744d74b746cd956ba4e8f4551a34a27e607201754b36fdbe0">TCP_I_CONNECTION_RESET</a>);
        <span class="keywordflow">return</span> <a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32a55dbf4b3147f64f1baeac365b019dea6">TCP_E_RCV_UNEXP_SYN</a>;
    }

    <span class="comment">//</span>
    <span class="comment">// RFC 793: fifth check the ACK field,</span>
    <span class="comment">//</span>
    <span class="keywordflow">if</span> (!tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a8415708f568387985da223286a9e5bfa">getAckBit</a>())
    {
        <span class="comment">// if the ACK bit is off drop the segment and return</span>
        <a class="code" href="_t_c_p_8h.html#a601325e92d65fe658c80eab711e12304">tcpEV</a> &lt;&lt; <span class="stringliteral">&quot;ACK not set, dropping segment\n&quot;</span>;
        <span class="keywordflow">return</span> <a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32acd405552b4f4c9973d5d5b7e8aae88f5">TCP_E_IGNORE</a>;
    }

    uint32 old_snd_una = <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#ace4a453b30bdffb99c1c0646fba597dc">snd_una</a>;

    <a class="code" href="_t_c_p_connection_8h.html#a9187fb8d597fec5e53124ffe46c7e85e">TCPEventCode</a> <span class="keyword">event</span> = <a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32acd405552b4f4c9973d5d5b7e8aae88f5">TCP_E_IGNORE</a>;

    <span class="keywordflow">if</span> (<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>.getState()==<a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaaf96abc23364b3cdd51216d5cc9a4f3fc">TCP_S_SYN_RCVD</a>)
    {
        <span class="comment">//&quot;</span>
        <span class="comment">// If SND.UNA =&lt; SEG.ACK =&lt; SND.NXT then enter ESTABLISHED state</span>
        <span class="comment">// and continue processing.</span>
        <span class="comment">//</span>
        <span class="comment">// If the segment acknowledgment is not acceptable, form a</span>
        <span class="comment">// reset segment,</span>
        <span class="comment">//</span>
        <span class="comment">//  &lt;SEQ=SEG.ACK&gt;&lt;CTL=RST&gt;</span>
        <span class="comment">//</span>
        <span class="comment">// and send it.</span>
        <span class="comment">//&quot;</span>
        <span class="keywordflow">if</span> (!<a class="code" href="namespacetcp__old.html#a2a4d76c437a6e0eb1e1440c02153e5db">seqLE</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#ace4a453b30bdffb99c1c0646fba597dc">snd_una</a>,tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a853ab8ce8acfb5da053fa9ca24592ce8">getAckNo</a>()) || !<a class="code" href="namespacetcp__old.html#a2a4d76c437a6e0eb1e1440c02153e5db">seqLE</a>(tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a853ab8ce8acfb5da053fa9ca24592ce8">getAckNo</a>(),<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#acab59efee35f446ab6310db804cd164d">snd_nxt</a>))
        {
            <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#afa03f88fc4589249aefe6f828eed9dd6">sendRst</a>(tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a853ab8ce8acfb5da053fa9ca24592ce8">getAckNo</a>());
            <span class="keywordflow">return</span> <a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32acd405552b4f4c9973d5d5b7e8aae88f5">TCP_E_IGNORE</a>;
        }

        <span class="comment">// notify tcpAlgorithm and app layer</span>
        <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a2212cb0deb11d2b1c5826cab57b3f42e">tcpAlgorithm</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_algorithm.html#a6bbeaec803a6c9e148ba36c838c267a5">established</a>(<span class="keyword">false</span>);
        <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ab04a91abde05d21293c30a78ab968eef">sendEstabIndicationToApp</a>();

        <span class="comment">// This will trigger transition to ESTABLISHED. Timers and notifying</span>
        <span class="comment">// app will be taken care of in stateEntered().</span>
        <span class="keyword">event</span> = <a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32a823e4834ff13aaff8408c38ac1b0f350">TCP_E_RCV_ACK</a>;
    }

    uint32 old_snd_nxt = <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#acab59efee35f446ab6310db804cd164d">snd_nxt</a>; <span class="comment">// later we&#39;ll need to see if snd_nxt changed</span>
    <span class="comment">// Note: If one of the last data segments is lost while already in LAST-ACK state (e.g. if using TCPEchoApps)</span>
    <span class="comment">// TCP must be able to process acceptable acknowledgments, however please note RFC 793, page 73:</span>
        <span class="comment">// &quot;LAST-ACK STATE</span>
    <span class="comment">//    The only thing that can arrive in this state is an</span>
    <span class="comment">//    acknowledgment of our FIN.  If our FIN is now acknowledged,</span>
    <span class="comment">//    delete the TCB, enter the CLOSED state, and return.&quot;</span>
    <span class="keywordflow">if</span> (<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>.getState()==<a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaaf96abc23364b3cdd51216d5cc9a4f3fc">TCP_S_SYN_RCVD</a> || <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>.getState()==<a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaa3b4387f45a765235dfda0bf3111ba1c6">TCP_S_ESTABLISHED</a> ||
        <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>.getState()==<a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaa1366e9fbbf862cd3fdfa3ea08e641cb0">TCP_S_FIN_WAIT_1</a> || <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>.getState()==<a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaaea07c6aa092a0b2e9141385fb4734797">TCP_S_FIN_WAIT_2</a> ||
        <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>.getState()==<a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaa3395b6fd6b4cf5d6165b37929d44eaa1">TCP_S_CLOSE_WAIT</a> || <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>.getState()==<a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaacdbad950a89de6fc964c3257d45e07a9">TCP_S_CLOSING</a> || <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>.getState()==<a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaaac5147b505ddf6bb15d84853242bcfdf">TCP_S_LAST_ACK</a>)
    {
        <span class="comment">//</span>
        <span class="comment">// ESTABLISHED processing:</span>
        <span class="comment">//&quot;</span>
        <span class="comment">//  If SND.UNA &lt; SEG.ACK =&lt; SND.NXT then, set SND.UNA &lt;- SEG.ACK.</span>
        <span class="comment">//  Any segments on the retransmission queue which are thereby</span>
        <span class="comment">//  entirely acknowledged are removed.  Users should receive</span>
        <span class="comment">//  positive acknowledgments for buffers which have been SENT and</span>
        <span class="comment">//  fully acknowledged (i.e., SEND buffer should be returned with</span>
        <span class="comment">//  &quot;ok&quot; response).  If the ACK is a duplicate</span>
        <span class="comment">//  (SEG.ACK &lt; SND.UNA), it can be ignored.  If the ACK acks</span>
        <span class="comment">//  something not yet sent (SEG.ACK &gt; SND.NXT) then send an ACK,</span>
        <span class="comment">//  drop the segment, and return.</span>
        <span class="comment">//</span>
        <span class="comment">//  If SND.UNA &lt; SEG.ACK =&lt; SND.NXT, the send window should be</span>
        <span class="comment">//  updated.  If (SND.WL1 &lt; SEG.SEQ or (SND.WL1 = SEG.SEQ and</span>
        <span class="comment">//  SND.WL2 =&lt; SEG.ACK)), set SND.WND &lt;- SEG.WND, set</span>
        <span class="comment">//  SND.WL1 &lt;- SEG.SEQ, and set SND.WL2 &lt;- SEG.ACK.</span>
        <span class="comment">//</span>
        <span class="comment">//  Note that SND.WND is an offset from SND.UNA, that SND.WL1</span>
        <span class="comment">//  records the sequence number of the last segment used to update</span>
        <span class="comment">//  SND.WND, and that SND.WL2 records the acknowledgment number of</span>
        <span class="comment">//  the last segment used to update SND.WND.  The check here</span>
        <span class="comment">//  prevents using old segments to update the window.</span>
        <span class="comment">//&quot;</span>
        <span class="keywordtype">bool</span> ok = <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ac1144f5ca6e960176d6e623998cb7456">processAckInEstabEtc</a>(tcpseg);
        <span class="keywordflow">if</span> (!ok)
            <span class="keywordflow">return</span> <a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32acd405552b4f4c9973d5d5b7e8aae88f5">TCP_E_IGNORE</a>;  <span class="comment">// if acks something not yet sent, drop it</span>
    }

    <span class="keywordflow">if</span> ((<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>.getState()==<a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaa1366e9fbbf862cd3fdfa3ea08e641cb0">TCP_S_FIN_WAIT_1</a> &amp;&amp; <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#ad2deb1000d47f2e1524f1f5dee059b34">fin_ack_rcvd</a>))
    {
        <span class="comment">//&quot;</span>
        <span class="comment">// FIN-WAIT-1 STATE</span>
        <span class="comment">//   In addition to the processing for the ESTABLISHED state, if</span>
        <span class="comment">//   our FIN is now acknowledged then enter FIN-WAIT-2 and continue</span>
        <span class="comment">//   processing in that state.</span>
        <span class="comment">//&quot;</span>
        <span class="keyword">event</span> = <a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32a823e4834ff13aaff8408c38ac1b0f350">TCP_E_RCV_ACK</a>;  <span class="comment">// will trigger transition to FIN-WAIT-2</span>
    }

    <span class="keywordflow">if</span> (<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>.getState()==<a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaaea07c6aa092a0b2e9141385fb4734797">TCP_S_FIN_WAIT_2</a>)
    {
        <span class="comment">//&quot;</span>
        <span class="comment">// FIN-WAIT-2 STATE</span>
        <span class="comment">//  In addition to the processing for the ESTABLISHED state, if</span>
        <span class="comment">//  the retransmission queue is empty, the user&#39;s CLOSE can be</span>
        <span class="comment">//  acknowledged (&quot;ok&quot;) but do not delete the TCB.</span>
        <span class="comment">//&quot;</span>
        <span class="comment">// nothing to do here (in our model, used commands don&#39;t need to be</span>
        <span class="comment">// acknowledged)</span>
    }

    <span class="keywordflow">if</span> (<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>.getState()==<a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaacdbad950a89de6fc964c3257d45e07a9">TCP_S_CLOSING</a>)
    {
        <span class="comment">//&quot;</span>
        <span class="comment">// In addition to the processing for the ESTABLISHED state, if</span>
        <span class="comment">// the ACK acknowledges our FIN then enter the TIME-WAIT state,</span>
        <span class="comment">// otherwise ignore the segment.</span>
        <span class="comment">//&quot;</span>
        <span class="keywordflow">if</span> (<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#ad2deb1000d47f2e1524f1f5dee059b34">fin_ack_rcvd</a>)
        {
            <a class="code" href="_t_c_p_8h.html#a601325e92d65fe658c80eab711e12304">tcpEV</a> &lt;&lt; <span class="stringliteral">&quot;Our FIN acked -- can go to TIME_WAIT now\n&quot;</span>;
            <span class="keyword">event</span> = <a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32a823e4834ff13aaff8408c38ac1b0f350">TCP_E_RCV_ACK</a>;  <span class="comment">// will trigger transition to TIME-WAIT</span>
            <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae1ff44c73d20293a446adc091842bedd">scheduleTimeout</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a67c3fa718ee0542b4bd93eda8785c0fc">the2MSLTimer</a>, <a class="code" href="_t_c_p_connection_8h.html#a25bdc88481176d96d87d31d71f32579b">TCP_TIMEOUT_2MSL</a>);  <span class="comment">// start timer</span>

            <span class="comment">// we&#39;re entering TIME_WAIT, so we can signal CLOSED the user</span>
            <span class="comment">// (the only thing left to do is wait until the 2MSL timer expires)</span>
            <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a65a8dc93c08a685f145248d0fb327428">sendIndicationToApp</a>(<a class="code" href="_t_c_p_command__m_8h.html#a68611fc79dbc74e8744d74b746cd956ba994690e6a29c6e7c3eedc8fbb29d7a8c">TCP_I_CLOSED</a>);
        }
    }

    <span class="keywordflow">if</span> (<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>.getState()==<a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaaac5147b505ddf6bb15d84853242bcfdf">TCP_S_LAST_ACK</a>)
    {
        <span class="comment">//&quot;</span>
        <span class="comment">// The only thing that can arrive in this state is an</span>
        <span class="comment">// acknowledgment of our FIN.  If our FIN is now acknowledged,</span>
        <span class="comment">// delete the TCB, enter the CLOSED state, and return.</span>
        <span class="comment">//&quot;</span>
        <span class="keywordflow">if</span> (<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a2a8d544b5707071afcc5402e6318e245">send_fin</a> &amp;&amp; tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a853ab8ce8acfb5da053fa9ca24592ce8">getAckNo</a>()==<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a1156c4cdd71d0e83c9bb401a68e9f606">snd_fin_seq</a>+1)
        {
            <a class="code" href="_t_c_p_8h.html#a601325e92d65fe658c80eab711e12304">tcpEV</a> &lt;&lt; <span class="stringliteral">&quot;Last ACK arrived\n&quot;</span>;
            <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a65a8dc93c08a685f145248d0fb327428">sendIndicationToApp</a>(<a class="code" href="_t_c_p_command__m_8h.html#a68611fc79dbc74e8744d74b746cd956ba994690e6a29c6e7c3eedc8fbb29d7a8c">TCP_I_CLOSED</a>);
            <span class="keywordflow">return</span> <a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32a823e4834ff13aaff8408c38ac1b0f350">TCP_E_RCV_ACK</a>; <span class="comment">// will trigger transition to CLOSED</span>
        }
    }

    <span class="keywordflow">if</span> (<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>.getState()==<a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaa8a4fa6fa69c727999ad6b8fe056a6fd1">TCP_S_TIME_WAIT</a>)
    {
        <span class="comment">//&quot;</span>
        <span class="comment">// The only thing that can arrive in this state is a</span>
        <span class="comment">// retransmission of the remote FIN.  Acknowledge it, and restart</span>
        <span class="comment">// the 2 MSL timeout.</span>
        <span class="comment">//&quot;</span>
        <span class="comment">// And we are staying in the TIME_WAIT state.</span>
        <span class="comment">//</span>
        <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a60ee5bc5b391d621e7e684857e195151">sendAck</a>();
        <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ad06a2b75a619021592db07ab486f0fed">cancelEvent</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a67c3fa718ee0542b4bd93eda8785c0fc">the2MSLTimer</a>);
        <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae1ff44c73d20293a446adc091842bedd">scheduleTimeout</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a67c3fa718ee0542b4bd93eda8785c0fc">the2MSLTimer</a>, <a class="code" href="_t_c_p_connection_8h.html#a25bdc88481176d96d87d31d71f32579b">TCP_TIMEOUT_2MSL</a>);
    }

    <span class="comment">//</span>
    <span class="comment">// RFC 793: sixth, check the URG bit,</span>
    <span class="comment">//</span>
    <span class="keywordflow">if</span> (tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a31028187ac8cf1f844d389b0e56baf8b">getUrgBit</a>() &amp;&amp; (<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>.getState()==<a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaa3b4387f45a765235dfda0bf3111ba1c6">TCP_S_ESTABLISHED</a> || <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>.getState()==<a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaa1366e9fbbf862cd3fdfa3ea08e641cb0">TCP_S_FIN_WAIT_1</a> ||
        <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>.getState()==<a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaaea07c6aa092a0b2e9141385fb4734797">TCP_S_FIN_WAIT_2</a>))
    {
        <span class="comment">//&quot;</span>
        <span class="comment">// If the URG bit is set, RCV.UP &lt;- max(RCV.UP,SEG.UP), and signal</span>
        <span class="comment">// the user that the remote side has urgent data if the urgent</span>
        <span class="comment">// pointer (RCV.UP) is in advance of the data consumed.  If the</span>
        <span class="comment">// user has already been signaled (or is still in the &quot;urgent</span>
        <span class="comment">// mode&quot;) for this continuous sequence of urgent data, do not</span>
        <span class="comment">// signal the user again.</span>
        <span class="comment">//&quot;</span>

        <span class="comment">// TBD: URG currently not supported</span>
    }

    <span class="comment">//</span>
    <span class="comment">// RFC 793: seventh, process the segment text,</span>
    <span class="comment">//</span>
    uint32 old_rcv_nxt = <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a18b8a2c7e52c332378bd9f70b1d91b29">rcv_nxt</a>; <span class="comment">// if rcv_nxt changes, we need to send/schedule an ACK</span>
    <span class="keywordflow">if</span> (<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>.getState()==<a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaaf96abc23364b3cdd51216d5cc9a4f3fc">TCP_S_SYN_RCVD</a> || <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>.getState()==<a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaa3b4387f45a765235dfda0bf3111ba1c6">TCP_S_ESTABLISHED</a> || <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>.getState()==<a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaa1366e9fbbf862cd3fdfa3ea08e641cb0">TCP_S_FIN_WAIT_1</a> || <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>.getState()==<a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaaea07c6aa092a0b2e9141385fb4734797">TCP_S_FIN_WAIT_2</a>)
    {
        <span class="comment">//&quot;</span>
        <span class="comment">// Once in the ESTABLISHED state, it is possible to deliver segment</span>
        <span class="comment">// text to user RECEIVE buffers.  Text from segments can be moved</span>
        <span class="comment">// into buffers until either the buffer is full or the segment is</span>
        <span class="comment">// empty.  If the segment empties and carries an PUSH flag, then</span>
        <span class="comment">// the user is informed, when the buffer is returned, that a PUSH</span>
        <span class="comment">// has been received.</span>
        <span class="comment">//</span>
        <span class="comment">// When the TCP takes responsibility for delivering the data to the</span>
        <span class="comment">// user it must also acknowledge the receipt of the data.</span>
        <span class="comment">//</span>
        <span class="comment">// Once the TCP takes responsibility for the data it advances</span>
        <span class="comment">// RCV.NXT over the data accepted, and adjusts RCV.WND as</span>
        <span class="comment">// apporopriate to the current buffer availability.  The total of</span>
        <span class="comment">// RCV.NXT and RCV.WND should not be reduced.</span>
        <span class="comment">//</span>
        <span class="comment">// Please note the window management suggestions in section 3.7.</span>
        <span class="comment">//</span>
        <span class="comment">// Send an acknowledgment of the form:</span>
        <span class="comment">//</span>
        <span class="comment">//   &lt;SEQ=SND.NXT&gt;&lt;ACK=RCV.NXT&gt;&lt;CTL=ACK&gt;</span>
        <span class="comment">//</span>
        <span class="comment">// This acknowledgment should be piggybacked on a segment being</span>
        <span class="comment">// transmitted if possible without incurring undue delay.</span>
        <span class="comment">//&quot;</span>
        <span class="keywordflow">if</span> (tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a7d9f010b71e3bfa267873ab21195fb73">getPayloadLength</a>()&gt;0)
        {
            <a class="code" href="_t_c_p_8h.html#a5eb334f5e4b6d6bb414d16141aca18af">tcpEV2</a> &lt;&lt; <span class="stringliteral">&quot;Processing segment text in a data transfer state\n&quot;</span>;

            <span class="comment">// insert into receive buffers. If this segment is contiguous with</span>
            <span class="comment">// previously received ones (seqNo==rcv_nxt), rcv_nxt can be increased;</span>
            <span class="comment">// otherwise it stays the same but the data must be cached nevertheless</span>
            <span class="comment">// (to avoid &quot;Failure to retain above-sequence data&quot; problem, RFC 2525</span>
            <span class="comment">// section 2.5).</span>
            uint32 old_rcv_nxt = <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a18b8a2c7e52c332378bd9f70b1d91b29">rcv_nxt</a>;
            <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a18b8a2c7e52c332378bd9f70b1d91b29">rcv_nxt</a> = <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a2602ec64d45270793076abe5938d16ac">receiveQueue</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_receive_queue.html#a28492372a4252f374ba62fbdcce7a566">insertBytesFromSegment</a>(tcpseg);

            <span class="keywordflow">if</span> (<a class="code" href="namespacetcp__old.html#a91800c1929091c104e787a01f5955a9f">seqGreater</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#ace4a453b30bdffb99c1c0646fba597dc">snd_una</a>, old_snd_una))
            {
                <span class="comment">// notify</span>
                <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a2212cb0deb11d2b1c5826cab57b3f42e">tcpAlgorithm</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_algorithm.html#aca06733ab569ab16f026d31a3bfe5077">receivedDataAck</a>(old_snd_una);

                <span class="comment">// in the receivedDataAck we need the old value</span>
                <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a74cb98612a9fa541a2682e33f3991582">dupacks</a> = 0;
            }

            <span class="comment">// out-of-order segment?</span>
            <span class="keywordflow">if</span> (old_rcv_nxt==<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a18b8a2c7e52c332378bd9f70b1d91b29">rcv_nxt</a>)
            {
                <span class="comment">// we&#39;ll probably want to send an ACK here</span>
                <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a2212cb0deb11d2b1c5826cab57b3f42e">tcpAlgorithm</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_algorithm.html#a7ea3a177d38f6a05e84637233ae3b63d">receivedOutOfOrderSegment</a>();
            }
            <span class="keywordflow">else</span>
            {
                <span class="comment">// forward data to app</span>
                <span class="comment">//</span>
                <span class="comment">// FIXME observe PSH bit</span>
                <span class="comment">//</span>
                <span class="comment">// FIXME we should implement socket READ command, and pass up only</span>
                <span class="comment">// as many bytes as requested. rcv_wnd should be decreased</span>
                <span class="comment">// accordingly! (right now we *always* advertise win=16384,</span>
                <span class="comment">// that is, there&#39;s practically no receiver-imposed flow control!)</span>
                <span class="comment">//</span>
                cPacket *msg;
                <span class="keywordflow">while</span> ((msg=<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a2602ec64d45270793076abe5938d16ac">receiveQueue</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_receive_queue.html#a8d5fa8d22c976a8be92512e11b350f9f">extractBytesUpTo</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a18b8a2c7e52c332378bd9f70b1d91b29">rcv_nxt</a>))!=NULL)
                {
                    msg-&gt;setKind(<a class="code" href="_t_c_p_command__m_8h.html#a68611fc79dbc74e8744d74b746cd956ba78bce3d41e158816c5212ed2fc959b06">TCP_I_DATA</a>);  <span class="comment">// TBD currently we never send TCP_I_URGENT_DATA</span>
                    <a class="code" href="class_t_c_p_command.html">TCPCommand</a> *cmd = <span class="keyword">new</span> <a class="code" href="class_t_c_p_command.html">TCPCommand</a>();
                    cmd-&gt;<a class="code" href="class_t_c_p_command.html#a4c843a0c691ac1bbbfc1307553131de3">setConnId</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae6ce2bfc0b9aa9d110db13efe08b7a0e">connId</a>);
                    msg-&gt;setControlInfo(cmd);
                    <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a6aa48826843116a0f5c4e0fa37a69cfc">sendToApp</a>(msg);
                }

                <span class="comment">// if this segment &quot;filled the gap&quot; until the previously arrived segment</span>
                <span class="comment">// that carried a FIN (i.e.rcv_nxt==rcv_fin_seq), we have to advance</span>
                <span class="comment">// rcv_nxt over the FIN.</span>
                <span class="keywordflow">if</span> (<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a595ba253f26cb674ecd990bfd6d929c1">fin_rcvd</a> &amp;&amp; <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a18b8a2c7e52c332378bd9f70b1d91b29">rcv_nxt</a>==<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a4e7a46f4ab93fc16930f38b65cc5ff07">rcv_fin_seq</a>)
                {
                    <a class="code" href="_t_c_p_8h.html#a601325e92d65fe658c80eab711e12304">tcpEV</a> &lt;&lt; <span class="stringliteral">&quot;All segments arrived up to the FIN segment, advancing rcv_nxt over the FIN\n&quot;</span>;
                    <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a18b8a2c7e52c332378bd9f70b1d91b29">rcv_nxt</a> = <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a4e7a46f4ab93fc16930f38b65cc5ff07">rcv_fin_seq</a>+1;
                    <span class="comment">// state transitions will be done in the state machine, here we just set</span>
                    <span class="comment">// the proper event code (TCP_E_RCV_FIN or TCP_E_RCV_FIN_ACK)</span>
                    <span class="keyword">event</span> = <a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32a59323c4bb3247640d61362e7f6ba824e">TCP_E_RCV_FIN</a>;
                    <span class="keywordflow">switch</span> (<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>.getState())
                    {
                        <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaa1366e9fbbf862cd3fdfa3ea08e641cb0">TCP_S_FIN_WAIT_1</a>:
                            <span class="keywordflow">if</span> (<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#ad2deb1000d47f2e1524f1f5dee059b34">fin_ack_rcvd</a>)
                            {
                                <span class="keyword">event</span> = <a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32a2f4afa3cc8122b708143ae335b542179">TCP_E_RCV_FIN_ACK</a>;
                                <span class="comment">// start the time-wait timer, turn off the other timers</span>
                                <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ad06a2b75a619021592db07ab486f0fed">cancelEvent</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a2a3d3f1792941e08c490795d1d2a4bc0">finWait2Timer</a>);
                                <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae1ff44c73d20293a446adc091842bedd">scheduleTimeout</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a67c3fa718ee0542b4bd93eda8785c0fc">the2MSLTimer</a>, <a class="code" href="_t_c_p_connection_8h.html#a25bdc88481176d96d87d31d71f32579b">TCP_TIMEOUT_2MSL</a>);

                                <span class="comment">// we&#39;re entering TIME_WAIT, so we can signal CLOSED the user</span>
                                <span class="comment">// (the only thing left to do is wait until the 2MSL timer expires)</span>
                                <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a65a8dc93c08a685f145248d0fb327428">sendIndicationToApp</a>(<a class="code" href="_t_c_p_command__m_8h.html#a68611fc79dbc74e8744d74b746cd956ba994690e6a29c6e7c3eedc8fbb29d7a8c">TCP_I_CLOSED</a>);
                            }
                            <span class="keywordflow">break</span>;
                        <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaaea07c6aa092a0b2e9141385fb4734797">TCP_S_FIN_WAIT_2</a>:
                            <span class="comment">// Start the time-wait timer, turn off the other timers.</span>
                            <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ad06a2b75a619021592db07ab486f0fed">cancelEvent</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a2a3d3f1792941e08c490795d1d2a4bc0">finWait2Timer</a>);
                            <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae1ff44c73d20293a446adc091842bedd">scheduleTimeout</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a67c3fa718ee0542b4bd93eda8785c0fc">the2MSLTimer</a>, <a class="code" href="_t_c_p_connection_8h.html#a25bdc88481176d96d87d31d71f32579b">TCP_TIMEOUT_2MSL</a>);

                            <span class="comment">// we&#39;re entering TIME_WAIT, so we can signal CLOSED the user</span>
                            <span class="comment">// (the only thing left to do is wait until the 2MSL timer expires)</span>
                            <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a65a8dc93c08a685f145248d0fb327428">sendIndicationToApp</a>(<a class="code" href="_t_c_p_command__m_8h.html#a68611fc79dbc74e8744d74b746cd956ba994690e6a29c6e7c3eedc8fbb29d7a8c">TCP_I_CLOSED</a>);
                            <span class="keywordflow">break</span>;
                        <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaa8a4fa6fa69c727999ad6b8fe056a6fd1">TCP_S_TIME_WAIT</a>:
                            <span class="comment">// Restart the 2 MSL time-wait timeout.</span>
                            <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ad06a2b75a619021592db07ab486f0fed">cancelEvent</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a67c3fa718ee0542b4bd93eda8785c0fc">the2MSLTimer</a>);
                            <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae1ff44c73d20293a446adc091842bedd">scheduleTimeout</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a67c3fa718ee0542b4bd93eda8785c0fc">the2MSLTimer</a>, <a class="code" href="_t_c_p_connection_8h.html#a25bdc88481176d96d87d31d71f32579b">TCP_TIMEOUT_2MSL</a>);
                            <span class="keywordflow">break</span>;
                    }
                    <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a65a8dc93c08a685f145248d0fb327428">sendIndicationToApp</a>(<a class="code" href="_t_c_p_command__m_8h.html#a68611fc79dbc74e8744d74b746cd956ba98ff9f82c08b1d7ae58049835c47368a">TCP_I_PEER_CLOSED</a>);
                }
            }
        }
    }

    <span class="comment">//</span>
    <span class="comment">// RFC 793: eighth, check the FIN bit,</span>
    <span class="comment">//</span>
    <span class="keywordflow">if</span> (tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#aa7615b353254cbd11ea14f03e80c55f6">getFinBit</a>())
    {
        <span class="comment">//&quot;</span>
        <span class="comment">// If the FIN bit is set, signal the user &quot;connection closing&quot; and</span>
        <span class="comment">// return any pending RECEIVEs with same message, advance RCV.NXT</span>
        <span class="comment">// over the FIN, and send an acknowledgment for the FIN.  Note that</span>
        <span class="comment">// FIN implies PUSH for any segment text not yet delivered to the</span>
        <span class="comment">// user.</span>
        <span class="comment">//&quot;</span>

        <span class="comment">// Note: seems like RFC 793 is not entirely correct here: if the</span>
        <span class="comment">// segment is &quot;above sequence&quot; (ie. RCV.NXT &lt; SEG.SEQ), we cannot</span>
        <span class="comment">// advance RCV.NXT over the FIN. Instead we remember this sequence</span>
        <span class="comment">// number and do it later.</span>
        uint32 fin_seq = (uint32)tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a0dafe41ef5a4306a4106fdb1e22b19e8">getSequenceNo</a>() + (uint32)tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a7d9f010b71e3bfa267873ab21195fb73">getPayloadLength</a>();
        <span class="keywordflow">if</span> (<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a18b8a2c7e52c332378bd9f70b1d91b29">rcv_nxt</a>==fin_seq)
        {
            <span class="comment">// advance rcv_nxt over FIN now</span>
            <a class="code" href="_t_c_p_8h.html#a601325e92d65fe658c80eab711e12304">tcpEV</a> &lt;&lt; <span class="stringliteral">&quot;FIN arrived, advancing rcv_nxt over the FIN\n&quot;</span>;
            <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a18b8a2c7e52c332378bd9f70b1d91b29">rcv_nxt</a>++;
            <span class="comment">// state transitions will be done in the state machine, here we just set</span>
            <span class="comment">// the proper event code (TCP_E_RCV_FIN or TCP_E_RCV_FIN_ACK)</span>
            <span class="keyword">event</span> = <a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32a59323c4bb3247640d61362e7f6ba824e">TCP_E_RCV_FIN</a>;
            <span class="keywordflow">switch</span> (<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>.getState())
            {
                <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaa1366e9fbbf862cd3fdfa3ea08e641cb0">TCP_S_FIN_WAIT_1</a>:
                    <span class="keywordflow">if</span> (<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#ad2deb1000d47f2e1524f1f5dee059b34">fin_ack_rcvd</a>)
                    {
                        <span class="keyword">event</span> = <a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32a2f4afa3cc8122b708143ae335b542179">TCP_E_RCV_FIN_ACK</a>;
                        <span class="comment">// start the time-wait timer, turn off the other timers</span>
                        <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ad06a2b75a619021592db07ab486f0fed">cancelEvent</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a2a3d3f1792941e08c490795d1d2a4bc0">finWait2Timer</a>);
                        <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae1ff44c73d20293a446adc091842bedd">scheduleTimeout</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a67c3fa718ee0542b4bd93eda8785c0fc">the2MSLTimer</a>, <a class="code" href="_t_c_p_connection_8h.html#a25bdc88481176d96d87d31d71f32579b">TCP_TIMEOUT_2MSL</a>);

                        <span class="comment">// we&#39;re entering TIME_WAIT, so we can signal CLOSED the user</span>
                        <span class="comment">// (the only thing left to do is wait until the 2MSL timer expires)</span>
                        <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a65a8dc93c08a685f145248d0fb327428">sendIndicationToApp</a>(<a class="code" href="_t_c_p_command__m_8h.html#a68611fc79dbc74e8744d74b746cd956ba994690e6a29c6e7c3eedc8fbb29d7a8c">TCP_I_CLOSED</a>);
                    }
                    <span class="keywordflow">break</span>;
                <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaaea07c6aa092a0b2e9141385fb4734797">TCP_S_FIN_WAIT_2</a>:
                    <span class="comment">// Start the time-wait timer, turn off the other timers.</span>
                    <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ad06a2b75a619021592db07ab486f0fed">cancelEvent</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a2a3d3f1792941e08c490795d1d2a4bc0">finWait2Timer</a>);
                    <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae1ff44c73d20293a446adc091842bedd">scheduleTimeout</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a67c3fa718ee0542b4bd93eda8785c0fc">the2MSLTimer</a>, <a class="code" href="_t_c_p_connection_8h.html#a25bdc88481176d96d87d31d71f32579b">TCP_TIMEOUT_2MSL</a>);

                    <span class="comment">// we&#39;re entering TIME_WAIT, so we can signal CLOSED the user</span>
                    <span class="comment">// (the only thing left to do is wait until the 2MSL timer expires)</span>
                    <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a65a8dc93c08a685f145248d0fb327428">sendIndicationToApp</a>(<a class="code" href="_t_c_p_command__m_8h.html#a68611fc79dbc74e8744d74b746cd956ba994690e6a29c6e7c3eedc8fbb29d7a8c">TCP_I_CLOSED</a>);
                    <span class="keywordflow">break</span>;
                <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaa8a4fa6fa69c727999ad6b8fe056a6fd1">TCP_S_TIME_WAIT</a>:
                    <span class="comment">// Restart the 2 MSL time-wait timeout.</span>
                    <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ad06a2b75a619021592db07ab486f0fed">cancelEvent</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a67c3fa718ee0542b4bd93eda8785c0fc">the2MSLTimer</a>);
                    <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae1ff44c73d20293a446adc091842bedd">scheduleTimeout</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a67c3fa718ee0542b4bd93eda8785c0fc">the2MSLTimer</a>, <a class="code" href="_t_c_p_connection_8h.html#a25bdc88481176d96d87d31d71f32579b">TCP_TIMEOUT_2MSL</a>);
                    <span class="keywordflow">break</span>;
            }
            <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a65a8dc93c08a685f145248d0fb327428">sendIndicationToApp</a>(<a class="code" href="_t_c_p_command__m_8h.html#a68611fc79dbc74e8744d74b746cd956ba98ff9f82c08b1d7ae58049835c47368a">TCP_I_PEER_CLOSED</a>);
        }
        <span class="keywordflow">else</span>
        {
            <span class="comment">// we&#39;ll have to do it later (when an arriving segment &quot;fills the gap&quot;)</span>
            <a class="code" href="_t_c_p_8h.html#a601325e92d65fe658c80eab711e12304">tcpEV</a> &lt;&lt; <span class="stringliteral">&quot;FIN segment above sequence, storing sequence number of FIN\n&quot;</span>;
            <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a595ba253f26cb674ecd990bfd6d929c1">fin_rcvd</a> = <span class="keyword">true</span>;
            <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a4e7a46f4ab93fc16930f38b65cc5ff07">rcv_fin_seq</a> = fin_seq;
        }

        <span class="comment">// TBD do PUSH stuff</span>
    }

    <span class="keywordflow">if</span> (old_rcv_nxt!=<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a18b8a2c7e52c332378bd9f70b1d91b29">rcv_nxt</a>)
    {
        <span class="comment">// if rcv_nxt changed, either because we received segment text or we</span>
        <span class="comment">// received a FIN that needs to be acked (or both), we need to send or</span>
        <span class="comment">// schedule an ACK.</span>

        <span class="comment">// tcpAlgorithm decides when and how to do ACKs</span>
        <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a2212cb0deb11d2b1c5826cab57b3f42e">tcpAlgorithm</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_algorithm.html#a3c59a57936e92218369a8702956df1c7">receiveSeqChanged</a>();
    }

    <span class="keywordflow">if</span> ((<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>.getState()==<a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaa3b4387f45a765235dfda0bf3111ba1c6">TCP_S_ESTABLISHED</a> || <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>.getState()==<a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaaf96abc23364b3cdd51216d5cc9a4f3fc">TCP_S_SYN_RCVD</a>) &amp;&amp;
        <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a2a8d544b5707071afcc5402e6318e245">send_fin</a> &amp;&amp; <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#acab59efee35f446ab6310db804cd164d">snd_nxt</a>==<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a1156c4cdd71d0e83c9bb401a68e9f606">snd_fin_seq</a>+1)
    {
        <span class="comment">// if the user issued the CLOSE command a long time ago and we&#39;ve just</span>
        <span class="comment">// managed to send off FIN, we simulate a CLOSE command now (we had to</span>
        <span class="comment">// defer it at that time because we still had data in the send queue.)</span>
        <span class="comment">// This CLOSE will take us into the FIN_WAIT_1 state.</span>
        <a class="code" href="_t_c_p_8h.html#a601325e92d65fe658c80eab711e12304">tcpEV</a> &lt;&lt; <span class="stringliteral">&quot;Now we can do the CLOSE which was deferred a while ago\n&quot;</span>;
        <span class="keyword">event</span> = <a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32a2c5c582787e0b87a4a913e34c4d20d1b">TCP_E_CLOSE</a>;
    }

    <span class="keywordflow">if</span> (<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">fsm</a>.getState()==<a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaa3395b6fd6b4cf5d6165b37929d44eaa1">TCP_S_CLOSE_WAIT</a> &amp;&amp; <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a2a8d544b5707071afcc5402e6318e245">send_fin</a> &amp;&amp;
        <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#acab59efee35f446ab6310db804cd164d">snd_nxt</a>==<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a1156c4cdd71d0e83c9bb401a68e9f606">snd_fin_seq</a>+1 &amp;&amp; old_snd_nxt!=<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#acab59efee35f446ab6310db804cd164d">snd_nxt</a>)
    {
        <span class="comment">// if we&#39;re in CLOSE_WAIT and we just got to sent our long-pending FIN,</span>
        <span class="comment">// we simulate a CLOSE command now (we had to defer it at that time because</span>
        <span class="comment">// we still had data in the send queue.) This CLOSE will take us into the</span>
        <span class="comment">// LAST_ACK state.</span>
        <a class="code" href="_t_c_p_8h.html#a601325e92d65fe658c80eab711e12304">tcpEV</a> &lt;&lt; <span class="stringliteral">&quot;Now we can do the CLOSE which was deferred a while ago\n&quot;</span>;
        <span class="keyword">event</span> = <a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32a2c5c582787e0b87a4a913e34c4d20d1b">TCP_E_CLOSE</a>;
    }

    <span class="keywordflow">return</span> <a class="code" href="namespacecesnet.html#a56e29c69128db750fc49a508a16cf7ba">event</a>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a4d034577df86997140d627feeda66a1f"></a><!-- doxytag: member="tcp_old::TCPConnection::processSegmentInListen" ref="a4d034577df86997140d627feeda66a1f" args="(TCPSegment *tcpseg, IPvXAddress src, IPvXAddress dest)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32">TCPEventCode</a> <a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a4d034577df86997140d627feeda66a1f">TCPConnection::processSegmentInListen</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_t_c_p_segment.html">TCPSegment</a> *&#160;</td>
          <td class="paramname"><em>tcpseg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_i_pv_x_address.html">IPvXAddress</a>&#160;</td>
          <td class="paramname"><em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_i_pv_x_address.html">IPvXAddress</a>&#160;</td>
          <td class="paramname"><em>dest</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html#l00622">622</a> of file <a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html">old/TCPConnectionRcvSegment.cc</a>.</p>

<p>Referenced by <a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html#l00083">process_RCV_SEGMENT()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="_t_c_p_8h.html#a5eb334f5e4b6d6bb414d16141aca18af">tcpEV2</a> &lt;&lt; <span class="stringliteral">&quot;Processing segment in LISTEN\n&quot;</span>;

    <span class="comment">//&quot;</span>
    <span class="comment">// first check for an RST</span>
    <span class="comment">//   An incoming RST should be ignored.  Return.</span>
    <span class="comment">//&quot;</span>
    <span class="keywordflow">if</span> (tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a606da99a84d95c74bb1626436b6e5e12">getRstBit</a>())
    {
        <a class="code" href="_t_c_p_8h.html#a601325e92d65fe658c80eab711e12304">tcpEV</a> &lt;&lt; <span class="stringliteral">&quot;RST bit set: dropping segment\n&quot;</span>;
        <span class="keywordflow">return</span> <a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32acd405552b4f4c9973d5d5b7e8aae88f5">TCP_E_IGNORE</a>;
    }

    <span class="comment">//&quot;</span>
    <span class="comment">// second check for an ACK</span>
    <span class="comment">//    Any acknowledgment is bad if it arrives on a connection still in</span>
    <span class="comment">//    the LISTEN state.  An acceptable reset segment should be formed</span>
    <span class="comment">//    for any arriving ACK-bearing segment.  The RST should be</span>
    <span class="comment">//    formatted as follows:</span>
    <span class="comment">//</span>
    <span class="comment">//      &lt;SEQ=SEG.ACK&gt;&lt;CTL=RST&gt;</span>
    <span class="comment">//</span>
    <span class="comment">//    Return.</span>
    <span class="comment">//&quot;</span>
    <span class="keywordflow">if</span> (tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a8415708f568387985da223286a9e5bfa">getAckBit</a>())
    {
        <a class="code" href="_t_c_p_8h.html#a601325e92d65fe658c80eab711e12304">tcpEV</a> &lt;&lt; <span class="stringliteral">&quot;ACK bit set: dropping segment and sending RST\n&quot;</span>;
        <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#afa03f88fc4589249aefe6f828eed9dd6">sendRst</a>(tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a853ab8ce8acfb5da053fa9ca24592ce8">getAckNo</a>(),destAddr,srcAddr,tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a9120715e275fdb4745fa15b300236d9a">getDestPort</a>(),tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#aca825ab6ff9fc98f52315c36254a66be">getSrcPort</a>());
        <span class="keywordflow">return</span> <a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32acd405552b4f4c9973d5d5b7e8aae88f5">TCP_E_IGNORE</a>;
    }

    <span class="comment">//&quot;</span>
    <span class="comment">// third check for a SYN</span>
    <span class="comment">//&quot;</span>
    <span class="keywordflow">if</span> (tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#affebf261c9d4fc303151a484d61d8bb7">getSynBit</a>())
    {
        <span class="keywordflow">if</span> (tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#aa7615b353254cbd11ea14f03e80c55f6">getFinBit</a>())
        {
            <span class="comment">// Looks like implementations vary on how to react to SYN+FIN.</span>
            <span class="comment">// Some treat it as plain SYN (and reply with SYN+ACK), some send RST+ACK.</span>
            <span class="comment">// Let&#39;s just do the former here.</span>
            <a class="code" href="_t_c_p_8h.html#a601325e92d65fe658c80eab711e12304">tcpEV</a> &lt;&lt; <span class="stringliteral">&quot;SYN+FIN received: ignoring FIN\n&quot;</span>;
        }

        <a class="code" href="_t_c_p_8h.html#a601325e92d65fe658c80eab711e12304">tcpEV</a> &lt;&lt; <span class="stringliteral">&quot;SYN bit set: filling in foreign socket and sending SYN+ACK\n&quot;</span>;

        <span class="comment">//&quot;</span>
        <span class="comment">// If the listen was not fully specified (i.e., the foreign socket was not</span>
        <span class="comment">// fully specified), then the unspecified fields should be filled in now.</span>
        <span class="comment">//&quot;</span>
        <span class="comment">//</span>
        <span class="comment">// Also, we may need to fork, in order to leave another connection</span>
        <span class="comment">// LISTENing on the port. Note: forking will change our connId.</span>
        <span class="comment">//</span>
        <span class="keywordflow">if</span> (<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a4f418e2320cca13bdf3a673ae74989ac">fork</a>)
        {
            <a class="code" href="classtcp__old_1_1_t_c_p_connection.html">TCPConnection</a> *conn = <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a1d5624dcbc77e79d142f6a886b3e788d">cloneListeningConnection</a>(); <span class="comment">// this will stay LISTENing</span>
            <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a6f9eb8f2af118d2f1fcd90df3c87249e">tcpMain</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p.html#abec1cedad1e72a349f7bd804501584fa">addForkedConnection</a>(<span class="keyword">this</span>, conn, destAddr, srcAddr, tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a9120715e275fdb4745fa15b300236d9a">getDestPort</a>(), tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#aca825ab6ff9fc98f52315c36254a66be">getSrcPort</a>());
            <a class="code" href="_t_c_p_8h.html#a601325e92d65fe658c80eab711e12304">tcpEV</a> &lt;&lt; <span class="stringliteral">&quot;Connection forked: this connection got new connId=&quot;</span> &lt;&lt; <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae6ce2bfc0b9aa9d110db13efe08b7a0e">connId</a> &lt;&lt; <span class="stringliteral">&quot;, &quot;</span>
                     <span class="stringliteral">&quot;spinoff keeps LISTENing with connId=&quot;</span> &lt;&lt; conn-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae6ce2bfc0b9aa9d110db13efe08b7a0e">connId</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;
        }
        <span class="keywordflow">else</span>
        {
            <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a6f9eb8f2af118d2f1fcd90df3c87249e">tcpMain</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p.html#a89cade3eb3a3f44ffae57c08dedd9285">updateSockPair</a>(<span class="keyword">this</span>, destAddr, srcAddr, tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a9120715e275fdb4745fa15b300236d9a">getDestPort</a>(), tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#aca825ab6ff9fc98f52315c36254a66be">getSrcPort</a>());
        }

        <span class="comment">//&quot;</span>
        <span class="comment">//  Set RCV.NXT to SEG.SEQ+1, IRS is set to SEG.SEQ and any other</span>
        <span class="comment">//  control or text should be queued for processing later.  ISS</span>
        <span class="comment">//  should be selected and a SYN segment sent of the form:</span>
        <span class="comment">//</span>
        <span class="comment">//    &lt;SEQ=ISS&gt;&lt;ACK=RCV.NXT&gt;&lt;CTL=SYN,ACK&gt;</span>
        <span class="comment">//</span>
        <span class="comment">//  SND.NXT is set to ISS+1 and SND.UNA to ISS.  The connection</span>
        <span class="comment">//  state should be changed to SYN-RECEIVED.</span>
        <span class="comment">//&quot;</span>
        <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a18b8a2c7e52c332378bd9f70b1d91b29">rcv_nxt</a> = tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a0dafe41ef5a4306a4106fdb1e22b19e8">getSequenceNo</a>()+1;
        <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#af9fc103c0361bcaffc4c894627abfc2d">irs</a> = tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a0dafe41ef5a4306a4106fdb1e22b19e8">getSequenceNo</a>();
        <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a2602ec64d45270793076abe5938d16ac">receiveQueue</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_receive_queue.html#aeec7fc4688fecfdd84653b748ff1c21e">init</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a18b8a2c7e52c332378bd9f70b1d91b29">rcv_nxt</a>);   <span class="comment">// FIXME may init twice...</span>
        <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a585bbcdd70565eb01b6bfe17a1487c78">selectInitialSeqNum</a>();

        <span class="comment">// although not mentioned in RFC 793, seems like we have to pick up</span>
        <span class="comment">// initial snd_wnd from the segment here.</span>
        <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a98ce75b56709cdf80549bf95b9b02023">snd_wnd</a> = tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a8ef1b3d7dceadd931a331c121e55c556">getWindow</a>();
        <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a4ddf055ba61bab9723814bfb1f55cfe5">snd_wl1</a> = tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a0dafe41ef5a4306a4106fdb1e22b19e8">getSequenceNo</a>();
        <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#aae32069f7798da55852c7244d816b9a1">snd_wl2</a> = <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a74b7f93c1777b2428f37a7b8d2d8a5a4">iss</a>;
        <span class="keywordflow">if</span> (<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ab58ab42e2f19a58edcfa549b51a7179b">sndWndVector</a>) <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ab58ab42e2f19a58edcfa549b51a7179b">sndWndVector</a>-&gt;record(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a98ce75b56709cdf80549bf95b9b02023">snd_wnd</a>);

        <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a675b131a43de7429552a574cabcc12dd">sendSynAck</a>();
        <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#aa58f44bc38ec0af46aca654f9403771f">startSynRexmitTimer</a>();
        <span class="keywordflow">if</span> (!<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a757386355261e95064b75f2dfec3788e">connEstabTimer</a>-&gt;isScheduled())
            <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae1ff44c73d20293a446adc091842bedd">scheduleTimeout</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a757386355261e95064b75f2dfec3788e">connEstabTimer</a>, <a class="code" href="_t_c_p_connection_8h.html#a512458671be6d68703cc89178b0b35f0">TCP_TIMEOUT_CONN_ESTAB</a>);

        <span class="comment">//&quot;</span>
        <span class="comment">// Note that any other incoming control or data (combined with SYN)</span>
        <span class="comment">// will be processed in the SYN-RECEIVED state, but processing of SYN</span>
        <span class="comment">// and ACK should not be repeated.</span>
        <span class="comment">//&quot;</span>
        <span class="comment">// We don&#39;t send text in SYN or SYN+ACK, but accept it. Otherwise</span>
        <span class="comment">// there isn&#39;t much left to do: RST, SYN, ACK, FIN got processed already,</span>
        <span class="comment">// so there&#39;s only URG and PSH left to handle.</span>
        <span class="comment">//</span>
        <span class="keywordflow">if</span> (tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a7d9f010b71e3bfa267873ab21195fb73">getPayloadLength</a>()&gt;0)
            <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a2602ec64d45270793076abe5938d16ac">receiveQueue</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_receive_queue.html#a28492372a4252f374ba62fbdcce7a566">insertBytesFromSegment</a>(tcpseg);
        <span class="keywordflow">if</span> (tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a31028187ac8cf1f844d389b0e56baf8b">getUrgBit</a>() || tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a951517b397bea146bb642976521469d7">getPshBit</a>())
            <a class="code" href="_t_c_p_8h.html#a601325e92d65fe658c80eab711e12304">tcpEV</a> &lt;&lt; <span class="stringliteral">&quot;Ignoring URG and PSH bits in SYN\n&quot;</span>; <span class="comment">// TBD</span>

        <span class="keywordflow">return</span> <a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32a6769520e2e41d511462d3608d18326ed">TCP_E_RCV_SYN</a>;  <span class="comment">// this will take us to SYN_RCVD</span>
    }

    <span class="comment">//&quot;</span>
    <span class="comment">//  fourth other text or control</span>
    <span class="comment">//   So you are unlikely to get here, but if you do, drop the segment, and return.</span>
    <span class="comment">//&quot;</span>
    <a class="code" href="_t_c_p_8h.html#a601325e92d65fe658c80eab711e12304">tcpEV</a> &lt;&lt; <span class="stringliteral">&quot;Unexpected segment: dropping it\n&quot;</span>;
    <span class="keywordflow">return</span> <a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32acd405552b4f4c9973d5d5b7e8aae88f5">TCP_E_IGNORE</a>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a12b903f9e148f5c26f926dcdc8107c86"></a><!-- doxytag: member="tcp_old::TCPConnection::processSegmentInSynSent" ref="a12b903f9e148f5c26f926dcdc8107c86" args="(TCPSegment *tcpseg, IPvXAddress src, IPvXAddress dest)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32">TCPEventCode</a> <a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a12b903f9e148f5c26f926dcdc8107c86">TCPConnection::processSegmentInSynSent</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_t_c_p_segment.html">TCPSegment</a> *&#160;</td>
          <td class="paramname"><em>tcpseg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_i_pv_x_address.html">IPvXAddress</a>&#160;</td>
          <td class="paramname"><em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_i_pv_x_address.html">IPvXAddress</a>&#160;</td>
          <td class="paramname"><em>dest</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html#l00741">741</a> of file <a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html">old/TCPConnectionRcvSegment.cc</a>.</p>

<p>Referenced by <a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html#l00083">process_RCV_SEGMENT()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="_t_c_p_8h.html#a5eb334f5e4b6d6bb414d16141aca18af">tcpEV2</a> &lt;&lt; <span class="stringliteral">&quot;Processing segment in SYN_SENT\n&quot;</span>;

    <span class="comment">//&quot;</span>
    <span class="comment">// first check the ACK bit</span>
    <span class="comment">//</span>
    <span class="comment">//   If the ACK bit is set</span>
    <span class="comment">//</span>
    <span class="comment">//     If SEG.ACK =&lt; ISS, or SEG.ACK &gt; SND.NXT, send a reset (unless</span>
    <span class="comment">//     the RST bit is set, if so drop the segment and return)</span>
    <span class="comment">//</span>
    <span class="comment">//       &lt;SEQ=SEG.ACK&gt;&lt;CTL=RST&gt;</span>
    <span class="comment">//</span>
    <span class="comment">//     and discard the segment.  Return.</span>
    <span class="comment">//</span>
    <span class="comment">//     If SND.UNA =&lt; SEG.ACK =&lt; SND.NXT then the ACK is acceptable.</span>
    <span class="comment">//&quot;</span>
    <span class="keywordflow">if</span> (tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a8415708f568387985da223286a9e5bfa">getAckBit</a>())
    {
        <span class="keywordflow">if</span> (<a class="code" href="namespacetcp__old.html#a2a4d76c437a6e0eb1e1440c02153e5db">seqLE</a>(tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a853ab8ce8acfb5da053fa9ca24592ce8">getAckNo</a>(),<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a74b7f93c1777b2428f37a7b8d2d8a5a4">iss</a>) || <a class="code" href="namespacetcp__old.html#a91800c1929091c104e787a01f5955a9f">seqGreater</a>(tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a853ab8ce8acfb5da053fa9ca24592ce8">getAckNo</a>(),<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#acab59efee35f446ab6310db804cd164d">snd_nxt</a>))
        {
            <a class="code" href="_t_c_p_8h.html#a601325e92d65fe658c80eab711e12304">tcpEV</a> &lt;&lt; <span class="stringliteral">&quot;ACK bit set but wrong AckNo, sending RST\n&quot;</span>;
            <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#afa03f88fc4589249aefe6f828eed9dd6">sendRst</a>(tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a853ab8ce8acfb5da053fa9ca24592ce8">getAckNo</a>(),destAddr,srcAddr,tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a9120715e275fdb4745fa15b300236d9a">getDestPort</a>(),tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#aca825ab6ff9fc98f52315c36254a66be">getSrcPort</a>());
            <span class="keywordflow">return</span> <a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32acd405552b4f4c9973d5d5b7e8aae88f5">TCP_E_IGNORE</a>;
        }
        <a class="code" href="_t_c_p_8h.html#a601325e92d65fe658c80eab711e12304">tcpEV</a> &lt;&lt; <span class="stringliteral">&quot;ACK bit set, AckNo acceptable\n&quot;</span>;
    }

    <span class="comment">//&quot;</span>
    <span class="comment">// second check the RST bit</span>
    <span class="comment">//</span>
    <span class="comment">//   If the RST bit is set</span>
    <span class="comment">//</span>
    <span class="comment">//     If the ACK was acceptable then signal the user &quot;error:</span>
    <span class="comment">//     connection reset&quot;, drop the segment, enter CLOSED state,</span>
    <span class="comment">//     delete TCB, and return.  Otherwise (no ACK) drop the segment</span>
    <span class="comment">//     and return.</span>
    <span class="comment">//&quot;</span>
    <span class="keywordflow">if</span> (tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a606da99a84d95c74bb1626436b6e5e12">getRstBit</a>())
    {
        <span class="keywordflow">if</span> (tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a8415708f568387985da223286a9e5bfa">getAckBit</a>())
        {
            <a class="code" href="_t_c_p_8h.html#a601325e92d65fe658c80eab711e12304">tcpEV</a> &lt;&lt; <span class="stringliteral">&quot;RST+ACK: performing connection reset\n&quot;</span>;
            <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a65a8dc93c08a685f145248d0fb327428">sendIndicationToApp</a>(<a class="code" href="_t_c_p_command__m_8h.html#a68611fc79dbc74e8744d74b746cd956ba4e8f4551a34a27e607201754b36fdbe0">TCP_I_CONNECTION_RESET</a>);
            <span class="keywordflow">return</span> <a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32a050c79add513afca8554e29b61fd5389">TCP_E_RCV_RST</a>;
        }
        <span class="keywordflow">else</span>
        {
            <a class="code" href="_t_c_p_8h.html#a601325e92d65fe658c80eab711e12304">tcpEV</a> &lt;&lt; <span class="stringliteral">&quot;RST without ACK: dropping segment\n&quot;</span>;
            <span class="keywordflow">return</span> <a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32acd405552b4f4c9973d5d5b7e8aae88f5">TCP_E_IGNORE</a>;
        }
    }

    <span class="comment">//&quot;</span>
    <span class="comment">// third check the security and precedence -- not done</span>
    <span class="comment">//</span>
    <span class="comment">// fourth check the SYN bit</span>
    <span class="comment">//</span>
    <span class="comment">//   This step should be reached only if the ACK is ok, or there is</span>
    <span class="comment">//   no ACK, and it the segment did not contain a RST.</span>
    <span class="comment">//</span>
    <span class="comment">//   If the SYN bit is on and the security/compartment and precedence</span>
    <span class="comment">//   are acceptable then,</span>
    <span class="comment">//&quot;</span>
    <span class="keywordflow">if</span> (tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#affebf261c9d4fc303151a484d61d8bb7">getSynBit</a>())
    {
        <span class="comment">//</span>
        <span class="comment">//   RCV.NXT is set to SEG.SEQ+1, IRS is set to</span>
        <span class="comment">//   SEG.SEQ.  SND.UNA should be advanced to equal SEG.ACK (if there</span>
        <span class="comment">//   is an ACK), and any segments on the retransmission queue which</span>
        <span class="comment">//   are thereby acknowledged should be removed.</span>
        <span class="comment">//</span>
        <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a18b8a2c7e52c332378bd9f70b1d91b29">rcv_nxt</a> = tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a0dafe41ef5a4306a4106fdb1e22b19e8">getSequenceNo</a>()+1;
        <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#af9fc103c0361bcaffc4c894627abfc2d">irs</a> = tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a0dafe41ef5a4306a4106fdb1e22b19e8">getSequenceNo</a>();
        <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a2602ec64d45270793076abe5938d16ac">receiveQueue</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_receive_queue.html#aeec7fc4688fecfdd84653b748ff1c21e">init</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a18b8a2c7e52c332378bd9f70b1d91b29">rcv_nxt</a>);

        <span class="keywordflow">if</span> (tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a8415708f568387985da223286a9e5bfa">getAckBit</a>())
        {
            <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#ace4a453b30bdffb99c1c0646fba597dc">snd_una</a> = tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a853ab8ce8acfb5da053fa9ca24592ce8">getAckNo</a>();
            <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a7bd9b6b2b4422771b92e00d307983d19">sendQueue</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_send_queue.html#aced2fde7fde0ec8f6a32b1e16d6bbda9">discardUpTo</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#ace4a453b30bdffb99c1c0646fba597dc">snd_una</a>);

            <span class="comment">// although not mentioned in RFC 793, seems like we have to pick up</span>
            <span class="comment">// initial snd_wnd from the segment here.</span>
            <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a98ce75b56709cdf80549bf95b9b02023">snd_wnd</a> = tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a8ef1b3d7dceadd931a331c121e55c556">getWindow</a>();
            <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a4ddf055ba61bab9723814bfb1f55cfe5">snd_wl1</a> = tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a0dafe41ef5a4306a4106fdb1e22b19e8">getSequenceNo</a>();
            <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#aae32069f7798da55852c7244d816b9a1">snd_wl2</a> = tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a853ab8ce8acfb5da053fa9ca24592ce8">getAckNo</a>();
            <span class="keywordflow">if</span> (<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ab58ab42e2f19a58edcfa549b51a7179b">sndWndVector</a>) <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ab58ab42e2f19a58edcfa549b51a7179b">sndWndVector</a>-&gt;record(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a98ce75b56709cdf80549bf95b9b02023">snd_wnd</a>);
        }

        <span class="comment">// this also seems to be a good time to learn our local IP address</span>
        <span class="comment">// (was probably unspecified at connection open)</span>
        <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a6f9eb8f2af118d2f1fcd90df3c87249e">tcpMain</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p.html#a89cade3eb3a3f44ffae57c08dedd9285">updateSockPair</a>(<span class="keyword">this</span>, destAddr, srcAddr, tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a9120715e275fdb4745fa15b300236d9a">getDestPort</a>(), tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#aca825ab6ff9fc98f52315c36254a66be">getSrcPort</a>());

        <span class="comment">//&quot;</span>
        <span class="comment">//   If SND.UNA &gt; ISS (our SYN has been ACKed), change the connection</span>
        <span class="comment">//   state to ESTABLISHED, form an ACK segment</span>
        <span class="comment">//</span>
        <span class="comment">//     &lt;SEQ=SND.NXT&gt;&lt;ACK=RCV.NXT&gt;&lt;CTL=ACK&gt;</span>
        <span class="comment">//</span>
        <span class="comment">//   and send it.  Data or controls which were queued for</span>
        <span class="comment">//   transmission may be included.  If there are other controls or</span>
        <span class="comment">//   text in the segment then continue processing at the sixth step</span>
        <span class="comment">//   below where the URG bit is checked, otherwise return.</span>
        <span class="comment">//&quot;</span>
        <span class="keywordflow">if</span> (<a class="code" href="namespacetcp__old.html#a91800c1929091c104e787a01f5955a9f">seqGreater</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#ace4a453b30bdffb99c1c0646fba597dc">snd_una</a>, <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a74b7f93c1777b2428f37a7b8d2d8a5a4">iss</a>))
        {
            <a class="code" href="_t_c_p_8h.html#a601325e92d65fe658c80eab711e12304">tcpEV</a> &lt;&lt; <span class="stringliteral">&quot;SYN+ACK bits set, connection established.\n&quot;</span>;

            <span class="comment">// RFC says &quot;continue processing at the sixth step below where</span>
            <span class="comment">// the URG bit is checked&quot;. Those steps deal with: URG, segment text</span>
            <span class="comment">// (and PSH), and FIN.</span>
            <span class="comment">// Now: URG and PSH we don&#39;t support yet; in SYN+FIN we ignore FIN;</span>
            <span class="comment">// with segment text we just take it easy and put it in the receiveQueue</span>
            <span class="comment">// -- we&#39;ll forward it to the user when more data arrives.</span>
            <span class="keywordflow">if</span> (tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#aa7615b353254cbd11ea14f03e80c55f6">getFinBit</a>())
                <a class="code" href="_t_c_p_8h.html#a601325e92d65fe658c80eab711e12304">tcpEV</a> &lt;&lt; <span class="stringliteral">&quot;SYN+ACK+FIN received: ignoring FIN\n&quot;</span>;
            <span class="keywordflow">if</span> (tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a7d9f010b71e3bfa267873ab21195fb73">getPayloadLength</a>()&gt;0)
                <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a18b8a2c7e52c332378bd9f70b1d91b29">rcv_nxt</a> = <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a2602ec64d45270793076abe5938d16ac">receiveQueue</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_receive_queue.html#a28492372a4252f374ba62fbdcce7a566">insertBytesFromSegment</a>(tcpseg); <span class="comment">// TBD forward to app, etc.</span>
            <span class="keywordflow">if</span> (tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a31028187ac8cf1f844d389b0e56baf8b">getUrgBit</a>() || tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a951517b397bea146bb642976521469d7">getPshBit</a>())
                <a class="code" href="_t_c_p_8h.html#a601325e92d65fe658c80eab711e12304">tcpEV</a> &lt;&lt; <span class="stringliteral">&quot;Ignoring URG and PSH bits in SYN+ACK\n&quot;</span>; <span class="comment">// TBD</span>

            <span class="comment">// notify tcpAlgorithm (it has to send ACK of SYN) and app layer</span>
            <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a2212cb0deb11d2b1c5826cab57b3f42e">tcpAlgorithm</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_algorithm.html#a6bbeaec803a6c9e148ba36c838c267a5">established</a>(<span class="keyword">true</span>);
            <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ab04a91abde05d21293c30a78ab968eef">sendEstabIndicationToApp</a>();

            <span class="comment">// This will trigger transition to ESTABLISHED. Timers and notifying</span>
            <span class="comment">// app will be taken care of in stateEntered().</span>
            <span class="keywordflow">return</span> <a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32a3239eea5ba6edf6850289914cfac51c8">TCP_E_RCV_SYN_ACK</a>;
        }

        <span class="comment">//&quot;</span>
        <span class="comment">//   Otherwise enter SYN-RECEIVED, form a SYN,ACK segment</span>
        <span class="comment">//</span>
        <span class="comment">//     &lt;SEQ=ISS&gt;&lt;ACK=RCV.NXT&gt;&lt;CTL=SYN,ACK&gt;</span>
        <span class="comment">//</span>
        <span class="comment">//   and send it.  If there are other controls or text in the</span>
        <span class="comment">//   segment, queue them for processing after the ESTABLISHED state</span>
        <span class="comment">//   has been reached, return.</span>
        <span class="comment">//&quot;</span>
        <a class="code" href="_t_c_p_8h.html#a601325e92d65fe658c80eab711e12304">tcpEV</a> &lt;&lt; <span class="stringliteral">&quot;SYN bit set: sending SYN+ACK\n&quot;</span>;
        <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a7589e90fe54f9579ab547d55760b4d17">snd_max</a> = <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#acab59efee35f446ab6310db804cd164d">snd_nxt</a> = <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a74b7f93c1777b2428f37a7b8d2d8a5a4">iss</a>;
        <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a675b131a43de7429552a574cabcc12dd">sendSynAck</a>();
        <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#aa58f44bc38ec0af46aca654f9403771f">startSynRexmitTimer</a>();

        <span class="comment">// Note: code below is similar to processing SYN in LISTEN.</span>

        <span class="comment">// For consistency with that code, we ignore SYN+FIN here</span>
        <span class="keywordflow">if</span> (tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#aa7615b353254cbd11ea14f03e80c55f6">getFinBit</a>())
            <a class="code" href="_t_c_p_8h.html#a601325e92d65fe658c80eab711e12304">tcpEV</a> &lt;&lt; <span class="stringliteral">&quot;SYN+FIN received: ignoring FIN\n&quot;</span>;

        <span class="comment">// We don&#39;t send text in SYN or SYN+ACK, but accept it. Otherwise</span>
        <span class="comment">// there isn&#39;t much left to do: RST, SYN, ACK, FIN got processed already,</span>
        <span class="comment">// so there&#39;s only URG and PSH left to handle.</span>
        <span class="keywordflow">if</span> (tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a7d9f010b71e3bfa267873ab21195fb73">getPayloadLength</a>()&gt;0)
            <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a2602ec64d45270793076abe5938d16ac">receiveQueue</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_receive_queue.html#a28492372a4252f374ba62fbdcce7a566">insertBytesFromSegment</a>(tcpseg);
        <span class="keywordflow">if</span> (tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a31028187ac8cf1f844d389b0e56baf8b">getUrgBit</a>() || tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a951517b397bea146bb642976521469d7">getPshBit</a>())
            <a class="code" href="_t_c_p_8h.html#a601325e92d65fe658c80eab711e12304">tcpEV</a> &lt;&lt; <span class="stringliteral">&quot;Ignoring URG and PSH bits in SYN\n&quot;</span>; <span class="comment">// TBD</span>
        <span class="keywordflow">return</span> <a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32a6769520e2e41d511462d3608d18326ed">TCP_E_RCV_SYN</a>;
    }

    <span class="comment">//&quot;</span>
    <span class="comment">// fifth, if neither of the SYN or RST bits is set then drop the</span>
    <span class="comment">// segment and return.</span>
    <span class="comment">//&quot;</span>
    <span class="keywordflow">return</span> <a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32acd405552b4f4c9973d5d5b7e8aae88f5">TCP_E_IGNORE</a>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a7f5f8ddb99114615c77fe0ccf16424e7"></a><!-- doxytag: member="tcp_old::TCPConnection::processTCPSegment" ref="a7f5f8ddb99114615c77fe0ccf16424e7" args="(TCPSegment *tcpSeg, IPvXAddress srcAddr, IPvXAddress destAddr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a7f5f8ddb99114615c77fe0ccf16424e7">TCPConnection::processTCPSegment</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_t_c_p_segment.html">TCPSegment</a> *&#160;</td>
          <td class="paramname"><em>tcpSeg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_i_pv_x_address.html">IPvXAddress</a>&#160;</td>
          <td class="paramname"><em>srcAddr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_i_pv_x_address.html">IPvXAddress</a>&#160;</td>
          <td class="paramname"><em>destAddr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Process incoming <a class="el" href="classtcp__old_1_1_t_c_p.html">TCP</a> segment. Normally returns true. A return value of false means that the connection structure must be deleted by the caller (<a class="el" href="classtcp__old_1_1_t_c_p.html">TCP</a>). </p>

<p>Definition at line <a class="el" href="old_2_t_c_p_connection_base_8cc_source.html#l00221">221</a> of file <a class="el" href="old_2_t_c_p_connection_base_8cc_source.html">old/TCPConnectionBase.cc</a>.</p>

<p>Referenced by <a class="el" href="old_2_t_c_p_8cc_source.html#l00084">tcp_old::TCP::handleMessage()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a8aaec47dd8098dbaa015f2e3e7b16442">printConnBrief</a>();
    <span class="keywordflow">if</span> (!<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#adc50d816f66c74441b608b01ed4800c7">localAddr</a>.<a class="code" href="class_i_pv_x_address.html#aa3534408a9aa5e4cb3fc141597d0ed1e">isUnspecified</a>())
    {
        ASSERT(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#adc50d816f66c74441b608b01ed4800c7">localAddr</a>==segDestAddr);
        ASSERT(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3af4312fbe2cd46bb1be1daf65715258">localPort</a>==tcpseg-&gt;getDestPort());
    }
    <span class="keywordflow">if</span> (!<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ad54931b7375eb7b6e51ca9862cb0a714">remoteAddr</a>.<a class="code" href="class_i_pv_x_address.html#aa3534408a9aa5e4cb3fc141597d0ed1e">isUnspecified</a>())
    {
        ASSERT(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ad54931b7375eb7b6e51ca9862cb0a714">remoteAddr</a>==segSrcAddr);
        ASSERT(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#aece396520a4675f35694895f37b35f88">remotePort</a>==tcpseg-&gt;getSrcPort());
    }

    <span class="keywordflow">if</span> (<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a9b7d3f811eab0367d3826dfb20c8d931">tryFastRoute</a>(tcpseg))
        <span class="keywordflow">return</span> <span class="keyword">true</span>;

    <span class="comment">// first do actions</span>
    <a class="code" href="_t_c_p_connection_8h.html#a9187fb8d597fec5e53124ffe46c7e85e">TCPEventCode</a> <span class="keyword">event</span> = <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a46ac1b09624942471db2eb76ef991143">process_RCV_SEGMENT</a>(tcpseg, segSrcAddr, segDestAddr);

    <span class="comment">// then state transitions</span>
    <span class="keywordflow">return</span> <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#aa1fe5fa359d4063c984d686e4166b798">performStateTransition</a>(<a class="code" href="namespacecesnet.html#a56e29c69128db750fc49a508a16cf7ba">event</a>);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a6f9e1e7a0cabaf710f2d37a19eea0caf"></a><!-- doxytag: member="tcp_old::TCPConnection::processTimer" ref="a6f9e1e7a0cabaf710f2d37a19eea0caf" args="(cMessage *msg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a6f9e1e7a0cabaf710f2d37a19eea0caf">TCPConnection::processTimer</a> </td>
          <td>(</td>
          <td class="paramtype">cMessage *&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Process self-messages (timers). Normally returns true. A return value of false means that the connection structure must be deleted by the caller (<a class="el" href="classtcp__old_1_1_t_c_p.html">TCP</a>). </p>

<p>Definition at line <a class="el" href="old_2_t_c_p_connection_base_8cc_source.html#l00184">184</a> of file <a class="el" href="old_2_t_c_p_connection_base_8cc_source.html">old/TCPConnectionBase.cc</a>.</p>

<p>Referenced by <a class="el" href="old_2_t_c_p_8cc_source.html#l00084">tcp_old::TCP::handleMessage()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a8aaec47dd8098dbaa015f2e3e7b16442">printConnBrief</a>();
    <a class="code" href="_t_c_p_8h.html#a601325e92d65fe658c80eab711e12304">tcpEV</a> &lt;&lt; msg-&gt;getName() &lt;&lt; <span class="stringliteral">&quot; timer expired\n&quot;</span>;

    <span class="comment">// first do actions</span>
    <a class="code" href="_t_c_p_connection_8h.html#a9187fb8d597fec5e53124ffe46c7e85e">TCPEventCode</a> <a class="code" href="namespacecesnet.html#a56e29c69128db750fc49a508a16cf7ba">event</a>;
    <span class="keywordflow">if</span> (msg==<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a67c3fa718ee0542b4bd93eda8785c0fc">the2MSLTimer</a>)
    {
        <span class="keyword">event</span> = <a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32a358c0a11572a1131e318543e4b64764a">TCP_E_TIMEOUT_2MSL</a>;
        <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae29072ef963e593c4c3053827ebbec6e">process_TIMEOUT_2MSL</a>();
    }
    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (msg==<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a757386355261e95064b75f2dfec3788e">connEstabTimer</a>)
    {
        <span class="keyword">event</span> = <a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32a6ba25d81f0bcad8dbc3f1f59ce2f08ed">TCP_E_TIMEOUT_CONN_ESTAB</a>;
        <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a7b47d21fa8a97f13cab52097f3332ea6">process_TIMEOUT_CONN_ESTAB</a>();
    }
    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (msg==<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a2a3d3f1792941e08c490795d1d2a4bc0">finWait2Timer</a>)
    {
        <span class="keyword">event</span> = <a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32a3d31d30a7eca2a0655da0b2c16df9500">TCP_E_TIMEOUT_FIN_WAIT_2</a>;
        <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a53d62d237307ad56bae8d320ff557e48">process_TIMEOUT_FIN_WAIT_2</a>();
    }
    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (msg==<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ad70c187b499189b370f99433eb825dcd">synRexmitTimer</a>)
    {
        <span class="keyword">event</span> = <a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32acd405552b4f4c9973d5d5b7e8aae88f5">TCP_E_IGNORE</a>;
        <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a33c6fe420de8b7fc6c09761f70118ed0">process_TIMEOUT_SYN_REXMIT</a>(event);
    }
    <span class="keywordflow">else</span>
    {
        <span class="keyword">event</span> = <a class="code" href="namespacetcp__old.html#abfa4f59944c07369d42e86a72040dd32acd405552b4f4c9973d5d5b7e8aae88f5">TCP_E_IGNORE</a>;
        <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a2212cb0deb11d2b1c5826cab57b3f42e">tcpAlgorithm</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_algorithm.html#a1139760efe38d49068564ab562e5c1f0">processTimer</a>(msg, event);
    }

    <span class="comment">// then state transitions</span>
    <span class="keywordflow">return</span> <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#aa1fe5fa359d4063c984d686e4166b798">performStateTransition</a>(event);
}
</pre></div>
</div>
</div>
<a class="anchor" id="ab2c57b0ff79eb111ca6840b8d7003b04"></a><!-- doxytag: member="tcp_old::TCPConnection::retransmitData" ref="ab2c57b0ff79eb111ca6840b8d7003b04" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classtcp__old_1_1_t_c_p_connection.html#ab2c57b0ff79eb111ca6840b8d7003b04">TCPConnection::retransmitData</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Utility: retransmit all from snd_una to snd_max </p>

<p>Definition at line <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00623">623</a> of file <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html">old/TCPConnectionUtil.cc</a>.</p>

<p>Referenced by <a class="el" href="old_2flavours_2_dumb_t_c_p_8cc_source.html#l00066">tcp_old::DumbTCP::processTimer()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="comment">// retransmit everything from snd_una</span>
    <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#acab59efee35f446ab6310db804cd164d">snd_nxt</a> = <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#ace4a453b30bdffb99c1c0646fba597dc">snd_una</a>;

    uint32 bytesToSend = <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a7589e90fe54f9579ab547d55760b4d17">snd_max</a> - <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#acab59efee35f446ab6310db804cd164d">snd_nxt</a>;
    ASSERT(bytesToSend!=0);

    <span class="comment">// TBD - avoid to send more than allowed - check cwnd and rwnd before retransmitting data!</span>
    <span class="keywordflow">while</span> (bytesToSend&gt;0)
    {
        uint32 bytes = <a class="code" href="_s_c_t_p_association_8h.html#ad61931b1ae6b8e5bb714e2e6744f4470">std::min</a>(bytesToSend, <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#aa63003ec3568a869469e95d848e836b7">snd_mss</a>);
        bytes = <a class="code" href="_s_c_t_p_association_8h.html#ad61931b1ae6b8e5bb714e2e6744f4470">std::min</a>(bytes, (uint32)(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a7bd9b6b2b4422771b92e00d307983d19">sendQueue</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_send_queue.html#acf03e0bbf6565ae7df7afa656d97ca18">getBytesAvailable</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#acab59efee35f446ab6310db804cd164d">snd_nxt</a>)));
        <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#af71155c4fad49ea52907d840463a06d5">sendSegment</a>(bytes);
        <span class="comment">// Do not send packets after the FIN.</span>
        <span class="comment">// fixes bug that occurs in examples/inet/bulktransfer at event #64043  T=13.861159213744</span>
        <span class="keywordflow">if</span> (<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a2a8d544b5707071afcc5402e6318e245">send_fin</a> &amp;&amp; <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#acab59efee35f446ab6310db804cd164d">snd_nxt</a>==<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a1156c4cdd71d0e83c9bb401a68e9f606">snd_fin_seq</a>+1)
            <span class="keywordflow">break</span>;
        bytesToSend -= bytes;
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a8ae68910942bd1ea6558ae7849ae22ea"></a><!-- doxytag: member="tcp_old::TCPConnection::retransmitOneSegment" ref="a8ae68910942bd1ea6558ae7849ae22ea" args="(bool called_at_rto)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a8ae68910942bd1ea6558ae7849ae22ea">TCPConnection::retransmitOneSegment</a> </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>called_at_rto</em></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Utility: retransmit one segment from snd_una </p>

<p>Definition at line <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00602">602</a> of file <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html">old/TCPConnectionUtil.cc</a>.</p>

<p>Referenced by <a class="el" href="old_2flavours_2_t_c_p_no_congestion_control_8cc_source.html#l00038">tcp_old::TCPNoCongestionControl::processRexmitTimer()</a>, <a class="el" href="old_2flavours_2_t_c_p_reno_8cc_source.html#l00041">tcp_old::TCPReno::processRexmitTimer()</a>, <a class="el" href="old_2flavours_2_t_c_p_tahoe_8cc_source.html#l00041">tcp_old::TCPTahoe::processRexmitTimer()</a>, <a class="el" href="old_2flavours_2_t_c_p_reno_8cc_source.html#l00130">tcp_old::TCPReno::receivedDuplicateAck()</a>, and <a class="el" href="old_2flavours_2_t_c_p_tahoe_8cc_source.html#l00111">tcp_old::TCPTahoe::receivedDuplicateAck()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="comment">// retransmit one segment at snd_una, and set snd_nxt accordingly (if not called at RTO)</span>
    uint32 old_snd_nxt = <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#acab59efee35f446ab6310db804cd164d">snd_nxt</a>;

    <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#acab59efee35f446ab6310db804cd164d">snd_nxt</a> = <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#ace4a453b30bdffb99c1c0646fba597dc">snd_una</a>;

    <a class="code" href="_i_n_e_t_defs_8h.html#a718b4eb2652c286f4d42dc18a8e71a1a">ulong</a> bytes = <a class="code" href="_s_c_t_p_association_8h.html#ad61931b1ae6b8e5bb714e2e6744f4470">std::min</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#aa63003ec3568a869469e95d848e836b7">snd_mss</a>, <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a7589e90fe54f9579ab547d55760b4d17">snd_max</a> - <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#acab59efee35f446ab6310db804cd164d">snd_nxt</a>);
    ASSERT(bytes!=0);

    <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#af71155c4fad49ea52907d840463a06d5">sendSegment</a>(bytes);

    <span class="keywordflow">if</span> (!called_at_rto)
    {
        <span class="keywordflow">if</span> (<a class="code" href="namespacetcp__old.html#a91800c1929091c104e787a01f5955a9f">seqGreater</a>(old_snd_nxt, <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#acab59efee35f446ab6310db804cd164d">snd_nxt</a>))
            <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#acab59efee35f446ab6310db804cd164d">snd_nxt</a> = old_snd_nxt;
    }
    <span class="comment">// notify</span>
    <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a2212cb0deb11d2b1c5826cab57b3f42e">tcpAlgorithm</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_algorithm.html#a522fdc8f478a358787e1a21a543532e2">ackSent</a>();
}
</pre></div>
</div>
</div>
<a class="anchor" id="ae1ff44c73d20293a446adc091842bedd"></a><!-- doxytag: member="tcp_old::TCPConnection::scheduleTimeout" ref="ae1ff44c73d20293a446adc091842bedd" args="(cMessage *msg, simtime_t timeout)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classtcp__old_1_1_t_c_p_connection.html#ae1ff44c73d20293a446adc091842bedd">tcp_old::TCPConnection::scheduleTimeout</a> </td>
          <td>(</td>
          <td class="paramtype">cMessage *&#160;</td>
          <td class="paramname"><em>msg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">simtime_t&#160;</td>
          <td class="paramname"><em>timeout</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Utility: start a timer </p>

<p>Definition at line <a class="el" href="_t_c_p_connection__old_8h_source.html#l00420">420</a> of file <a class="el" href="_t_c_p_connection__old_8h_source.html">TCPConnection_old.h</a>.</p>

<p>Referenced by <a class="el" href="old_2flavours_2_dumb_t_c_p_8cc_source.html#l00117">tcp_old::DumbTCP::dataSent()</a>, <a class="el" href="old_2_t_c_p_connection_event_proc_8cc_source.html#l00034">process_OPEN_ACTIVE()</a>, <a class="el" href="old_2_t_c_p_connection_event_proc_8cc_source.html#l00113">process_SEND()</a>, <a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html#l01125">process_TIMEOUT_SYN_REXMIT()</a>, <a class="el" href="old_2flavours_2_t_c_p_base_alg_8cc_source.html#l00179">tcp_old::TCPBaseAlg::processRexmitTimer()</a>, <a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html#l00114">processSegment1stThru8th()</a>, <a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html#l00622">processSegmentInListen()</a>, <a class="el" href="old_2flavours_2_dumb_t_c_p_8cc_source.html#l00066">tcp_old::DumbTCP::processTimer()</a>, <a class="el" href="old_2flavours_2_t_c_p_base_alg_8cc_source.html#l00329">tcp_old::TCPBaseAlg::receiveSeqChanged()</a>, <a class="el" href="old_2flavours_2_t_c_p_base_alg_8cc_source.html#l00245">tcp_old::TCPBaseAlg::startRexmitTimer()</a>, and <a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html#l01115">startSynRexmitTimer()</a>.</p>
<div class="fragment"><pre class="fragment">        {<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a6f9eb8f2af118d2f1fcd90df3c87249e">tcpMain</a>-&gt;scheduleAt(simTime()+<a class="code" href="_r_i_p_timer__m_8h.html#a8c453bfd16599e8a0b20f94bdc7c7506a51a69776ef0949e2b87cdae793625906">timeout</a>, msg);}
</pre></div>
</div>
</div>
<a class="anchor" id="a82f6b7680530f0f784e9d8efa78fa5a5"></a><!-- doxytag: member="tcp_old::TCPConnection::segmentArrivalWhileClosed" ref="a82f6b7680530f0f784e9d8efa78fa5a5" args="(TCPSegment *tcpseg, IPvXAddress src, IPvXAddress dest)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a82f6b7680530f0f784e9d8efa78fa5a5">TCPConnection::segmentArrivalWhileClosed</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_t_c_p_segment.html">TCPSegment</a> *&#160;</td>
          <td class="paramname"><em>tcpseg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_i_pv_x_address.html">IPvXAddress</a>&#160;</td>
          <td class="paramname"><em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_i_pv_x_address.html">IPvXAddress</a>&#160;</td>
          <td class="paramname"><em>dest</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>This method gets invoked from <a class="el" href="classtcp__old_1_1_t_c_p.html">TCP</a> when a segment arrives which doesn't belong to an existing connection. <a class="el" href="classtcp__old_1_1_t_c_p.html">TCP</a> creates a temporary connection object so that it can call this method, then immediately deletes it. </p>

<p>Definition at line <a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html#l00037">37</a> of file <a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html">old/TCPConnectionRcvSegment.cc</a>.</p>

<p>Referenced by <a class="el" href="old_2_t_c_p_8cc_source.html#l00175">tcp_old::TCP::segmentArrivalWhileClosed()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="_t_c_p_8h.html#a601325e92d65fe658c80eab711e12304">tcpEV</a> &lt;&lt; <span class="stringliteral">&quot;Seg arrived: &quot;</span>;
    <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a188549e7c936c8cad622c180d3200c69">printSegmentBrief</a>(tcpseg);

    <span class="comment">// This segment doesn&#39;t belong to any connection, so this object</span>
    <span class="comment">// must be a temp object created solely for the purpose of calling us</span>
    ASSERT(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>==NULL);
    <a class="code" href="_t_c_p_8h.html#a601325e92d65fe658c80eab711e12304">tcpEV</a> &lt;&lt; <span class="stringliteral">&quot;Segment doesn&#39;t belong to any existing connection\n&quot;</span>;

    <span class="comment">// RFC 793:</span>
    <span class="comment">//&quot;</span>
    <span class="comment">// all data in the incoming segment is discarded.  An incoming</span>
    <span class="comment">// segment containing a RST is discarded.  An incoming segment not</span>
    <span class="comment">// containing a RST causes a RST to be sent in response.  The</span>
    <span class="comment">// acknowledgment and sequence field values are selected to make the</span>
    <span class="comment">// reset sequence acceptable to the TCP that sent the offending</span>
    <span class="comment">// segment.</span>
    <span class="comment">//</span>
    <span class="comment">// If the ACK bit is off, sequence number zero is used,</span>
    <span class="comment">//</span>
    <span class="comment">//    &lt;SEQ=0&gt;&lt;ACK=SEG.SEQ+SEG.LEN&gt;&lt;CTL=RST,ACK&gt;</span>
    <span class="comment">//</span>
    <span class="comment">// If the ACK bit is on,</span>
    <span class="comment">//</span>
    <span class="comment">//    &lt;SEQ=SEG.ACK&gt;&lt;CTL=RST&gt;</span>
    <span class="comment">//&quot;</span>
    <span class="keywordflow">if</span> (tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a606da99a84d95c74bb1626436b6e5e12">getRstBit</a>())
    {
        <a class="code" href="_t_c_p_8h.html#a601325e92d65fe658c80eab711e12304">tcpEV</a> &lt;&lt; <span class="stringliteral">&quot;RST bit set: dropping segment\n&quot;</span>;
        <span class="keywordflow">return</span>;
    }

    <span class="keywordflow">if</span> (!tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a8415708f568387985da223286a9e5bfa">getAckBit</a>())
    {
        <a class="code" href="_t_c_p_8h.html#a601325e92d65fe658c80eab711e12304">tcpEV</a> &lt;&lt; <span class="stringliteral">&quot;ACK bit not set: sending RST+ACK\n&quot;</span>;
        uint32 ackNo = tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a0dafe41ef5a4306a4106fdb1e22b19e8">getSequenceNo</a>() + (uint32)tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a7d9f010b71e3bfa267873ab21195fb73">getPayloadLength</a>();
        <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ade3c9c38be0aa758b4eb448d5c1169b9">sendRstAck</a>(0,ackNo,destAddr,srcAddr,tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a9120715e275fdb4745fa15b300236d9a">getDestPort</a>(),tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#aca825ab6ff9fc98f52315c36254a66be">getSrcPort</a>());
    }
    <span class="keywordflow">else</span>
    {
        <a class="code" href="_t_c_p_8h.html#a601325e92d65fe658c80eab711e12304">tcpEV</a> &lt;&lt; <span class="stringliteral">&quot;ACK bit set: sending RST\n&quot;</span>;
        <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#afa03f88fc4589249aefe6f828eed9dd6">sendRst</a>(tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a853ab8ce8acfb5da053fa9ca24592ce8">getAckNo</a>(),destAddr,srcAddr,tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a9120715e275fdb4745fa15b300236d9a">getDestPort</a>(),tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#aca825ab6ff9fc98f52315c36254a66be">getSrcPort</a>());
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a585bbcdd70565eb01b6bfe17a1487c78"></a><!-- doxytag: member="tcp_old::TCPConnection::selectInitialSeqNum" ref="a585bbcdd70565eb01b6bfe17a1487c78" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a585bbcdd70565eb01b6bfe17a1487c78">TCPConnection::selectInitialSeqNum</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Utility: generates ISS and initializes corresponding state variables </p>

<p>Definition at line <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00320">320</a> of file <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html">old/TCPConnectionUtil.cc</a>.</p>

<p>Referenced by <a class="el" href="old_2_t_c_p_connection_event_proc_8cc_source.html#l00034">process_OPEN_ACTIVE()</a>, <a class="el" href="old_2_t_c_p_connection_event_proc_8cc_source.html#l00113">process_SEND()</a>, and <a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html#l00622">processSegmentInListen()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="comment">// set the initial send sequence number</span>
    <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a74b7f93c1777b2428f37a7b8d2d8a5a4">iss</a> = (<span class="keywordtype">unsigned</span> long)fmod(SIMTIME_DBL(simTime())*250000.0, 1.0+(double)(<span class="keywordtype">unsigned</span>)0xffffffffUL) &amp; 0xffffffffUL;

    <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#ace4a453b30bdffb99c1c0646fba597dc">snd_una</a> = <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#acab59efee35f446ab6310db804cd164d">snd_nxt</a> = <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a7589e90fe54f9579ab547d55760b4d17">snd_max</a> = <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a74b7f93c1777b2428f37a7b8d2d8a5a4">iss</a>;

    <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a7bd9b6b2b4422771b92e00d307983d19">sendQueue</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_send_queue.html#ace918ba2cb215baffc2c3136e35a0d16">init</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a74b7f93c1777b2428f37a7b8d2d8a5a4">iss</a>+1); <span class="comment">// +1 is for SYN</span>
}
</pre></div>
</div>
</div>
<a class="anchor" id="a60ee5bc5b391d621e7e684857e195151"></a><!-- doxytag: member="tcp_old::TCPConnection::sendAck" ref="a60ee5bc5b391d621e7e684857e195151" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a60ee5bc5b391d621e7e684857e195151">TCPConnection::sendAck</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Utility: send ACK </p>

<p>Definition at line <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00414">414</a> of file <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html">old/TCPConnectionUtil.cc</a>.</p>

<p>Referenced by <a class="el" href="old_2flavours_2_dumb_t_c_p_8cc_source.html#l00050">tcp_old::DumbTCP::established()</a>, <a class="el" href="old_2flavours_2_t_c_p_base_alg_8cc_source.html#l00141">tcp_old::TCPBaseAlg::established()</a>, <a class="el" href="old_2flavours_2_t_c_p_base_alg_8cc_source.html#l00235">tcp_old::TCPBaseAlg::processDelayedAckTimer()</a>, <a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html#l00114">processSegment1stThru8th()</a>, <a class="el" href="old_2flavours_2_dumb_t_c_p_8cc_source.html#l00107">tcp_old::DumbTCP::receivedAckForDataNotYetSent()</a>, <a class="el" href="old_2flavours_2_t_c_p_base_alg_8cc_source.html#l00419">tcp_old::TCPBaseAlg::receivedAckForDataNotYetSent()</a>, <a class="el" href="old_2flavours_2_dumb_t_c_p_8cc_source.html#l00081">tcp_old::DumbTCP::receivedOutOfOrderSegment()</a>, <a class="el" href="old_2flavours_2_t_c_p_base_alg_8cc_source.html#l00323">tcp_old::TCPBaseAlg::receivedOutOfOrderSegment()</a>, <a class="el" href="old_2flavours_2_dumb_t_c_p_8cc_source.html#l00087">tcp_old::DumbTCP::receiveSeqChanged()</a>, and <a class="el" href="old_2flavours_2_t_c_p_base_alg_8cc_source.html#l00329">tcp_old::TCPBaseAlg::receiveSeqChanged()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="class_t_c_p_segment.html">TCPSegment</a> *tcpseg = <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a462206e0bc50ae521a47a797552a0057">createTCPSegment</a>(<span class="stringliteral">&quot;ACK&quot;</span>);

    tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#aeb0193b718efcc2ae0522f451cd61486">setAckBit</a>(<span class="keyword">true</span>);
    tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#ad1d2bb885011423e134672910576d91c">setSequenceNo</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#acab59efee35f446ab6310db804cd164d">snd_nxt</a>);
    tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#ac41efddddd655dd36d8c5995002e2a62">setAckNo</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a18b8a2c7e52c332378bd9f70b1d91b29">rcv_nxt</a>);
    tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#af832b13637c4228c56b14e633c30616c">setWindow</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#ab26a1e5c5f13a245ef7578dc87e81cfe">rcv_wnd</a>);

    <span class="comment">// send it</span>
    <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a86143cf35f957006c5fe17c506be21c7">sendToIP</a>(tcpseg);

    <span class="comment">// notify</span>
    <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a2212cb0deb11d2b1c5826cab57b3f42e">tcpAlgorithm</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_algorithm.html#a522fdc8f478a358787e1a21a543532e2">ackSent</a>();
}
</pre></div>
</div>
</div>
<a class="anchor" id="ab2cbccc16b2f006369a83c51426e4bc5"></a><!-- doxytag: member="tcp_old::TCPConnection::sendData" ref="ab2cbccc16b2f006369a83c51426e4bc5" args="(bool fullSegmentsOnly, int congestionWindow=&#45;1)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classtcp__old_1_1_t_c_p_connection.html#ab2cbccc16b2f006369a83c51426e4bc5">TCPConnection::sendData</a> </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>fullSegmentsOnly</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>congestionWindow</em> = <code>-1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Utility: Send data from sendQueue, at most congestionWindow (-1 means no limit). FIXME adjust comment!!! If fullSegmentsOnly is set, don't send segments smaller than MSS (needed for Nagle). Returns true if some data was actually sent. </p>

<p>Definition at line <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00480">480</a> of file <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html">old/TCPConnectionUtil.cc</a>.</p>

<p>Referenced by <a class="el" href="old_2flavours_2_dumb_t_c_p_8cc_source.html#l00050">tcp_old::DumbTCP::established()</a>, <a class="el" href="old_2flavours_2_dumb_t_c_p_8cc_source.html#l00095">tcp_old::DumbTCP::receivedDataAck()</a>, <a class="el" href="old_2flavours_2_dumb_t_c_p_8cc_source.html#l00075">tcp_old::DumbTCP::sendCommandInvoked()</a>, and <a class="el" href="old_2flavours_2_t_c_p_base_alg_8cc_source.html#l00294">tcp_old::TCPBaseAlg::sendData()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordflow">if</span> (!<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a3a3438ec884f8d063558f87d793c1fee">afterRto</a>)
    {
        <span class="comment">// we&#39;ll start sending from snd_max</span>
        <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#acab59efee35f446ab6310db804cd164d">snd_nxt</a> = <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a7589e90fe54f9579ab547d55760b4d17">snd_max</a>;
    }

    <span class="comment">// check how many bytes we have</span>
    <a class="code" href="_i_n_e_t_defs_8h.html#a718b4eb2652c286f4d42dc18a8e71a1a">ulong</a> buffered = <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a7bd9b6b2b4422771b92e00d307983d19">sendQueue</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_send_queue.html#acf03e0bbf6565ae7df7afa656d97ca18">getBytesAvailable</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#acab59efee35f446ab6310db804cd164d">snd_nxt</a>);
    <span class="keywordflow">if</span> (buffered==0)
        <span class="keywordflow">return</span> <span class="keyword">false</span>;

    <span class="comment">// maxWindow is smaller of (snd_wnd, congestionWindow)</span>
    <span class="keywordtype">long</span> maxWindow = <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a98ce75b56709cdf80549bf95b9b02023">snd_wnd</a>;
    <span class="keywordflow">if</span> (congestionWindow&gt;=0 &amp;&amp; maxWindow &gt; congestionWindow)
        maxWindow = congestionWindow;

    <span class="comment">// effectiveWindow: number of bytes we&#39;re allowed to send now</span>
    <span class="keywordtype">long</span> effectiveWin = maxWindow - (<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#acab59efee35f446ab6310db804cd164d">snd_nxt</a> - <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#ace4a453b30bdffb99c1c0646fba597dc">snd_una</a>);
    <span class="keywordflow">if</span> (effectiveWin &lt;= 0)
    {
        <a class="code" href="_t_c_p_8h.html#a601325e92d65fe658c80eab711e12304">tcpEV</a> &lt;&lt; <span class="stringliteral">&quot;Effective window is zero (advertised window &quot;</span> &lt;&lt; <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a98ce75b56709cdf80549bf95b9b02023">snd_wnd</a> &lt;&lt;
                 <span class="stringliteral">&quot;, congestion window &quot;</span> &lt;&lt; congestionWindow &lt;&lt; <span class="stringliteral">&quot;), cannot send.\n&quot;</span>;
        <span class="keywordflow">return</span> <span class="keyword">false</span>;
    }

    <a class="code" href="_i_n_e_t_defs_8h.html#a718b4eb2652c286f4d42dc18a8e71a1a">ulong</a> bytesToSend = effectiveWin;

    <span class="keywordflow">if</span> (bytesToSend &gt; buffered)
        bytesToSend = buffered;

    <span class="keywordflow">if</span> (fullSegmentsOnly &amp;&amp; bytesToSend &lt; state-&gt;snd_mss &amp;&amp; buffered &gt; (<a class="code" href="_i_n_e_t_defs_8h.html#a718b4eb2652c286f4d42dc18a8e71a1a">ulong</a>) effectiveWin) <span class="comment">// last segment could be less than state-&gt;snd_mss</span>
    {
        <a class="code" href="_t_c_p_8h.html#a601325e92d65fe658c80eab711e12304">tcpEV</a> &lt;&lt; <span class="stringliteral">&quot;Cannot send, not enough data for a full segment (SMSS=&quot;</span> &lt;&lt; <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#aa63003ec3568a869469e95d848e836b7">snd_mss</a>
            &lt;&lt; <span class="stringliteral">&quot;, in buffer &quot;</span> &lt;&lt; buffered &lt;&lt; <span class="stringliteral">&quot;)\n&quot;</span>;
        <span class="keywordflow">return</span> <span class="keyword">false</span>;
    }

    <span class="comment">// start sending &#39;bytesToSend&#39; bytes</span>
    <a class="code" href="_t_c_p_8h.html#a601325e92d65fe658c80eab711e12304">tcpEV</a> &lt;&lt; <span class="stringliteral">&quot;Will send &quot;</span> &lt;&lt; bytesToSend &lt;&lt; <span class="stringliteral">&quot; bytes (effectiveWindow &quot;</span> &lt;&lt; effectiveWin
        &lt;&lt; <span class="stringliteral">&quot;, in buffer &quot;</span> &lt;&lt; buffered &lt;&lt; <span class="stringliteral">&quot; bytes)\n&quot;</span>;

    uint32 old_snd_nxt = <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#acab59efee35f446ab6310db804cd164d">snd_nxt</a>;
    ASSERT(bytesToSend&gt;0);

<span class="preprocessor">#ifdef TCP_SENDFRAGMENTS  </span><span class="comment">/* normally undefined */</span>
    <span class="comment">// make agressive use of the window until the last byte</span>
    <span class="keywordflow">while</span> (bytesToSend&gt;0)
    {
        <a class="code" href="_i_n_e_t_defs_8h.html#a718b4eb2652c286f4d42dc18a8e71a1a">ulong</a> bytes = <a class="code" href="_s_c_t_p_association_8h.html#ad61931b1ae6b8e5bb714e2e6744f4470">std::min</a>(bytesToSend, <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#aa63003ec3568a869469e95d848e836b7">snd_mss</a>);
        <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#af71155c4fad49ea52907d840463a06d5">sendSegment</a>(bytes);
        bytesToSend -= bytes;
    }
<span class="preprocessor">#else</span>
<span class="preprocessor"></span>    <span class="comment">// send &lt;MSS segments only if it&#39;s the only segment we can send now</span>
    <span class="comment">// FIXME this should probably obey Nagle&#39;s alg -- to be checked</span>
    <span class="keywordflow">if</span> (bytesToSend &lt;= state-&gt;snd_mss)
    {
        <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#af71155c4fad49ea52907d840463a06d5">sendSegment</a>(bytesToSend);
    }
    <span class="keywordflow">else</span>
    {
        <span class="comment">// send whole segments only (nagle_enabled)</span>
        <span class="keywordflow">while</span> (bytesToSend&gt;=<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#aa63003ec3568a869469e95d848e836b7">snd_mss</a>)
        {
            <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#af71155c4fad49ea52907d840463a06d5">sendSegment</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#aa63003ec3568a869469e95d848e836b7">snd_mss</a>);
            bytesToSend -= <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#aa63003ec3568a869469e95d848e836b7">snd_mss</a>;
        }
        <span class="comment">// check how many bytes we have - last segment could be less than state-&gt;snd_mss</span>
        buffered = <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a7bd9b6b2b4422771b92e00d307983d19">sendQueue</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_send_queue.html#acf03e0bbf6565ae7df7afa656d97ca18">getBytesAvailable</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#acab59efee35f446ab6310db804cd164d">snd_nxt</a>);
        <span class="keywordflow">if</span> (bytesToSend==buffered &amp;&amp; buffered!=0) <span class="comment">// last segment?</span>
            <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#af71155c4fad49ea52907d840463a06d5">sendSegment</a>(bytesToSend);
        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bytesToSend&gt;0)
            <a class="code" href="_t_c_p_8h.html#a601325e92d65fe658c80eab711e12304">tcpEV</a> &lt;&lt; bytesToSend &lt;&lt; <span class="stringliteral">&quot; bytes of space left in effectiveWindow\n&quot;</span>;
    }
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>
    <span class="comment">// remember highest seq sent (snd_nxt may be set back on retransmission,</span>
    <span class="comment">// but we&#39;ll need snd_max to check validity of ACKs -- they must ack</span>
    <span class="comment">// something we really sent)</span>
    <span class="keywordflow">if</span> (<a class="code" href="namespacetcp__old.html#a91800c1929091c104e787a01f5955a9f">seqGreater</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#acab59efee35f446ab6310db804cd164d">snd_nxt</a>, <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a7589e90fe54f9579ab547d55760b4d17">snd_max</a>))
        <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a7589e90fe54f9579ab547d55760b4d17">snd_max</a> = <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#acab59efee35f446ab6310db804cd164d">snd_nxt</a>;
    <span class="keywordflow">if</span> (<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a529775c184153f33ff75a91bacc8b0fc">unackedVector</a>) <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a529775c184153f33ff75a91bacc8b0fc">unackedVector</a>-&gt;record(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a7589e90fe54f9579ab547d55760b4d17">snd_max</a> - <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#ace4a453b30bdffb99c1c0646fba597dc">snd_una</a>);

    <span class="comment">// notify (once is enough)</span>
    <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a2212cb0deb11d2b1c5826cab57b3f42e">tcpAlgorithm</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_algorithm.html#a522fdc8f478a358787e1a21a543532e2">ackSent</a>();
    <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a2212cb0deb11d2b1c5826cab57b3f42e">tcpAlgorithm</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_algorithm.html#a2a8e9ea9d181d94d837c4ca41d38627b">dataSent</a>(old_snd_nxt);

    <span class="keywordflow">return</span> <span class="keyword">true</span>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="ab04a91abde05d21293c30a78ab968eef"></a><!-- doxytag: member="tcp_old::TCPConnection::sendEstabIndicationToApp" ref="ab04a91abde05d21293c30a78ab968eef" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classtcp__old_1_1_t_c_p_connection.html#ab04a91abde05d21293c30a78ab968eef">TCPConnection::sendEstabIndicationToApp</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Utility: sends TCP_I_ESTABLISHED indication with <a class="el" href="class_t_c_p_connect_info.html">TCPConnectInfo</a> to application </p>

<p>Definition at line <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00261">261</a> of file <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html">old/TCPConnectionUtil.cc</a>.</p>

<p>Referenced by <a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html#l00114">processSegment1stThru8th()</a>, and <a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html#l00741">processSegmentInSynSent()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="_t_c_p_8h.html#a601325e92d65fe658c80eab711e12304">tcpEV</a> &lt;&lt; <span class="stringliteral">&quot;Notifying app: &quot;</span> &lt;&lt; <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#adeef1c0b8f04a744168a107f68c397ba">indicationName</a>(<a class="code" href="_t_c_p_command__m_8h.html#a68611fc79dbc74e8744d74b746cd956ba778d635f284e560631e2b6ce594e3323">TCP_I_ESTABLISHED</a>) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;
    cMessage *msg = <span class="keyword">new</span> cMessage(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#adeef1c0b8f04a744168a107f68c397ba">indicationName</a>(<a class="code" href="_t_c_p_command__m_8h.html#a68611fc79dbc74e8744d74b746cd956ba778d635f284e560631e2b6ce594e3323">TCP_I_ESTABLISHED</a>));
    msg-&gt;setKind(<a class="code" href="_t_c_p_command__m_8h.html#a68611fc79dbc74e8744d74b746cd956ba778d635f284e560631e2b6ce594e3323">TCP_I_ESTABLISHED</a>);

    <a class="code" href="class_t_c_p_connect_info.html">TCPConnectInfo</a> *ind = <span class="keyword">new</span> <a class="code" href="class_t_c_p_connect_info.html">TCPConnectInfo</a>();
    ind-&gt;<a class="code" href="class_t_c_p_command.html#a4c843a0c691ac1bbbfc1307553131de3">setConnId</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae6ce2bfc0b9aa9d110db13efe08b7a0e">connId</a>);
    ind-&gt;<a class="code" href="class_t_c_p_connect_info.html#a88c615df6ba91e13c4dbd8e551b148fe">setLocalAddr</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#adc50d816f66c74441b608b01ed4800c7">localAddr</a>);
    ind-&gt;<a class="code" href="class_t_c_p_connect_info.html#a1cbcc49cfccade9bea7acbe7f4da0751">setRemoteAddr</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ad54931b7375eb7b6e51ca9862cb0a714">remoteAddr</a>);
    ind-&gt;<a class="code" href="class_t_c_p_connect_info.html#a0aebf300f8134eae08fee10bac3454f5">setLocalPort</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3af4312fbe2cd46bb1be1daf65715258">localPort</a>);
    ind-&gt;<a class="code" href="class_t_c_p_connect_info.html#ac055daa817b6d40678a32208b22258c4">setRemotePort</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#aece396520a4675f35694895f37b35f88">remotePort</a>);

    msg-&gt;setControlInfo(ind);
    <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a6f9eb8f2af118d2f1fcd90df3c87249e">tcpMain</a>-&gt;send(msg, <span class="stringliteral">&quot;appOut&quot;</span>, <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ad04d1e9fb23f48cd53dcd7c411caea80">appGateIndex</a>);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a70acf513d8461c73bfd06037036b1682"></a><!-- doxytag: member="tcp_old::TCPConnection::sendFin" ref="a70acf513d8461c73bfd06037036b1682" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a70acf513d8461c73bfd06037036b1682">TCPConnection::sendFin</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Utility: sends FIN </p>

<p>Definition at line <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00430">430</a> of file <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html">old/TCPConnectionUtil.cc</a>.</p>

<p>Referenced by <a class="el" href="old_2_t_c_p_connection_event_proc_8cc_source.html#l00161">process_CLOSE()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="class_t_c_p_segment.html">TCPSegment</a> *tcpseg = <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a462206e0bc50ae521a47a797552a0057">createTCPSegment</a>(<span class="stringliteral">&quot;FIN&quot;</span>);

    <span class="comment">// Note: ACK bit *must* be set for both FIN and FIN+ACK. What makes</span>
    <span class="comment">// the difference for FIN+ACK is that its ackNo acks the remote TCP&#39;s FIN.</span>
    tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a46867176335c6026208fa54d7689dcc8">setFinBit</a>(<span class="keyword">true</span>);
    tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#aeb0193b718efcc2ae0522f451cd61486">setAckBit</a>(<span class="keyword">true</span>);
    tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#ac41efddddd655dd36d8c5995002e2a62">setAckNo</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a18b8a2c7e52c332378bd9f70b1d91b29">rcv_nxt</a>);
    tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#ad1d2bb885011423e134672910576d91c">setSequenceNo</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#acab59efee35f446ab6310db804cd164d">snd_nxt</a>);
    tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#af832b13637c4228c56b14e633c30616c">setWindow</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#ab26a1e5c5f13a245ef7578dc87e81cfe">rcv_wnd</a>);

    <span class="comment">// send it</span>
    <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a86143cf35f957006c5fe17c506be21c7">sendToIP</a>(tcpseg);

    <span class="comment">// notify</span>
    <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a2212cb0deb11d2b1c5826cab57b3f42e">tcpAlgorithm</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_algorithm.html#a522fdc8f478a358787e1a21a543532e2">ackSent</a>();
}
</pre></div>
</div>
</div>
<a class="anchor" id="a65a8dc93c08a685f145248d0fb327428"></a><!-- doxytag: member="tcp_old::TCPConnection::sendIndicationToApp" ref="a65a8dc93c08a685f145248d0fb327428" args="(int code)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a65a8dc93c08a685f145248d0fb327428">TCPConnection::sendIndicationToApp</a> </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>code</em></td><td>)</td>
          <td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Utility: sends status indication (TCP_I_xxx) to application </p>

<p>Definition at line <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00250">250</a> of file <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html">old/TCPConnectionUtil.cc</a>.</p>

<p>Referenced by <a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html#l01059">process_TIMEOUT_CONN_ESTAB()</a>, <a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html#l01100">process_TIMEOUT_FIN_WAIT_2()</a>, <a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html#l00909">processRstInSynReceived()</a>, <a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html#l00114">processSegment1stThru8th()</a>, <a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html#l00741">processSegmentInSynSent()</a>, and <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00245">signalConnectionTimeout()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="_t_c_p_8h.html#a601325e92d65fe658c80eab711e12304">tcpEV</a> &lt;&lt; <span class="stringliteral">&quot;Notifying app: &quot;</span> &lt;&lt; <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#adeef1c0b8f04a744168a107f68c397ba">indicationName</a>(code) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;
    cMessage *msg = <span class="keyword">new</span> cMessage(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#adeef1c0b8f04a744168a107f68c397ba">indicationName</a>(code));
    msg-&gt;setKind(code);
    <a class="code" href="class_t_c_p_command.html">TCPCommand</a> *ind = <span class="keyword">new</span> <a class="code" href="class_t_c_p_command.html">TCPCommand</a>();
    ind-&gt;<a class="code" href="class_t_c_p_command.html#a4c843a0c691ac1bbbfc1307553131de3">setConnId</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae6ce2bfc0b9aa9d110db13efe08b7a0e">connId</a>);
    msg-&gt;setControlInfo(ind);
    <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a6f9eb8f2af118d2f1fcd90df3c87249e">tcpMain</a>-&gt;send(msg, <span class="stringliteral">&quot;appOut&quot;</span>, <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ad04d1e9fb23f48cd53dcd7c411caea80">appGateIndex</a>);
}
</pre></div>
</div>
</div>
<a class="anchor" id="ab07a8b0ce79c80e9baf75c3e82f56937"></a><!-- doxytag: member="tcp_old::TCPConnection::sendProbe" ref="ab07a8b0ce79c80e9baf75c3e82f56937" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classtcp__old_1_1_t_c_p_connection.html#ab07a8b0ce79c80e9baf75c3e82f56937">TCPConnection::sendProbe</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Utility: sends 1 bytes as "probe", called by the "persist" mechanism </p>

<p>Definition at line <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00572">572</a> of file <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html">old/TCPConnectionUtil.cc</a>.</p>

<p>Referenced by <a class="el" href="old_2flavours_2_t_c_p_base_alg_8cc_source.html#l00229">tcp_old::TCPBaseAlg::processPersistTimer()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="comment">// we&#39;ll start sending from snd_max</span>
    <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#acab59efee35f446ab6310db804cd164d">snd_nxt</a> = <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a7589e90fe54f9579ab547d55760b4d17">snd_max</a>;

    <span class="comment">// check we have 1 byte to send</span>
    <span class="keywordflow">if</span> (<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a7bd9b6b2b4422771b92e00d307983d19">sendQueue</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_send_queue.html#acf03e0bbf6565ae7df7afa656d97ca18">getBytesAvailable</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#acab59efee35f446ab6310db804cd164d">snd_nxt</a>)==0)
    {
        <a class="code" href="_t_c_p_8h.html#a601325e92d65fe658c80eab711e12304">tcpEV</a> &lt;&lt; <span class="stringliteral">&quot;Cannot send probe because send buffer is empty\n&quot;</span>;
        <span class="keywordflow">return</span> <span class="keyword">false</span>;
    }

    uint32 old_snd_nxt = <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#acab59efee35f446ab6310db804cd164d">snd_nxt</a>;

    <a class="code" href="_t_c_p_8h.html#a601325e92d65fe658c80eab711e12304">tcpEV</a> &lt;&lt; <span class="stringliteral">&quot;Sending 1 byte as probe, with seq=&quot;</span> &lt;&lt; <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#acab59efee35f446ab6310db804cd164d">snd_nxt</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;
    <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#af71155c4fad49ea52907d840463a06d5">sendSegment</a>(1);

    <span class="comment">// remember highest seq sent (snd_nxt may be set back on retransmission,</span>
    <span class="comment">// but we&#39;ll need snd_max to check validity of ACKs -- they must ack</span>
    <span class="comment">// something we really sent)</span>
    <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a7589e90fe54f9579ab547d55760b4d17">snd_max</a> = <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#acab59efee35f446ab6310db804cd164d">snd_nxt</a>;
    <span class="keywordflow">if</span> (<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a529775c184153f33ff75a91bacc8b0fc">unackedVector</a>) <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a529775c184153f33ff75a91bacc8b0fc">unackedVector</a>-&gt;record(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a7589e90fe54f9579ab547d55760b4d17">snd_max</a> - <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#ace4a453b30bdffb99c1c0646fba597dc">snd_una</a>);

    <span class="comment">// notify</span>
    <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a2212cb0deb11d2b1c5826cab57b3f42e">tcpAlgorithm</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_algorithm.html#a522fdc8f478a358787e1a21a543532e2">ackSent</a>();
    <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a2212cb0deb11d2b1c5826cab57b3f42e">tcpAlgorithm</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_algorithm.html#a2a8e9ea9d181d94d837c4ca41d38627b">dataSent</a>(old_snd_nxt);

    <span class="keywordflow">return</span> <span class="keyword">true</span>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="afa03f88fc4589249aefe6f828eed9dd6"></a><!-- doxytag: member="tcp_old::TCPConnection::sendRst" ref="afa03f88fc4589249aefe6f828eed9dd6" args="(uint32 seqNo)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classtcp__old_1_1_t_c_p_connection.html#afa03f88fc4589249aefe6f828eed9dd6">TCPConnection::sendRst</a> </td>
          <td>(</td>
          <td class="paramtype">uint32&#160;</td>
          <td class="paramname"><em>seqNo</em></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Utility: sends RST </p>

<p>Definition at line <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00376">376</a> of file <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html">old/TCPConnectionUtil.cc</a>.</p>

<p>Referenced by <a class="el" href="old_2_t_c_p_connection_event_proc_8cc_source.html#l00222">process_ABORT()</a>, <a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html#l00114">processSegment1stThru8th()</a>, <a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html#l00622">processSegmentInListen()</a>, <a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html#l00741">processSegmentInSynSent()</a>, and <a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html#l00037">segmentArrivalWhileClosed()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#afa03f88fc4589249aefe6f828eed9dd6">sendRst</a>(seqNo, <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#adc50d816f66c74441b608b01ed4800c7">localAddr</a>, <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ad54931b7375eb7b6e51ca9862cb0a714">remoteAddr</a>, <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3af4312fbe2cd46bb1be1daf65715258">localPort</a>, <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#aece396520a4675f35694895f37b35f88">remotePort</a>);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a3dc25263bb2f0b1013ee398c1587b128"></a><!-- doxytag: member="tcp_old::TCPConnection::sendRst" ref="a3dc25263bb2f0b1013ee398c1587b128" args="(uint32 seq, IPvXAddress src, IPvXAddress dest, int srcPort, int destPort)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classtcp__old_1_1_t_c_p_connection.html#afa03f88fc4589249aefe6f828eed9dd6">TCPConnection::sendRst</a> </td>
          <td>(</td>
          <td class="paramtype">uint32&#160;</td>
          <td class="paramname"><em>seq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_i_pv_x_address.html">IPvXAddress</a>&#160;</td>
          <td class="paramname"><em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_i_pv_x_address.html">IPvXAddress</a>&#160;</td>
          <td class="paramname"><em>dest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>srcPort</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>destPort</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Utility: sends RST; does not use connection state </p>

<p>Definition at line <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00381">381</a> of file <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html">old/TCPConnectionUtil.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="class_t_c_p_segment.html">TCPSegment</a> *tcpseg = <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a462206e0bc50ae521a47a797552a0057">createTCPSegment</a>(<span class="stringliteral">&quot;RST&quot;</span>);

    tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#ac6d2da16cb6c8949b2e01b2e3432902b">setSrcPort</a>(srcPort);
    tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a39fdd5e1dd84407f9d8f8926425c4e19">setDestPort</a>(destPort);

    tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a0bafe92cd008e16caed7f99f83e49683">setRstBit</a>(<span class="keyword">true</span>);
    tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#ad1d2bb885011423e134672910576d91c">setSequenceNo</a>(seq);

    <span class="comment">// send it</span>
    <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a86143cf35f957006c5fe17c506be21c7">sendToIP</a>(tcpseg, src, dest);
}
</pre></div>
</div>
</div>
<a class="anchor" id="ade3c9c38be0aa758b4eb448d5c1169b9"></a><!-- doxytag: member="tcp_old::TCPConnection::sendRstAck" ref="ade3c9c38be0aa758b4eb448d5c1169b9" args="(uint32 seq, uint32 ack, IPvXAddress src, IPvXAddress dest, int srcPort, int destPort)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classtcp__old_1_1_t_c_p_connection.html#ade3c9c38be0aa758b4eb448d5c1169b9">TCPConnection::sendRstAck</a> </td>
          <td>(</td>
          <td class="paramtype">uint32&#160;</td>
          <td class="paramname"><em>seq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32&#160;</td>
          <td class="paramname"><em>ack</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_i_pv_x_address.html">IPvXAddress</a>&#160;</td>
          <td class="paramname"><em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_i_pv_x_address.html">IPvXAddress</a>&#160;</td>
          <td class="paramname"><em>dest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>srcPort</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>destPort</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Utility: sends RST+ACK; does not use connection state </p>

<p>Definition at line <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00395">395</a> of file <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html">old/TCPConnectionUtil.cc</a>.</p>

<p>Referenced by <a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html#l00037">segmentArrivalWhileClosed()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="class_t_c_p_segment.html">TCPSegment</a> *tcpseg = <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a462206e0bc50ae521a47a797552a0057">createTCPSegment</a>(<span class="stringliteral">&quot;RST+ACK&quot;</span>);

    tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#ac6d2da16cb6c8949b2e01b2e3432902b">setSrcPort</a>(srcPort);
    tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a39fdd5e1dd84407f9d8f8926425c4e19">setDestPort</a>(destPort);

    tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a0bafe92cd008e16caed7f99f83e49683">setRstBit</a>(<span class="keyword">true</span>);
    tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#aeb0193b718efcc2ae0522f451cd61486">setAckBit</a>(<span class="keyword">true</span>);
    tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#ad1d2bb885011423e134672910576d91c">setSequenceNo</a>(seq);
    tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#ac41efddddd655dd36d8c5995002e2a62">setAckNo</a>(ack);

    <span class="comment">// send it</span>
    <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a86143cf35f957006c5fe17c506be21c7">sendToIP</a>(tcpseg, src, dest);

    <span class="comment">// notify</span>
    <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a2212cb0deb11d2b1c5826cab57b3f42e">tcpAlgorithm</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_algorithm.html#a522fdc8f478a358787e1a21a543532e2">ackSent</a>();
}
</pre></div>
</div>
</div>
<a class="anchor" id="af71155c4fad49ea52907d840463a06d5"></a><!-- doxytag: member="tcp_old::TCPConnection::sendSegment" ref="af71155c4fad49ea52907d840463a06d5" args="(uint32 bytes)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classtcp__old_1_1_t_c_p_connection.html#af71155c4fad49ea52907d840463a06d5">TCPConnection::sendSegment</a> </td>
          <td>(</td>
          <td class="paramtype">uint32&#160;</td>
          <td class="paramname"><em>bytes</em></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Utility: sends one segment of 'bytes' bytes from snd_nxt, and advances snd_nxt. <a class="el" href="classtcp__old_1_1_t_c_p_connection.html#ab2cbccc16b2f006369a83c51426e4bc5">sendData()</a>, <a class="el" href="classtcp__old_1_1_t_c_p_connection.html#ab07a8b0ce79c80e9baf75c3e82f56937">sendProbe()</a> and <a class="el" href="classtcp__old_1_1_t_c_p_connection.html#ab2c57b0ff79eb111ca6840b8d7003b04">retransmitData()</a> internally all rely on this one. </p>

<p>Definition at line <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00449">449</a> of file <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html">old/TCPConnectionUtil.cc</a>.</p>

<p>Referenced by <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00623">retransmitData()</a>, <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00602">retransmitOneSegment()</a>, <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00480">sendData()</a>, and <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00572">sendProbe()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="_i_n_e_t_defs_8h.html#a718b4eb2652c286f4d42dc18a8e71a1a">ulong</a> buffered = <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a7bd9b6b2b4422771b92e00d307983d19">sendQueue</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_send_queue.html#acf03e0bbf6565ae7df7afa656d97ca18">getBytesAvailable</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#acab59efee35f446ab6310db804cd164d">snd_nxt</a>);
    <span class="keywordflow">if</span> (bytes &gt; buffered) <span class="comment">// last segment?</span>
        bytes = buffered;

    <span class="comment">// send one segment of &#39;bytes&#39; bytes from snd_nxt, and advance snd_nxt</span>
    <a class="code" href="class_t_c_p_segment.html">TCPSegment</a> *tcpseg = <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a7bd9b6b2b4422771b92e00d307983d19">sendQueue</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_send_queue.html#aa2bd6a59bbf6f5adf7ce1d73e374d7fa">createSegmentWithBytes</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#acab59efee35f446ab6310db804cd164d">snd_nxt</a>, bytes);
    tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#ac41efddddd655dd36d8c5995002e2a62">setAckNo</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a18b8a2c7e52c332378bd9f70b1d91b29">rcv_nxt</a>);
    tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#aeb0193b718efcc2ae0522f451cd61486">setAckBit</a>(<span class="keyword">true</span>);
    tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#af832b13637c4228c56b14e633c30616c">setWindow</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#ab26a1e5c5f13a245ef7578dc87e81cfe">rcv_wnd</a>);
    <span class="comment">// TBD when to set PSH bit?</span>
    <span class="comment">// TBD set URG bit if needed</span>
    ASSERT(bytes==tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a7d9f010b71e3bfa267873ab21195fb73">getPayloadLength</a>());

    <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#acab59efee35f446ab6310db804cd164d">snd_nxt</a> += bytes;

    <span class="comment">// check if afterRto bit can be reset</span>
    <span class="keywordflow">if</span> (<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a3a3438ec884f8d063558f87d793c1fee">afterRto</a> &amp;&amp; <a class="code" href="namespacetcp__old.html#a0012c6f2a0631480574729efd85a05c9">seqGE</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#acab59efee35f446ab6310db804cd164d">snd_nxt</a>, <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a7589e90fe54f9579ab547d55760b4d17">snd_max</a>))
        <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a3a3438ec884f8d063558f87d793c1fee">afterRto</a> = <span class="keyword">false</span>;

    if (<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a2a8d544b5707071afcc5402e6318e245">send_fin</a> &amp;&amp; <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#acab59efee35f446ab6310db804cd164d">snd_nxt</a>==<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a1156c4cdd71d0e83c9bb401a68e9f606">snd_fin_seq</a>)
    {
        <a class="code" href="_t_c_p_8h.html#a601325e92d65fe658c80eab711e12304">tcpEV</a> &lt;&lt; <span class="stringliteral">&quot;Setting FIN on segment\n&quot;</span>;
        tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a46867176335c6026208fa54d7689dcc8">setFinBit</a>(<span class="keyword">true</span>);
        <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#acab59efee35f446ab6310db804cd164d">snd_nxt</a> = <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a1156c4cdd71d0e83c9bb401a68e9f606">snd_fin_seq</a>+1;
    }

    <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a86143cf35f957006c5fe17c506be21c7">sendToIP</a>(tcpseg);
}
</pre></div>
</div>
</div>
<a class="anchor" id="abcd8f7efecc7c0077050184d3384b493"></a><!-- doxytag: member="tcp_old::TCPConnection::sendSyn" ref="abcd8f7efecc7c0077050184d3384b493" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classtcp__old_1_1_t_c_p_connection.html#abcd8f7efecc7c0077050184d3384b493">TCPConnection::sendSyn</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Utility: send SYN </p>

<p>Definition at line <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00338">338</a> of file <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html">old/TCPConnectionUtil.cc</a>.</p>

<p>Referenced by <a class="el" href="old_2_t_c_p_connection_event_proc_8cc_source.html#l00034">process_OPEN_ACTIVE()</a>, <a class="el" href="old_2_t_c_p_connection_event_proc_8cc_source.html#l00113">process_SEND()</a>, and <a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html#l01125">process_TIMEOUT_SYN_REXMIT()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordflow">if</span> (<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ad54931b7375eb7b6e51ca9862cb0a714">remoteAddr</a>.<a class="code" href="class_i_pv_x_address.html#aa3534408a9aa5e4cb3fc141597d0ed1e">isUnspecified</a>() || <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#aece396520a4675f35694895f37b35f88">remotePort</a>==-1)
        opp_error(<span class="stringliteral">&quot;Error processing command OPEN_ACTIVE: foreign socket unspecified&quot;</span>);
    <span class="keywordflow">if</span> (<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3af4312fbe2cd46bb1be1daf65715258">localPort</a>==-1)
        opp_error(<span class="stringliteral">&quot;Error processing command OPEN_ACTIVE: local port unspecified&quot;</span>);

    <span class="comment">// create segment</span>
    <a class="code" href="class_t_c_p_segment.html">TCPSegment</a> *tcpseg = <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a462206e0bc50ae521a47a797552a0057">createTCPSegment</a>(<span class="stringliteral">&quot;SYN&quot;</span>);
    tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#ad1d2bb885011423e134672910576d91c">setSequenceNo</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a74b7f93c1777b2428f37a7b8d2d8a5a4">iss</a>);
    tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a78c8b6faccfd790b31c75b4652be3ab9">setSynBit</a>(<span class="keyword">true</span>);
    tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#af832b13637c4228c56b14e633c30616c">setWindow</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#ab26a1e5c5f13a245ef7578dc87e81cfe">rcv_wnd</a>);

    <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a7589e90fe54f9579ab547d55760b4d17">snd_max</a> = <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#acab59efee35f446ab6310db804cd164d">snd_nxt</a> = <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a74b7f93c1777b2428f37a7b8d2d8a5a4">iss</a>+1;

    <span class="comment">// send it</span>
    <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a86143cf35f957006c5fe17c506be21c7">sendToIP</a>(tcpseg);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a675b131a43de7429552a574cabcc12dd"></a><!-- doxytag: member="tcp_old::TCPConnection::sendSynAck" ref="a675b131a43de7429552a574cabcc12dd" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a675b131a43de7429552a574cabcc12dd">TCPConnection::sendSynAck</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Utility: send SYN+ACK </p>

<p>Definition at line <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00357">357</a> of file <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html">old/TCPConnectionUtil.cc</a>.</p>

<p>Referenced by <a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html#l01125">process_TIMEOUT_SYN_REXMIT()</a>, <a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html#l00622">processSegmentInListen()</a>, and <a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html#l00741">processSegmentInSynSent()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="comment">// create segment</span>
    <a class="code" href="class_t_c_p_segment.html">TCPSegment</a> *tcpseg = <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a462206e0bc50ae521a47a797552a0057">createTCPSegment</a>(<span class="stringliteral">&quot;SYN+ACK&quot;</span>);
    tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#ad1d2bb885011423e134672910576d91c">setSequenceNo</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a74b7f93c1777b2428f37a7b8d2d8a5a4">iss</a>);
    tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#ac41efddddd655dd36d8c5995002e2a62">setAckNo</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a18b8a2c7e52c332378bd9f70b1d91b29">rcv_nxt</a>);
    tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a78c8b6faccfd790b31c75b4652be3ab9">setSynBit</a>(<span class="keyword">true</span>);
    tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#aeb0193b718efcc2ae0522f451cd61486">setAckBit</a>(<span class="keyword">true</span>);
    tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#af832b13637c4228c56b14e633c30616c">setWindow</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#ab26a1e5c5f13a245ef7578dc87e81cfe">rcv_wnd</a>);

    <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a7589e90fe54f9579ab547d55760b4d17">snd_max</a> = <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#acab59efee35f446ab6310db804cd164d">snd_nxt</a> = <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a74b7f93c1777b2428f37a7b8d2d8a5a4">iss</a>+1;

    <span class="comment">// send it</span>
    <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a86143cf35f957006c5fe17c506be21c7">sendToIP</a>(tcpseg);

    <span class="comment">// notify</span>
    <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a2212cb0deb11d2b1c5826cab57b3f42e">tcpAlgorithm</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_algorithm.html#a522fdc8f478a358787e1a21a543532e2">ackSent</a>();
}
</pre></div>
</div>
</div>
<a class="anchor" id="a6aa48826843116a0f5c4e0fa37a69cfc"></a><!-- doxytag: member="tcp_old::TCPConnection::sendToApp" ref="a6aa48826843116a0f5c4e0fa37a69cfc" args="(cMessage *msg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a6aa48826843116a0f5c4e0fa37a69cfc">TCPConnection::sendToApp</a> </td>
          <td>(</td>
          <td class="paramtype">cMessage *&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Utility: sends packet to application </p>

<p>Definition at line <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00278">278</a> of file <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html">old/TCPConnectionUtil.cc</a>.</p>

<p>Referenced by <a class="el" href="old_2_t_c_p_connection_event_proc_8cc_source.html#l00253">process_STATUS()</a>, and <a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html#l00114">processSegment1stThru8th()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a6f9eb8f2af118d2f1fcd90df3c87249e">tcpMain</a>-&gt;send(msg, <span class="stringliteral">&quot;appOut&quot;</span>, <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ad04d1e9fb23f48cd53dcd7c411caea80">appGateIndex</a>);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a86143cf35f957006c5fe17c506be21c7"></a><!-- doxytag: member="tcp_old::TCPConnection::sendToIP" ref="a86143cf35f957006c5fe17c506be21c7" args="(TCPSegment *tcpseg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a86143cf35f957006c5fe17c506be21c7">TCPConnection::sendToIP</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_t_c_p_segment.html">TCPSegment</a> *&#160;</td>
          <td class="paramname"><em>tcpseg</em></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Utility: adds control info to segment and sends it to <a class="el" href="class_i_p.html">IP</a> </p>

<p>Definition at line <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00169">169</a> of file <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html">old/TCPConnectionUtil.cc</a>.</p>

<p>Referenced by <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00414">sendAck()</a>, <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00430">sendFin()</a>, <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00381">sendRst()</a>, <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00395">sendRstAck()</a>, <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00449">sendSegment()</a>, <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00338">sendSyn()</a>, and <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00357">sendSynAck()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="comment">// record seq (only if we do send data) and ackno</span>
    <span class="keywordflow">if</span> (<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a946bf6fc849e9554b489e5fff58be513">sndNxtVector</a> &amp;&amp; tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a7d9f010b71e3bfa267873ab21195fb73">getPayloadLength</a>()!=0)
        <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a946bf6fc849e9554b489e5fff58be513">sndNxtVector</a>-&gt;record(tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a0dafe41ef5a4306a4106fdb1e22b19e8">getSequenceNo</a>());
    <span class="keywordflow">if</span> (<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#afe2cc9a34e2074f95626e4085236d561">sndAckVector</a>) <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#afe2cc9a34e2074f95626e4085236d561">sndAckVector</a>-&gt;record(tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a853ab8ce8acfb5da053fa9ca24592ce8">getAckNo</a>());

    <span class="comment">// final touches on the segment before sending</span>
    tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#ac6d2da16cb6c8949b2e01b2e3432902b">setSrcPort</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a3af4312fbe2cd46bb1be1daf65715258">localPort</a>);
    tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a39fdd5e1dd84407f9d8f8926425c4e19">setDestPort</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#aece396520a4675f35694895f37b35f88">remotePort</a>);
    tcpseg-&gt;setByteLength(<a class="code" href="_t_c_p_segment__m_8h.html#a77315d68700647283fc64814a5862090">TCP_HEADER_OCTETS</a>+tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a7d9f010b71e3bfa267873ab21195fb73">getPayloadLength</a>());
    <span class="comment">// TBD account for Options (once they get implemented)</span>

    <a class="code" href="_t_c_p_8h.html#a601325e92d65fe658c80eab711e12304">tcpEV</a> &lt;&lt; <span class="stringliteral">&quot;Sending: &quot;</span>;
    <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a188549e7c936c8cad622c180d3200c69">printSegmentBrief</a>(tcpseg);

    <span class="comment">// TBD reuse next function for sending</span>

    <span class="keywordflow">if</span> (!<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ad54931b7375eb7b6e51ca9862cb0a714">remoteAddr</a>.<a class="code" href="class_i_pv_x_address.html#a43ef7d0a976817991cfd41d09435225d">isIPv6</a>())
    {
        <span class="comment">// send over IPv4</span>
        <a class="code" href="class_i_p_control_info.html">IPControlInfo</a> *controlInfo = <span class="keyword">new</span> <a class="code" href="class_i_p_control_info.html">IPControlInfo</a>();
        controlInfo-&gt;<a class="code" href="class_i_p_control_info___base.html#a78e061aecfa0388abb94af81ac6d6db0">setProtocol</a>(<a class="code" href="_i_p_protocol_id__m_8h.html#a4297c2f400ba53cf6866e6d45bc81b70a69fd8777dfd279b247a88b6eec793bd7">IP_PROT_TCP</a>);
        controlInfo-&gt;<a class="code" href="class_i_p_control_info___base.html#aa3ab93f45185a2567d84803fc39b5a60">setSrcAddr</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#adc50d816f66c74441b608b01ed4800c7">localAddr</a>.<a class="code" href="class_i_pv_x_address.html#a00acd2be0fc0f254afb2eb7540a4ea6e">get4</a>());
        controlInfo-&gt;<a class="code" href="class_i_p_control_info___base.html#a9966e4ad4c21b7cb8fea36d19752af54">setDestAddr</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ad54931b7375eb7b6e51ca9862cb0a714">remoteAddr</a>.<a class="code" href="class_i_pv_x_address.html#a00acd2be0fc0f254afb2eb7540a4ea6e">get4</a>());
        tcpseg-&gt;setControlInfo(controlInfo);

        <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a6f9eb8f2af118d2f1fcd90df3c87249e">tcpMain</a>-&gt;send(tcpseg,<span class="stringliteral">&quot;ipOut&quot;</span>);
    }
    <span class="keywordflow">else</span>
    {
        <span class="comment">// send over IPv6</span>
        <a class="code" href="class_i_pv6_control_info.html">IPv6ControlInfo</a> *controlInfo = <span class="keyword">new</span> <a class="code" href="class_i_pv6_control_info.html">IPv6ControlInfo</a>();
        controlInfo-&gt;<a class="code" href="class_i_pv6_control_info___base.html#a95b27ccb8d018e7387cdbcd512791e30">setProtocol</a>(<a class="code" href="_i_p_protocol_id__m_8h.html#a4297c2f400ba53cf6866e6d45bc81b70a69fd8777dfd279b247a88b6eec793bd7">IP_PROT_TCP</a>);
        controlInfo-&gt;<a class="code" href="class_i_pv6_control_info___base.html#a319cf2aaec7229cc010ae83ab6e18604">setSrcAddr</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#adc50d816f66c74441b608b01ed4800c7">localAddr</a>.<a class="code" href="class_i_pv_x_address.html#a733678e1e28f88c954cfce854af576c6">get6</a>());
        controlInfo-&gt;<a class="code" href="class_i_pv6_control_info___base.html#a061a09229c1cb5c450e90fda062d278f">setDestAddr</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ad54931b7375eb7b6e51ca9862cb0a714">remoteAddr</a>.<a class="code" href="class_i_pv_x_address.html#a733678e1e28f88c954cfce854af576c6">get6</a>());
        tcpseg-&gt;setControlInfo(controlInfo);

        <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a6f9eb8f2af118d2f1fcd90df3c87249e">tcpMain</a>-&gt;send(tcpseg,<span class="stringliteral">&quot;ipv6Out&quot;</span>);
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a8763146770969da7d0a1196efe23615c"></a><!-- doxytag: member="tcp_old::TCPConnection::sendToIP" ref="a8763146770969da7d0a1196efe23615c" args="(TCPSegment *tcpseg, IPvXAddress src, IPvXAddress dest)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a86143cf35f957006c5fe17c506be21c7">TCPConnection::sendToIP</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_t_c_p_segment.html">TCPSegment</a> *&#160;</td>
          <td class="paramname"><em>tcpseg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_i_pv_x_address.html">IPvXAddress</a>&#160;</td>
          <td class="paramname"><em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_i_pv_x_address.html">IPvXAddress</a>&#160;</td>
          <td class="paramname"><em>dest</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static, protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Utility: send <a class="el" href="class_i_p.html">IP</a> packet </p>

<p>Definition at line <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00211">211</a> of file <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html">old/TCPConnectionUtil.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="_t_c_p_8h.html#a601325e92d65fe658c80eab711e12304">tcpEV</a> &lt;&lt; <span class="stringliteral">&quot;Sending: &quot;</span>;
    <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a188549e7c936c8cad622c180d3200c69">printSegmentBrief</a>(tcpseg);

    <span class="keywordflow">if</span> (!dest.<a class="code" href="class_i_pv_x_address.html#a43ef7d0a976817991cfd41d09435225d">isIPv6</a>())
    {
        <span class="comment">// send over IPv4</span>
        <a class="code" href="class_i_p_control_info.html">IPControlInfo</a> *controlInfo = <span class="keyword">new</span> <a class="code" href="class_i_p_control_info.html">IPControlInfo</a>();
        controlInfo-&gt;<a class="code" href="class_i_p_control_info___base.html#a78e061aecfa0388abb94af81ac6d6db0">setProtocol</a>(<a class="code" href="_i_p_protocol_id__m_8h.html#a4297c2f400ba53cf6866e6d45bc81b70a69fd8777dfd279b247a88b6eec793bd7">IP_PROT_TCP</a>);
        controlInfo-&gt;<a class="code" href="class_i_p_control_info___base.html#aa3ab93f45185a2567d84803fc39b5a60">setSrcAddr</a>(src.<a class="code" href="class_i_pv_x_address.html#a00acd2be0fc0f254afb2eb7540a4ea6e">get4</a>());
        controlInfo-&gt;<a class="code" href="class_i_p_control_info___base.html#a9966e4ad4c21b7cb8fea36d19752af54">setDestAddr</a>(dest.<a class="code" href="class_i_pv_x_address.html#a00acd2be0fc0f254afb2eb7540a4ea6e">get4</a>());
        tcpseg-&gt;setControlInfo(controlInfo);

        check_and_cast&lt;<a class="code" href="classtcp__old_1_1_t_c_p.html">TCP</a> *&gt;(simulation.getContextModule())-&gt;send(tcpseg,<span class="stringliteral">&quot;ipOut&quot;</span>);
    }
    <span class="keywordflow">else</span>
    {
        <span class="comment">// send over IPv6</span>
        <a class="code" href="class_i_pv6_control_info.html">IPv6ControlInfo</a> *controlInfo = <span class="keyword">new</span> <a class="code" href="class_i_pv6_control_info.html">IPv6ControlInfo</a>();
        controlInfo-&gt;<a class="code" href="class_i_pv6_control_info___base.html#a95b27ccb8d018e7387cdbcd512791e30">setProtocol</a>(<a class="code" href="_i_p_protocol_id__m_8h.html#a4297c2f400ba53cf6866e6d45bc81b70a69fd8777dfd279b247a88b6eec793bd7">IP_PROT_TCP</a>);
        controlInfo-&gt;<a class="code" href="class_i_pv6_control_info___base.html#a319cf2aaec7229cc010ae83ab6e18604">setSrcAddr</a>(src.<a class="code" href="class_i_pv_x_address.html#a733678e1e28f88c954cfce854af576c6">get6</a>());
        controlInfo-&gt;<a class="code" href="class_i_pv6_control_info___base.html#a061a09229c1cb5c450e90fda062d278f">setDestAddr</a>(dest.<a class="code" href="class_i_pv_x_address.html#a733678e1e28f88c954cfce854af576c6">get6</a>());
        tcpseg-&gt;setControlInfo(controlInfo);

        check_and_cast&lt;<a class="code" href="classtcp__old_1_1_t_c_p.html">TCP</a> *&gt;(simulation.getContextModule())-&gt;send(tcpseg,<span class="stringliteral">&quot;ipv6Out&quot;</span>);
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a264eb196b44591ed68422a9e70dab680"></a><!-- doxytag: member="tcp_old::TCPConnection::signalConnectionTimeout" ref="a264eb196b44591ed68422a9e70dab680" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a264eb196b44591ed68422a9e70dab680">TCPConnection::signalConnectionTimeout</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Utility: signal to user that connection timed out </p>

<p>Definition at line <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00245">245</a> of file <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html">old/TCPConnectionUtil.cc</a>.</p>

<p>Referenced by <a class="el" href="old_2flavours_2_t_c_p_base_alg_8cc_source.html#l00179">tcp_old::TCPBaseAlg::processRexmitTimer()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a65a8dc93c08a685f145248d0fb327428">sendIndicationToApp</a>(<a class="code" href="_t_c_p_command__m_8h.html#a68611fc79dbc74e8744d74b746cd956ba06629e44a0aef5201b4cd424596127bf">TCP_I_TIMED_OUT</a>);
}
</pre></div>
</div>
</div>
<a class="anchor" id="aa58f44bc38ec0af46aca654f9403771f"></a><!-- doxytag: member="tcp_old::TCPConnection::startSynRexmitTimer" ref="aa58f44bc38ec0af46aca654f9403771f" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classtcp__old_1_1_t_c_p_connection.html#aa58f44bc38ec0af46aca654f9403771f">TCPConnection::startSynRexmitTimer</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Utility: start SYN-REXMIT timer </p>

<p>Definition at line <a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html#l01115">1115</a> of file <a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html">old/TCPConnectionRcvSegment.cc</a>.</p>

<p>Referenced by <a class="el" href="old_2_t_c_p_connection_event_proc_8cc_source.html#l00034">process_OPEN_ACTIVE()</a>, <a class="el" href="old_2_t_c_p_connection_event_proc_8cc_source.html#l00113">process_SEND()</a>, <a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html#l00622">processSegmentInListen()</a>, and <a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html#l00741">processSegmentInSynSent()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#add0426103a74138a0599e58049526e8a">syn_rexmit_count</a> = 0;
    <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a9aec9c42959150643d39bde968908d39">syn_rexmit_timeout</a> = <a class="code" href="_t_c_p_connection_8h.html#a89ce38305130a5021e21134602a88f79">TCP_TIMEOUT_SYN_REXMIT</a>;

    <span class="keywordflow">if</span> (<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ad70c187b499189b370f99433eb825dcd">synRexmitTimer</a>-&gt;isScheduled())
        <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ad06a2b75a619021592db07ab486f0fed">cancelEvent</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ad70c187b499189b370f99433eb825dcd">synRexmitTimer</a>);
    <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae1ff44c73d20293a446adc091842bedd">scheduleTimeout</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ad70c187b499189b370f99433eb825dcd">synRexmitTimer</a>, <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_state_variables.html#a9aec9c42959150643d39bde968908d39">syn_rexmit_timeout</a>);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a1be68d20f98e68b01ef9267a8dd2088a"></a><!-- doxytag: member="tcp_old::TCPConnection::stateEntered" ref="a1be68d20f98e68b01ef9267a8dd2088a" args="(int state)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a1be68d20f98e68b01ef9267a8dd2088a">TCPConnection::stateEntered</a> </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>state</em></td><td>)</td>
          <td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Perform cleanup necessary when entering a new state, e.g. cancelling timers </p>

<p>Definition at line <a class="el" href="old_2_t_c_p_connection_base_8cc_source.html#l00449">449</a> of file <a class="el" href="old_2_t_c_p_connection_base_8cc_source.html">old/TCPConnectionBase.cc</a>.</p>

<p>Referenced by <a class="el" href="old_2_t_c_p_connection_base_8cc_source.html#l00284">performStateTransition()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="comment">// cancel timers</span>
    <span class="keywordflow">switch</span> (<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>)
    {
        <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaa8b6438b06a8e3cd7537e09f9fb2f0d03">TCP_S_INIT</a>:
            <span class="comment">// we&#39;ll never get back to INIT</span>
            <span class="keywordflow">break</span>;
        <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaa8a809324e3edea6ff6800a639d7bcea2">TCP_S_LISTEN</a>:
            <span class="comment">// we may get back to LISTEN from SYN_RCVD</span>
            ASSERT(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a757386355261e95064b75f2dfec3788e">connEstabTimer</a> &amp;&amp; <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ad70c187b499189b370f99433eb825dcd">synRexmitTimer</a>);
            <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ad06a2b75a619021592db07ab486f0fed">cancelEvent</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a757386355261e95064b75f2dfec3788e">connEstabTimer</a>);
            <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ad06a2b75a619021592db07ab486f0fed">cancelEvent</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ad70c187b499189b370f99433eb825dcd">synRexmitTimer</a>);
            <span class="keywordflow">break</span>;
        <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaaf96abc23364b3cdd51216d5cc9a4f3fc">TCP_S_SYN_RCVD</a>:
        <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaafde4b4cc43d59d14ba2cbf0bc3adb525">TCP_S_SYN_SENT</a>:
            <span class="keywordflow">break</span>;
        <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaa3b4387f45a765235dfda0bf3111ba1c6">TCP_S_ESTABLISHED</a>:
            <span class="comment">// we&#39;re in ESTABLISHED, these timers are no longer needed</span>
            <span class="keyword">delete</span> <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ad06a2b75a619021592db07ab486f0fed">cancelEvent</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a757386355261e95064b75f2dfec3788e">connEstabTimer</a>);
            <span class="keyword">delete</span> <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ad06a2b75a619021592db07ab486f0fed">cancelEvent</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ad70c187b499189b370f99433eb825dcd">synRexmitTimer</a>);
            <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a757386355261e95064b75f2dfec3788e">connEstabTimer</a> = <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ad70c187b499189b370f99433eb825dcd">synRexmitTimer</a> = NULL;
            <span class="comment">// TCP_I_ESTAB notification moved inside event processing</span>
            <span class="keywordflow">break</span>;
        <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaa3395b6fd6b4cf5d6165b37929d44eaa1">TCP_S_CLOSE_WAIT</a>:
        <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaaac5147b505ddf6bb15d84853242bcfdf">TCP_S_LAST_ACK</a>:
        <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaa1366e9fbbf862cd3fdfa3ea08e641cb0">TCP_S_FIN_WAIT_1</a>:
        <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaaea07c6aa092a0b2e9141385fb4734797">TCP_S_FIN_WAIT_2</a>:
        <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaacdbad950a89de6fc964c3257d45e07a9">TCP_S_CLOSING</a>:
        <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaa8a4fa6fa69c727999ad6b8fe056a6fd1">TCP_S_TIME_WAIT</a>:
            <span class="comment">// whether connection setup succeeded (ESTABLISHED) or not (others),</span>
            <span class="comment">// cancel these timers</span>
            <span class="keywordflow">if</span> (<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a757386355261e95064b75f2dfec3788e">connEstabTimer</a>) <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ad06a2b75a619021592db07ab486f0fed">cancelEvent</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a757386355261e95064b75f2dfec3788e">connEstabTimer</a>);
            <span class="keywordflow">if</span> (<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ad70c187b499189b370f99433eb825dcd">synRexmitTimer</a>) <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ad06a2b75a619021592db07ab486f0fed">cancelEvent</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ad70c187b499189b370f99433eb825dcd">synRexmitTimer</a>);
            <span class="keywordflow">break</span>;
        <span class="keywordflow">case</span> <a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaaae392e6982b73d95ab4e48e3a27ce552">TCP_S_CLOSED</a>:
            <span class="comment">// all timers need to be cancelled</span>
            <span class="keywordflow">if</span> (<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a67c3fa718ee0542b4bd93eda8785c0fc">the2MSLTimer</a>)   <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ad06a2b75a619021592db07ab486f0fed">cancelEvent</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a67c3fa718ee0542b4bd93eda8785c0fc">the2MSLTimer</a>);
            <span class="keywordflow">if</span> (<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a757386355261e95064b75f2dfec3788e">connEstabTimer</a>) <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ad06a2b75a619021592db07ab486f0fed">cancelEvent</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a757386355261e95064b75f2dfec3788e">connEstabTimer</a>);
            <span class="keywordflow">if</span> (<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a2a3d3f1792941e08c490795d1d2a4bc0">finWait2Timer</a>)  <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ad06a2b75a619021592db07ab486f0fed">cancelEvent</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a2a3d3f1792941e08c490795d1d2a4bc0">finWait2Timer</a>);
            <span class="keywordflow">if</span> (<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ad70c187b499189b370f99433eb825dcd">synRexmitTimer</a>) <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ad06a2b75a619021592db07ab486f0fed">cancelEvent</a>(<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ad70c187b499189b370f99433eb825dcd">synRexmitTimer</a>);
            <a class="code" href="classtcp__old_1_1_t_c_p_connection.html#a2212cb0deb11d2b1c5826cab57b3f42e">tcpAlgorithm</a>-&gt;<a class="code" href="classtcp__old_1_1_t_c_p_algorithm.html#a3f274c87ed54d3828b9d7908d45aeb70">connectionClosed</a>();
            <span class="keywordflow">break</span>;
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="ab991cf2680a63832310a4a56ac17972e"></a><!-- doxytag: member="tcp_old::TCPConnection::stateName" ref="ab991cf2680a63832310a4a56ac17972e" args="(int state)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char * <a class="el" href="classtcp__old_1_1_t_c_p_connection.html#ab991cf2680a63832310a4a56ac17972e">TCPConnection::stateName</a> </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>state</em></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Utility: returns name of TCP_S_xxx constants </p>

<p>Definition at line <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00037">37</a> of file <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html">old/TCPConnectionUtil.cc</a>.</p>

<p>Referenced by <a class="el" href="old_2_t_c_p_connection_base_8cc_source.html#l00284">performStateTransition()</a>, <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00109">printConnBrief()</a>, <a class="el" href="old_2_t_c_p_connection_event_proc_8cc_source.html#l00253">process_STATUS()</a>, <a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html#l01079">process_TIMEOUT_2MSL()</a>, <a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html#l01059">process_TIMEOUT_CONN_ESTAB()</a>, <a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html#l01100">process_TIMEOUT_FIN_WAIT_2()</a>, and <a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html#l01125">process_TIMEOUT_SYN_REXMIT()</a>.</p>
<div class="fragment"><pre class="fragment">{
<span class="preprocessor">#define CASE(x) case x: s=#x+6; break</span>
<span class="preprocessor"></span>    <span class="keyword">const</span> <span class="keywordtype">char</span> *s = <span class="stringliteral">&quot;unknown&quot;</span>;
    <span class="keywordflow">switch</span> (<a class="code" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">state</a>)
    {
        <a class="code" href="_ansa_ether_m_a_c_8cc.html#a60cc06bef97da802b8522d258ac4fe89">CASE</a>(<a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaa8b6438b06a8e3cd7537e09f9fb2f0d03">TCP_S_INIT</a>);
        <a class="code" href="_ansa_ether_m_a_c_8cc.html#a60cc06bef97da802b8522d258ac4fe89">CASE</a>(<a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaaae392e6982b73d95ab4e48e3a27ce552">TCP_S_CLOSED</a>);
        <a class="code" href="_ansa_ether_m_a_c_8cc.html#a60cc06bef97da802b8522d258ac4fe89">CASE</a>(<a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaa8a809324e3edea6ff6800a639d7bcea2">TCP_S_LISTEN</a>);
        <a class="code" href="_ansa_ether_m_a_c_8cc.html#a60cc06bef97da802b8522d258ac4fe89">CASE</a>(<a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaafde4b4cc43d59d14ba2cbf0bc3adb525">TCP_S_SYN_SENT</a>);
        <a class="code" href="_ansa_ether_m_a_c_8cc.html#a60cc06bef97da802b8522d258ac4fe89">CASE</a>(<a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaaf96abc23364b3cdd51216d5cc9a4f3fc">TCP_S_SYN_RCVD</a>);
        <a class="code" href="_ansa_ether_m_a_c_8cc.html#a60cc06bef97da802b8522d258ac4fe89">CASE</a>(<a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaa3b4387f45a765235dfda0bf3111ba1c6">TCP_S_ESTABLISHED</a>);
        <a class="code" href="_ansa_ether_m_a_c_8cc.html#a60cc06bef97da802b8522d258ac4fe89">CASE</a>(<a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaa3395b6fd6b4cf5d6165b37929d44eaa1">TCP_S_CLOSE_WAIT</a>);
        <a class="code" href="_ansa_ether_m_a_c_8cc.html#a60cc06bef97da802b8522d258ac4fe89">CASE</a>(<a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaaac5147b505ddf6bb15d84853242bcfdf">TCP_S_LAST_ACK</a>);
        <a class="code" href="_ansa_ether_m_a_c_8cc.html#a60cc06bef97da802b8522d258ac4fe89">CASE</a>(<a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaa1366e9fbbf862cd3fdfa3ea08e641cb0">TCP_S_FIN_WAIT_1</a>);
        <a class="code" href="_ansa_ether_m_a_c_8cc.html#a60cc06bef97da802b8522d258ac4fe89">CASE</a>(<a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaaea07c6aa092a0b2e9141385fb4734797">TCP_S_FIN_WAIT_2</a>);
        <a class="code" href="_ansa_ether_m_a_c_8cc.html#a60cc06bef97da802b8522d258ac4fe89">CASE</a>(<a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaacdbad950a89de6fc964c3257d45e07a9">TCP_S_CLOSING</a>);
        <a class="code" href="_ansa_ether_m_a_c_8cc.html#a60cc06bef97da802b8522d258ac4fe89">CASE</a>(<a class="code" href="namespacetcp__old.html#acdbb7986967662f90bca9b6ef46f3acaa8a4fa6fa69c727999ad6b8fe056a6fd1">TCP_S_TIME_WAIT</a>);
    }
    <span class="keywordflow">return</span> s;
<span class="preprocessor">#undef CASE</span>
<span class="preprocessor"></span>}
</pre></div>
</div>
</div>
<a class="anchor" id="a9b7d3f811eab0367d3826dfb20c8d931"></a><!-- doxytag: member="tcp_old::TCPConnection::tryFastRoute" ref="a9b7d3f811eab0367d3826dfb20c8d931" args="(TCPSegment *tcpseg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a9b7d3f811eab0367d3826dfb20c8d931">TCPConnection::tryFastRoute</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_t_c_p_segment.html">TCPSegment</a> *&#160;</td>
          <td class="paramname"><em>tcpseg</em></td><td>)</td>
          <td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Shortcut to process most common case as fast as possible. Returns false if segment requires normal (slow) route. </p>

<p>Definition at line <a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html#l00030">30</a> of file <a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html">old/TCPConnectionRcvSegment.cc</a>.</p>

<p>Referenced by <a class="el" href="old_2_t_c_p_connection_base_8cc_source.html#l00221">processTCPSegment()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="comment">// fast route processing not yet implemented</span>
    <span class="keywordflow">return</span> <span class="keyword">false</span>;
}
</pre></div>
</div>
</div>
<hr/><h2>Member Data Documentation</h2>
<a class="anchor" id="ad04d1e9fb23f48cd53dcd7c411caea80"></a><!-- doxytag: member="tcp_old::TCPConnection::appGateIndex" ref="ad04d1e9fb23f48cd53dcd7c411caea80" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="classtcp__old_1_1_t_c_p_connection.html#ad04d1e9fb23f48cd53dcd7c411caea80">tcp_old::TCPConnection::appGateIndex</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_t_c_p_connection__old_8h_source.html#l00260">260</a> of file <a class="el" href="_t_c_p_connection__old_8h_source.html">TCPConnection_old.h</a>.</p>

<p>Referenced by <a class="el" href="old_2_t_c_p_8cc_source.html#l00360">tcp_old::TCP::addForkedConnection()</a>, <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00138">cloneListeningConnection()</a>, <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00109">printConnBrief()</a>, <a class="el" href="old_2_t_c_p_8cc_source.html#l00380">tcp_old::TCP::removeConnection()</a>, <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00261">sendEstabIndicationToApp()</a>, <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00250">sendIndicationToApp()</a>, <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00278">sendToApp()</a>, and <a class="el" href="old_2_t_c_p_connection_base_8cc_source.html#l00114">TCPConnection()</a>.</p>

</div>
</div>
<a class="anchor" id="a757386355261e95064b75f2dfec3788e"></a><!-- doxytag: member="tcp_old::TCPConnection::connEstabTimer" ref="a757386355261e95064b75f2dfec3788e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">cMessage* <a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a757386355261e95064b75f2dfec3788e">tcp_old::TCPConnection::connEstabTimer</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_t_c_p_connection__old_8h_source.html#l00287">287</a> of file <a class="el" href="_t_c_p_connection__old_8h_source.html">TCPConnection_old.h</a>.</p>

<p>Referenced by <a class="el" href="old_2_t_c_p_connection_event_proc_8cc_source.html#l00034">process_OPEN_ACTIVE()</a>, <a class="el" href="old_2_t_c_p_connection_event_proc_8cc_source.html#l00113">process_SEND()</a>, <a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html#l00622">processSegmentInListen()</a>, <a class="el" href="old_2_t_c_p_connection_base_8cc_source.html#l00184">processTimer()</a>, <a class="el" href="old_2_t_c_p_connection_base_8cc_source.html#l00449">stateEntered()</a>, <a class="el" href="old_2_t_c_p_connection_base_8cc_source.html#l00098">TCPConnection()</a>, and <a class="el" href="old_2_t_c_p_connection_base_8cc_source.html#l00163">~TCPConnection()</a>.</p>

</div>
</div>
<a class="anchor" id="ae6ce2bfc0b9aa9d110db13efe08b7a0e"></a><!-- doxytag: member="tcp_old::TCPConnection::connId" ref="ae6ce2bfc0b9aa9d110db13efe08b7a0e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="classtcp__old_1_1_t_c_p_connection.html#ae6ce2bfc0b9aa9d110db13efe08b7a0e">tcp_old::TCPConnection::connId</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_t_c_p_connection__old_8h_source.html#l00261">261</a> of file <a class="el" href="_t_c_p_connection__old_8h_source.html">TCPConnection_old.h</a>.</p>

<p>Referenced by <a class="el" href="old_2_t_c_p_8cc_source.html#l00360">tcp_old::TCP::addForkedConnection()</a>, <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00138">cloneListeningConnection()</a>, <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00109">printConnBrief()</a>, <a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html#l00114">processSegment1stThru8th()</a>, <a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html#l00622">processSegmentInListen()</a>, <a class="el" href="old_2_t_c_p_8cc_source.html#l00380">tcp_old::TCP::removeConnection()</a>, <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00261">sendEstabIndicationToApp()</a>, <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00250">sendIndicationToApp()</a>, and <a class="el" href="old_2_t_c_p_connection_base_8cc_source.html#l00114">TCPConnection()</a>.</p>

</div>
</div>
<a class="anchor" id="a2a3d3f1792941e08c490795d1d2a4bc0"></a><!-- doxytag: member="tcp_old::TCPConnection::finWait2Timer" ref="a2a3d3f1792941e08c490795d1d2a4bc0" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">cMessage* <a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a2a3d3f1792941e08c490795d1d2a4bc0">tcp_old::TCPConnection::finWait2Timer</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_t_c_p_connection__old_8h_source.html#l00288">288</a> of file <a class="el" href="_t_c_p_connection__old_8h_source.html">TCPConnection_old.h</a>.</p>

<p>Referenced by <a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html#l00114">processSegment1stThru8th()</a>, <a class="el" href="old_2_t_c_p_connection_base_8cc_source.html#l00184">processTimer()</a>, <a class="el" href="old_2_t_c_p_connection_base_8cc_source.html#l00449">stateEntered()</a>, <a class="el" href="old_2_t_c_p_connection_base_8cc_source.html#l00098">TCPConnection()</a>, and <a class="el" href="old_2_t_c_p_connection_base_8cc_source.html#l00163">~TCPConnection()</a>.</p>

</div>
</div>
<a class="anchor" id="a3b7998c1cae436f8d35cabdb073d3881"></a><!-- doxytag: member="tcp_old::TCPConnection::fsm" ref="a3b7998c1cae436f8d35cabdb073d3881" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">cFSM <a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a3b7998c1cae436f8d35cabdb073d3881">tcp_old::TCPConnection::fsm</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_t_c_p_connection__old_8h_source.html#l00273">273</a> of file <a class="el" href="_t_c_p_connection__old_8h_source.html">TCPConnection_old.h</a>.</p>

<p>Referenced by <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00138">cloneListeningConnection()</a>, <a class="el" href="old_2_t_c_p_connection_base_8cc_source.html#l00284">performStateTransition()</a>, <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00109">printConnBrief()</a>, <a class="el" href="old_2_t_c_p_connection_event_proc_8cc_source.html#l00222">process_ABORT()</a>, <a class="el" href="old_2_t_c_p_connection_event_proc_8cc_source.html#l00161">process_CLOSE()</a>, <a class="el" href="old_2_t_c_p_connection_event_proc_8cc_source.html#l00034">process_OPEN_ACTIVE()</a>, <a class="el" href="old_2_t_c_p_connection_event_proc_8cc_source.html#l00080">process_OPEN_PASSIVE()</a>, <a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html#l00083">process_RCV_SEGMENT()</a>, <a class="el" href="old_2_t_c_p_connection_event_proc_8cc_source.html#l00113">process_SEND()</a>, <a class="el" href="old_2_t_c_p_connection_event_proc_8cc_source.html#l00253">process_STATUS()</a>, <a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html#l01079">process_TIMEOUT_2MSL()</a>, <a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html#l01059">process_TIMEOUT_CONN_ESTAB()</a>, <a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html#l01100">process_TIMEOUT_FIN_WAIT_2()</a>, <a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html#l01125">process_TIMEOUT_SYN_REXMIT()</a>, <a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html#l00937">processAckInEstabEtc()</a>, <a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html#l00114">processSegment1stThru8th()</a>, and <a class="el" href="old_2_t_c_p_connection_base_8cc_source.html#l00114">TCPConnection()</a>.</p>

</div>
</div>
<a class="anchor" id="adc50d816f66c74441b608b01ed4800c7"></a><!-- doxytag: member="tcp_old::TCPConnection::localAddr" ref="adc50d816f66c74441b608b01ed4800c7" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_i_pv_x_address.html">IPvXAddress</a> <a class="el" href="classtcp__old_1_1_t_c_p_connection.html#adc50d816f66c74441b608b01ed4800c7">tcp_old::TCPConnection::localAddr</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_t_c_p_connection__old_8h_source.html#l00264">264</a> of file <a class="el" href="_t_c_p_connection__old_8h_source.html">TCPConnection_old.h</a>.</p>

<p>Referenced by <a class="el" href="old_2_t_c_p_8cc_source.html#l00360">tcp_old::TCP::addForkedConnection()</a>, <a class="el" href="old_2_t_c_p_8cc_source.html#l00306">tcp_old::TCP::addSockPair()</a>, <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00138">cloneListeningConnection()</a>, <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00109">printConnBrief()</a>, <a class="el" href="old_2_t_c_p_connection_event_proc_8cc_source.html#l00034">process_OPEN_ACTIVE()</a>, <a class="el" href="old_2_t_c_p_connection_event_proc_8cc_source.html#l00080">process_OPEN_PASSIVE()</a>, <a class="el" href="old_2_t_c_p_connection_event_proc_8cc_source.html#l00253">process_STATUS()</a>, <a class="el" href="old_2_t_c_p_connection_base_8cc_source.html#l00221">processTCPSegment()</a>, <a class="el" href="old_2_t_c_p_8cc_source.html#l00380">tcp_old::TCP::removeConnection()</a>, <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00261">sendEstabIndicationToApp()</a>, <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00376">sendRst()</a>, <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00169">sendToIP()</a>, and <a class="el" href="old_2_t_c_p_8cc_source.html#l00336">tcp_old::TCP::updateSockPair()</a>.</p>

</div>
</div>
<a class="anchor" id="a3af4312fbe2cd46bb1be1daf65715258"></a><!-- doxytag: member="tcp_old::TCPConnection::localPort" ref="a3af4312fbe2cd46bb1be1daf65715258" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a3af4312fbe2cd46bb1be1daf65715258">tcp_old::TCPConnection::localPort</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_t_c_p_connection__old_8h_source.html#l00266">266</a> of file <a class="el" href="_t_c_p_connection__old_8h_source.html">TCPConnection_old.h</a>.</p>

<p>Referenced by <a class="el" href="old_2_t_c_p_8cc_source.html#l00360">tcp_old::TCP::addForkedConnection()</a>, <a class="el" href="old_2_t_c_p_8cc_source.html#l00306">tcp_old::TCP::addSockPair()</a>, <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00138">cloneListeningConnection()</a>, <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00109">printConnBrief()</a>, <a class="el" href="old_2_t_c_p_connection_event_proc_8cc_source.html#l00034">process_OPEN_ACTIVE()</a>, <a class="el" href="old_2_t_c_p_connection_event_proc_8cc_source.html#l00080">process_OPEN_PASSIVE()</a>, <a class="el" href="old_2_t_c_p_connection_event_proc_8cc_source.html#l00253">process_STATUS()</a>, <a class="el" href="old_2_t_c_p_connection_base_8cc_source.html#l00221">processTCPSegment()</a>, <a class="el" href="old_2_t_c_p_8cc_source.html#l00380">tcp_old::TCP::removeConnection()</a>, <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00261">sendEstabIndicationToApp()</a>, <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00376">sendRst()</a>, <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00338">sendSyn()</a>, <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00169">sendToIP()</a>, <a class="el" href="old_2_t_c_p_connection_base_8cc_source.html#l00114">TCPConnection()</a>, and <a class="el" href="old_2_t_c_p_8cc_source.html#l00336">tcp_old::TCP::updateSockPair()</a>.</p>

</div>
</div>
<a class="anchor" id="a7b6c1fcdd10a035c035dea350420286d"></a><!-- doxytag: member="tcp_old::TCPConnection::rcvAckVector" ref="a7b6c1fcdd10a035c035dea350420286d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">cOutVector* <a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a7b6c1fcdd10a035c035dea350420286d">tcp_old::TCPConnection::rcvAckVector</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_t_c_p_connection__old_8h_source.html#l00296">296</a> of file <a class="el" href="_t_c_p_connection__old_8h_source.html">TCPConnection_old.h</a>.</p>

<p>Referenced by <a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html#l00083">process_RCV_SEGMENT()</a>, <a class="el" href="old_2_t_c_p_connection_base_8cc_source.html#l00098">TCPConnection()</a>, and <a class="el" href="old_2_t_c_p_connection_base_8cc_source.html#l00163">~TCPConnection()</a>.</p>

</div>
</div>
<a class="anchor" id="acb4230bb789e0bf3e413479e26316d60"></a><!-- doxytag: member="tcp_old::TCPConnection::rcvSeqVector" ref="acb4230bb789e0bf3e413479e26316d60" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">cOutVector* <a class="el" href="classtcp__old_1_1_t_c_p_connection.html#acb4230bb789e0bf3e413479e26316d60">tcp_old::TCPConnection::rcvSeqVector</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_t_c_p_connection__old_8h_source.html#l00295">295</a> of file <a class="el" href="_t_c_p_connection__old_8h_source.html">TCPConnection_old.h</a>.</p>

<p>Referenced by <a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html#l00083">process_RCV_SEGMENT()</a>, <a class="el" href="old_2_t_c_p_connection_base_8cc_source.html#l00098">TCPConnection()</a>, and <a class="el" href="old_2_t_c_p_connection_base_8cc_source.html#l00163">~TCPConnection()</a>.</p>

</div>
</div>
<a class="anchor" id="a2602ec64d45270793076abe5938d16ac"></a><!-- doxytag: member="tcp_old::TCPConnection::receiveQueue" ref="a2602ec64d45270793076abe5938d16ac" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classtcp__old_1_1_t_c_p_receive_queue.html">TCPReceiveQueue</a>* <a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a2602ec64d45270793076abe5938d16ac">tcp_old::TCPConnection::receiveQueue</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_t_c_p_connection__old_8h_source.html#l00280">280</a> of file <a class="el" href="_t_c_p_connection__old_8h_source.html">TCPConnection_old.h</a>.</p>

<p>Referenced by <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00138">cloneListeningConnection()</a>, <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00283">initConnection()</a>, <a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html#l00114">processSegment1stThru8th()</a>, <a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html#l00622">processSegmentInListen()</a>, <a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html#l00741">processSegmentInSynSent()</a>, <a class="el" href="old_2_t_c_p_connection_base_8cc_source.html#l00098">TCPConnection()</a>, and <a class="el" href="old_2_t_c_p_connection_base_8cc_source.html#l00163">~TCPConnection()</a>.</p>

</div>
</div>
<a class="anchor" id="ad54931b7375eb7b6e51ca9862cb0a714"></a><!-- doxytag: member="tcp_old::TCPConnection::remoteAddr" ref="ad54931b7375eb7b6e51ca9862cb0a714" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_i_pv_x_address.html">IPvXAddress</a> <a class="el" href="classtcp__old_1_1_t_c_p_connection.html#ad54931b7375eb7b6e51ca9862cb0a714">tcp_old::TCPConnection::remoteAddr</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_t_c_p_connection__old_8h_source.html#l00265">265</a> of file <a class="el" href="_t_c_p_connection__old_8h_source.html">TCPConnection_old.h</a>.</p>

<p>Referenced by <a class="el" href="old_2_t_c_p_8cc_source.html#l00360">tcp_old::TCP::addForkedConnection()</a>, <a class="el" href="old_2_t_c_p_8cc_source.html#l00306">tcp_old::TCP::addSockPair()</a>, <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00109">printConnBrief()</a>, <a class="el" href="old_2_t_c_p_connection_event_proc_8cc_source.html#l00034">process_OPEN_ACTIVE()</a>, <a class="el" href="old_2_t_c_p_connection_event_proc_8cc_source.html#l00253">process_STATUS()</a>, <a class="el" href="old_2_t_c_p_connection_base_8cc_source.html#l00221">processTCPSegment()</a>, <a class="el" href="old_2_t_c_p_8cc_source.html#l00380">tcp_old::TCP::removeConnection()</a>, <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00261">sendEstabIndicationToApp()</a>, <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00376">sendRst()</a>, <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00338">sendSyn()</a>, <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00169">sendToIP()</a>, and <a class="el" href="old_2_t_c_p_8cc_source.html#l00336">tcp_old::TCP::updateSockPair()</a>.</p>

</div>
</div>
<a class="anchor" id="aece396520a4675f35694895f37b35f88"></a><!-- doxytag: member="tcp_old::TCPConnection::remotePort" ref="aece396520a4675f35694895f37b35f88" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="classtcp__old_1_1_t_c_p_connection.html#aece396520a4675f35694895f37b35f88">tcp_old::TCPConnection::remotePort</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_t_c_p_connection__old_8h_source.html#l00267">267</a> of file <a class="el" href="_t_c_p_connection__old_8h_source.html">TCPConnection_old.h</a>.</p>

<p>Referenced by <a class="el" href="old_2_t_c_p_8cc_source.html#l00360">tcp_old::TCP::addForkedConnection()</a>, <a class="el" href="old_2_t_c_p_8cc_source.html#l00306">tcp_old::TCP::addSockPair()</a>, <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00109">printConnBrief()</a>, <a class="el" href="old_2_t_c_p_connection_event_proc_8cc_source.html#l00034">process_OPEN_ACTIVE()</a>, <a class="el" href="old_2_t_c_p_connection_event_proc_8cc_source.html#l00253">process_STATUS()</a>, <a class="el" href="old_2_t_c_p_connection_base_8cc_source.html#l00221">processTCPSegment()</a>, <a class="el" href="old_2_t_c_p_8cc_source.html#l00380">tcp_old::TCP::removeConnection()</a>, <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00261">sendEstabIndicationToApp()</a>, <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00376">sendRst()</a>, <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00338">sendSyn()</a>, <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00169">sendToIP()</a>, <a class="el" href="old_2_t_c_p_connection_base_8cc_source.html#l00114">TCPConnection()</a>, and <a class="el" href="old_2_t_c_p_8cc_source.html#l00336">tcp_old::TCP::updateSockPair()</a>.</p>

</div>
</div>
<a class="anchor" id="a7bd9b6b2b4422771b92e00d307983d19"></a><!-- doxytag: member="tcp_old::TCPConnection::sendQueue" ref="a7bd9b6b2b4422771b92e00d307983d19" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classtcp__old_1_1_t_c_p_send_queue.html">TCPSendQueue</a>* <a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a7bd9b6b2b4422771b92e00d307983d19">tcp_old::TCPConnection::sendQueue</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_t_c_p_connection__old_8h_source.html#l00279">279</a> of file <a class="el" href="_t_c_p_connection__old_8h_source.html">TCPConnection_old.h</a>.</p>

<p>Referenced by <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00138">cloneListeningConnection()</a>, <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00283">initConnection()</a>, <a class="el" href="old_2_t_c_p_connection_event_proc_8cc_source.html#l00161">process_CLOSE()</a>, <a class="el" href="old_2_t_c_p_connection_event_proc_8cc_source.html#l00113">process_SEND()</a>, <a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html#l00937">processAckInEstabEtc()</a>, <a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html#l00909">processRstInSynReceived()</a>, <a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html#l00741">processSegmentInSynSent()</a>, <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00623">retransmitData()</a>, <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00320">selectInitialSeqNum()</a>, <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00480">sendData()</a>, <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00572">sendProbe()</a>, <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00449">sendSegment()</a>, <a class="el" href="old_2_t_c_p_connection_base_8cc_source.html#l00098">TCPConnection()</a>, and <a class="el" href="old_2_t_c_p_connection_base_8cc_source.html#l00163">~TCPConnection()</a>.</p>

</div>
</div>
<a class="anchor" id="afe2cc9a34e2074f95626e4085236d561"></a><!-- doxytag: member="tcp_old::TCPConnection::sndAckVector" ref="afe2cc9a34e2074f95626e4085236d561" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">cOutVector* <a class="el" href="classtcp__old_1_1_t_c_p_connection.html#afe2cc9a34e2074f95626e4085236d561">tcp_old::TCPConnection::sndAckVector</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_t_c_p_connection__old_8h_source.html#l00294">294</a> of file <a class="el" href="_t_c_p_connection__old_8h_source.html">TCPConnection_old.h</a>.</p>

<p>Referenced by <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00169">sendToIP()</a>, <a class="el" href="old_2_t_c_p_connection_base_8cc_source.html#l00098">TCPConnection()</a>, and <a class="el" href="old_2_t_c_p_connection_base_8cc_source.html#l00163">~TCPConnection()</a>.</p>

</div>
</div>
<a class="anchor" id="a946bf6fc849e9554b489e5fff58be513"></a><!-- doxytag: member="tcp_old::TCPConnection::sndNxtVector" ref="a946bf6fc849e9554b489e5fff58be513" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">cOutVector* <a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a946bf6fc849e9554b489e5fff58be513">tcp_old::TCPConnection::sndNxtVector</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_t_c_p_connection__old_8h_source.html#l00293">293</a> of file <a class="el" href="_t_c_p_connection__old_8h_source.html">TCPConnection_old.h</a>.</p>

<p>Referenced by <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00169">sendToIP()</a>, <a class="el" href="old_2_t_c_p_connection_base_8cc_source.html#l00098">TCPConnection()</a>, and <a class="el" href="old_2_t_c_p_connection_base_8cc_source.html#l00163">~TCPConnection()</a>.</p>

</div>
</div>
<a class="anchor" id="ab58ab42e2f19a58edcfa549b51a7179b"></a><!-- doxytag: member="tcp_old::TCPConnection::sndWndVector" ref="ab58ab42e2f19a58edcfa549b51a7179b" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">cOutVector* <a class="el" href="classtcp__old_1_1_t_c_p_connection.html#ab58ab42e2f19a58edcfa549b51a7179b">tcp_old::TCPConnection::sndWndVector</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_t_c_p_connection__old_8h_source.html#l00292">292</a> of file <a class="el" href="_t_c_p_connection__old_8h_source.html">TCPConnection_old.h</a>.</p>

<p>Referenced by <a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html#l00937">processAckInEstabEtc()</a>, <a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html#l00622">processSegmentInListen()</a>, <a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html#l00741">processSegmentInSynSent()</a>, <a class="el" href="old_2_t_c_p_connection_base_8cc_source.html#l00098">TCPConnection()</a>, and <a class="el" href="old_2_t_c_p_connection_base_8cc_source.html#l00163">~TCPConnection()</a>.</p>

</div>
</div>
<a class="anchor" id="ae549dc567d3d71f2981c3be27cee0ccb"></a><!-- doxytag: member="tcp_old::TCPConnection::state" ref="ae549dc567d3d71f2981c3be27cee0ccb" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classtcp__old_1_1_t_c_p_state_variables.html">TCPStateVariables</a>* <a class="el" href="classtcp__old_1_1_t_c_p_connection.html#ae549dc567d3d71f2981c3be27cee0ccb">tcp_old::TCPConnection::state</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_t_c_p_connection__old_8h_source.html#l00276">276</a> of file <a class="el" href="_t_c_p_connection__old_8h_source.html">TCPConnection_old.h</a>.</p>

<p>Referenced by <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00138">cloneListeningConnection()</a>, <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00311">configureStateVariables()</a>, <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00283">initConnection()</a>, <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00330">isSegmentAcceptable()</a>, <a class="el" href="old_2_t_c_p_connection_base_8cc_source.html#l00284">performStateTransition()</a>, <a class="el" href="old_2_t_c_p_connection_event_proc_8cc_source.html#l00222">process_ABORT()</a>, <a class="el" href="old_2_t_c_p_connection_event_proc_8cc_source.html#l00161">process_CLOSE()</a>, <a class="el" href="old_2_t_c_p_connection_event_proc_8cc_source.html#l00034">process_OPEN_ACTIVE()</a>, <a class="el" href="old_2_t_c_p_connection_event_proc_8cc_source.html#l00080">process_OPEN_PASSIVE()</a>, <a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html#l00083">process_RCV_SEGMENT()</a>, <a class="el" href="old_2_t_c_p_connection_event_proc_8cc_source.html#l00113">process_SEND()</a>, <a class="el" href="old_2_t_c_p_connection_event_proc_8cc_source.html#l00253">process_STATUS()</a>, <a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html#l01059">process_TIMEOUT_CONN_ESTAB()</a>, <a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html#l01125">process_TIMEOUT_SYN_REXMIT()</a>, <a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html#l00937">processAckInEstabEtc()</a>, <a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html#l00909">processRstInSynReceived()</a>, <a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html#l00114">processSegment1stThru8th()</a>, <a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html#l00622">processSegmentInListen()</a>, <a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html#l00741">processSegmentInSynSent()</a>, <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00623">retransmitData()</a>, <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00602">retransmitOneSegment()</a>, <a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html#l00037">segmentArrivalWhileClosed()</a>, <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00320">selectInitialSeqNum()</a>, <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00414">sendAck()</a>, <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00480">sendData()</a>, <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00430">sendFin()</a>, <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00572">sendProbe()</a>, <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00449">sendSegment()</a>, <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00338">sendSyn()</a>, <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00357">sendSynAck()</a>, <a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html#l01115">startSynRexmitTimer()</a>, <a class="el" href="old_2_t_c_p_connection_base_8cc_source.html#l00098">TCPConnection()</a>, and <a class="el" href="old_2_t_c_p_connection_base_8cc_source.html#l00163">~TCPConnection()</a>.</p>

</div>
</div>
<a class="anchor" id="ad70c187b499189b370f99433eb825dcd"></a><!-- doxytag: member="tcp_old::TCPConnection::synRexmitTimer" ref="ad70c187b499189b370f99433eb825dcd" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">cMessage* <a class="el" href="classtcp__old_1_1_t_c_p_connection.html#ad70c187b499189b370f99433eb825dcd">tcp_old::TCPConnection::synRexmitTimer</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_t_c_p_connection__old_8h_source.html#l00289">289</a> of file <a class="el" href="_t_c_p_connection__old_8h_source.html">TCPConnection_old.h</a>.</p>

<p>Referenced by <a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html#l01125">process_TIMEOUT_SYN_REXMIT()</a>, <a class="el" href="old_2_t_c_p_connection_base_8cc_source.html#l00184">processTimer()</a>, <a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html#l01115">startSynRexmitTimer()</a>, <a class="el" href="old_2_t_c_p_connection_base_8cc_source.html#l00449">stateEntered()</a>, <a class="el" href="old_2_t_c_p_connection_base_8cc_source.html#l00098">TCPConnection()</a>, and <a class="el" href="old_2_t_c_p_connection_base_8cc_source.html#l00163">~TCPConnection()</a>.</p>

</div>
</div>
<a class="anchor" id="a2212cb0deb11d2b1c5826cab57b3f42e"></a><!-- doxytag: member="tcp_old::TCPConnection::tcpAlgorithm" ref="a2212cb0deb11d2b1c5826cab57b3f42e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classtcp__old_1_1_t_c_p_algorithm.html">TCPAlgorithm</a>* <a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a2212cb0deb11d2b1c5826cab57b3f42e">tcp_old::TCPConnection::tcpAlgorithm</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_t_c_p_connection__old_8h_source.html#l00283">283</a> of file <a class="el" href="_t_c_p_connection__old_8h_source.html">TCPConnection_old.h</a>.</p>

<p>Referenced by <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00138">cloneListeningConnection()</a>, <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00283">initConnection()</a>, <a class="el" href="old_2_t_c_p_connection_event_proc_8cc_source.html#l00161">process_CLOSE()</a>, <a class="el" href="old_2_t_c_p_connection_event_proc_8cc_source.html#l00113">process_SEND()</a>, <a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html#l00937">processAckInEstabEtc()</a>, <a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html#l00114">processSegment1stThru8th()</a>, <a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html#l00741">processSegmentInSynSent()</a>, <a class="el" href="old_2_t_c_p_connection_base_8cc_source.html#l00184">processTimer()</a>, <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00602">retransmitOneSegment()</a>, <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00414">sendAck()</a>, <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00480">sendData()</a>, <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00430">sendFin()</a>, <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00572">sendProbe()</a>, <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00395">sendRstAck()</a>, <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00357">sendSynAck()</a>, <a class="el" href="old_2_t_c_p_connection_base_8cc_source.html#l00449">stateEntered()</a>, <a class="el" href="old_2_t_c_p_connection_base_8cc_source.html#l00098">TCPConnection()</a>, and <a class="el" href="old_2_t_c_p_connection_base_8cc_source.html#l00163">~TCPConnection()</a>.</p>

</div>
</div>
<a class="anchor" id="a6f9eb8f2af118d2f1fcd90df3c87249e"></a><!-- doxytag: member="tcp_old::TCPConnection::tcpMain" ref="a6f9eb8f2af118d2f1fcd90df3c87249e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classtcp__old_1_1_t_c_p.html">TCP</a>* <a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a6f9eb8f2af118d2f1fcd90df3c87249e">tcp_old::TCPConnection::tcpMain</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_t_c_p_connection__old_8h_source.html#l00270">270</a> of file <a class="el" href="_t_c_p_connection__old_8h_source.html">TCPConnection_old.h</a>.</p>

<p>Referenced by <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00138">cloneListeningConnection()</a>, <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00311">configureStateVariables()</a>, <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00283">initConnection()</a>, <a class="el" href="old_2_t_c_p_connection_base_8cc_source.html#l00284">performStateTransition()</a>, <a class="el" href="old_2_t_c_p_connection_event_proc_8cc_source.html#l00034">process_OPEN_ACTIVE()</a>, <a class="el" href="old_2_t_c_p_connection_event_proc_8cc_source.html#l00080">process_OPEN_PASSIVE()</a>, <a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html#l00622">processSegmentInListen()</a>, <a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html#l00741">processSegmentInSynSent()</a>, <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00261">sendEstabIndicationToApp()</a>, <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00250">sendIndicationToApp()</a>, <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00278">sendToApp()</a>, <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00169">sendToIP()</a>, and <a class="el" href="old_2_t_c_p_connection_base_8cc_source.html#l00114">TCPConnection()</a>.</p>

</div>
</div>
<a class="anchor" id="a67c3fa718ee0542b4bd93eda8785c0fc"></a><!-- doxytag: member="tcp_old::TCPConnection::the2MSLTimer" ref="a67c3fa718ee0542b4bd93eda8785c0fc" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">cMessage* <a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a67c3fa718ee0542b4bd93eda8785c0fc">tcp_old::TCPConnection::the2MSLTimer</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_t_c_p_connection__old_8h_source.html#l00286">286</a> of file <a class="el" href="_t_c_p_connection__old_8h_source.html">TCPConnection_old.h</a>.</p>

<p>Referenced by <a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html#l00114">processSegment1stThru8th()</a>, <a class="el" href="old_2_t_c_p_connection_base_8cc_source.html#l00184">processTimer()</a>, <a class="el" href="old_2_t_c_p_connection_base_8cc_source.html#l00449">stateEntered()</a>, <a class="el" href="old_2_t_c_p_connection_base_8cc_source.html#l00098">TCPConnection()</a>, and <a class="el" href="old_2_t_c_p_connection_base_8cc_source.html#l00163">~TCPConnection()</a>.</p>

</div>
</div>
<a class="anchor" id="a529775c184153f33ff75a91bacc8b0fc"></a><!-- doxytag: member="tcp_old::TCPConnection::unackedVector" ref="a529775c184153f33ff75a91bacc8b0fc" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">cOutVector* <a class="el" href="classtcp__old_1_1_t_c_p_connection.html#a529775c184153f33ff75a91bacc8b0fc">tcp_old::TCPConnection::unackedVector</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_t_c_p_connection__old_8h_source.html#l00297">297</a> of file <a class="el" href="_t_c_p_connection__old_8h_source.html">TCPConnection_old.h</a>.</p>

<p>Referenced by <a class="el" href="old_2_t_c_p_connection_event_proc_8cc_source.html#l00161">process_CLOSE()</a>, <a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html#l00937">processAckInEstabEtc()</a>, <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00480">sendData()</a>, <a class="el" href="old_2_t_c_p_connection_util_8cc_source.html#l00572">sendProbe()</a>, <a class="el" href="old_2_t_c_p_connection_base_8cc_source.html#l00098">TCPConnection()</a>, and <a class="el" href="old_2_t_c_p_connection_base_8cc_source.html#l00163">~TCPConnection()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="_t_c_p_connection__old_8h_source.html">TCPConnection_old.h</a></li>
<li><a class="el" href="old_2_t_c_p_connection_base_8cc_source.html">old/TCPConnectionBase.cc</a></li>
<li><a class="el" href="old_2_t_c_p_connection_event_proc_8cc_source.html">old/TCPConnectionEventProc.cc</a></li>
<li><a class="el" href="old_2_t_c_p_connection_rcv_segment_8cc_source.html">old/TCPConnectionRcvSegment.cc</a></li>
<li><a class="el" href="old_2_t_c_p_connection_util_8cc_source.html">old/TCPConnectionUtil.cc</a></li>
</ul>
</div><!-- contents -->
</div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="namespacetcp__old.html">tcp_old</a>      </li>
      <li class="navelem"><a class="el" href="classtcp__old_1_1_t_c_p_connection.html">TCPConnection</a>      </li>

    <li class="footer">Generated on Wed Aug 29 2012 21:13:18 for INET Framework for OMNeT++/OMNEST by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.6.1 </li>
   </ul>
 </div>


</body>
</html>
