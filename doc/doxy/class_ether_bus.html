<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>INET Framework for OMNeT++/OMNEST: EtherBus Class Reference</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>


</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">INET Framework for OMNeT++/OMNEST
   
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('class_ether_bus.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a>  </div>
  <div class="headertitle">
<div class="title">EtherBus Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<!-- doxytag: class="EtherBus" -->
<p><code>#include &lt;<a class="el" href="_ether_bus_8h_source.html">EtherBus.h</a>&gt;</code></p>

<p><a href="class_ether_bus-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_ether_bus_1_1_bus_tap.html">BusTap</a></td></tr>
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ether_bus.html#abf6f3e8e6c9f66aa1db9e0924058cb54">EtherBus</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ether_bus.html#ae964fdf7cd502083dd64d0797bb55b73">~EtherBus</a> ()</td></tr>
<tr><td colspan="2"><h2><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ether_bus.html#aa9103ead3d52328992f3552042de19f5">initialize</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ether_bus.html#a2d9769ddc5abdfea9fd611806d7d1032">handleMessage</a> (cMessage *)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ether_bus.html#a42424c657962b0e11eb4674f477577b8">finish</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ether_bus.html#a9a9aba7a3ca46634e2a33770082bf02a">tokenize</a> (const char *str, std::vector&lt; double &gt; &amp;array)</td></tr>
<tr><td colspan="2"><h2><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ether_bus.html#a67ab8414865ce84b633ef3a6b9cab740">propagationSpeed</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="struct_ether_bus_1_1_bus_tap.html">BusTap</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ether_bus.html#adac598e12927e743757602578adc2a33">tap</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ether_bus.html#af1efce2293dfdb1be1e8091a2899b1a8">taps</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ether_bus.html#a2f405fe03dc3c21f4580d8b7df4e1b27">numMessages</a></td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>Implements the bus which connects hosts, switches and other LAN entities on an Ethernet LAN. </p>

<p>Definition at line <a class="el" href="_ether_bus_8h_source.html#l00031">31</a> of file <a class="el" href="_ether_bus_8h_source.html">EtherBus.h</a>.</p>
</div><hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="abf6f3e8e6c9f66aa1db9e0924058cb54"></a><!-- doxytag: member="EtherBus::EtherBus" ref="abf6f3e8e6c9f66aa1db9e0924058cb54" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_ether_bus.html#abf6f3e8e6c9f66aa1db9e0924058cb54">EtherBus::EtherBus</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_ether_bus_8cc_source.html#l00029">29</a> of file <a class="el" href="_ether_bus_8cc_source.html">EtherBus.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="class_ether_bus.html#adac598e12927e743757602578adc2a33">tap</a> = NULL;
}
</pre></div>
</div>
</div>
<a class="anchor" id="ae964fdf7cd502083dd64d0797bb55b73"></a><!-- doxytag: member="EtherBus::~EtherBus" ref="ae964fdf7cd502083dd64d0797bb55b73" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_ether_bus.html#ae964fdf7cd502083dd64d0797bb55b73">EtherBus::~EtherBus</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_ether_bus_8cc_source.html#l00034">34</a> of file <a class="el" href="_ether_bus_8cc_source.html">EtherBus.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keyword">delete</span> [] <a class="code" href="class_ether_bus.html#adac598e12927e743757602578adc2a33">tap</a>;
}
</pre></div>
</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="a42424c657962b0e11eb4674f477577b8"></a><!-- doxytag: member="EtherBus::finish" ref="a42424c657962b0e11eb4674f477577b8" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_ether_bus.html#a42424c657962b0e11eb4674f477577b8">EtherBus::finish</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_ether_bus_8cc_source.html#l00191">191</a> of file <a class="el" href="_ether_bus_8cc_source.html">EtherBus.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    simtime_t t = simTime();
    recordScalar(<span class="stringliteral">&quot;simulated time&quot;</span>, t);
    recordScalar(<span class="stringliteral">&quot;messages handled&quot;</span>, <a class="code" href="class_ether_bus.html#a2f405fe03dc3c21f4580d8b7df4e1b27">numMessages</a>);
    <span class="keywordflow">if</span> (t&gt;0)
        recordScalar(<span class="stringliteral">&quot;messages/sec&quot;</span>, <a class="code" href="class_ether_bus.html#a2f405fe03dc3c21f4580d8b7df4e1b27">numMessages</a>/t);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a2d9769ddc5abdfea9fd611806d7d1032"></a><!-- doxytag: member="EtherBus::handleMessage" ref="a2d9769ddc5abdfea9fd611806d7d1032" args="(cMessage *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_ether_bus.html#a2d9769ddc5abdfea9fd611806d7d1032">EtherBus::handleMessage</a> </td>
          <td>(</td>
          <td class="paramtype">cMessage *&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_ether_bus_8cc_source.html#l00117">117</a> of file <a class="el" href="_ether_bus_8cc_source.html">EtherBus.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordflow">if</span> (!msg-&gt;isSelfMessage())
    {
        <span class="comment">// Handle frame sent down from the network entity</span>
        <span class="keywordtype">int</span> tapPoint = msg-&gt;getArrivalGate()-&gt;getIndex();
        <a class="code" href="_i_n_e_t_defs_8h.html#a650ef3eff8a2900bef69dae29c05d2dd">EV</a> &lt;&lt; <span class="stringliteral">&quot;Frame &quot;</span> &lt;&lt; msg &lt;&lt; <span class="stringliteral">&quot; arrived on tap &quot;</span> &lt;&lt; tapPoint &lt;&lt; endl;

        <span class="comment">// create upstream and downstream events</span>
        <span class="keywordflow">if</span> (tapPoint&gt;0)
        {
            <span class="comment">// start UPSTREAM travel</span>
            <span class="comment">// if goes downstream too, we need to make a copy</span>
            cMessage *msg2 = (tapPoint&lt;<a class="code" href="class_ether_bus.html#af1efce2293dfdb1be1e8091a2899b1a8">taps</a>-1) ? (cMessage *)msg-&gt;dup() : msg;
            msg2-&gt;setKind(<a class="code" href="_ether_bus_8h.html#aecc70b06b9893c001633b54e288ff29d">UPSTREAM</a>);
            msg2-&gt;setContextPointer(&amp;<a class="code" href="class_ether_bus.html#adac598e12927e743757602578adc2a33">tap</a>[tapPoint-1]);
            scheduleAt(simTime()+<a class="code" href="class_ether_bus.html#adac598e12927e743757602578adc2a33">tap</a>[tapPoint].propagationDelay[<a class="code" href="_ether_bus_8h.html#aecc70b06b9893c001633b54e288ff29d">UPSTREAM</a>], msg2);
        }
        <span class="keywordflow">if</span> (tapPoint&lt;<a class="code" href="class_ether_bus.html#af1efce2293dfdb1be1e8091a2899b1a8">taps</a>-1)
        {
            <span class="comment">// start DOWNSTREAM travel</span>
            msg-&gt;setKind(<a class="code" href="_ether_bus_8h.html#a0fdd4161dbd1e51472cb8977d633f144">DOWNSTREAM</a>);
            msg-&gt;setContextPointer(&amp;<a class="code" href="class_ether_bus.html#adac598e12927e743757602578adc2a33">tap</a>[tapPoint+1]);
            scheduleAt(simTime()+<a class="code" href="class_ether_bus.html#adac598e12927e743757602578adc2a33">tap</a>[tapPoint].propagationDelay[<a class="code" href="_ether_bus_8h.html#a0fdd4161dbd1e51472cb8977d633f144">DOWNSTREAM</a>], msg);
        }
        <span class="keywordflow">if</span> (<a class="code" href="class_ether_bus.html#af1efce2293dfdb1be1e8091a2899b1a8">taps</a>==1)
        {
            <span class="comment">// if there&#39;s only one tap, there&#39;s nothing to do</span>
            <span class="keyword">delete</span> msg;
        }
    }
    <span class="keywordflow">else</span>
    {
        <span class="comment">// handle upstream and downstream events</span>
        <span class="keywordtype">int</span> direction = msg-&gt;getKind();
        BusTap *thistap = (BusTap *) msg-&gt;getContextPointer();
        <span class="keywordtype">int</span> tapPoint = thistap-&gt;id;

        <a class="code" href="_i_n_e_t_defs_8h.html#a650ef3eff8a2900bef69dae29c05d2dd">EV</a> &lt;&lt; <span class="stringliteral">&quot;Event &quot;</span> &lt;&lt; msg &lt;&lt; <span class="stringliteral">&quot; on tap &quot;</span> &lt;&lt; tapPoint &lt;&lt; <span class="stringliteral">&quot;, sending out frame\n&quot;</span>;

        <span class="comment">// send out on gate</span>
        <span class="keywordtype">bool</span> isLast = (direction==<a class="code" href="_ether_bus_8h.html#aecc70b06b9893c001633b54e288ff29d">UPSTREAM</a>) ? (tapPoint==0) : (tapPoint==<a class="code" href="class_ether_bus.html#af1efce2293dfdb1be1e8091a2899b1a8">taps</a>-1);
        cPacket *msg2 = isLast ? <a class="code" href="_i_n_e_t_defs_8h.html#ae5b816f7de3c5248c812bdb6920f4e06">PK</a>(msg) : PK(msg-&gt;dup());
        send(msg2, <span class="stringliteral">&quot;ethg$o&quot;</span>, tapPoint);

        <span class="comment">// if not end of the bus, schedule for next tap</span>
        <span class="keywordflow">if</span> (isLast)
        {
            <a class="code" href="_i_n_e_t_defs_8h.html#a650ef3eff8a2900bef69dae29c05d2dd">EV</a> &lt;&lt; <span class="stringliteral">&quot;End of bus reached\n&quot;</span>;
        }
        <span class="keywordflow">else</span>
        {
            <a class="code" href="_i_n_e_t_defs_8h.html#a650ef3eff8a2900bef69dae29c05d2dd">EV</a> &lt;&lt; <span class="stringliteral">&quot;Scheduling for next tap\n&quot;</span>;
            <span class="keywordtype">int</span> nextTap = (direction==<a class="code" href="_ether_bus_8h.html#aecc70b06b9893c001633b54e288ff29d">UPSTREAM</a>) ? (tapPoint-1) : (tapPoint+1);
            msg-&gt;setContextPointer(&amp;<a class="code" href="class_ether_bus.html#adac598e12927e743757602578adc2a33">tap</a>[nextTap]);
            scheduleAt(simTime()+<a class="code" href="class_ether_bus.html#adac598e12927e743757602578adc2a33">tap</a>[tapPoint].propagationDelay[direction], msg);
        }
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="aa9103ead3d52328992f3552042de19f5"></a><!-- doxytag: member="EtherBus::initialize" ref="aa9103ead3d52328992f3552042de19f5" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_ether_bus.html#aa9103ead3d52328992f3552042de19f5">EtherBus::initialize</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_ether_bus_8cc_source.html#l00039">39</a> of file <a class="el" href="_ether_bus_8cc_source.html">EtherBus.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="class_ether_bus.html#a2f405fe03dc3c21f4580d8b7df4e1b27">numMessages</a> = 0;
    WATCH(<a class="code" href="class_ether_bus.html#a2f405fe03dc3c21f4580d8b7df4e1b27">numMessages</a>);

    <a class="code" href="class_ether_bus.html#a67ab8414865ce84b633ef3a6b9cab740">propagationSpeed</a> = par(<span class="stringliteral">&quot;propagationSpeed&quot;</span>).doubleValue();

    <span class="comment">// initialize the positions where the hosts connects to the bus</span>
    <a class="code" href="class_ether_bus.html#af1efce2293dfdb1be1e8091a2899b1a8">taps</a> = gateSize(<span class="stringliteral">&quot;ethg&quot;</span>);

    <span class="comment">// read positions and check if positions are defined in order (we&#39;re lazy to sort...)</span>
    std::vector&lt;double&gt; pos;
    <a class="code" href="class_ether_bus.html#a9a9aba7a3ca46634e2a33770082bf02a">tokenize</a>(par(<span class="stringliteral">&quot;positions&quot;</span>).stringValue(), pos);
    <span class="keywordtype">int</span> numPos = pos.size();
    <span class="keywordflow">if</span> (numPos&gt;<a class="code" href="class_ether_bus.html#af1efce2293dfdb1be1e8091a2899b1a8">taps</a>)
        <a class="code" href="_i_n_e_t_defs_8h.html#a650ef3eff8a2900bef69dae29c05d2dd">EV</a> &lt;&lt; <span class="stringliteral">&quot;Note: `positions&#39; parameter contains more values (&quot;</span>&lt;&lt; numPos &lt;&lt; <span class="stringliteral">&quot;) than &quot;</span>
              <span class="stringliteral">&quot;the number of taps (&quot;</span> &lt;&lt; <a class="code" href="class_ether_bus.html#af1efce2293dfdb1be1e8091a2899b1a8">taps</a> &lt;&lt; <span class="stringliteral">&quot;), ignoring excess values.\n&quot;</span>;
    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (numPos&lt;taps &amp;&amp; numPos&gt;=2)
        <a class="code" href="_i_n_e_t_defs_8h.html#a650ef3eff8a2900bef69dae29c05d2dd">EV</a> &lt;&lt; <span class="stringliteral">&quot;Note: `positions&#39; parameter contains less values (&quot;</span>&lt;&lt; numPos &lt;&lt; <span class="stringliteral">&quot;) than &quot;</span>
              <span class="stringliteral">&quot;the number of taps (&quot;</span> &lt;&lt; taps &lt;&lt; <span class="stringliteral">&quot;), repeating distance between last 2 positions.\n&quot;</span>;
    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (numPos&lt;taps &amp;&amp; numPos&lt;2)
        <a class="code" href="_i_n_e_t_defs_8h.html#a650ef3eff8a2900bef69dae29c05d2dd">EV</a> &lt;&lt; <span class="stringliteral">&quot;Note: `positions&#39; parameter contains too few values, using 5m distances.\n&quot;</span>;

    <a class="code" href="class_ether_bus.html#adac598e12927e743757602578adc2a33">tap</a> = <span class="keyword">new</span> BusTap[<a class="code" href="class_ether_bus.html#af1efce2293dfdb1be1e8091a2899b1a8">taps</a>];

    <span class="keywordtype">int</span> <a class="code" href="namespacecesnet.html#a2d959620f0e772e579c21833995d082e">i</a>;
    <span class="keywordtype">double</span> distance = numPos&gt;=2 ? pos[numPos-1]-pos[numPos-2] : 5;
    <span class="keywordflow">for</span> (i=0; i&lt;<a class="code" href="class_ether_bus.html#af1efce2293dfdb1be1e8091a2899b1a8">taps</a>; i++)
    {
        <a class="code" href="class_ether_bus.html#adac598e12927e743757602578adc2a33">tap</a>[<a class="code" href="namespacecesnet.html#a2d959620f0e772e579c21833995d082e">i</a>].<a class="code" href="struct_ether_bus_1_1_bus_tap.html#a4902b7cbbfbafed664ebcf354be45112">id</a> = <a class="code" href="namespacecesnet.html#a2d959620f0e772e579c21833995d082e">i</a>;
        <a class="code" href="class_ether_bus.html#adac598e12927e743757602578adc2a33">tap</a>[<a class="code" href="namespacecesnet.html#a2d959620f0e772e579c21833995d082e">i</a>].<a class="code" href="struct_ether_bus_1_1_bus_tap.html#adf33f42b254152ba66ff16c7617f89f7">position</a> = i&lt;numPos ? pos[<a class="code" href="namespacecesnet.html#a2d959620f0e772e579c21833995d082e">i</a>] : i==0 ? 5 : <a class="code" href="class_ether_bus.html#adac598e12927e743757602578adc2a33">tap</a>[i-1].<a class="code" href="struct_ether_bus_1_1_bus_tap.html#adf33f42b254152ba66ff16c7617f89f7">position</a>+distance;
    }
    <span class="keywordflow">for</span> (i=0; i&lt;taps-1; i++)
    {
        <span class="keywordflow">if</span> (<a class="code" href="class_ether_bus.html#adac598e12927e743757602578adc2a33">tap</a>[i].position &gt; <a class="code" href="class_ether_bus.html#adac598e12927e743757602578adc2a33">tap</a>[i+1].position)
            error(<span class="stringliteral">&quot;Tap positions must be ordered in ascending fashion, modify &#39;positions&#39; parameter and rerun\n&quot;</span>);
    }

    <span class="comment">// Calculate propagation of delays between tap points on the bus</span>
    <span class="keywordflow">for</span> (i=0; i&lt;<a class="code" href="class_ether_bus.html#af1efce2293dfdb1be1e8091a2899b1a8">taps</a>; i++)
    {
        <span class="comment">// Propagation delay between adjacent tap points</span>
        <span class="keywordflow">if</span> (i == 0) {
            <a class="code" href="class_ether_bus.html#adac598e12927e743757602578adc2a33">tap</a>[<a class="code" href="namespacecesnet.html#a2d959620f0e772e579c21833995d082e">i</a>].<a class="code" href="struct_ether_bus_1_1_bus_tap.html#ac55ab2b50802979bd08061a6f98ca6b3">propagationDelay</a>[<a class="code" href="_ether_bus_8h.html#aecc70b06b9893c001633b54e288ff29d">UPSTREAM</a>] = 0;
            <a class="code" href="class_ether_bus.html#adac598e12927e743757602578adc2a33">tap</a>[<a class="code" href="namespacecesnet.html#a2d959620f0e772e579c21833995d082e">i</a>].<a class="code" href="struct_ether_bus_1_1_bus_tap.html#ac55ab2b50802979bd08061a6f98ca6b3">propagationDelay</a>[<a class="code" href="_ether_bus_8h.html#a0fdd4161dbd1e51472cb8977d633f144">DOWNSTREAM</a>] = (<a class="code" href="class_ether_bus.html#adac598e12927e743757602578adc2a33">tap</a>[i+1].<a class="code" href="struct_ether_bus_1_1_bus_tap.html#adf33f42b254152ba66ff16c7617f89f7">position</a> - <a class="code" href="class_ether_bus.html#adac598e12927e743757602578adc2a33">tap</a>[<a class="code" href="namespacecesnet.html#a2d959620f0e772e579c21833995d082e">i</a>].<a class="code" href="struct_ether_bus_1_1_bus_tap.html#adf33f42b254152ba66ff16c7617f89f7">position</a>)/<a class="code" href="class_ether_bus.html#a67ab8414865ce84b633ef3a6b9cab740">propagationSpeed</a>;
        }
        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (i == taps-1) {
            <a class="code" href="class_ether_bus.html#adac598e12927e743757602578adc2a33">tap</a>[<a class="code" href="namespacecesnet.html#a2d959620f0e772e579c21833995d082e">i</a>].<a class="code" href="struct_ether_bus_1_1_bus_tap.html#ac55ab2b50802979bd08061a6f98ca6b3">propagationDelay</a>[<a class="code" href="_ether_bus_8h.html#aecc70b06b9893c001633b54e288ff29d">UPSTREAM</a>] = <a class="code" href="class_ether_bus.html#adac598e12927e743757602578adc2a33">tap</a>[i-1].<a class="code" href="struct_ether_bus_1_1_bus_tap.html#ac55ab2b50802979bd08061a6f98ca6b3">propagationDelay</a>[<a class="code" href="_ether_bus_8h.html#a0fdd4161dbd1e51472cb8977d633f144">DOWNSTREAM</a>];
            <a class="code" href="class_ether_bus.html#adac598e12927e743757602578adc2a33">tap</a>[<a class="code" href="namespacecesnet.html#a2d959620f0e772e579c21833995d082e">i</a>].<a class="code" href="struct_ether_bus_1_1_bus_tap.html#ac55ab2b50802979bd08061a6f98ca6b3">propagationDelay</a>[<a class="code" href="_ether_bus_8h.html#a0fdd4161dbd1e51472cb8977d633f144">DOWNSTREAM</a>] = 0;
        }
        <span class="keywordflow">else</span> {
            <a class="code" href="class_ether_bus.html#adac598e12927e743757602578adc2a33">tap</a>[<a class="code" href="namespacecesnet.html#a2d959620f0e772e579c21833995d082e">i</a>].<a class="code" href="struct_ether_bus_1_1_bus_tap.html#ac55ab2b50802979bd08061a6f98ca6b3">propagationDelay</a>[<a class="code" href="_ether_bus_8h.html#aecc70b06b9893c001633b54e288ff29d">UPSTREAM</a>] = <a class="code" href="class_ether_bus.html#adac598e12927e743757602578adc2a33">tap</a>[i-1].<a class="code" href="struct_ether_bus_1_1_bus_tap.html#ac55ab2b50802979bd08061a6f98ca6b3">propagationDelay</a>[<a class="code" href="_ether_bus_8h.html#a0fdd4161dbd1e51472cb8977d633f144">DOWNSTREAM</a>];
            <a class="code" href="class_ether_bus.html#adac598e12927e743757602578adc2a33">tap</a>[<a class="code" href="namespacecesnet.html#a2d959620f0e772e579c21833995d082e">i</a>].<a class="code" href="struct_ether_bus_1_1_bus_tap.html#ac55ab2b50802979bd08061a6f98ca6b3">propagationDelay</a>[<a class="code" href="_ether_bus_8h.html#a0fdd4161dbd1e51472cb8977d633f144">DOWNSTREAM</a>] = (<a class="code" href="class_ether_bus.html#adac598e12927e743757602578adc2a33">tap</a>[i+1].<a class="code" href="struct_ether_bus_1_1_bus_tap.html#adf33f42b254152ba66ff16c7617f89f7">position</a> - <a class="code" href="class_ether_bus.html#adac598e12927e743757602578adc2a33">tap</a>[<a class="code" href="namespacecesnet.html#a2d959620f0e772e579c21833995d082e">i</a>].<a class="code" href="struct_ether_bus_1_1_bus_tap.html#adf33f42b254152ba66ff16c7617f89f7">position</a>)/<a class="code" href="class_ether_bus.html#a67ab8414865ce84b633ef3a6b9cab740">propagationSpeed</a>;;
        }
    }

    <span class="comment">// Prints out data of parameters for parameter checking...</span>
    <a class="code" href="_i_n_e_t_defs_8h.html#a650ef3eff8a2900bef69dae29c05d2dd">EV</a> &lt;&lt; <span class="stringliteral">&quot;Parameters of (&quot;</span> &lt;&lt; getClassName() &lt;&lt; <span class="stringliteral">&quot;) &quot;</span> &lt;&lt; getFullPath() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;
    <a class="code" href="_i_n_e_t_defs_8h.html#a650ef3eff8a2900bef69dae29c05d2dd">EV</a> &lt;&lt; <span class="stringliteral">&quot;propagationSpeed: &quot;</span> &lt;&lt; <a class="code" href="class_ether_bus.html#a67ab8414865ce84b633ef3a6b9cab740">propagationSpeed</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;
    <span class="keywordflow">for</span> (i=0; i&lt;<a class="code" href="class_ether_bus.html#af1efce2293dfdb1be1e8091a2899b1a8">taps</a>; i++)
    {
        <a class="code" href="_i_n_e_t_defs_8h.html#a650ef3eff8a2900bef69dae29c05d2dd">EV</a> &lt;&lt; <span class="stringliteral">&quot;tap[&quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;] pos: &quot;</span> &lt;&lt; <a class="code" href="class_ether_bus.html#adac598e12927e743757602578adc2a33">tap</a>[<a class="code" href="namespacecesnet.html#a2d959620f0e772e579c21833995d082e">i</a>].<a class="code" href="struct_ether_bus_1_1_bus_tap.html#adf33f42b254152ba66ff16c7617f89f7">position</a> &lt;&lt;
              <span class="stringliteral">&quot;  upstream delay: &quot;</span> &lt;&lt; <a class="code" href="class_ether_bus.html#adac598e12927e743757602578adc2a33">tap</a>[<a class="code" href="namespacecesnet.html#a2d959620f0e772e579c21833995d082e">i</a>].<a class="code" href="struct_ether_bus_1_1_bus_tap.html#ac55ab2b50802979bd08061a6f98ca6b3">propagationDelay</a>[<a class="code" href="_ether_bus_8h.html#aecc70b06b9893c001633b54e288ff29d">UPSTREAM</a>] &lt;&lt;
              <span class="stringliteral">&quot;  downstream delay: &quot;</span> &lt;&lt; <a class="code" href="class_ether_bus.html#adac598e12927e743757602578adc2a33">tap</a>[<a class="code" href="namespacecesnet.html#a2d959620f0e772e579c21833995d082e">i</a>].<a class="code" href="struct_ether_bus_1_1_bus_tap.html#ac55ab2b50802979bd08061a6f98ca6b3">propagationDelay</a>[<a class="code" href="_ether_bus_8h.html#a0fdd4161dbd1e51472cb8977d633f144">DOWNSTREAM</a>] &lt;&lt; endl;
    }
    <a class="code" href="_i_n_e_t_defs_8h.html#a650ef3eff8a2900bef69dae29c05d2dd">EV</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;

    <span class="comment">// autoconfig: tell everyone that bus supports only 10Mb half-duplex</span>
    <a class="code" href="_i_n_e_t_defs_8h.html#a650ef3eff8a2900bef69dae29c05d2dd">EV</a> &lt;&lt; <span class="stringliteral">&quot;Autoconfig: advertising that we only support 10Mb half-duplex operation\n&quot;</span>;
    <span class="keywordflow">for</span> (i=0; i&lt;<a class="code" href="class_ether_bus.html#af1efce2293dfdb1be1e8091a2899b1a8">taps</a>; i++)
    {
        <a class="code" href="class_ether_autoconfig.html">EtherAutoconfig</a> *autoconf = <span class="keyword">new</span> <a class="code" href="class_ether_autoconfig.html">EtherAutoconfig</a>(<span class="stringliteral">&quot;autoconf-10Mb-halfduplex&quot;</span>);
        autoconf-&gt;<a class="code" href="class_ether_autoconfig.html#a5d1d09e7a43b4854f80b7a7e66035453">setHalfDuplex</a>(<span class="keyword">true</span>);
        autoconf-&gt;<a class="code" href="class_ether_autoconfig.html#ab1f1ccdb75c2e687c9e284eb61965093">setTxrate</a>(10000000); <span class="comment">// 10Mb</span>
        send(autoconf,<span class="stringliteral">&quot;ethg$o&quot;</span>,i);
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a9a9aba7a3ca46634e2a33770082bf02a"></a><!-- doxytag: member="EtherBus::tokenize" ref="a9a9aba7a3ca46634e2a33770082bf02a" args="(const char *str, std::vector&lt; double &gt; &amp;array)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_ether_bus.html#a9a9aba7a3ca46634e2a33770082bf02a">EtherBus::tokenize</a> </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>str</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>array</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_ether_bus_8cc_source.html#l00177">177</a> of file <a class="el" href="_ether_bus_8cc_source.html">EtherBus.cc</a>.</p>

<p>Referenced by <a class="el" href="_ether_bus_8cc_source.html#l00039">initialize()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordtype">char</span> *str2 = opp_strdup(str);
    <span class="keywordflow">if</span> (!str2) <span class="keywordflow">return</span>;
        <span class="keywordtype">char</span> *s = strtok(str2, <span class="stringliteral">&quot; &quot;</span>);
    <span class="keywordflow">while</span> (s)
    {
        array.push_back(atof(s));
        s = strtok(NULL, <span class="stringliteral">&quot; &quot;</span>);
    }
    <span class="keyword">delete</span> [] str2;
}
</pre></div>
</div>
</div>
<hr/><h2>Member Data Documentation</h2>
<a class="anchor" id="a2f405fe03dc3c21f4580d8b7df4e1b27"></a><!-- doxytag: member="EtherBus::numMessages" ref="a2f405fe03dc3c21f4580d8b7df4e1b27" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">long <a class="el" href="class_ether_bus.html#a2f405fe03dc3c21f4580d8b7df4e1b27">EtherBus::numMessages</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_ether_bus_8h_source.html#l00050">50</a> of file <a class="el" href="_ether_bus_8h_source.html">EtherBus.h</a>.</p>

<p>Referenced by <a class="el" href="_ether_bus_8cc_source.html#l00191">finish()</a>, and <a class="el" href="_ether_bus_8cc_source.html#l00039">initialize()</a>.</p>

</div>
</div>
<a class="anchor" id="a67ab8414865ce84b633ef3a6b9cab740"></a><!-- doxytag: member="EtherBus::propagationSpeed" ref="a67ab8414865ce84b633ef3a6b9cab740" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double <a class="el" href="class_ether_bus.html#a67ab8414865ce84b633ef3a6b9cab740">EtherBus::propagationSpeed</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_ether_bus_8h_source.html#l00045">45</a> of file <a class="el" href="_ether_bus_8h_source.html">EtherBus.h</a>.</p>

<p>Referenced by <a class="el" href="_ether_bus_8cc_source.html#l00039">initialize()</a>.</p>

</div>
</div>
<a class="anchor" id="adac598e12927e743757602578adc2a33"></a><!-- doxytag: member="EtherBus::tap" ref="adac598e12927e743757602578adc2a33" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct_ether_bus_1_1_bus_tap.html">BusTap</a>* <a class="el" href="class_ether_bus.html#adac598e12927e743757602578adc2a33">EtherBus::tap</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_ether_bus_8h_source.html#l00047">47</a> of file <a class="el" href="_ether_bus_8h_source.html">EtherBus.h</a>.</p>

<p>Referenced by <a class="el" href="_ether_bus_8cc_source.html#l00029">EtherBus()</a>, <a class="el" href="_ether_bus_8cc_source.html#l00117">handleMessage()</a>, <a class="el" href="_ether_bus_8cc_source.html#l00039">initialize()</a>, and <a class="el" href="_ether_bus_8cc_source.html#l00034">~EtherBus()</a>.</p>

</div>
</div>
<a class="anchor" id="af1efce2293dfdb1be1e8091a2899b1a8"></a><!-- doxytag: member="EtherBus::taps" ref="af1efce2293dfdb1be1e8091a2899b1a8" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="class_ether_bus.html#af1efce2293dfdb1be1e8091a2899b1a8">EtherBus::taps</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_ether_bus_8h_source.html#l00048">48</a> of file <a class="el" href="_ether_bus_8h_source.html">EtherBus.h</a>.</p>

<p>Referenced by <a class="el" href="_ether_bus_8cc_source.html#l00117">handleMessage()</a>, and <a class="el" href="_ether_bus_8cc_source.html#l00039">initialize()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="_ether_bus_8h_source.html">EtherBus.h</a></li>
<li><a class="el" href="_ether_bus_8cc_source.html">EtherBus.cc</a></li>
</ul>
</div><!-- contents -->
</div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="class_ether_bus.html">EtherBus</a>      </li>

    <li class="footer">Generated on Wed Aug 29 2012 21:13:04 for INET Framework for OMNeT++/OMNEST by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.6.1 </li>
   </ul>
 </div>


</body>
</html>
