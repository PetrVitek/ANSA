<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>INET Framework for OMNeT++/OMNEST: SCTP Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript">
$(document).ready(initResizable);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">INET Framework for OMNeT++/OMNEST</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('class_s_c_t_p.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="#pub-static-attribs">Static Public Attributes</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="#pro-static-attribs">Static Protected Attributes</a>  </div>
  <div class="headertitle">
<div class="title">SCTP Class Reference</div>  </div>
</div>
<div class="contents">
<!-- doxytag: class="SCTP" -->
<p><code>#include &lt;SCTP.h&gt;</code></p>

<p><a href="class_s_c_t_p-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_s_c_t_p_1_1_app_conn_key.html">AppConnKey</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_s_c_t_p_1_1_assoc_stat.html">AssocStat</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_s_c_t_p_1_1_sock_pair.html">SockPair</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_s_c_t_p_1_1_v_tag_pair.html">VTagPair</a></td></tr>
<tr><td colspan="2"><h2><a name="pub-types"></a>
Public Types</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef std::map&lt; int32, <br class="typebreak"/>
<a class="el" href="struct_s_c_t_p_1_1_assoc_stat.html">AssocStat</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_s_c_t_p.html#a439de408c0d516fec889a8e67172156a">AssocStatMap</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef std::map&lt; int32, <a class="el" href="struct_s_c_t_p_1_1_v_tag_pair.html">VTagPair</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_s_c_t_p.html#acdebc4566eea2a17e3a309be272423c6">SctpVTagMap</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef std::map&lt; <a class="el" href="struct_s_c_t_p_1_1_app_conn_key.html">AppConnKey</a>, <br class="typebreak"/>
<a class="el" href="class_s_c_t_p_association.html">SCTPAssociation</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_s_c_t_p.html#ae31035be18163654260221f1d31ccbc6">SctpAppConnMap</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef std::map&lt; <a class="el" href="struct_s_c_t_p_1_1_sock_pair.html">SockPair</a>, <br class="typebreak"/>
<a class="el" href="class_s_c_t_p_association.html">SCTPAssociation</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_s_c_t_p.html#a119ab387204716b81562e9ea58789eab">SctpConnMap</a></td></tr>
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_s_c_t_p.html#a84f317375ec11a83b15062a0d77694d3">printInfoConnMap</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_s_c_t_p.html#afbb694a62bd6c7c911275ba3a6ce38db">printVTagMap</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_s_c_t_p.html#a4848bf1f15a9f7aac6e53cd1889f9345">removeAssociation</a> (<a class="el" href="class_s_c_t_p_association.html">SCTPAssociation</a> *assoc)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_s_c_t_p.html#a592a2d4ff219d86d6665d7a1a65fe8e0">~SCTP</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_s_c_t_p.html#a7c9cce2a01f191ddeb3c4ed21f413339">initialize</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_s_c_t_p.html#a305de6ada20d2db21ddd19ad19cac3a1">handleMessage</a> (cMessage *msg)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_s_c_t_p.html#a7547ab07373b78775ff3ec27eb704ae3">finish</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="struct_s_c_t_p_1_1_assoc_stat.html">AssocStat</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_s_c_t_p.html#ac0d7608e4fb9d3d5cc41d98ac2cd66de">getAssocStat</a> (uint32 assocId)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_s_c_t_p.html#a2ee4aaa2e36516a679b8c4a0748ecd9a">updateSockPair</a> (<a class="el" href="class_s_c_t_p_association.html">SCTPAssociation</a> *assoc, <a class="el" href="class_i_pv_x_address.html">IPvXAddress</a> localAddr, <a class="el" href="class_i_pv_x_address.html">IPvXAddress</a> remoteAddr, int32 localPort, int32 remotePort)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_s_c_t_p.html#aeb3f468f36416f953ab7e647540f75e4">addLocalAddress</a> (<a class="el" href="class_s_c_t_p_association.html">SCTPAssociation</a> *conn, <a class="el" href="class_i_pv_x_address.html">IPvXAddress</a> address)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_s_c_t_p.html#a476b640dbefbde3ee8029eef4393800e">addLocalAddressToAllRemoteAddresses</a> (<a class="el" href="class_s_c_t_p_association.html">SCTPAssociation</a> *conn, <a class="el" href="class_i_pv_x_address.html">IPvXAddress</a> address, std::vector&lt; <a class="el" href="class_i_pv_x_address.html">IPvXAddress</a> &gt; remAddresses)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_s_c_t_p.html#a34e3e284fe397118d5e69b56e497ed45">addRemoteAddress</a> (<a class="el" href="class_s_c_t_p_association.html">SCTPAssociation</a> *conn, <a class="el" href="class_i_pv_x_address.html">IPvXAddress</a> localAddress, <a class="el" href="class_i_pv_x_address.html">IPvXAddress</a> remoteAddress)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_s_c_t_p.html#abd09eaf1572e207a25aff6988091ca0f">removeLocalAddressFromAllRemoteAddresses</a> (<a class="el" href="class_s_c_t_p_association.html">SCTPAssociation</a> *conn, <a class="el" href="class_i_pv_x_address.html">IPvXAddress</a> address, std::vector&lt; <a class="el" href="class_i_pv_x_address.html">IPvXAddress</a> &gt; remAddresses)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_s_c_t_p.html#a2d162fde6e9246ce9db340f1824187a1">removeRemoteAddressFromAllConnections</a> (<a class="el" href="class_s_c_t_p_association.html">SCTPAssociation</a> *conn, <a class="el" href="class_i_pv_x_address.html">IPvXAddress</a> address, std::vector&lt; <a class="el" href="class_i_pv_x_address.html">IPvXAddress</a> &gt; locAddresses)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_s_c_t_p.html#a8e139c401cbd596810592e62be90a21e">addForkedAssociation</a> (<a class="el" href="class_s_c_t_p_association.html">SCTPAssociation</a> *assoc, <a class="el" href="class_s_c_t_p_association.html">SCTPAssociation</a> *newAssoc, <a class="el" href="class_i_pv_x_address.html">IPvXAddress</a> localAddr, <a class="el" href="class_i_pv_x_address.html">IPvXAddress</a> remoteAddr, int32 localPort, int32 remotePort)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint16&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_s_c_t_p.html#acf8131c6cb5ae94bc2b49b3305b51304">getEphemeralPort</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_s_c_t_p_association.html">SCTPAssociation</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_s_c_t_p.html#a399d0ce6826ad6cc3bd4656be35bc5e7">getAssoc</a> (int32 assocId)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_s_c_t_p_association.html">SCTPAssociation</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_s_c_t_p.html#a09e0381fe0039c77faf2a2d17736201e">findAssocWithVTag</a> (uint32 peerVTag, uint32 remotePort, uint32 localPort)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_s_c_t_p.html#acdebc4566eea2a17e3a309be272423c6">SctpVTagMap</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_s_c_t_p.html#ab1523f02b1b32c1a42ca04a028948ad0">getVTagMap</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_s_c_t_p.html#a7102d8279e65efb42c25c3e79bbaa492">bindPortForUDP</a> ()</td></tr>
<tr><td colspan="2"><h2><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int32&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_s_c_t_p.html#a3eddd3a5ef9f40583d51b4eac4204f5f">getNewConnId</a> ()</td></tr>
<tr><td colspan="2"><h2><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_s_c_t_p.html#a439de408c0d516fec889a8e67172156a">AssocStatMap</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_s_c_t_p.html#a43c9f3107b99f1c969a4d5ca9c168bd3">assocStatMap</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_s_c_t_p.html#acdebc4566eea2a17e3a309be272423c6">SctpVTagMap</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_s_c_t_p.html#ad27c44853f019878d8c9be020c56f8d9">sctpVTagMap</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_s_c_t_p.html#ae31035be18163654260221f1d31ccbc6">SctpAppConnMap</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_s_c_t_p.html#a0bdbaac417e09631312a82718184fca5">sctpAppConnMap</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_s_c_t_p.html#a119ab387204716b81562e9ea58789eab">SctpConnMap</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_s_c_t_p.html#aa7f1b6e9c58bb2e49f644cc4fad58af2">sctpConnMap</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::list&lt; <a class="el" href="class_s_c_t_p_association.html">SCTPAssociation</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_s_c_t_p.html#affa2f26db6bbbf00938fa27e35b8f567">assocList</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">simtime_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_s_c_t_p.html#a35089977465533256142ee442021b18d">testTimeout</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint32&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_s_c_t_p.html#ac9a52a17f3bf53576459c72587f36dc8">numGapReports</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint32&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_s_c_t_p.html#ab63c2cdb48459ff2da4de9dd8be20651">numPacketsReceived</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint32&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_s_c_t_p.html#a08ec3d0f806364ad7d97ec0349b9d815">numPacketsDropped</a></td></tr>
<tr><td colspan="2"><h2><a name="pub-static-attribs"></a>
Static Public Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_s_c_t_p.html#a0c82ce1676bd810f2defcce17bd1bd0a">testing</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_s_c_t_p.html#afd8d177039fd50dc468ce8c4231d59f7">logverbose</a></td></tr>
<tr><td colspan="2"><h2><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_s_c_t_p_association.html">SCTPAssociation</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_s_c_t_p.html#ad481f51413de9f5cf1070ea507ffb345">findAssocForMessage</a> (<a class="el" href="class_i_pv_x_address.html">IPvXAddress</a> srcAddr, <a class="el" href="class_i_pv_x_address.html">IPvXAddress</a> destAddr, uint32 srcPort, uint32 destPort, bool findListen)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_s_c_t_p_association.html">SCTPAssociation</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_s_c_t_p.html#aae97b24ba4ed4bb4950c3117f4c101d1">findAssocForApp</a> (int32 appGateIndex, int32 assocId)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_s_c_t_p.html#a8a189047a5fbd254dcd9d9283ba08836">sendAbortFromMain</a> (<a class="el" href="class_s_c_t_p_message.html">SCTPMessage</a> *sctpmsg, <a class="el" href="class_i_pv_x_address.html">IPvXAddress</a> srcAddr, <a class="el" href="class_i_pv_x_address.html">IPvXAddress</a> destAddr)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_s_c_t_p.html#aa184b3126dcf702901f1c1f0bc3529f4">sendShutdownCompleteFromMain</a> (<a class="el" href="class_s_c_t_p_message.html">SCTPMessage</a> *sctpmsg, <a class="el" href="class_i_pv_x_address.html">IPvXAddress</a> srcAddr, <a class="el" href="class_i_pv_x_address.html">IPvXAddress</a> destAddr)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_s_c_t_p.html#a47a90c0d2a89f45862e0a21004c11bdb">updateDisplayString</a> ()</td></tr>
<tr><td colspan="2"><h2><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int32&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_s_c_t_p.html#a5c27765c60c9634a47b00c4de6137809">sizeConnMap</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint16&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_s_c_t_p.html#aaa0391c9c63435dee2ca1da5610bf697">nextEphemeralPort</a></td></tr>
<tr><td colspan="2"><h2><a name="pro-static-attribs"></a>
Static Protected Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int32&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_s_c_t_p.html#adcb74cef25ffed39e3825f2181f488f9">nextConnId</a> = 0</td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>Implements the <a class="el" href="class_s_c_t_p.html">SCTP</a> protocol. This section describes the internal architecture of the <a class="el" href="class_s_c_t_p.html">SCTP</a> model.</p>
<p>You may want to check the <a class="el" href="class_s_c_t_p_socket.html">SCTPSocket</a> class which makes it easier to use <a class="el" href="class_s_c_t_p.html">SCTP</a> from applications.</p>
<p>The <a class="el" href="class_s_c_t_p.html">SCTP</a> protocol implementation is composed of several classes (discussion follows below):</p>
<ul>
<li><a class="el" href="class_s_c_t_p.html">SCTP</a>: the module class</li>
<li><a class="el" href="class_s_c_t_p_association.html">SCTPAssociation</a>: manages a connection</li>
<li>SCTPSendQueue, SCTPReceiveQueue: abstract base classes for various types of send and receive queues</li>
<li><a class="el" href="class_s_c_t_p_algorithm.html">SCTPAlgorithm</a>: abstract base class for <a class="el" href="class_s_c_t_p.html">SCTP</a> algorithms</li>
</ul>
<p><a class="el" href="class_s_c_t_p.html">SCTP</a> subclassed from cSimpleModule. It manages socketpair-to-connection mapping, and dispatches segments and user commands to the appropriate <a class="el" href="class_s_c_t_p_association.html">SCTPAssociation</a> object.</p>
<p><a class="el" href="class_s_c_t_p_association.html">SCTPAssociation</a> manages the connection, with the help of other objects. <a class="el" href="class_s_c_t_p_association.html">SCTPAssociation</a> itself implements the basic <a class="el" href="class_s_c_t_p.html">SCTP</a> "machinery": takes care of the state machine, stores the state variables (TCB), sends/receives etc.</p>
<p><a class="el" href="class_s_c_t_p_association.html">SCTPAssociation</a> internally relies on 3 objects. The first two are subclassed from SCTPSendQueue and SCTPReceiveQueue. They manage the actual data stream, so <a class="el" href="class_s_c_t_p_association.html">SCTPAssociation</a> itself only works with sequence number variables. This makes it possible to easily accomodate need for various types of simulated data transfer: real byte stream, "virtual" bytes (byte counts only), and sequence of cMessage objects (where every message object is mapped to a <a class="el" href="class_s_c_t_p.html">SCTP</a> sequence number range).</p>
<p>Currently implemented send queue and receive queue classes are SCTPVirtualDataSendQueue and SCTPVirtualDataRcvQueue which implement queues with "virtual" bytes (byte counts only).</p>
<p>The third object is subclassed from <a class="el" href="class_s_c_t_p_algorithm.html">SCTPAlgorithm</a>. Control over retransmissions, congestion control and ACK sending are "outsourced" from <a class="el" href="class_s_c_t_p_association.html">SCTPAssociation</a> into <a class="el" href="class_s_c_t_p_algorithm.html">SCTPAlgorithm</a>: delayed acks, slow start, fast rexmit, etc. are all implemented in <a class="el" href="class_s_c_t_p_algorithm.html">SCTPAlgorithm</a> subclasses.</p>
<p>The concrete <a class="el" href="class_s_c_t_p_algorithm.html">SCTPAlgorithm</a> class to use can be chosen per connection (in OPEN) or in a module parameter. </p>
</div><hr/><h2>Member Typedef Documentation</h2>
<a class="anchor" id="a439de408c0d516fec889a8e67172156a"></a><!-- doxytag: member="SCTP::AssocStatMap" ref="a439de408c0d516fec889a8e67172156a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef std::map&lt;int32,<a class="el" href="struct_s_c_t_p_1_1_assoc_stat.html">AssocStat</a>&gt; <a class="el" href="class_s_c_t_p.html#a439de408c0d516fec889a8e67172156a">SCTP::AssocStatMap</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="ae31035be18163654260221f1d31ccbc6"></a><!-- doxytag: member="SCTP::SctpAppConnMap" ref="ae31035be18163654260221f1d31ccbc6" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef std::map&lt;<a class="el" href="struct_s_c_t_p_1_1_app_conn_key.html">AppConnKey</a>,<a class="el" href="class_s_c_t_p_association.html">SCTPAssociation</a>*&gt; <a class="el" href="class_s_c_t_p.html#ae31035be18163654260221f1d31ccbc6">SCTP::SctpAppConnMap</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a119ab387204716b81562e9ea58789eab"></a><!-- doxytag: member="SCTP::SctpConnMap" ref="a119ab387204716b81562e9ea58789eab" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef std::map&lt;<a class="el" href="struct_s_c_t_p_1_1_sock_pair.html">SockPair</a>,<a class="el" href="class_s_c_t_p_association.html">SCTPAssociation</a>*&gt; <a class="el" href="class_s_c_t_p.html#a119ab387204716b81562e9ea58789eab">SCTP::SctpConnMap</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="acdebc4566eea2a17e3a309be272423c6"></a><!-- doxytag: member="SCTP::SctpVTagMap" ref="acdebc4566eea2a17e3a309be272423c6" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef std::map&lt;int32, <a class="el" href="struct_s_c_t_p_1_1_v_tag_pair.html">VTagPair</a>&gt; <a class="el" href="class_s_c_t_p.html#acdebc4566eea2a17e3a309be272423c6">SCTP::SctpVTagMap</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a592a2d4ff219d86d6665d7a1a65fe8e0"></a><!-- doxytag: member="SCTP::~SCTP" ref="a592a2d4ff219d86d6665d7a1a65fe8e0" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SCTP::~SCTP </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<div class="fragment"><pre class="fragment">{
    <a class="code" href="_s_c_t_p_8h.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a>&lt;&lt;<span class="stringliteral">&quot;delete SCTPMain\n&quot;</span>;
    <span class="keywordflow">if</span> (!(<a class="code" href="class_s_c_t_p.html#a0bdbaac417e09631312a82718184fca5">sctpAppConnMap</a>.empty()))
    {
        <a class="code" href="_s_c_t_p_8h.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a>&lt;&lt;<span class="stringliteral">&quot;clear appConnMap ptr=&quot;</span>&lt;&lt;&amp;<a class="code" href="class_s_c_t_p.html#a0bdbaac417e09631312a82718184fca5">sctpAppConnMap</a>&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;
        sctpAppConnMap.clear();
    }
    <span class="keywordflow">if</span> (!(<a class="code" href="class_s_c_t_p.html#a43c9f3107b99f1c969a4d5ca9c168bd3">assocStatMap</a>.empty()))
    {
        <a class="code" href="_s_c_t_p_8h.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a>&lt;&lt;<span class="stringliteral">&quot;clear assocStatMap ptr=&quot;</span>&lt;&lt;&amp;<a class="code" href="class_s_c_t_p.html#a43c9f3107b99f1c969a4d5ca9c168bd3">assocStatMap</a>&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;
        assocStatMap.clear();
    }
    <span class="keywordflow">if</span> (!(<a class="code" href="class_s_c_t_p.html#ad27c44853f019878d8c9be020c56f8d9">sctpVTagMap</a>.empty()))
    {
        <a class="code" href="class_s_c_t_p.html#ad27c44853f019878d8c9be020c56f8d9">sctpVTagMap</a>.clear();
    }
    <a class="code" href="_s_c_t_p_8h.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a>&lt;&lt;<span class="stringliteral">&quot;after clearing maps\n&quot;</span>;
}
</pre></div>
</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="a8e139c401cbd596810592e62be90a21e"></a><!-- doxytag: member="SCTP::addForkedAssociation" ref="a8e139c401cbd596810592e62be90a21e" args="(SCTPAssociation *assoc, SCTPAssociation *newAssoc, IPvXAddress localAddr, IPvXAddress remoteAddr, int32 localPort, int32 remotePort)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SCTP::addForkedAssociation </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_s_c_t_p_association.html">SCTPAssociation</a> *&#160;</td>
          <td class="paramname"><em>assoc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_s_c_t_p_association.html">SCTPAssociation</a> *&#160;</td>
          <td class="paramname"><em>newAssoc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_i_pv_x_address.html">IPvXAddress</a>&#160;</td>
          <td class="paramname"><em>localAddr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_i_pv_x_address.html">IPvXAddress</a>&#160;</td>
          <td class="paramname"><em>remoteAddr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>localPort</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>remotePort</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Update assocs socket pair, and register newAssoc (which'll keep LISTENing). Also, assoc will get a new assocId (and newAssoc will live on with its old assocId). </p>

<p>Referenced by <a class="el" href="class_s_c_t_p_association.html#add502b430991fe297800a08dd62c569d">SCTPAssociation::processInitArrived()</a>.</p>
<div class="fragment"><pre class="fragment">{
    SockPair keyAssoc;

    ev&lt;&lt;<span class="stringliteral">&quot;addForkedConnection assocId=&quot;</span>&lt;&lt;assoc-&gt;<a class="code" href="class_s_c_t_p_association.html#a135afa4887cc640b0e8410dc95a29972">assocId</a>&lt;&lt;<span class="stringliteral">&quot;    newId=&quot;</span>&lt;&lt;newAssoc-&gt;<a class="code" href="class_s_c_t_p_association.html#a135afa4887cc640b0e8410dc95a29972">assocId</a>&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;

    <span class="keywordflow">for</span> (SctpConnMap::iterator j=<a class="code" href="class_s_c_t_p.html#aa7f1b6e9c58bb2e49f644cc4fad58af2">sctpConnMap</a>.begin(); j!=<a class="code" href="class_s_c_t_p.html#aa7f1b6e9c58bb2e49f644cc4fad58af2">sctpConnMap</a>.end(); ++j)
        <span class="keywordflow">if</span> (assoc-&gt;<a class="code" href="class_s_c_t_p_association.html#a135afa4887cc640b0e8410dc95a29972">assocId</a>==j-&gt;second-&gt;assocId)
            keyAssoc = j-&gt;first;
    <span class="comment">// update conn&#39;s socket pair, and register newConn (which&#39;ll keep LISTENing)</span>
    <a class="code" href="class_s_c_t_p.html#a2ee4aaa2e36516a679b8c4a0748ecd9a">updateSockPair</a>(assoc, localAddr, remoteAddr, localPort, remotePort);
    <a class="code" href="class_s_c_t_p.html#a2ee4aaa2e36516a679b8c4a0748ecd9a">updateSockPair</a>(newAssoc, keyAssoc.<a class="code" href="class_s_c_t_p_association.html#a3e8d3c43ea031c35ab782b91f628563c">localAddr</a>, keyAssoc.remoteAddr, keyAssoc.localPort, keyAssoc.remotePort);
    <span class="comment">// conn will get a new assocId...</span>
    AppConnKey key;
    key.appGateIndex = assoc-&gt;<a class="code" href="class_s_c_t_p_association.html#aba709e2f773752366d1c291c4fb360c8">appGateIndex</a>;
    key.assocId = assoc-&gt;<a class="code" href="class_s_c_t_p_association.html#a135afa4887cc640b0e8410dc95a29972">assocId</a>;
    <a class="code" href="class_s_c_t_p.html#a0bdbaac417e09631312a82718184fca5">sctpAppConnMap</a>.erase(key);
    key.assocId = assoc-&gt;<a class="code" href="class_s_c_t_p_association.html#a135afa4887cc640b0e8410dc95a29972">assocId</a> = <a class="code" href="class_s_c_t_p.html#a3eddd3a5ef9f40583d51b4eac4204f5f">getNewConnId</a>();
    <a class="code" href="class_s_c_t_p.html#a0bdbaac417e09631312a82718184fca5">sctpAppConnMap</a>[key] = assoc;

    <span class="comment">// ...and newConn will live on with the old assocId</span>
    key.<a class="code" href="class_s_c_t_p_association.html#aba709e2f773752366d1c291c4fb360c8">appGateIndex</a> = newAssoc-&gt;<a class="code" href="class_s_c_t_p_association.html#aba709e2f773752366d1c291c4fb360c8">appGateIndex</a>;
    key.assocId = newAssoc-&gt;<a class="code" href="class_s_c_t_p_association.html#a135afa4887cc640b0e8410dc95a29972">assocId</a>;
    <a class="code" href="class_s_c_t_p.html#a0bdbaac417e09631312a82718184fca5">sctpAppConnMap</a>[key] = newAssoc;
    <span class="comment">/*ev&lt;&lt;&quot;assocId=&quot;&lt;&lt;assoc-&gt;assocId&lt;&lt;&quot; remoteAddr=&quot;&lt;&lt;assoc-&gt;remoteAddr&lt;&lt;&quot;\n&quot;;</span>
<span class="comment">    assoc-&gt;removeOldPath();*/</span>
    <a class="code" href="class_s_c_t_p.html#a84f317375ec11a83b15062a0d77694d3">printInfoConnMap</a>();
}
</pre></div>
</div>
</div>
<a class="anchor" id="aeb3f468f36416f953ab7e647540f75e4"></a><!-- doxytag: member="SCTP::addLocalAddress" ref="aeb3f468f36416f953ab7e647540f75e4" args="(SCTPAssociation *conn, IPvXAddress address)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SCTP::addLocalAddress </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_s_c_t_p_association.html">SCTPAssociation</a> *&#160;</td>
          <td class="paramname"><em>conn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_i_pv_x_address.html">IPvXAddress</a>&#160;</td>
          <td class="paramname"><em>address</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="class_s_c_t_p_association.html#add502b430991fe297800a08dd62c569d">SCTPAssociation::processInitArrived()</a>, and <a class="el" href="class_s_c_t_p_association.html#afc1d3dc0cb62842b7d83998facfbfd06">SCTPAssociation::sendInit()</a>.</p>
<div class="fragment"><pre class="fragment">{

        <span class="comment">//sctpEV3&lt;&lt;&quot;Add local address: &quot;&lt;&lt;address&lt;&lt;&quot;\n&quot;;</span>

        SockPair key;

        key.localAddr = conn-&gt;<a class="code" href="class_s_c_t_p_association.html#a3e8d3c43ea031c35ab782b91f628563c">localAddr</a>;
        key.remoteAddr = conn-&gt;<a class="code" href="class_s_c_t_p_association.html#a694133846dd4defebbd87493888d7c2e">remoteAddr</a>;
        key.localPort = conn-&gt;<a class="code" href="class_s_c_t_p_association.html#acb21c9ce886b796d5134b1c0daa3227b">localPort</a>;
        key.remotePort = conn-&gt;<a class="code" href="class_s_c_t_p_association.html#a62e2c58ac9cc4e804800c05bae9da71f">remotePort</a>;

        SctpConnMap::iterator i = <a class="code" href="class_s_c_t_p.html#aa7f1b6e9c58bb2e49f644cc4fad58af2">sctpConnMap</a>.find(key);
        <span class="keywordflow">if</span> (i!=<a class="code" href="class_s_c_t_p.html#aa7f1b6e9c58bb2e49f644cc4fad58af2">sctpConnMap</a>.end())
        {
            ASSERT(i-&gt;second==conn);
            <span class="keywordflow">if</span> (key.localAddr.isUnspecified())
            {
                <a class="code" href="class_s_c_t_p.html#aa7f1b6e9c58bb2e49f644cc4fad58af2">sctpConnMap</a>.erase(i);
                <a class="code" href="class_s_c_t_p.html#a5c27765c60c9634a47b00c4de6137809">sizeConnMap</a>--;
            }
        }
        <span class="keywordflow">else</span>
            <a class="code" href="_s_c_t_p_8h.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a>&lt;&lt;<span class="stringliteral">&quot;no actual sockPair found\n&quot;</span>;
        key.localAddr = address;
        <span class="comment">//key.localAddr = address.get4().getInt();</span>
        <span class="comment">// //sctpEV3&lt;&lt;&quot;laddr=&quot;&lt;&lt;key.localAddr&lt;&lt;&quot;    lp=&quot;&lt;&lt;key.localPort&lt;&lt;&quot;  raddr=&quot;&lt;&lt;key.remoteAddr&lt;&lt;&quot; rPort=&quot;&lt;&lt;key.remotePort&lt;&lt;&quot;\n&quot;;</span>
        <a class="code" href="class_s_c_t_p.html#aa7f1b6e9c58bb2e49f644cc4fad58af2">sctpConnMap</a>[key] = conn;
        <a class="code" href="class_s_c_t_p.html#a5c27765c60c9634a47b00c4de6137809">sizeConnMap</a> = <a class="code" href="class_s_c_t_p.html#aa7f1b6e9c58bb2e49f644cc4fad58af2">sctpConnMap</a>.size();
        <a class="code" href="_s_c_t_p_8h.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a>&lt;&lt;<span class="stringliteral">&quot;number of connections=&quot;</span>&lt;&lt;<a class="code" href="class_s_c_t_p.html#a5c27765c60c9634a47b00c4de6137809">sizeConnMap</a>&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;

        <a class="code" href="class_s_c_t_p.html#a84f317375ec11a83b15062a0d77694d3">printInfoConnMap</a>();
}
</pre></div>
</div>
</div>
<a class="anchor" id="a476b640dbefbde3ee8029eef4393800e"></a><!-- doxytag: member="SCTP::addLocalAddressToAllRemoteAddresses" ref="a476b640dbefbde3ee8029eef4393800e" args="(SCTPAssociation *conn, IPvXAddress address, std::vector&lt; IPvXAddress &gt; remAddresses)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SCTP::addLocalAddressToAllRemoteAddresses </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_s_c_t_p_association.html">SCTPAssociation</a> *&#160;</td>
          <td class="paramname"><em>conn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_i_pv_x_address.html">IPvXAddress</a>&#160;</td>
          <td class="paramname"><em>address</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="class_i_pv_x_address.html">IPvXAddress</a> &gt;&#160;</td>
          <td class="paramname"><em>remAddresses</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<div class="fragment"><pre class="fragment">{

        <span class="comment">//sctpEV3&lt;&lt;&quot;Add local address: &quot;&lt;&lt;address&lt;&lt;&quot;\n&quot;;</span>

        SockPair key;

        <span class="keywordflow">for</span> (AddressVector::iterator i=remAddresses.begin(); i!=remAddresses.end(); ++i)
        {
            <span class="comment">//sctpEV3&lt;&lt;&quot;remote address=&quot;&lt;&lt;(*i)&lt;&lt;&quot;\n&quot;;</span>
            key.localAddr = conn-&gt;<a class="code" href="class_s_c_t_p_association.html#a3e8d3c43ea031c35ab782b91f628563c">localAddr</a>;
            key.remoteAddr = (*i);
            key.localPort = conn-&gt;<a class="code" href="class_s_c_t_p_association.html#acb21c9ce886b796d5134b1c0daa3227b">localPort</a>;
            key.remotePort = conn-&gt;<a class="code" href="class_s_c_t_p_association.html#a62e2c58ac9cc4e804800c05bae9da71f">remotePort</a>;

            SctpConnMap::iterator j = <a class="code" href="class_s_c_t_p.html#aa7f1b6e9c58bb2e49f644cc4fad58af2">sctpConnMap</a>.find(key);
            <span class="keywordflow">if</span> (j!=<a class="code" href="class_s_c_t_p.html#aa7f1b6e9c58bb2e49f644cc4fad58af2">sctpConnMap</a>.end())
            {
            ASSERT(j-&gt;second==conn);
            <span class="keywordflow">if</span> (key.localAddr.isUnspecified())
                    {
                    <a class="code" href="class_s_c_t_p.html#aa7f1b6e9c58bb2e49f644cc4fad58af2">sctpConnMap</a>.erase(j);
                    <a class="code" href="class_s_c_t_p.html#a5c27765c60c9634a47b00c4de6137809">sizeConnMap</a>--;
                }

            }
            <span class="keywordflow">else</span>
                <a class="code" href="_s_c_t_p_8h.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a>&lt;&lt;<span class="stringliteral">&quot;no actual sockPair found\n&quot;</span>;
            key.localAddr = address;
            <a class="code" href="class_s_c_t_p.html#aa7f1b6e9c58bb2e49f644cc4fad58af2">sctpConnMap</a>[key] = conn;

            <a class="code" href="class_s_c_t_p.html#a5c27765c60c9634a47b00c4de6137809">sizeConnMap</a>++;
            <a class="code" href="_s_c_t_p_8h.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a>&lt;&lt;<span class="stringliteral">&quot;number of connections=&quot;</span>&lt;&lt;<a class="code" href="class_s_c_t_p.html#aa7f1b6e9c58bb2e49f644cc4fad58af2">sctpConnMap</a>.size()&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;

            <a class="code" href="class_s_c_t_p.html#a84f317375ec11a83b15062a0d77694d3">printInfoConnMap</a>();
        }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a34e3e284fe397118d5e69b56e497ed45"></a><!-- doxytag: member="SCTP::addRemoteAddress" ref="a34e3e284fe397118d5e69b56e497ed45" args="(SCTPAssociation *conn, IPvXAddress localAddress, IPvXAddress remoteAddress)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SCTP::addRemoteAddress </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_s_c_t_p_association.html">SCTPAssociation</a> *&#160;</td>
          <td class="paramname"><em>conn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_i_pv_x_address.html">IPvXAddress</a>&#160;</td>
          <td class="paramname"><em>localAddress</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_i_pv_x_address.html">IPvXAddress</a>&#160;</td>
          <td class="paramname"><em>remoteAddress</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="class_s_c_t_p_association.html#aa72dc267f9e5e18957f7e1c0d942195f">SCTPAssociation::processInitAckArrived()</a>, and <a class="el" href="class_s_c_t_p_association.html#add502b430991fe297800a08dd62c569d">SCTPAssociation::processInitArrived()</a>.</p>
<div class="fragment"><pre class="fragment">{

    <a class="code" href="_s_c_t_p_8h.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a>&lt;&lt;<span class="stringliteral">&quot;Add remote Address: &quot;</span>&lt;&lt;remoteAddress&lt;&lt;<span class="stringliteral">&quot; to local Address &quot;</span>&lt;&lt;localAddress&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;

    SockPair key;
    key.localAddr = localAddress;
    key.remoteAddr = remoteAddress;
    key.localPort = conn-&gt;<a class="code" href="class_s_c_t_p_association.html#acb21c9ce886b796d5134b1c0daa3227b">localPort</a>;
    key.remotePort = conn-&gt;<a class="code" href="class_s_c_t_p_association.html#a62e2c58ac9cc4e804800c05bae9da71f">remotePort</a>;

    SctpConnMap::iterator i = <a class="code" href="class_s_c_t_p.html#aa7f1b6e9c58bb2e49f644cc4fad58af2">sctpConnMap</a>.find(key);
    <span class="keywordflow">if</span> (i!=<a class="code" href="class_s_c_t_p.html#aa7f1b6e9c58bb2e49f644cc4fad58af2">sctpConnMap</a>.end())
    {
        ASSERT(i-&gt;second==conn);
    }
    <span class="keywordflow">else</span>
    {

        <span class="comment">//sctpEV3&lt;&lt;&quot;no actual sockPair found\n&quot;;</span>

        <a class="code" href="class_s_c_t_p.html#aa7f1b6e9c58bb2e49f644cc4fad58af2">sctpConnMap</a>[key] = conn;
        <a class="code" href="class_s_c_t_p.html#a5c27765c60c9634a47b00c4de6137809">sizeConnMap</a>++;
    }

    <span class="comment">//sctpEV3&lt;&lt;&quot;number of connections=&quot;&lt;&lt;sctpConnMap.size()&lt;&lt;&quot;\n&quot;;</span>
    <a class="code" href="class_s_c_t_p.html#a84f317375ec11a83b15062a0d77694d3">printInfoConnMap</a>();
}
</pre></div>
</div>
</div>
<a class="anchor" id="a7102d8279e65efb42c25c3e79bbaa492"></a><!-- doxytag: member="SCTP::bindPortForUDP" ref="a7102d8279e65efb42c25c3e79bbaa492" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SCTP::bindPortForUDP </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="class_s_c_t_p.html#a7c9cce2a01f191ddeb3c4ed21f413339">initialize()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="_i_n_e_t_defs_8h.html#a650ef3eff8a2900bef69dae29c05d2dd">EV</a> &lt;&lt; <span class="stringliteral">&quot;Binding to UDP port &quot;</span> &lt;&lt; 9899 &lt;&lt; endl;

    cMessage *msg = <span class="keyword">new</span> cMessage(<span class="stringliteral">&quot;UDP_C_BIND&quot;</span>, UDP_C_BIND);
    UDPControlInfo *ctrl = <span class="keyword">new</span> UDPControlInfo();
    ctrl-&gt;setSrcPort(9899);
    ctrl-&gt;setSockId(<a class="code" href="class_u_d_p_socket.html#a33867fc36dae0097215522ece28cd376">UDPSocket::generateSocketId</a>());
    msg-&gt;setControlInfo(ctrl);
    send(msg, <span class="stringliteral">&quot;to_ip&quot;</span>);
}
</pre></div>
</div>
</div>
<a class="anchor" id="aae97b24ba4ed4bb4950c3117f4c101d1"></a><!-- doxytag: member="SCTP::findAssocForApp" ref="aae97b24ba4ed4bb4950c3117f4c101d1" args="(int32 appGateIndex, int32 assocId)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_s_c_t_p_association.html">SCTPAssociation</a> * SCTP::findAssocForApp </td>
          <td>(</td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>appGateIndex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>assocId</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="class_s_c_t_p.html#a305de6ada20d2db21ddd19ad19cac3a1">handleMessage()</a>.</p>
<div class="fragment"><pre class="fragment">{
    AppConnKey key;
    key.appGateIndex = appGateIndex;
    key.assocId = assocId;
    <a class="code" href="_s_c_t_p_8h.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a>&lt;&lt;<span class="stringliteral">&quot;findAssoc for appGateIndex &quot;</span>&lt;&lt;appGateIndex&lt;&lt;<span class="stringliteral">&quot; and assoc &quot;</span>&lt;&lt;assocId&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;
    SctpAppConnMap::iterator i = <a class="code" href="class_s_c_t_p.html#a0bdbaac417e09631312a82718184fca5">sctpAppConnMap</a>.find(key);
    <span class="keywordflow">return</span> i==<a class="code" href="class_s_c_t_p.html#a0bdbaac417e09631312a82718184fca5">sctpAppConnMap</a>.end() ? NULL : i-&gt;second;
}
</pre></div>
</div>
</div>
<a class="anchor" id="ad481f51413de9f5cf1070ea507ffb345"></a><!-- doxytag: member="SCTP::findAssocForMessage" ref="ad481f51413de9f5cf1070ea507ffb345" args="(IPvXAddress srcAddr, IPvXAddress destAddr, uint32 srcPort, uint32 destPort, bool findListen)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_s_c_t_p_association.html">SCTPAssociation</a> * SCTP::findAssocForMessage </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_i_pv_x_address.html">IPvXAddress</a>&#160;</td>
          <td class="paramname"><em>srcAddr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_i_pv_x_address.html">IPvXAddress</a>&#160;</td>
          <td class="paramname"><em>destAddr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32&#160;</td>
          <td class="paramname"><em>srcPort</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32&#160;</td>
          <td class="paramname"><em>destPort</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>findListen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="class_s_c_t_p.html#a305de6ada20d2db21ddd19ad19cac3a1">handleMessage()</a>.</p>
<div class="fragment"><pre class="fragment">{
    SockPair key;

    key.localAddr = destAddr;
    key.remoteAddr = srcAddr;
    key.localPort = destPort;
    key.remotePort = srcPort;
    SockPair save = key;
    <a class="code" href="_s_c_t_p_8h.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a>&lt;&lt;<span class="stringliteral">&quot;findAssocForMessage: srcAddr=&quot;</span>&lt;&lt;destAddr&lt;&lt;<span class="stringliteral">&quot; destAddr=&quot;</span>&lt;&lt;srcAddr&lt;&lt;<span class="stringliteral">&quot; srcPort=&quot;</span>&lt;&lt;destPort&lt;&lt;<span class="stringliteral">&quot;  destPort=&quot;</span>&lt;&lt;srcPort&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;
    <a class="code" href="class_s_c_t_p.html#a84f317375ec11a83b15062a0d77694d3">printInfoConnMap</a>();

    <span class="comment">// try with fully qualified SockPair</span>
    SctpConnMap::iterator i;
    i = <a class="code" href="class_s_c_t_p.html#aa7f1b6e9c58bb2e49f644cc4fad58af2">sctpConnMap</a>.find(key);
    <span class="keywordflow">if</span> (i!=<a class="code" href="class_s_c_t_p.html#aa7f1b6e9c58bb2e49f644cc4fad58af2">sctpConnMap</a>.end())
        <span class="keywordflow">return</span> i-&gt;second;


    <span class="comment">// try with localAddr missing (only localPort specified in passive/active open)</span>
    key.localAddr.set(<span class="stringliteral">&quot;0.0.0.0&quot;</span>);

    i = <a class="code" href="class_s_c_t_p.html#aa7f1b6e9c58bb2e49f644cc4fad58af2">sctpConnMap</a>.find(key);
    <span class="keywordflow">if</span> (i!=<a class="code" href="class_s_c_t_p.html#aa7f1b6e9c58bb2e49f644cc4fad58af2">sctpConnMap</a>.end())
    {

        <span class="comment">//sctpEV3&lt;&lt;&quot;try with localAddr missing (only localPort specified in passive/active open)\n&quot;;</span>

        <span class="keywordflow">return</span> i-&gt;second;
    }

    <span class="keywordflow">if</span> (findListen==<span class="keyword">true</span>)
    {
        <span class="comment">/*key = save;</span>
<span class="comment">        key.localPort = 0;</span>
<span class="comment">        key.localAddr.set(&quot;0.0.0.0&quot;);</span>
<span class="comment">        i = sctpConnMap.find(key);</span>
<span class="comment">        if (i!=sctpConnMap.end())</span>
<span class="comment">        {</span>
<span class="comment">            return i-&gt;second;</span>
<span class="comment">        }*/</span>


        <span class="comment">// try fully qualified local socket + blank remote socket (for incoming SYN)</span>
        key = save;
        key.remoteAddr.set(<span class="stringliteral">&quot;0.0.0.0&quot;</span>);
        key.remotePort = 0;
        i = <a class="code" href="class_s_c_t_p.html#aa7f1b6e9c58bb2e49f644cc4fad58af2">sctpConnMap</a>.find(key);
        <span class="keywordflow">if</span> (i!=<a class="code" href="class_s_c_t_p.html#aa7f1b6e9c58bb2e49f644cc4fad58af2">sctpConnMap</a>.end())
        {

            <span class="comment">//sctpEV3&lt;&lt;&quot;try fully qualified local socket + blank remote socket \n&quot;;</span>

            <span class="keywordflow">return</span> i-&gt;second;
        }


        <span class="comment">// try with blank remote socket, and localAddr missing (for incoming SYN)</span>
        key.localAddr.set(<span class="stringliteral">&quot;0.0.0.0&quot;</span>);
        i = <a class="code" href="class_s_c_t_p.html#aa7f1b6e9c58bb2e49f644cc4fad58af2">sctpConnMap</a>.find(key);
        <span class="keywordflow">if</span> (i!=<a class="code" href="class_s_c_t_p.html#aa7f1b6e9c58bb2e49f644cc4fad58af2">sctpConnMap</a>.end())
        {

            <span class="comment">//sctpEV3&lt;&lt;&quot;try with blank remote socket, and localAddr missing \n&quot;;</span>

            <span class="keywordflow">return</span> i-&gt;second;
        }
    }
    <span class="comment">// given up</span>

    <a class="code" href="_s_c_t_p_8h.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a>&lt;&lt;<span class="stringliteral">&quot;giving up on trying to find assoc for localAddr=&quot;</span>&lt;&lt;srcAddr&lt;&lt;<span class="stringliteral">&quot; remoteAddr=&quot;</span>&lt;&lt;destAddr&lt;&lt;<span class="stringliteral">&quot; localPort=&quot;</span>&lt;&lt;srcPort&lt;&lt;<span class="stringliteral">&quot; remotePort=&quot;</span>&lt;&lt;destPort&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;
    <span class="keywordflow">return</span> NULL;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a09e0381fe0039c77faf2a2d17736201e"></a><!-- doxytag: member="SCTP::findAssocWithVTag" ref="a09e0381fe0039c77faf2a2d17736201e" args="(uint32 peerVTag, uint32 remotePort, uint32 localPort)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_s_c_t_p_association.html">SCTPAssociation</a> * SCTP::findAssocWithVTag </td>
          <td>(</td>
          <td class="paramtype">uint32&#160;</td>
          <td class="paramname"><em>peerVTag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32&#160;</td>
          <td class="paramname"><em>remotePort</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32&#160;</td>
          <td class="paramname"><em>localPort</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="class_s_c_t_p.html#a305de6ada20d2db21ddd19ad19cac3a1">handleMessage()</a>.</p>
<div class="fragment"><pre class="fragment">{

    <a class="code" href="class_s_c_t_p.html#afbb694a62bd6c7c911275ba3a6ce38db">printVTagMap</a>();
    <a class="code" href="_s_c_t_p_8h.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a>&lt;&lt;<span class="stringliteral">&quot;findAssocWithVTag: peerVTag=&quot;</span>&lt;&lt;peerVTag&lt;&lt;<span class="stringliteral">&quot; srcPort=&quot;</span>&lt;&lt;remotePort&lt;&lt;<span class="stringliteral">&quot;    destPort=&quot;</span>&lt;&lt;localPort&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;
    <a class="code" href="class_s_c_t_p.html#a84f317375ec11a83b15062a0d77694d3">printInfoConnMap</a>();

    <span class="comment">// try with fully qualified SockPair</span>
    <span class="keywordflow">for</span> (SctpVTagMap::iterator i=<a class="code" href="class_s_c_t_p.html#ad27c44853f019878d8c9be020c56f8d9">sctpVTagMap</a>.begin(); i!=<a class="code" href="class_s_c_t_p.html#ad27c44853f019878d8c9be020c56f8d9">sctpVTagMap</a>.end();i++)
    {
        <span class="keywordflow">if</span> ((i-&gt;second.peerVTag==peerVTag &amp;&amp; i-&gt;second.localPort==localPort
            &amp;&amp; i-&gt;second.remotePort==remotePort)
            || (i-&gt;second.localVTag==peerVTag &amp;&amp; i-&gt;second.localPort==localPort
            &amp;&amp; i-&gt;second.remotePort==remotePort))
            <span class="keywordflow">return</span> <a class="code" href="class_s_c_t_p.html#a399d0ce6826ad6cc3bd4656be35bc5e7">getAssoc</a>(i-&gt;first);
    }
    <span class="keywordflow">return</span> NULL;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a7547ab07373b78775ff3ec27eb704ae3"></a><!-- doxytag: member="SCTP::finish" ref="a7547ab07373b78775ff3ec27eb704ae3" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SCTP::finish </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<div class="fragment"><pre class="fragment">{
    SctpConnMap::iterator connMapIterator = <a class="code" href="class_s_c_t_p.html#aa7f1b6e9c58bb2e49f644cc4fad58af2">sctpConnMap</a>.begin();
    <span class="keywordflow">while</span> (connMapIterator != <a class="code" href="class_s_c_t_p.html#aa7f1b6e9c58bb2e49f644cc4fad58af2">sctpConnMap</a>.end()) {
        <a class="code" href="class_s_c_t_p.html#a4848bf1f15a9f7aac6e53cd1889f9345">removeAssociation</a>(connMapIterator-&gt;second);
        connMapIterator = <a class="code" href="class_s_c_t_p.html#aa7f1b6e9c58bb2e49f644cc4fad58af2">sctpConnMap</a>.begin();
    }
    ev &lt;&lt; getFullPath() &lt;&lt; <span class="stringliteral">&quot;: finishing SCTP with &quot;</span>
        &lt;&lt; <a class="code" href="class_s_c_t_p.html#aa7f1b6e9c58bb2e49f644cc4fad58af2">sctpConnMap</a>.size() &lt;&lt; <span class="stringliteral">&quot; connections open.&quot;</span> &lt;&lt; endl;

    <span class="keywordflow">for</span> (AssocStatMap::const_iterator iterator = <a class="code" href="class_s_c_t_p.html#a43c9f3107b99f1c969a4d5ca9c168bd3">assocStatMap</a>.begin();
          iterator != <a class="code" href="class_s_c_t_p.html#a43c9f3107b99f1c969a4d5ca9c168bd3">assocStatMap</a>.end(); iterator++) {
        <span class="keyword">const</span> <a class="code" href="struct_s_c_t_p_1_1_assoc_stat.html">SCTP::AssocStat</a>&amp; assoc = iterator-&gt;second;

        ev &lt;&lt; <span class="stringliteral">&quot;Association &quot;</span> &lt;&lt; assoc.<a class="code" href="struct_s_c_t_p_1_1_assoc_stat.html#af6d2b88d12009123a90976f56451a43f">assocId</a> &lt;&lt; <span class="stringliteral">&quot;: started at &quot;</span> &lt;&lt; assoc.<a class="code" href="struct_s_c_t_p_1_1_assoc_stat.html#adb6d3d3bab2e33cd79cf26363c7fe6fd">start</a>
            &lt;&lt; <span class="stringliteral">&quot; and finished at &quot;</span> &lt;&lt; assoc.<a class="code" href="struct_s_c_t_p_1_1_assoc_stat.html#a8350bc0756ad1c9d9c4b221e0f3cbde8">stop</a> &lt;&lt; <span class="stringliteral">&quot; --&gt; lifetime: &quot;</span> &lt;&lt; assoc.<a class="code" href="struct_s_c_t_p_1_1_assoc_stat.html#a5fb723fc12d2858561865a432267244c">lifeTime</a> &lt;&lt; endl;
        ev &lt;&lt; <span class="stringliteral">&quot;Association &quot;</span> &lt;&lt; assoc.<a class="code" href="struct_s_c_t_p_1_1_assoc_stat.html#af6d2b88d12009123a90976f56451a43f">assocId</a> &lt;&lt; <span class="stringliteral">&quot;: sent bytes=&quot;</span> &lt;&lt; assoc.<a class="code" href="struct_s_c_t_p_1_1_assoc_stat.html#ae2d4f4001028f1aa570bdb4c68818a8a">sentBytes</a>
            &lt;&lt; <span class="stringliteral">&quot;, acked bytes=&quot;</span> &lt;&lt; assoc.<a class="code" href="struct_s_c_t_p_1_1_assoc_stat.html#acc55fd8a06afd95c5fd58930e5537cf2">ackedBytes</a>&lt;&lt; <span class="stringliteral">&quot;, throughput=&quot;</span> &lt;&lt; assoc.<a class="code" href="struct_s_c_t_p_1_1_assoc_stat.html#aefab702936b7f133023cab351f1578ab">throughput</a>&lt;&lt; <span class="stringliteral">&quot; bit/s&quot;</span> &lt;&lt; endl;
        ev &lt;&lt; <span class="stringliteral">&quot;Association &quot;</span> &lt;&lt; assoc.<a class="code" href="struct_s_c_t_p_1_1_assoc_stat.html#af6d2b88d12009123a90976f56451a43f">assocId</a> &lt;&lt; <span class="stringliteral">&quot;: transmitted Bytes=&quot;</span>
            &lt;&lt; assoc.<a class="code" href="struct_s_c_t_p_1_1_assoc_stat.html#a456a49c0acd0315753b9900ab720f272">transmittedBytes</a>&lt;&lt; <span class="stringliteral">&quot;, retransmitted Bytes=&quot;</span> &lt;&lt; assoc.<a class="code" href="struct_s_c_t_p_1_1_assoc_stat.html#a456a49c0acd0315753b9900ab720f272">transmittedBytes</a>-assoc.<a class="code" href="struct_s_c_t_p_1_1_assoc_stat.html#acc55fd8a06afd95c5fd58930e5537cf2">ackedBytes</a>&lt;&lt; endl;
        ev &lt;&lt; <span class="stringliteral">&quot;Association &quot;</span> &lt;&lt; assoc.<a class="code" href="struct_s_c_t_p_1_1_assoc_stat.html#af6d2b88d12009123a90976f56451a43f">assocId</a> &lt;&lt; <span class="stringliteral">&quot;: number of Fast RTX=&quot;</span>
            &lt;&lt; assoc.<a class="code" href="struct_s_c_t_p_1_1_assoc_stat.html#a375a63659531c9124b90e7dfa527d34b">numFastRtx</a> &lt;&lt; <span class="stringliteral">&quot;, number of Timer-Based RTX=&quot;</span> &lt;&lt; assoc.<a class="code" href="struct_s_c_t_p_1_1_assoc_stat.html#a4106523ad51fd8ed0b51008b63333e0e">numT3Rtx</a>
            &lt;&lt; <span class="stringliteral">&quot;, path failures=&quot;</span> &lt;&lt; assoc.<a class="code" href="struct_s_c_t_p_1_1_assoc_stat.html#a9b881501500b50607d80c7e1420b70f4">numPathFailures</a>&lt;&lt; <span class="stringliteral">&quot;, ForwardTsns=&quot;</span> &lt;&lt; assoc.<a class="code" href="struct_s_c_t_p_1_1_assoc_stat.html#a347d3a84ee0bd7c151761d96140059dc">numForwardTsn</a>&lt;&lt; endl;
        ev &lt;&lt; <span class="stringliteral">&quot;AllMessages=&quot;</span> &lt;&lt;<a class="code" href="class_s_c_t_p.html#ab63c2cdb48459ff2da4de9dd8be20651">numPacketsReceived</a>&lt;&lt; <span class="stringliteral">&quot; BadMessages=&quot;</span> &lt;&lt;<a class="code" href="class_s_c_t_p.html#a08ec3d0f806364ad7d97ec0349b9d815">numPacketsDropped</a>&lt;&lt; endl;

        recordScalar(<span class="stringliteral">&quot;Association Lifetime&quot;</span>, assoc.<a class="code" href="struct_s_c_t_p_1_1_assoc_stat.html#a5fb723fc12d2858561865a432267244c">lifeTime</a>);
        recordScalar(<span class="stringliteral">&quot;Acked Bytes&quot;</span>,          assoc.<a class="code" href="struct_s_c_t_p_1_1_assoc_stat.html#acc55fd8a06afd95c5fd58930e5537cf2">ackedBytes</a>);
        recordScalar(<span class="stringliteral">&quot;Throughput [bit/s]&quot;</span>,   assoc.<a class="code" href="struct_s_c_t_p_1_1_assoc_stat.html#aefab702936b7f133023cab351f1578ab">throughput</a>);
        recordScalar(<span class="stringliteral">&quot;Transmitted Bytes&quot;</span>,    assoc.<a class="code" href="struct_s_c_t_p_1_1_assoc_stat.html#a456a49c0acd0315753b9900ab720f272">transmittedBytes</a>);
        recordScalar(<span class="stringliteral">&quot;Fast RTX&quot;</span>,                 assoc.<a class="code" href="struct_s_c_t_p_1_1_assoc_stat.html#a375a63659531c9124b90e7dfa527d34b">numFastRtx</a>);
        recordScalar(<span class="stringliteral">&quot;Timer-Based RTX&quot;</span>,      assoc.<a class="code" href="struct_s_c_t_p_1_1_assoc_stat.html#a4106523ad51fd8ed0b51008b63333e0e">numT3Rtx</a>);
        recordScalar(<span class="stringliteral">&quot;Duplicate Acks&quot;</span>,       assoc.<a class="code" href="struct_s_c_t_p_1_1_assoc_stat.html#a241f15afb831c0c4750e59ed00e8a794">numDups</a>);
        recordScalar(<span class="stringliteral">&quot;Packets Received&quot;</span>,         <a class="code" href="class_s_c_t_p.html#ab63c2cdb48459ff2da4de9dd8be20651">numPacketsReceived</a>);
        recordScalar(<span class="stringliteral">&quot;Packets Dropped&quot;</span>,      <a class="code" href="class_s_c_t_p.html#a08ec3d0f806364ad7d97ec0349b9d815">numPacketsDropped</a>);

    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a399d0ce6826ad6cc3bd4656be35bc5e7"></a><!-- doxytag: member="SCTP::getAssoc" ref="a399d0ce6826ad6cc3bd4656be35bc5e7" args="(int32 assocId)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_s_c_t_p_association.html">SCTPAssociation</a> * SCTP::getAssoc </td>
          <td>(</td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>assocId</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="class_s_c_t_p.html#a09e0381fe0039c77faf2a2d17736201e">findAssocWithVTag()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordflow">for</span> (SctpAppConnMap::iterator i = <a class="code" href="class_s_c_t_p.html#a0bdbaac417e09631312a82718184fca5">sctpAppConnMap</a>.begin(); i!=<a class="code" href="class_s_c_t_p.html#a0bdbaac417e09631312a82718184fca5">sctpAppConnMap</a>.end(); i++)
    {
        <span class="keywordflow">if</span> (i-&gt;first.assocId==assocId)
            <span class="keywordflow">return</span> i-&gt;second;
    }
    <span class="keywordflow">return</span> NULL;
}
</pre></div>
</div>
</div>
<a class="anchor" id="ac0d7608e4fb9d3d5cc41d98ac2cd66de"></a><!-- doxytag: member="SCTP::getAssocStat" ref="ac0d7608e4fb9d3d5cc41d98ac2cd66de" args="(uint32 assocId)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct_s_c_t_p_1_1_assoc_stat.html">AssocStat</a>* SCTP::getAssocStat </td>
          <td>(</td>
          <td class="paramtype">uint32&#160;</td>
          <td class="paramname"><em>assocId</em></td><td>)</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="class_s_c_t_p_association.html#a8bc32c70b39e641735ba4f73c00480ae">SCTPAssociation::dequeueAckedChunks()</a>, and <a class="el" href="class_s_c_t_p_association.html#a01a9c50a325baf1ebf3d25972a776393">SCTPAssociation::handleChunkReportedAsMissing()</a>.</p>
<div class="fragment"><pre class="fragment">                                                       {
            SCTP::AssocStatMap::iterator found = <a class="code" href="class_s_c_t_p.html#a43c9f3107b99f1c969a4d5ca9c168bd3">assocStatMap</a>.find(assocId);
            <span class="keywordflow">if</span>(found != <a class="code" href="class_s_c_t_p.html#a43c9f3107b99f1c969a4d5ca9c168bd3">assocStatMap</a>.end()) {
              <span class="keywordflow">return</span>(&amp;found-&gt;second);
            }
            <span class="keywordflow">return</span>(NULL);
        }
</pre></div>
</div>
</div>
<a class="anchor" id="acf8131c6cb5ae94bc2b49b3305b51304"></a><!-- doxytag: member="SCTP::getEphemeralPort" ref="acf8131c6cb5ae94bc2b49b3305b51304" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16 SCTP::getEphemeralPort </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>To be called from <a class="el" href="class_s_c_t_p_association.html">SCTPAssociation</a>: reserves an ephemeral port for the connection. </p>

<p>Referenced by <a class="el" href="class_s_c_t_p_association.html#adf53e2f26b7881391b481c3716783cc9">SCTPAssociation::process_ASSOCIATE()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordflow">if</span> (<a class="code" href="class_s_c_t_p.html#aaa0391c9c63435dee2ca1da5610bf697">nextEphemeralPort</a>==5000)
        error(<span class="stringliteral">&quot;Ephemeral port range 1024..4999 exhausted (email SCTP model &quot;</span>
                <span class="stringliteral">&quot;author that he should implement reuse of ephemeral ports!!!)&quot;</span>);
    <span class="keywordflow">return</span> <a class="code" href="class_s_c_t_p.html#aaa0391c9c63435dee2ca1da5610bf697">nextEphemeralPort</a>++;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a3eddd3a5ef9f40583d51b4eac4204f5f"></a><!-- doxytag: member="SCTP::getNewConnId" ref="a3eddd3a5ef9f40583d51b4eac4204f5f" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int32 SCTP::getNewConnId </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Generates a new integer, to be used as assocId. (assocId is part of the key which associates connections with their apps). </p>

<p>Referenced by <a class="el" href="class_s_c_t_p.html#a8e139c401cbd596810592e62be90a21e">addForkedAssociation()</a>, <a class="el" href="class_s_c_t_p_socket.html#aec3241da9f007e4a3d1211c314f7dcc5">SCTPSocket::connect()</a>, <a class="el" href="class_s_c_t_p_socket.html#aaf460eed5521fb6c1a587075bec6f6b4">SCTPSocket::listen()</a>, and <a class="el" href="class_s_c_t_p_socket.html#a1695937ed0ed6829c14c044e01399a8b">SCTPSocket::SCTPSocket()</a>.</p>
<div class="fragment"><pre class="fragment">{<span class="keywordflow">return</span> ++<a class="code" href="class_s_c_t_p.html#adcb74cef25ffed39e3825f2181f488f9">nextConnId</a>;}
</pre></div>
</div>
</div>
<a class="anchor" id="ab1523f02b1b32c1a42ca04a028948ad0"></a><!-- doxytag: member="SCTP::getVTagMap" ref="ab1523f02b1b32c1a42ca04a028948ad0" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_s_c_t_p.html#acdebc4566eea2a17e3a309be272423c6">SctpVTagMap</a> SCTP::getVTagMap </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<div class="fragment"><pre class="fragment">{<span class="keywordflow">return</span> <a class="code" href="class_s_c_t_p.html#ad27c44853f019878d8c9be020c56f8d9">sctpVTagMap</a>;};
</pre></div>
</div>
</div>
<a class="anchor" id="a305de6ada20d2db21ddd19ad19cac3a1"></a><!-- doxytag: member="SCTP::handleMessage" ref="a305de6ada20d2db21ddd19ad19cac3a1" args="(cMessage *msg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SCTP::handleMessage </td>
          <td>(</td>
          <td class="paramtype">cMessage *&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<div class="fragment"><pre class="fragment">{
    <a class="code" href="class_i_pv_x_address.html">IPvXAddress</a> destAddr;
    <a class="code" href="class_i_pv_x_address.html">IPvXAddress</a> srcAddr;
    <a class="code" href="class_i_p_control_info.html">IPControlInfo</a> *controlInfo =NULL;
    <a class="code" href="class_i_pv6_control_info.html">IPv6ControlInfo</a> *controlInfoV6 =NULL;
    <span class="keywordtype">bool</span> findListen = <span class="keyword">false</span>;
    <span class="keywordtype">bool</span> bitError = <span class="keyword">false</span>;

    <a class="code" href="_s_c_t_p_8h.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a>&lt;&lt;<span class="stringliteral">&quot;\n\nSCTPMain handleMessage at &quot;</span>&lt;&lt;getFullPath()&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;

    <span class="keywordflow">if</span> (msg-&gt;isSelfMessage())
    {

        <a class="code" href="_s_c_t_p_8h.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a>&lt;&lt;<span class="stringliteral">&quot;selfMessage\n&quot;</span>;

         <a class="code" href="class_s_c_t_p_association.html">SCTPAssociation</a> *assoc = (<a class="code" href="class_s_c_t_p_association.html">SCTPAssociation</a> *) msg-&gt;getContextPointer();
        <span class="keywordtype">bool</span> ret = assoc-&gt;<a class="code" href="class_s_c_t_p_association.html#a001fa353226a6d713050940b2aa8587d">processTimer</a>(msg);

        <span class="keywordflow">if</span> (!ret)
            <a class="code" href="class_s_c_t_p.html#a4848bf1f15a9f7aac6e53cd1889f9345">removeAssociation</a>(assoc);
    }
    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (msg-&gt;arrivedOn(<span class="stringliteral">&quot;from_ip&quot;</span>) || msg-&gt;arrivedOn(<span class="stringliteral">&quot;from_ipv6&quot;</span>))
    {
        <a class="code" href="_s_c_t_p_8h.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a>&lt;&lt;<span class="stringliteral">&quot;Message from IP\n&quot;</span>;
        <a class="code" href="class_s_c_t_p.html#a84f317375ec11a83b15062a0d77694d3">printInfoConnMap</a>();
        <span class="keywordflow">if</span> (!dynamic_cast&lt;SCTPMessage *&gt;(msg))
        {
            <a class="code" href="_s_c_t_p_8h.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a>&lt;&lt;<span class="stringliteral">&quot;no sctp message, delete it\n&quot;</span>;
            <span class="keyword">delete</span> msg;
            <span class="keywordflow">return</span>;
        }
        <a class="code" href="class_s_c_t_p_message.html">SCTPMessage</a> *sctpmsg = check_and_cast&lt;<a class="code" href="class_s_c_t_p_message.html">SCTPMessage</a> *&gt;(msg);

        <a class="code" href="class_s_c_t_p.html#ab63c2cdb48459ff2da4de9dd8be20651">numPacketsReceived</a>++;

        <span class="keywordflow">if</span> ((sctpmsg-&gt;hasBitError() || !(sctpmsg-&gt;getChecksumOk()))) {
            <a class="code" href="_s_c_t_p_8h.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a>&lt;&lt;<span class="stringliteral">&quot;Packet has bit-error. delete it\n&quot;</span>;

            bitError = <span class="keyword">true</span>;
            <a class="code" href="class_s_c_t_p.html#a08ec3d0f806364ad7d97ec0349b9d815">numPacketsDropped</a>++;
            <span class="keyword">delete</span> msg;
            <span class="keywordflow">return</span>;
        }
        <span class="keywordflow">if</span> (msg-&gt;arrivedOn(<span class="stringliteral">&quot;from_ip&quot;</span>))
        {
            <span class="keywordflow">if</span> (par(<span class="stringliteral">&quot;udpEncapsEnabled&quot;</span>))
            {
                std::cout&lt;&lt;<span class="stringliteral">&quot;Laenge SCTPMSG=&quot;</span>&lt;&lt;sctpmsg-&gt;getByteLength()&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;
                UDPControlInfo *ctrl = check_and_cast&lt;UDPControlInfo *&gt;(msg-&gt;removeControlInfo());
                srcAddr = ctrl-&gt;getSrcAddr();
                destAddr = ctrl-&gt;getDestAddr();
                std::cout&lt;&lt;<span class="stringliteral">&quot;controlInfo srcAddr=&quot;</span>&lt;&lt;srcAddr&lt;&lt;<span class="stringliteral">&quot;  destAddr=&quot;</span>&lt;&lt;destAddr&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;
                std::cout&lt;&lt;<span class="stringliteral">&quot;VTag=&quot;</span>&lt;&lt;sctpmsg-&gt;getTag()&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;
            }
            <span class="keywordflow">else</span>
            {
                controlInfo = check_and_cast&lt;<a class="code" href="class_i_p_control_info.html">IPControlInfo</a> *&gt;(msg-&gt;removeControlInfo());
                IPDatagram *datagram = controlInfo-&gt;<a class="code" href="class_i_p_control_info.html#a15838ba067f5c6ffd1e0a67114b4ddf2">removeOrigDatagram</a>();
                <span class="keyword">delete</span> datagram;
                <a class="code" href="_s_c_t_p_8h.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a>&lt;&lt;<span class="stringliteral">&quot;controlInfo srcAddr=&quot;</span>&lt;&lt;controlInfo-&gt;getSrcAddr()&lt;&lt;<span class="stringliteral">&quot;   destAddr=&quot;</span>&lt;&lt;controlInfo-&gt;getDestAddr()&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;
                srcAddr = controlInfo-&gt;getSrcAddr();
                destAddr = controlInfo-&gt;getDestAddr();
            }
        }
        <span class="keywordflow">else</span>
        {
            controlInfoV6 = check_and_cast&lt;<a class="code" href="class_i_pv6_control_info.html">IPv6ControlInfo</a> *&gt;(msg-&gt;removeControlInfo());
            srcAddr = controlInfoV6-&gt;getSrcAddr();
            destAddr = controlInfoV6-&gt;getDestAddr();
        }


        <a class="code" href="_s_c_t_p_8h.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a>&lt;&lt;<span class="stringliteral">&quot;srcAddr=&quot;</span>&lt;&lt;srcAddr&lt;&lt;<span class="stringliteral">&quot; destAddr=&quot;</span>&lt;&lt;destAddr&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;
        <span class="keywordflow">if</span> (sctpmsg-&gt;getBitLength()&gt;(<a class="code" href="_s_c_t_p_association_8h.html#a5cd94d6b80cfc4869b11f345c9de4d93">SCTP_COMMON_HEADER</a>*8))
        {
            <span class="keywordflow">if</span> (((SCTPChunk*)(sctpmsg-&gt;<a class="code" href="class_s_c_t_p_message.html#a3fee5bba66df88a7771c3b5984f33008">getChunks</a>(0)))-&gt;getChunkType()==<a class="code" href="_s_c_t_p_association_8h.html#a8886377ab3f4b4ef217558f2b83b7b12a0cb1b2c6a7db1f1084886c98909a3f36">INIT</a> || ((SCTPChunk*)(sctpmsg-&gt;<a class="code" href="class_s_c_t_p_message.html#a3fee5bba66df88a7771c3b5984f33008">getChunks</a>(0)))-&gt;getChunkType()==<a class="code" href="_s_c_t_p_association_8h.html#a8886377ab3f4b4ef217558f2b83b7b12abb473557985d30fdf16d2525388e3a22">INIT_ACK</a> )
                findListen = <span class="keyword">true</span>;

            <a class="code" href="class_s_c_t_p_association.html">SCTPAssociation</a> *assoc = <a class="code" href="class_s_c_t_p.html#ad481f51413de9f5cf1070ea507ffb345">findAssocForMessage</a>(srcAddr, destAddr, sctpmsg-&gt;getSrcPort(),sctpmsg-&gt;getDestPort(), findListen);
            <span class="keywordflow">if</span> (!assoc &amp;&amp; <a class="code" href="class_s_c_t_p.html#aa7f1b6e9c58bb2e49f644cc4fad58af2">sctpConnMap</a>.size()&gt;0)
                assoc = <a class="code" href="class_s_c_t_p.html#a09e0381fe0039c77faf2a2d17736201e">findAssocWithVTag</a>(sctpmsg-&gt;getTag(),sctpmsg-&gt;getSrcPort(), sctpmsg-&gt;getDestPort());
            <span class="keywordflow">if</span> (!assoc)
            {
                <a class="code" href="_s_c_t_p_8h.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a>&lt;&lt;<span class="stringliteral">&quot;no assoc found msg=&quot;</span>&lt;&lt;sctpmsg-&gt;getName()&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;
                <span class="keywordflow">if</span> (bitError)
                {
                    <span class="keyword">delete</span> sctpmsg;
                    <span class="keywordflow">return</span>;
                }
                <span class="keywordflow">if</span> (((SCTPChunk*)(sctpmsg-&gt;<a class="code" href="class_s_c_t_p_message.html#a3fee5bba66df88a7771c3b5984f33008">getChunks</a>(0)))-&gt;getChunkType()==<a class="code" href="_s_c_t_p_association_8h.html#a8886377ab3f4b4ef217558f2b83b7b12a7f11b152058ba8f4656266d735a50c4b">SHUTDOWN_ACK</a>)
                    <a class="code" href="class_s_c_t_p.html#aa184b3126dcf702901f1c1f0bc3529f4">sendShutdownCompleteFromMain</a>(sctpmsg, destAddr, srcAddr);
                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (((SCTPChunk*)(sctpmsg-&gt;<a class="code" href="class_s_c_t_p_message.html#a3fee5bba66df88a7771c3b5984f33008">getChunks</a>(0)))-&gt;getChunkType()!=<a class="code" href="_s_c_t_p_association_8h.html#a8886377ab3f4b4ef217558f2b83b7b12a781ad2788df9e25c59a70894c7832096">ABORT</a>  &amp;&amp;
                    ((SCTPChunk*)(sctpmsg-&gt;<a class="code" href="class_s_c_t_p_message.html#a3fee5bba66df88a7771c3b5984f33008">getChunks</a>(0)))-&gt;getChunkType()!=<a class="code" href="_s_c_t_p_association_8h.html#a8886377ab3f4b4ef217558f2b83b7b12a1ac9ae29771c5095efe16ce822d561d7">SHUTDOWN_COMPLETE</a>)
                {
                    <a class="code" href="class_s_c_t_p.html#a8a189047a5fbd254dcd9d9283ba08836">sendAbortFromMain</a>(sctpmsg, destAddr, srcAddr);
                }
                <span class="keyword">delete</span> sctpmsg;
            }
            <span class="keywordflow">else</span>
            {
                <span class="keywordtype">bool</span> ret = assoc-&gt;<a class="code" href="class_s_c_t_p_association.html#a1460f83f7b50fee1f47fe7b4bf6744be">processSCTPMessage</a>(sctpmsg, srcAddr, destAddr);
                <span class="keywordflow">if</span> (!ret)
                {
                    <a class="code" href="_s_c_t_p_8h.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a>&lt;&lt;<span class="stringliteral">&quot;SCTPMain:: removeAssociation \n&quot;</span>;
                    <a class="code" href="class_s_c_t_p.html#a4848bf1f15a9f7aac6e53cd1889f9345">removeAssociation</a>(assoc);
                    <span class="keyword">delete</span> sctpmsg;
                }
                <span class="keywordflow">else</span>
                {
                    <span class="keyword">delete</span> sctpmsg;
                }
            }
        }
        <span class="keywordflow">else</span>
        {
            <span class="keyword">delete</span> sctpmsg;
        }
    }
    <span class="keywordflow">else</span> <span class="comment">// must be from app</span>
    {
        <a class="code" href="_s_c_t_p_8h.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a>&lt;&lt;<span class="stringliteral">&quot;must be from app\n&quot;</span>;
        SCTPCommand *controlInfo = check_and_cast&lt;SCTPCommand *&gt;(msg-&gt;getControlInfo());

        int32 appGateIndex;
        <span class="keywordflow">if</span> (controlInfo-&gt;getGate()!=-1)
            appGateIndex = controlInfo-&gt;getGate();
        <span class="keywordflow">else</span>
            appGateIndex = msg-&gt;getArrivalGate()-&gt;getIndex();
        int32 assocId = controlInfo-&gt;getAssocId();
        <a class="code" href="_s_c_t_p_8h.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a>&lt;&lt;<span class="stringliteral">&quot;msg arrived from app for assoc &quot;</span>&lt;&lt;assocId&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;
        <a class="code" href="class_s_c_t_p_association.html">SCTPAssociation</a> *assoc = <a class="code" href="class_s_c_t_p.html#aae97b24ba4ed4bb4950c3117f4c101d1">findAssocForApp</a>(appGateIndex, assocId);

        <span class="keywordflow">if</span> (!assoc)
        {
            <a class="code" href="_s_c_t_p_8h.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a> &lt;&lt; <span class="stringliteral">&quot;no assoc found. msg=&quot;</span>&lt;&lt;msg-&gt;getName()&lt;&lt;<span class="stringliteral">&quot; number of assocs = &quot;</span>&lt;&lt;<a class="code" href="class_s_c_t_p.html#affa2f26db6bbbf00938fa27e35b8f567">assocList</a>.size()&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;

            <span class="keywordflow">if</span> (strcmp(msg-&gt;getName(),<span class="stringliteral">&quot;PassiveOPEN&quot;</span>)==0 || strcmp(msg-&gt;getName(),<span class="stringliteral">&quot;Associate&quot;</span>)==0)
            {
                <span class="keywordflow">if</span> (<a class="code" href="class_s_c_t_p.html#affa2f26db6bbbf00938fa27e35b8f567">assocList</a>.size()&gt;0)
                {
                    assoc = NULL;
                    SCTPOpenCommand* open = check_and_cast&lt;SCTPOpenCommand*&gt;(controlInfo);
                    <a class="code" href="_s_c_t_p_8h.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a>&lt;&lt;<span class="stringliteral">&quot;Looking for assoc with remoteAddr=&quot;</span>&lt;&lt;open-&gt;getRemoteAddr()&lt;&lt;<span class="stringliteral">&quot;, remotePort=&quot;</span>&lt;&lt;open-&gt;getRemotePort()&lt;&lt;<span class="stringliteral">&quot;, localPort=&quot;</span>&lt;&lt;open-&gt;getLocalPort()&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;
                    <span class="keywordflow">for</span> (std::list&lt;SCTPAssociation*&gt;::iterator iter=<a class="code" href="class_s_c_t_p.html#affa2f26db6bbbf00938fa27e35b8f567">assocList</a>.begin(); iter!=<a class="code" href="class_s_c_t_p.html#affa2f26db6bbbf00938fa27e35b8f567">assocList</a>.end(); iter++)
                    {
                        <a class="code" href="_s_c_t_p_8h.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a>&lt;&lt;<span class="stringliteral">&quot;remoteAddr=&quot;</span>&lt;&lt;(*iter)-&gt;remoteAddr&lt;&lt;<span class="stringliteral">&quot;, remotePort=&quot;</span>&lt;&lt;(*iter)-&gt;remotePort&lt;&lt;<span class="stringliteral">&quot;, localPort=&quot;</span>&lt;&lt;(*iter)-&gt;localPort&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;
                        <span class="keywordflow">if</span> ((*iter)-&gt;remoteAddr == open-&gt;getRemoteAddr() &amp;&amp; (*iter)-&gt;localPort==open-&gt;getLocalPort() &amp;&amp; (*iter)-&gt;remotePort==open-&gt;getRemotePort())
                        {
                            assoc = (*iter);
                            <span class="keywordflow">break</span>;
                        }
                    }
                }
                <span class="keywordflow">if</span> (assoc==NULL)
                {
                    assoc = <span class="keyword">new</span> <a class="code" href="class_s_c_t_p_association.html">SCTPAssociation</a>(<span class="keyword">this</span>,appGateIndex,assocId);

                    AppConnKey key;
                    key.appGateIndex = appGateIndex;
                    key.assocId = assocId;
                    <a class="code" href="class_s_c_t_p.html#a0bdbaac417e09631312a82718184fca5">sctpAppConnMap</a>[key] = assoc;
                    <a class="code" href="_s_c_t_p_8h.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a> &lt;&lt; <span class="stringliteral">&quot;SCTP association created for appGateIndex &quot;</span> &lt;&lt; appGateIndex &lt;&lt; <span class="stringliteral">&quot; and assoc &quot;</span>&lt;&lt;assocId&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;
                    <span class="keywordtype">bool</span> ret = assoc-&gt;<a class="code" href="class_s_c_t_p_association.html#ad14a311c7f07f7377a1a3422d0e6fc6c">processAppCommand</a>(<a class="code" href="_i_n_e_t_defs_8h.html#ae5b816f7de3c5248c812bdb6920f4e06">PK</a>(msg));
                    <span class="keywordflow">if</span> (!ret)
                    {
                        <a class="code" href="class_s_c_t_p.html#a4848bf1f15a9f7aac6e53cd1889f9345">removeAssociation</a>(assoc);
                    }
                }
            }
        }
        <span class="keywordflow">else</span>
        {
            <a class="code" href="_s_c_t_p_8h.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a>&lt;&lt;<span class="stringliteral">&quot;assoc found\n&quot;</span>;
            <span class="keywordtype">bool</span> ret = assoc-&gt;<a class="code" href="class_s_c_t_p_association.html#ad14a311c7f07f7377a1a3422d0e6fc6c">processAppCommand</a>(<a class="code" href="_i_n_e_t_defs_8h.html#ae5b816f7de3c5248c812bdb6920f4e06">PK</a>(msg));

            <span class="keywordflow">if</span> (!ret)
                <a class="code" href="class_s_c_t_p.html#a4848bf1f15a9f7aac6e53cd1889f9345">removeAssociation</a>(assoc);
        }
        <span class="keyword">delete</span> msg;
    }
    <span class="keywordflow">if</span> (ev.isGUI())
        <a class="code" href="class_s_c_t_p.html#a47a90c0d2a89f45862e0a21004c11bdb">updateDisplayString</a>();
}
</pre></div>
</div>
</div>
<a class="anchor" id="a7c9cce2a01f191ddeb3c4ed21f413339"></a><!-- doxytag: member="SCTP::initialize" ref="a7c9cce2a01f191ddeb3c4ed21f413339" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SCTP::initialize </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<div class="fragment"><pre class="fragment">{
    <a class="code" href="class_s_c_t_p.html#aaa0391c9c63435dee2ca1da5610bf697">nextEphemeralPort</a> = (uint16)(intrand(10000) + 30000);

    <span class="comment">//sctpEV3&lt;&lt;&quot;SCTPMain initialize\n&quot;;</span>

    cModule *netw = simulation.getSystemModule();

    <a class="code" href="class_s_c_t_p.html#a0c82ce1676bd810f2defcce17bd1bd0a">testing</a> = netw-&gt;hasPar(<span class="stringliteral">&quot;testing&quot;</span>) &amp;&amp; netw-&gt;par(<span class="stringliteral">&quot;testing&quot;</span>).boolValue();
    <span class="keywordflow">if</span>(<a class="code" href="class_s_c_t_p.html#a0c82ce1676bd810f2defcce17bd1bd0a">testing</a>) {
    }
    <span class="keywordflow">if</span> (netw-&gt;hasPar(<span class="stringliteral">&quot;testTimeout&quot;</span>))
    {
        <a class="code" href="class_s_c_t_p.html#a35089977465533256142ee442021b18d">testTimeout</a> = (simtime_t)netw-&gt;par(<span class="stringliteral">&quot;testTimeout&quot;</span>);
    }
    <a class="code" href="class_s_c_t_p.html#ab63c2cdb48459ff2da4de9dd8be20651">numPacketsReceived</a> = 0;
    <a class="code" href="class_s_c_t_p.html#a08ec3d0f806364ad7d97ec0349b9d815">numPacketsDropped</a>    = 0;
    <a class="code" href="class_s_c_t_p.html#a5c27765c60c9634a47b00c4de6137809">sizeConnMap</a>          = 0;
    <span class="keywordflow">if</span> ((<span class="keywordtype">bool</span>)par(<span class="stringliteral">&quot;udpEncapsEnabled&quot;</span>))
        <a class="code" href="class_s_c_t_p.html#a7102d8279e65efb42c25c3e79bbaa492">bindPortForUDP</a>();
}
</pre></div>
</div>
</div>
<a class="anchor" id="a84f317375ec11a83b15062a0d77694d3"></a><!-- doxytag: member="SCTP::printInfoConnMap" ref="a84f317375ec11a83b15062a0d77694d3" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SCTP::printInfoConnMap </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="class_s_c_t_p.html#a8e139c401cbd596810592e62be90a21e">addForkedAssociation()</a>, <a class="el" href="class_s_c_t_p.html#aeb3f468f36416f953ab7e647540f75e4">addLocalAddress()</a>, <a class="el" href="class_s_c_t_p.html#a476b640dbefbde3ee8029eef4393800e">addLocalAddressToAllRemoteAddresses()</a>, <a class="el" href="class_s_c_t_p.html#a34e3e284fe397118d5e69b56e497ed45">addRemoteAddress()</a>, <a class="el" href="class_s_c_t_p_association.html#ae6315c7df4b1537e0b8374583492a0be">SCTPAssociation::cloneAssociation()</a>, <a class="el" href="class_s_c_t_p.html#ad481f51413de9f5cf1070ea507ffb345">findAssocForMessage()</a>, <a class="el" href="class_s_c_t_p.html#a09e0381fe0039c77faf2a2d17736201e">findAssocWithVTag()</a>, <a class="el" href="class_s_c_t_p.html#a305de6ada20d2db21ddd19ad19cac3a1">handleMessage()</a>, <a class="el" href="class_s_c_t_p.html#a4848bf1f15a9f7aac6e53cd1889f9345">removeAssociation()</a>, <a class="el" href="class_s_c_t_p.html#abd09eaf1572e207a25aff6988091ca0f">removeLocalAddressFromAllRemoteAddresses()</a>, <a class="el" href="class_s_c_t_p.html#a2d162fde6e9246ce9db340f1824187a1">removeRemoteAddressFromAllConnections()</a>, <a class="el" href="class_s_c_t_p_association.html#afc1d3dc0cb62842b7d83998facfbfd06">SCTPAssociation::sendInit()</a>, and <a class="el" href="class_s_c_t_p.html#a2ee4aaa2e36516a679b8c4a0748ecd9a">updateSockPair()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="class_s_c_t_p_association.html">SCTPAssociation</a>* assoc;
    SockPair      key;
    <a class="code" href="_s_c_t_p_8h.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a>&lt;&lt;<span class="stringliteral">&quot;Number of Assocs: &quot;</span>&lt;&lt;<a class="code" href="class_s_c_t_p.html#a5c27765c60c9634a47b00c4de6137809">sizeConnMap</a>&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;
    <span class="keywordflow">if</span> (sizeConnMap&gt;0)
    {
        <span class="keywordflow">for</span> (SctpConnMap::iterator i = <a class="code" href="class_s_c_t_p.html#aa7f1b6e9c58bb2e49f644cc4fad58af2">sctpConnMap</a>.begin(); i!=<a class="code" href="class_s_c_t_p.html#aa7f1b6e9c58bb2e49f644cc4fad58af2">sctpConnMap</a>.end(); ++i)
        {
            assoc = i-&gt;second;
            key = i-&gt;first;

                <a class="code" href="_s_c_t_p_8h.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a>&lt;&lt;<span class="stringliteral">&quot;assocId: &quot;</span>&lt;&lt;assoc-&gt;<a class="code" href="class_s_c_t_p_association.html#a135afa4887cc640b0e8410dc95a29972">assocId</a>&lt;&lt;<span class="stringliteral">&quot;  assoc: &quot;</span>&lt;&lt;assoc&lt;&lt;<span class="stringliteral">&quot; src: &quot;</span>&lt;&lt;<a class="code" href="class_i_pv_x_address.html">IPvXAddress</a>(key.localAddr)&lt;&lt;<span class="stringliteral">&quot; dst: &quot;</span>&lt;&lt;<a class="code" href="class_i_pv_x_address.html">IPvXAddress</a>(key.remoteAddr)&lt;&lt;<span class="stringliteral">&quot; lPort: &quot;</span>&lt;&lt;key.localPort&lt;&lt;<span class="stringliteral">&quot; rPort: &quot;</span>&lt;&lt;key.remotePort&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;

        }

        <a class="code" href="_s_c_t_p_8h.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a>&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;
    }

}
</pre></div>
</div>
</div>
<a class="anchor" id="afbb694a62bd6c7c911275ba3a6ce38db"></a><!-- doxytag: member="SCTP::printVTagMap" ref="afbb694a62bd6c7c911275ba3a6ce38db" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SCTP::printVTagMap </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="class_s_c_t_p.html#a09e0381fe0039c77faf2a2d17736201e">findAssocWithVTag()</a>.</p>
<div class="fragment"><pre class="fragment">{
    int32 assocId;
    VTagPair      key;
    <a class="code" href="_s_c_t_p_8h.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a>&lt;&lt;<span class="stringliteral">&quot;Number of Assocs: &quot;</span>&lt;&lt;<a class="code" href="class_s_c_t_p.html#ad27c44853f019878d8c9be020c56f8d9">sctpVTagMap</a>.size()&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;
    <span class="keywordflow">if</span> (<a class="code" href="class_s_c_t_p.html#ad27c44853f019878d8c9be020c56f8d9">sctpVTagMap</a>.size()&gt;0)
    {
        <span class="keywordflow">for</span> (SctpVTagMap::iterator i = <a class="code" href="class_s_c_t_p.html#ad27c44853f019878d8c9be020c56f8d9">sctpVTagMap</a>.begin(); i!=<a class="code" href="class_s_c_t_p.html#ad27c44853f019878d8c9be020c56f8d9">sctpVTagMap</a>.end(); ++i)
        {
            assocId = i-&gt;first;
            key = i-&gt;second;

                <a class="code" href="_s_c_t_p_8h.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a>&lt;&lt;<span class="stringliteral">&quot;assocId: &quot;</span>&lt;&lt;assocId&lt;&lt;<span class="stringliteral">&quot; peerVTag: &quot;</span>&lt;&lt;key.peerVTag&lt;&lt;
                <span class="stringliteral">&quot; localVTag: &quot;</span>&lt;&lt;key.localVTag&lt;&lt;
                <span class="stringliteral">&quot; localPort: &quot;</span>&lt;&lt;key.localPort&lt;&lt;<span class="stringliteral">&quot; rPort: &quot;</span>&lt;&lt;key.remotePort&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;
        }

        <a class="code" href="_s_c_t_p_8h.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a>&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a4848bf1f15a9f7aac6e53cd1889f9345"></a><!-- doxytag: member="SCTP::removeAssociation" ref="a4848bf1f15a9f7aac6e53cd1889f9345" args="(SCTPAssociation *assoc)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SCTP::removeAssociation </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_s_c_t_p_association.html">SCTPAssociation</a> *&#160;</td>
          <td class="paramname"><em>assoc</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="class_s_c_t_p.html#a7547ab07373b78775ff3ec27eb704ae3">finish()</a>, <a class="el" href="class_s_c_t_p.html#a305de6ada20d2db21ddd19ad19cac3a1">handleMessage()</a>, <a class="el" href="class_s_c_t_p_association.html#a042415b8feb32a392938f9a844bc4aca">SCTPAssociation::process_RCV_Message()</a>, <a class="el" href="class_s_c_t_p_association.html#acb89ca4bcc84239541171327977762e9">SCTPAssociation::process_TIMEOUT_HEARTBEAT()</a>, <a class="el" href="class_s_c_t_p_association.html#ae94a9d41597adc5806db8c60f27ab45d">SCTPAssociation::process_TIMEOUT_INIT_REXMIT()</a>, <a class="el" href="class_s_c_t_p_association.html#ab0e373e70c4541d7f64666e98e99e7d3">SCTPAssociation::process_TIMEOUT_RTX()</a>, <a class="el" href="class_s_c_t_p_association.html#a6866e326d923a8915cdbb3d80802c527">SCTPAssociation::process_TIMEOUT_SHUTDOWN()</a>, <a class="el" href="class_s_c_t_p_association.html#a001fa353226a6d713050940b2aa8587d">SCTPAssociation::processTimer()</a>, and <a class="el" href="class_s_c_t_p_association.html#a3cb6d23f3c34f789d2b1c5945d0d0a76">SCTPAssociation::updateCounters()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordtype">bool</span>            ok    = <span class="keyword">false</span>;
    <span class="keywordtype">bool</span>            <a class="code" href="_utils_8cc.html#a33bdc8b2583dcc9d2a8bfe1ec578352d">find</a> = <span class="keyword">false</span>;
    <span class="keyword">const</span> int32 <span class="keywordtype">id</span>    = conn-&gt;assocId;

    <a class="code" href="_s_c_t_p_8h.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a> &lt;&lt; <span class="stringliteral">&quot;Deleting SCTP connection &quot;</span> &lt;&lt; conn &lt;&lt; <span class="stringliteral">&quot; id= &quot;</span>&lt;&lt; <span class="keywordtype">id</span> &lt;&lt; endl;

    <a class="code" href="class_s_c_t_p.html#a84f317375ec11a83b15062a0d77694d3">printInfoConnMap</a>();
    <span class="keywordflow">if</span> (<a class="code" href="class_s_c_t_p.html#a5c27765c60c9634a47b00c4de6137809">sizeConnMap</a> &gt; 0) {
        AssocStatMap::iterator assocStatMapIterator = <a class="code" href="class_s_c_t_p.html#a43c9f3107b99f1c969a4d5ca9c168bd3">assocStatMap</a>.find(conn-&gt;assocId);
        <span class="keywordflow">if</span> (assocStatMapIterator != <a class="code" href="class_s_c_t_p.html#a43c9f3107b99f1c969a4d5ca9c168bd3">assocStatMap</a>.end()) {
            assocStatMapIterator-&gt;second.stop        = simulation.getSimTime();
            assocStatMapIterator-&gt;second.lifeTime    = assocStatMapIterator-&gt;second.stop - assocStatMapIterator-&gt;second.start;
            assocStatMapIterator-&gt;second.throughput = assocStatMapIterator-&gt;second.ackedBytes*8 / assocStatMapIterator-&gt;second.lifeTime.dbl();
        }
        <span class="keywordflow">while</span> (!ok) {
            <span class="keywordflow">if</span> (<a class="code" href="class_s_c_t_p.html#a5c27765c60c9634a47b00c4de6137809">sizeConnMap</a> == 0) {
                ok = <span class="keyword">true</span>;
            }
            <span class="keywordflow">else</span> {
                <span class="keywordflow">for</span> (SctpConnMap::iterator sctpConnMapIterator = <a class="code" href="class_s_c_t_p.html#aa7f1b6e9c58bb2e49f644cc4fad58af2">sctpConnMap</a>.begin();
                      sctpConnMapIterator != <a class="code" href="class_s_c_t_p.html#aa7f1b6e9c58bb2e49f644cc4fad58af2">sctpConnMap</a>.end(); sctpConnMapIterator++) {
                    <span class="keywordflow">if</span> (sctpConnMapIterator-&gt;second != NULL) {
                        <a class="code" href="class_s_c_t_p_association.html">SCTPAssociation</a>* assoc = sctpConnMapIterator-&gt;second;
                        <span class="keywordflow">if</span> (assoc-&gt;<a class="code" href="class_s_c_t_p_association.html#a135afa4887cc640b0e8410dc95a29972">assocId</a> == conn-&gt;assocId) {
                            <span class="keywordflow">if</span> (assoc-&gt;<a class="code" href="class_s_c_t_p_association.html#ae8e6881f56bba3560101d1c898bf4ad3">T1_InitTimer</a>) {
                                assoc-&gt;<a class="code" href="class_s_c_t_p_association.html#a5929aa6d346d39510a8826dfce06169a">stopTimer</a>(assoc-&gt;<a class="code" href="class_s_c_t_p_association.html#ae8e6881f56bba3560101d1c898bf4ad3">T1_InitTimer</a>);
                            }
                            <span class="keywordflow">if</span> (assoc-&gt;<a class="code" href="class_s_c_t_p_association.html#ab57c64d047b0645a215f7e0bc2d903fb">T2_ShutdownTimer</a>) {
                                assoc-&gt;<a class="code" href="class_s_c_t_p_association.html#a5929aa6d346d39510a8826dfce06169a">stopTimer</a>(assoc-&gt;<a class="code" href="class_s_c_t_p_association.html#ab57c64d047b0645a215f7e0bc2d903fb">T2_ShutdownTimer</a>);
                            }
                            <span class="keywordflow">if</span> (assoc-&gt;<a class="code" href="class_s_c_t_p_association.html#ac418d05be502a677a2f22b375f7e7a7b">T5_ShutdownGuardTimer</a>) {
                                assoc-&gt;<a class="code" href="class_s_c_t_p_association.html#a5929aa6d346d39510a8826dfce06169a">stopTimer</a>(assoc-&gt;<a class="code" href="class_s_c_t_p_association.html#ac418d05be502a677a2f22b375f7e7a7b">T5_ShutdownGuardTimer</a>);
                            }
                            <span class="keywordflow">if</span> (assoc-&gt;<a class="code" href="class_s_c_t_p_association.html#a1fae2ceab572718540c51768e3c1c452">SackTimer</a>) {
                                assoc-&gt;<a class="code" href="class_s_c_t_p_association.html#a5929aa6d346d39510a8826dfce06169a">stopTimer</a>(assoc-&gt;<a class="code" href="class_s_c_t_p_association.html#a1fae2ceab572718540c51768e3c1c452">SackTimer</a>);
                            }
                            <a class="code" href="class_s_c_t_p.html#aa7f1b6e9c58bb2e49f644cc4fad58af2">sctpConnMap</a>.erase(sctpConnMapIterator);
                            <a class="code" href="class_s_c_t_p.html#a5c27765c60c9634a47b00c4de6137809">sizeConnMap</a>--;
                            find = <span class="keyword">true</span>;
                            <span class="keywordflow">break</span>;
                        }
                    }
                }
            }

            <span class="keywordflow">if</span> (!find) {
                ok = <span class="keyword">true</span>;
            }
            <span class="keywordflow">else</span> {
                find = <span class="keyword">false</span>;
            }
        }
    }

    <span class="comment">// T.D. 26.11.09: Write statistics</span>
    <span class="keywordtype">char</span> str[128];
    <span class="keywordflow">for</span> (SCTPAssociation::SCTPPathMap::iterator pathMapIterator = conn-&gt;sctpPathMap.begin();
          pathMapIterator != conn-&gt;sctpPathMap.end(); pathMapIterator++) {
        <span class="keyword">const</span> <a class="code" href="class_s_c_t_p_path_variables.html">SCTPPathVariables</a>* path = pathMapIterator-&gt;second;
        snprintf((<span class="keywordtype">char</span>*)&amp;str, <span class="keyword">sizeof</span>(str), <span class="stringliteral">&quot;Number of Fast Retransmissions %d:%s&quot;</span>,
                 conn-&gt;assocId, path-&gt;<a class="code" href="class_s_c_t_p_path_variables.html#aa633bf8cbecd1b7152d64e56365dcd1a">remoteAddress</a>.<a class="code" href="class_i_pv_x_address.html#a27e3ec9ec324d86c1874a03db4788a92">str</a>().c_str());
        recordScalar(str, path-&gt;<a class="code" href="class_s_c_t_p_path_variables.html#ae6fd6147ac0475508eb44ae76c518cda">numberOfFastRetransmissions</a>);
        snprintf((<span class="keywordtype">char</span>*)&amp;str, <span class="keyword">sizeof</span>(str), <span class="stringliteral">&quot;Number of Timer-Based Retransmissions %d:%s&quot;</span>,
                 conn-&gt;assocId, path-&gt;<a class="code" href="class_s_c_t_p_path_variables.html#aa633bf8cbecd1b7152d64e56365dcd1a">remoteAddress</a>.<a class="code" href="class_i_pv_x_address.html#a27e3ec9ec324d86c1874a03db4788a92">str</a>().c_str());
        recordScalar(str, path-&gt;<a class="code" href="class_s_c_t_p_path_variables.html#a2b7ee405351a9463919c483bce4539b5">numberOfTimerBasedRetransmissions</a>);
        snprintf((<span class="keywordtype">char</span>*)&amp;str, <span class="keyword">sizeof</span>(str), <span class="stringliteral">&quot;Number of Heartbeats Sent %d:%s&quot;</span>,
                 conn-&gt;assocId, path-&gt;<a class="code" href="class_s_c_t_p_path_variables.html#aa633bf8cbecd1b7152d64e56365dcd1a">remoteAddress</a>.<a class="code" href="class_i_pv_x_address.html#a27e3ec9ec324d86c1874a03db4788a92">str</a>().c_str());
        recordScalar(str, path-&gt;<a class="code" href="class_s_c_t_p_path_variables.html#afa7428f4dadb2631a67af315b9de178b">numberOfHeartbeatsSent</a>);
        snprintf((<span class="keywordtype">char</span>*)&amp;str, <span class="keyword">sizeof</span>(str), <span class="stringliteral">&quot;Number of Heartbeats Received %d:%s&quot;</span>,
                 conn-&gt;assocId, path-&gt;<a class="code" href="class_s_c_t_p_path_variables.html#aa633bf8cbecd1b7152d64e56365dcd1a">remoteAddress</a>.<a class="code" href="class_i_pv_x_address.html#a27e3ec9ec324d86c1874a03db4788a92">str</a>().c_str());
        recordScalar(str, path-&gt;<a class="code" href="class_s_c_t_p_path_variables.html#ac9cdb40c8aec7bbd7c7708c1e7485f66">numberOfHeartbeatsRcvd</a>);
        snprintf((<span class="keywordtype">char</span>*)&amp;str, <span class="keyword">sizeof</span>(str), <span class="stringliteral">&quot;Number of Heartbeat ACKs Sent %d:%s&quot;</span>,
                 conn-&gt;assocId, path-&gt;<a class="code" href="class_s_c_t_p_path_variables.html#aa633bf8cbecd1b7152d64e56365dcd1a">remoteAddress</a>.<a class="code" href="class_i_pv_x_address.html#a27e3ec9ec324d86c1874a03db4788a92">str</a>().c_str());
        recordScalar(str, path-&gt;<a class="code" href="class_s_c_t_p_path_variables.html#ae53a26f064bdf041b920c64a167ffd50">numberOfHeartbeatAcksSent</a>);
        snprintf((<span class="keywordtype">char</span>*)&amp;str, <span class="keyword">sizeof</span>(str), <span class="stringliteral">&quot;Number of Heartbeat ACKs Received %d:%s&quot;</span>,
                 conn-&gt;assocId, path-&gt;<a class="code" href="class_s_c_t_p_path_variables.html#aa633bf8cbecd1b7152d64e56365dcd1a">remoteAddress</a>.<a class="code" href="class_i_pv_x_address.html#a27e3ec9ec324d86c1874a03db4788a92">str</a>().c_str());
        recordScalar(str, path-&gt;<a class="code" href="class_s_c_t_p_path_variables.html#af24b6bffabfd4c9b91288b66db995759">numberOfHeartbeatAcksRcvd</a>);
    }


    conn-&gt;removePath();
    conn-&gt;deleteStreams();

    <span class="comment">// TD 20.11.09: Chunks may be in the transmission and retransmission queues simultaneously.</span>
    <span class="comment">//                   Remove entry from transmission queue if it is already in the retransmission queue.</span>
    <span class="keywordflow">for</span> (SCTPQueue::PayloadQueue::iterator i = conn-&gt;getRetransmissionQueue()-&gt;payloadQueue.begin();
          i != conn-&gt;getRetransmissionQueue()-&gt;payloadQueue.end(); i++) {
        SCTPQueue::PayloadQueue::iterator j = conn-&gt;getTransmissionQueue()-&gt;payloadQueue.find(i-&gt;second-&gt;tsn);
        <span class="keywordflow">if</span>(j != conn-&gt;getTransmissionQueue()-&gt;payloadQueue.end()) {
            conn-&gt;getTransmissionQueue()-&gt;payloadQueue.erase(j);
        }
    }
     <span class="comment">// TD 20.11.09: Now, both queues can be safely deleted.</span>
    <span class="keyword">delete</span> conn-&gt;getRetransmissionQueue();
    <span class="keyword">delete</span> conn-&gt;getTransmissionQueue();

    AppConnKey key;
    key.appGateIndex = conn-&gt;appGateIndex;
    key.assocId       = conn-&gt;assocId;
    <a class="code" href="class_s_c_t_p.html#a0bdbaac417e09631312a82718184fca5">sctpAppConnMap</a>.erase(key);
    <a class="code" href="class_s_c_t_p.html#affa2f26db6bbbf00938fa27e35b8f567">assocList</a>.remove(conn);
    <span class="keyword">delete</span> conn;
}
</pre></div>
</div>
</div>
<a class="anchor" id="abd09eaf1572e207a25aff6988091ca0f"></a><!-- doxytag: member="SCTP::removeLocalAddressFromAllRemoteAddresses" ref="abd09eaf1572e207a25aff6988091ca0f" args="(SCTPAssociation *conn, IPvXAddress address, std::vector&lt; IPvXAddress &gt; remAddresses)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SCTP::removeLocalAddressFromAllRemoteAddresses </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_s_c_t_p_association.html">SCTPAssociation</a> *&#160;</td>
          <td class="paramname"><em>conn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_i_pv_x_address.html">IPvXAddress</a>&#160;</td>
          <td class="paramname"><em>address</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="class_i_pv_x_address.html">IPvXAddress</a> &gt;&#160;</td>
          <td class="paramname"><em>remAddresses</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<div class="fragment"><pre class="fragment">{

        <span class="comment">//sctpEV3&lt;&lt;&quot;Remove local address: &quot;&lt;&lt;address&lt;&lt;&quot;\n&quot;;</span>

        SockPair key;

        <span class="keywordflow">for</span> (AddressVector::iterator i=remAddresses.begin(); i!=remAddresses.end(); ++i)
        {
            <span class="comment">//sctpEV3&lt;&lt;&quot;remote address=&quot;&lt;&lt;(*i)&lt;&lt;&quot;\n&quot;;</span>
            key.localAddr = address;
            key.remoteAddr = (*i);
            key.localPort = conn-&gt;<a class="code" href="class_s_c_t_p_association.html#acb21c9ce886b796d5134b1c0daa3227b">localPort</a>;
            key.remotePort = conn-&gt;<a class="code" href="class_s_c_t_p_association.html#a62e2c58ac9cc4e804800c05bae9da71f">remotePort</a>;

            SctpConnMap::iterator j = <a class="code" href="class_s_c_t_p.html#aa7f1b6e9c58bb2e49f644cc4fad58af2">sctpConnMap</a>.find(key);
            <span class="keywordflow">if</span> (j!=<a class="code" href="class_s_c_t_p.html#aa7f1b6e9c58bb2e49f644cc4fad58af2">sctpConnMap</a>.end())
            {
                ASSERT(j-&gt;second==conn);
                <a class="code" href="class_s_c_t_p.html#aa7f1b6e9c58bb2e49f644cc4fad58af2">sctpConnMap</a>.erase(j);
                <a class="code" href="class_s_c_t_p.html#a5c27765c60c9634a47b00c4de6137809">sizeConnMap</a>--;
            }
            <span class="keywordflow">else</span>
                <a class="code" href="_s_c_t_p_8h.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a>&lt;&lt;<span class="stringliteral">&quot;no actual sockPair found\n&quot;</span>;

            <span class="comment">//sctpEV3&lt;&lt;&quot;number of connections=&quot;&lt;&lt;sctpConnMap.size()&lt;&lt;&quot;\n&quot;;</span>

            <a class="code" href="class_s_c_t_p.html#a84f317375ec11a83b15062a0d77694d3">printInfoConnMap</a>();
        }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a2d162fde6e9246ce9db340f1824187a1"></a><!-- doxytag: member="SCTP::removeRemoteAddressFromAllConnections" ref="a2d162fde6e9246ce9db340f1824187a1" args="(SCTPAssociation *conn, IPvXAddress address, std::vector&lt; IPvXAddress &gt; locAddresses)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SCTP::removeRemoteAddressFromAllConnections </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_s_c_t_p_association.html">SCTPAssociation</a> *&#160;</td>
          <td class="paramname"><em>conn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_i_pv_x_address.html">IPvXAddress</a>&#160;</td>
          <td class="paramname"><em>address</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="class_i_pv_x_address.html">IPvXAddress</a> &gt;&#160;</td>
          <td class="paramname"><em>locAddresses</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<div class="fragment"><pre class="fragment">{

        <span class="comment">//sctpEV3&lt;&lt;&quot;Remove remote address: &quot;&lt;&lt;address&lt;&lt;&quot;\n&quot;;</span>

        SockPair key;

        <span class="keywordflow">for</span> (AddressVector::iterator i=locAddresses.begin(); i!=locAddresses.end(); i++)
        {
            <span class="comment">//sctpEV3&lt;&lt;&quot;local address=&quot;&lt;&lt;(*i)&lt;&lt;&quot;\n&quot;;</span>
            key.localAddr = (*i);
            key.remoteAddr = address;
            key.localPort = conn-&gt;<a class="code" href="class_s_c_t_p_association.html#acb21c9ce886b796d5134b1c0daa3227b">localPort</a>;
            key.remotePort = conn-&gt;<a class="code" href="class_s_c_t_p_association.html#a62e2c58ac9cc4e804800c05bae9da71f">remotePort</a>;

            SctpConnMap::iterator j = <a class="code" href="class_s_c_t_p.html#aa7f1b6e9c58bb2e49f644cc4fad58af2">sctpConnMap</a>.find(key);
            <span class="keywordflow">if</span> (j!=<a class="code" href="class_s_c_t_p.html#aa7f1b6e9c58bb2e49f644cc4fad58af2">sctpConnMap</a>.end())
            {
                ASSERT(j-&gt;second==conn);
                <a class="code" href="class_s_c_t_p.html#aa7f1b6e9c58bb2e49f644cc4fad58af2">sctpConnMap</a>.erase(j);
                <a class="code" href="class_s_c_t_p.html#a5c27765c60c9634a47b00c4de6137809">sizeConnMap</a>--;
            }
            <span class="keywordflow">else</span>
                <a class="code" href="_s_c_t_p_8h.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a>&lt;&lt;<span class="stringliteral">&quot;no actual sockPair found\n&quot;</span>;

            <span class="comment">//sctpEV3&lt;&lt;&quot;number of connections=&quot;&lt;&lt;sctpConnMap.size()&lt;&lt;&quot;\n&quot;;</span>

            <a class="code" href="class_s_c_t_p.html#a84f317375ec11a83b15062a0d77694d3">printInfoConnMap</a>();
        }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a8a189047a5fbd254dcd9d9283ba08836"></a><!-- doxytag: member="SCTP::sendAbortFromMain" ref="a8a189047a5fbd254dcd9d9283ba08836" args="(SCTPMessage *sctpmsg, IPvXAddress srcAddr, IPvXAddress destAddr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SCTP::sendAbortFromMain </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_s_c_t_p_message.html">SCTPMessage</a> *&#160;</td>
          <td class="paramname"><em>sctpmsg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_i_pv_x_address.html">IPvXAddress</a>&#160;</td>
          <td class="paramname"><em>srcAddr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_i_pv_x_address.html">IPvXAddress</a>&#160;</td>
          <td class="paramname"><em>destAddr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="class_s_c_t_p.html#a305de6ada20d2db21ddd19ad19cac3a1">handleMessage()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="class_s_c_t_p_message.html">SCTPMessage</a> *msg = <span class="keyword">new</span> <a class="code" href="class_s_c_t_p_message.html">SCTPMessage</a>();

    <a class="code" href="_s_c_t_p_8h.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a>&lt;&lt;<span class="stringliteral">&quot;\n\nSCTPMain:sendABORT \n&quot;</span>;

    msg-&gt;setSrcPort(sctpmsg-&gt;getDestPort());
    msg-&gt;setDestPort(sctpmsg-&gt;getSrcPort());
    msg-&gt;setBitLength(<a class="code" href="_s_c_t_p_association_8h.html#a5cd94d6b80cfc4869b11f345c9de4d93">SCTP_COMMON_HEADER</a>*8);
    msg-&gt;setChecksumOk(<span class="keyword">true</span>);

    SCTPAbortChunk* abortChunk = <span class="keyword">new</span> SCTPAbortChunk(<span class="stringliteral">&quot;ABORT&quot;</span>);
    abortChunk-&gt;setChunkType(<a class="code" href="_s_c_t_p_association_8h.html#a8886377ab3f4b4ef217558f2b83b7b12a781ad2788df9e25c59a70894c7832096">ABORT</a>);
    <span class="keywordflow">if</span> (sctpmsg-&gt;<a class="code" href="class_s_c_t_p_message.html#a6f20de2280586794996c56c77bf5c479">getChunksArraySize</a>()&gt;0 &amp;&amp; ((SCTPChunk*)(sctpmsg-&gt;<a class="code" href="class_s_c_t_p_message.html#a3fee5bba66df88a7771c3b5984f33008">getChunks</a>(0)))-&gt;getChunkType()==<a class="code" href="_s_c_t_p_association_8h.html#a8886377ab3f4b4ef217558f2b83b7b12a0cb1b2c6a7db1f1084886c98909a3f36">INIT</a>)
    {

        SCTPInitChunk* initChunk = check_and_cast&lt;SCTPInitChunk *&gt;(sctpmsg-&gt;<a class="code" href="class_s_c_t_p_message.html#a3fee5bba66df88a7771c3b5984f33008">getChunks</a>(0));
        abortChunk-&gt;setT_Bit(0);
        msg-&gt;setTag(initChunk-&gt;getInitTag());
    }
    <span class="keywordflow">else</span>
    {
        abortChunk-&gt;setT_Bit(1);
        msg-&gt;setTag(sctpmsg-&gt;getTag());
    }
    abortChunk-&gt;setBitLength(<a class="code" href="_s_c_t_p_association_8h.html#a2383950ff71160db077c713351a3baff">SCTP_ABORT_CHUNK_LENGTH</a>*8);
    msg-&gt;<a class="code" href="class_s_c_t_p_message.html#a46c6cc49994da66b04d2ab9eadc564b7">addChunk</a>(abortChunk);
    <span class="keywordflow">if</span> ((<span class="keywordtype">bool</span>)par(<span class="stringliteral">&quot;udpEncapsEnabled&quot;</span>))
    {
        msg-&gt;setKind(UDP_C_DATA);
        std::cout&lt;&lt;<span class="stringliteral">&quot;VTag=&quot;</span>&lt;&lt;msg-&gt;getTag()&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;
        UDPControlInfo *ctrl = <span class="keyword">new</span> UDPControlInfo();
        ctrl-&gt;setSrcPort(9899);
        ctrl-&gt;setDestAddr(destAddr.<a class="code" href="class_i_pv_x_address.html#a00acd2be0fc0f254afb2eb7540a4ea6e">get4</a>());
        ctrl-&gt;setDestPort(9899);
        msg-&gt;setControlInfo(ctrl);
    }
    <span class="keywordflow">else</span>
    {
        <a class="code" href="class_i_p_control_info.html">IPControlInfo</a> *controlInfo = <span class="keyword">new</span> <a class="code" href="class_i_p_control_info.html">IPControlInfo</a>();
        controlInfo-&gt;setProtocol(<a class="code" href="_i_p_serializer_8cc.html#a6ef95db1429c11d64f48e6f984044589">IP_PROT_SCTP</a>);
        controlInfo-&gt;setSrcAddr(srcAddr.<a class="code" href="class_i_pv_x_address.html#a00acd2be0fc0f254afb2eb7540a4ea6e">get4</a>());
        controlInfo-&gt;setDestAddr(destAddr.<a class="code" href="class_i_pv_x_address.html#a00acd2be0fc0f254afb2eb7540a4ea6e">get4</a>());
        msg-&gt;setControlInfo(controlInfo);
    }
    send(msg,<span class="stringliteral">&quot;to_ip&quot;</span>);
}
</pre></div>
</div>
</div>
<a class="anchor" id="aa184b3126dcf702901f1c1f0bc3529f4"></a><!-- doxytag: member="SCTP::sendShutdownCompleteFromMain" ref="aa184b3126dcf702901f1c1f0bc3529f4" args="(SCTPMessage *sctpmsg, IPvXAddress srcAddr, IPvXAddress destAddr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SCTP::sendShutdownCompleteFromMain </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_s_c_t_p_message.html">SCTPMessage</a> *&#160;</td>
          <td class="paramname"><em>sctpmsg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_i_pv_x_address.html">IPvXAddress</a>&#160;</td>
          <td class="paramname"><em>srcAddr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_i_pv_x_address.html">IPvXAddress</a>&#160;</td>
          <td class="paramname"><em>destAddr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="class_s_c_t_p.html#a305de6ada20d2db21ddd19ad19cac3a1">handleMessage()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="class_s_c_t_p_message.html">SCTPMessage</a> *msg = <span class="keyword">new</span> <a class="code" href="class_s_c_t_p_message.html">SCTPMessage</a>();

    <a class="code" href="_s_c_t_p_8h.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a>&lt;&lt;<span class="stringliteral">&quot;\n\nSCTP:sendABORT \n&quot;</span>;

    msg-&gt;setSrcPort(sctpmsg-&gt;getDestPort());
    msg-&gt;setDestPort(sctpmsg-&gt;getSrcPort());
    msg-&gt;setBitLength(<a class="code" href="_s_c_t_p_association_8h.html#a5cd94d6b80cfc4869b11f345c9de4d93">SCTP_COMMON_HEADER</a>*8);
    msg-&gt;setChecksumOk(<span class="keyword">true</span>);

    SCTPShutdownCompleteChunk* scChunk = <span class="keyword">new</span> SCTPShutdownCompleteChunk(<span class="stringliteral">&quot;SHUTDOWN_COMPLETE&quot;</span>);
    scChunk-&gt;setChunkType(<a class="code" href="_s_c_t_p_association_8h.html#a8886377ab3f4b4ef217558f2b83b7b12a1ac9ae29771c5095efe16ce822d561d7">SHUTDOWN_COMPLETE</a>);
    scChunk-&gt;setTBit(1);
    msg-&gt;setTag(sctpmsg-&gt;getTag());

    scChunk-&gt;setBitLength(<a class="code" href="_s_c_t_p_association_8h.html#ad1963dfab19884e93c14d1527c1e0535">SCTP_SHUTDOWN_ACK_LENGTH</a>*8);
    msg-&gt;<a class="code" href="class_s_c_t_p_message.html#a46c6cc49994da66b04d2ab9eadc564b7">addChunk</a>(scChunk);
    <a class="code" href="class_i_p_control_info.html">IPControlInfo</a> *controlInfo = <span class="keyword">new</span> <a class="code" href="class_i_p_control_info.html">IPControlInfo</a>();
    controlInfo-&gt;setProtocol(<a class="code" href="_i_p_serializer_8cc.html#a6ef95db1429c11d64f48e6f984044589">IP_PROT_SCTP</a>);
    controlInfo-&gt;setSrcAddr(srcAddr.<a class="code" href="class_i_pv_x_address.html#a00acd2be0fc0f254afb2eb7540a4ea6e">get4</a>());
    controlInfo-&gt;setDestAddr(destAddr.<a class="code" href="class_i_pv_x_address.html#a00acd2be0fc0f254afb2eb7540a4ea6e">get4</a>());
    msg-&gt;setControlInfo(controlInfo);
    send(msg,<span class="stringliteral">&quot;to_ip&quot;</span>);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a47a90c0d2a89f45862e0a21004c11bdb"></a><!-- doxytag: member="SCTP::updateDisplayString" ref="a47a90c0d2a89f45862e0a21004c11bdb" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SCTP::updateDisplayString </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="class_s_c_t_p.html#a305de6ada20d2db21ddd19ad19cac3a1">handleMessage()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordflow">if</span> (ev.disable_tracing)
    {
        <span class="comment">// in express mode, we don&#39;t bother to update the display</span>
        <span class="comment">// (std::map&#39;s iteration is not very fast if map is large)</span>
        getDisplayString().setTagArg(<span class="stringliteral">&quot;t&quot;</span>,0,<span class="stringliteral">&quot;&quot;</span>);
        <span class="keywordflow">return</span>;
    }

}
</pre></div>
</div>
</div>
<a class="anchor" id="a2ee4aaa2e36516a679b8c4a0748ecd9a"></a><!-- doxytag: member="SCTP::updateSockPair" ref="a2ee4aaa2e36516a679b8c4a0748ecd9a" args="(SCTPAssociation *assoc, IPvXAddress localAddr, IPvXAddress remoteAddr, int32 localPort, int32 remotePort)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SCTP::updateSockPair </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_s_c_t_p_association.html">SCTPAssociation</a> *&#160;</td>
          <td class="paramname"><em>assoc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_i_pv_x_address.html">IPvXAddress</a>&#160;</td>
          <td class="paramname"><em>localAddr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_i_pv_x_address.html">IPvXAddress</a>&#160;</td>
          <td class="paramname"><em>remoteAddr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>localPort</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>remotePort</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>To be called from <a class="el" href="class_s_c_t_p_association.html">SCTPAssociation</a> when socket pair changes </p>

<p>Referenced by <a class="el" href="class_s_c_t_p.html#a8e139c401cbd596810592e62be90a21e">addForkedAssociation()</a>, <a class="el" href="class_s_c_t_p_association.html#adf53e2f26b7881391b481c3716783cc9">SCTPAssociation::process_ASSOCIATE()</a>, <a class="el" href="class_s_c_t_p_association.html#a5cc7381e91d34e5c13a4b97eb02f9b7e">SCTPAssociation::process_OPEN_PASSIVE()</a>, and <a class="el" href="class_s_c_t_p_association.html#add502b430991fe297800a08dd62c569d">SCTPAssociation::processInitArrived()</a>.</p>
<div class="fragment"><pre class="fragment">{
    SockPair key;
    <a class="code" href="_s_c_t_p_8h.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a>&lt;&lt;<span class="stringliteral">&quot;updateSockPair:   localAddr: &quot;</span>&lt;&lt;localAddr&lt;&lt;<span class="stringliteral">&quot;   remoteAddr=&quot;</span>&lt;&lt;remoteAddr&lt;&lt;<span class="stringliteral">&quot;    localPort=&quot;</span>&lt;&lt;localPort&lt;&lt;<span class="stringliteral">&quot; remotePort=&quot;</span>&lt;&lt;remotePort&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;

    key.localAddr = (conn-&gt;localAddr = localAddr);
    key.remoteAddr = (conn-&gt;remoteAddr = remoteAddr);
    key.localPort = conn-&gt;localPort = localPort;
    key.remotePort = conn-&gt;remotePort = remotePort;

    <span class="keywordflow">for</span> (SctpConnMap::iterator i=<a class="code" href="class_s_c_t_p.html#aa7f1b6e9c58bb2e49f644cc4fad58af2">sctpConnMap</a>.begin(); i!=<a class="code" href="class_s_c_t_p.html#aa7f1b6e9c58bb2e49f644cc4fad58af2">sctpConnMap</a>.end(); i++)
    {
        <span class="keywordflow">if</span> (i-&gt;second == conn)
        {
            <a class="code" href="class_s_c_t_p.html#aa7f1b6e9c58bb2e49f644cc4fad58af2">sctpConnMap</a>.erase(i);
            <span class="keywordflow">break</span>;
        }
    }

    <a class="code" href="_s_c_t_p_8h.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a>&lt;&lt;<span class="stringliteral">&quot;updateSockPair conn=&quot;</span>&lt;&lt;conn&lt;&lt;<span class="stringliteral">&quot;    localAddr=&quot;</span>&lt;&lt;key.localAddr&lt;&lt;<span class="stringliteral">&quot;            remoteAddr=&quot;</span>&lt;&lt;key.remoteAddr&lt;&lt;<span class="stringliteral">&quot;     localPort=&quot;</span>&lt;&lt;key.localPort&lt;&lt;<span class="stringliteral">&quot;  remotePort=&quot;</span>&lt;&lt;remotePort&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;

    <a class="code" href="class_s_c_t_p.html#aa7f1b6e9c58bb2e49f644cc4fad58af2">sctpConnMap</a>[key] = conn;
    <a class="code" href="class_s_c_t_p.html#a5c27765c60c9634a47b00c4de6137809">sizeConnMap</a> = <a class="code" href="class_s_c_t_p.html#aa7f1b6e9c58bb2e49f644cc4fad58af2">sctpConnMap</a>.size();
    <span class="comment">//sctpEV3&lt;&lt;&quot;number of connections=&quot;&lt;&lt;sctpConnMap.size()&lt;&lt;&quot;\n&quot;;</span>
    <a class="code" href="_s_c_t_p_8h.html#ae124292366093a18d977ca18bd0c19f1">sctpEV3</a>&lt;&lt;<span class="stringliteral">&quot;assoc inserted in sctpConnMap\n&quot;</span>;
    <a class="code" href="class_s_c_t_p.html#a84f317375ec11a83b15062a0d77694d3">printInfoConnMap</a>();
}
</pre></div>
</div>
</div>
<hr/><h2>Member Data Documentation</h2>
<a class="anchor" id="affa2f26db6bbbf00938fa27e35b8f567"></a><!-- doxytag: member="SCTP::assocList" ref="affa2f26db6bbbf00938fa27e35b8f567" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::list&lt;<a class="el" href="class_s_c_t_p_association.html">SCTPAssociation</a>*&gt; <a class="el" href="class_s_c_t_p.html#affa2f26db6bbbf00938fa27e35b8f567">SCTP::assocList</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="class_s_c_t_p.html#a305de6ada20d2db21ddd19ad19cac3a1">handleMessage()</a>, <a class="el" href="class_s_c_t_p.html#a4848bf1f15a9f7aac6e53cd1889f9345">removeAssociation()</a>, <a class="el" href="class_s_c_t_p_association.html#afc1d3dc0cb62842b7d83998facfbfd06">SCTPAssociation::sendInit()</a>, and <a class="el" href="class_s_c_t_p_association.html#ac40f2aff108134cbfcea6cb06e25fdb1">SCTPAssociation::sendInitAck()</a>.</p>

</div>
</div>
<a class="anchor" id="a43c9f3107b99f1c969a4d5ca9c168bd3"></a><!-- doxytag: member="SCTP::assocStatMap" ref="a43c9f3107b99f1c969a4d5ca9c168bd3" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_s_c_t_p.html#a439de408c0d516fec889a8e67172156a">AssocStatMap</a> <a class="el" href="class_s_c_t_p.html#a43c9f3107b99f1c969a4d5ca9c168bd3">SCTP::assocStatMap</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="class_s_c_t_p.html#a7547ab07373b78775ff3ec27eb704ae3">finish()</a>, <a class="el" href="class_s_c_t_p_association.html#aee07b10bc3e9c1999e15c025d5e7db5f">SCTPAssociation::pathStatusIndication()</a>, <a class="el" href="class_s_c_t_p_association.html#a7eb1c9af2610929a04cb744b97af93c8">SCTPAssociation::process_SEND()</a>, <a class="el" href="class_s_c_t_p_association.html#ab0e373e70c4541d7f64666e98e99e7d3">SCTPAssociation::process_TIMEOUT_RTX()</a>, <a class="el" href="class_s_c_t_p_association.html#a4a28f10181c8a7af088e504c76242b7c">SCTPAssociation::processDataArrived()</a>, <a class="el" href="class_s_c_t_p.html#a4848bf1f15a9f7aac6e53cd1889f9345">removeAssociation()</a>, <a class="el" href="class_s_c_t_p_association.html#aa7cf5e2c2c169ce78e856025bb181116">SCTPAssociation::sendOnPath()</a>, <a class="el" href="class_s_c_t_p_association.html#a1edd1c4ec96bec1f031f6b83550471bc">SCTPAssociation::stateEntered()</a>, and <a class="el" href="class_s_c_t_p.html#a592a2d4ff219d86d6665d7a1a65fe8e0">~SCTP()</a>.</p>

</div>
</div>
<a class="anchor" id="afd8d177039fd50dc468ce8c4231d59f7"></a><!-- doxytag: member="SCTP::logverbose" ref="afd8d177039fd50dc468ce8c4231d59f7" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="class_s_c_t_p.html#afd8d177039fd50dc468ce8c4231d59f7">SCTP::logverbose</a><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="adcb74cef25ffed39e3825f2181f488f9"></a><!-- doxytag: member="SCTP::nextConnId" ref="adcb74cef25ffed39e3825f2181f488f9" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int32 <a class="el" href="class_s_c_t_p.html#adcb74cef25ffed39e3825f2181f488f9">SCTP::nextConnId</a> = 0<code> [static, protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="aaa0391c9c63435dee2ca1da5610bf697"></a><!-- doxytag: member="SCTP::nextEphemeralPort" ref="aaa0391c9c63435dee2ca1da5610bf697" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16 <a class="el" href="class_s_c_t_p.html#aaa0391c9c63435dee2ca1da5610bf697">SCTP::nextEphemeralPort</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="class_s_c_t_p.html#acf8131c6cb5ae94bc2b49b3305b51304">getEphemeralPort()</a>, and <a class="el" href="class_s_c_t_p.html#a7c9cce2a01f191ddeb3c4ed21f413339">initialize()</a>.</p>

</div>
</div>
<a class="anchor" id="ac9a52a17f3bf53576459c72587f36dc8"></a><!-- doxytag: member="SCTP::numGapReports" ref="ac9a52a17f3bf53576459c72587f36dc8" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32 <a class="el" href="class_s_c_t_p.html#ac9a52a17f3bf53576459c72587f36dc8">SCTP::numGapReports</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a08ec3d0f806364ad7d97ec0349b9d815"></a><!-- doxytag: member="SCTP::numPacketsDropped" ref="a08ec3d0f806364ad7d97ec0349b9d815" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32 <a class="el" href="class_s_c_t_p.html#a08ec3d0f806364ad7d97ec0349b9d815">SCTP::numPacketsDropped</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="class_s_c_t_p.html#a7547ab07373b78775ff3ec27eb704ae3">finish()</a>, <a class="el" href="class_s_c_t_p.html#a305de6ada20d2db21ddd19ad19cac3a1">handleMessage()</a>, and <a class="el" href="class_s_c_t_p.html#a7c9cce2a01f191ddeb3c4ed21f413339">initialize()</a>.</p>

</div>
</div>
<a class="anchor" id="ab63c2cdb48459ff2da4de9dd8be20651"></a><!-- doxytag: member="SCTP::numPacketsReceived" ref="ab63c2cdb48459ff2da4de9dd8be20651" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32 <a class="el" href="class_s_c_t_p.html#ab63c2cdb48459ff2da4de9dd8be20651">SCTP::numPacketsReceived</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="class_s_c_t_p.html#a7547ab07373b78775ff3ec27eb704ae3">finish()</a>, <a class="el" href="class_s_c_t_p.html#a305de6ada20d2db21ddd19ad19cac3a1">handleMessage()</a>, and <a class="el" href="class_s_c_t_p.html#a7c9cce2a01f191ddeb3c4ed21f413339">initialize()</a>.</p>

</div>
</div>
<a class="anchor" id="a0bdbaac417e09631312a82718184fca5"></a><!-- doxytag: member="SCTP::sctpAppConnMap" ref="a0bdbaac417e09631312a82718184fca5" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_s_c_t_p.html#ae31035be18163654260221f1d31ccbc6">SctpAppConnMap</a> <a class="el" href="class_s_c_t_p.html#a0bdbaac417e09631312a82718184fca5">SCTP::sctpAppConnMap</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="class_s_c_t_p.html#a8e139c401cbd596810592e62be90a21e">addForkedAssociation()</a>, <a class="el" href="class_s_c_t_p.html#aae97b24ba4ed4bb4950c3117f4c101d1">findAssocForApp()</a>, <a class="el" href="class_s_c_t_p.html#a399d0ce6826ad6cc3bd4656be35bc5e7">getAssoc()</a>, <a class="el" href="class_s_c_t_p.html#a305de6ada20d2db21ddd19ad19cac3a1">handleMessage()</a>, <a class="el" href="class_s_c_t_p.html#a4848bf1f15a9f7aac6e53cd1889f9345">removeAssociation()</a>, and <a class="el" href="class_s_c_t_p.html#a592a2d4ff219d86d6665d7a1a65fe8e0">~SCTP()</a>.</p>

</div>
</div>
<a class="anchor" id="aa7f1b6e9c58bb2e49f644cc4fad58af2"></a><!-- doxytag: member="SCTP::sctpConnMap" ref="aa7f1b6e9c58bb2e49f644cc4fad58af2" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_s_c_t_p.html#a119ab387204716b81562e9ea58789eab">SctpConnMap</a> <a class="el" href="class_s_c_t_p.html#aa7f1b6e9c58bb2e49f644cc4fad58af2">SCTP::sctpConnMap</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="class_s_c_t_p.html#a8e139c401cbd596810592e62be90a21e">addForkedAssociation()</a>, <a class="el" href="class_s_c_t_p.html#aeb3f468f36416f953ab7e647540f75e4">addLocalAddress()</a>, <a class="el" href="class_s_c_t_p.html#a476b640dbefbde3ee8029eef4393800e">addLocalAddressToAllRemoteAddresses()</a>, <a class="el" href="class_s_c_t_p.html#a34e3e284fe397118d5e69b56e497ed45">addRemoteAddress()</a>, <a class="el" href="class_s_c_t_p.html#ad481f51413de9f5cf1070ea507ffb345">findAssocForMessage()</a>, <a class="el" href="class_s_c_t_p.html#a7547ab07373b78775ff3ec27eb704ae3">finish()</a>, <a class="el" href="class_s_c_t_p.html#a305de6ada20d2db21ddd19ad19cac3a1">handleMessage()</a>, <a class="el" href="class_s_c_t_p.html#a84f317375ec11a83b15062a0d77694d3">printInfoConnMap()</a>, <a class="el" href="class_s_c_t_p.html#a4848bf1f15a9f7aac6e53cd1889f9345">removeAssociation()</a>, <a class="el" href="class_s_c_t_p.html#abd09eaf1572e207a25aff6988091ca0f">removeLocalAddressFromAllRemoteAddresses()</a>, <a class="el" href="class_s_c_t_p.html#a2d162fde6e9246ce9db340f1824187a1">removeRemoteAddressFromAllConnections()</a>, and <a class="el" href="class_s_c_t_p.html#a2ee4aaa2e36516a679b8c4a0748ecd9a">updateSockPair()</a>.</p>

</div>
</div>
<a class="anchor" id="ad27c44853f019878d8c9be020c56f8d9"></a><!-- doxytag: member="SCTP::sctpVTagMap" ref="ad27c44853f019878d8c9be020c56f8d9" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_s_c_t_p.html#acdebc4566eea2a17e3a309be272423c6">SctpVTagMap</a> <a class="el" href="class_s_c_t_p.html#ad27c44853f019878d8c9be020c56f8d9">SCTP::sctpVTagMap</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="class_s_c_t_p.html#a09e0381fe0039c77faf2a2d17736201e">findAssocWithVTag()</a>, <a class="el" href="class_s_c_t_p.html#afbb694a62bd6c7c911275ba3a6ce38db">printVTagMap()</a>, <a class="el" href="class_s_c_t_p_association.html#a1edd1c4ec96bec1f031f6b83550471bc">SCTPAssociation::stateEntered()</a>, and <a class="el" href="class_s_c_t_p.html#a592a2d4ff219d86d6665d7a1a65fe8e0">~SCTP()</a>.</p>

</div>
</div>
<a class="anchor" id="a5c27765c60c9634a47b00c4de6137809"></a><!-- doxytag: member="SCTP::sizeConnMap" ref="a5c27765c60c9634a47b00c4de6137809" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int32 <a class="el" href="class_s_c_t_p.html#a5c27765c60c9634a47b00c4de6137809">SCTP::sizeConnMap</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="class_s_c_t_p.html#aeb3f468f36416f953ab7e647540f75e4">addLocalAddress()</a>, <a class="el" href="class_s_c_t_p.html#a476b640dbefbde3ee8029eef4393800e">addLocalAddressToAllRemoteAddresses()</a>, <a class="el" href="class_s_c_t_p.html#a34e3e284fe397118d5e69b56e497ed45">addRemoteAddress()</a>, <a class="el" href="class_s_c_t_p.html#a7c9cce2a01f191ddeb3c4ed21f413339">initialize()</a>, <a class="el" href="class_s_c_t_p.html#a84f317375ec11a83b15062a0d77694d3">printInfoConnMap()</a>, <a class="el" href="class_s_c_t_p.html#a4848bf1f15a9f7aac6e53cd1889f9345">removeAssociation()</a>, <a class="el" href="class_s_c_t_p.html#abd09eaf1572e207a25aff6988091ca0f">removeLocalAddressFromAllRemoteAddresses()</a>, <a class="el" href="class_s_c_t_p.html#a2d162fde6e9246ce9db340f1824187a1">removeRemoteAddressFromAllConnections()</a>, and <a class="el" href="class_s_c_t_p.html#a2ee4aaa2e36516a679b8c4a0748ecd9a">updateSockPair()</a>.</p>

</div>
</div>
<a class="anchor" id="a0c82ce1676bd810f2defcce17bd1bd0a"></a><!-- doxytag: member="SCTP::testing" ref="a0c82ce1676bd810f2defcce17bd1bd0a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="class_s_c_t_p.html#a0c82ce1676bd810f2defcce17bd1bd0a">SCTP::testing</a><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="class_s_c_t_p.html#a7c9cce2a01f191ddeb3c4ed21f413339">initialize()</a>, and <a class="el" href="class_s_c_t_p_association.html#a001fa353226a6d713050940b2aa8587d">SCTPAssociation::processTimer()</a>.</p>

</div>
</div>
<a class="anchor" id="a35089977465533256142ee442021b18d"></a><!-- doxytag: member="SCTP::testTimeout" ref="a35089977465533256142ee442021b18d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">simtime_t <a class="el" href="class_s_c_t_p.html#a35089977465533256142ee442021b18d">SCTP::testTimeout</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="class_s_c_t_p.html#a7c9cce2a01f191ddeb3c4ed21f413339">initialize()</a>, and <a class="el" href="class_s_c_t_p_association.html#ad1984a2e17a73629a51334904745086f">SCTPAssociation::SCTPAssociation()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="_s_c_t_p_8h.html">SCTP.h</a></li>
<li><a class="el" href="_s_c_t_p_8cc.html">SCTP.cc</a></li>
</ul>
</div>
</div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="class_s_c_t_p.html">SCTP</a>      </li>
      <li class="footer">Generated on Fri Nov 18 2011 12:47:15 for INET Framework for OMNeT++/OMNEST by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </li>
    </ul>
  </div>

</body>
</html>
