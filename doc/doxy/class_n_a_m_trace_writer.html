<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>INET Framework for OMNeT++/OMNEST: NAMTraceWriter Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript">
$(document).ready(initResizable);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">INET Framework for OMNeT++/OMNEST</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('class_n_a_m_trace_writer.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a>  </div>
  <div class="headertitle">
<div class="title">NAMTraceWriter Class Reference</div>  </div>
</div>
<div class="contents">
<!-- doxytag: class="NAMTraceWriter" --><!-- doxytag: inherits="INotifiable" -->
<p><code>#include &lt;NAMTraceWriter.h&gt;</code></p>
<div class="dynheader">
Inheritance diagram for NAMTraceWriter:</div>
<div class="dyncontent">
 <div class="center">
  <img src="class_n_a_m_trace_writer.png" usemap="#NAMTraceWriter_map" alt=""/>
  <map id="NAMTraceWriter_map" name="NAMTraceWriter_map">
<area href="class_i_notifiable.html" alt="INotifiable" shape="rect" coords="0,0,108,24"/>
</map>
 </div></div>

<p><a href="class_n_a_m_trace_writer-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_n_a_m_trace_writer.html#a26f33a8a63dad5943dff47ce7cd6d0da">recordNodeEvent</a> (const char *state, const char *shape)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_n_a_m_trace_writer.html#a2e24f03665a06177035537fb361f1aa8">recordLinkEvent</a> (int peernamid, double datarate, simtime_t delay, const char *state)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_n_a_m_trace_writer.html#af7018709ca48f989580066ebe642f8b9">recordPacketEvent</a> (char event, int peernamid, cPacket *msg)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_n_a_m_trace_writer.html#a882721ae03388a6115163d89e1159a40">numInitStages</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_n_a_m_trace_writer.html#abc842e182202d89c16cadbe453d88350">initialize</a> (int stage)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_n_a_m_trace_writer.html#a392c5a8300f91dbd21c656b543602bd3">~NAMTraceWriter</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_n_a_m_trace_writer.html#aa23f82118398aa92a06664fe8fc43617">receiveChangeNotification</a> (int category, const cPolymorphic *details)</td></tr>
<tr><td colspan="2"><h2><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_n_a_m_trace_writer.html#ad8d40b42fd5ef8bb1764f31a6ae30ae8">namid</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_n_a_m_trace.html">NAMTrace</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_n_a_m_trace_writer.html#a41819db35e8fb9a79369d58dea90ec09">nt</a></td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>Writes a "nam" trace. </p>
</div><hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a392c5a8300f91dbd21c656b543602bd3"></a><!-- doxytag: member="NAMTraceWriter::~NAMTraceWriter" ref="a392c5a8300f91dbd21c656b543602bd3" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">NAMTraceWriter::~NAMTraceWriter </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<div class="fragment"><pre class="fragment">{
<span class="comment">/*FIXME this will crash if the &quot;nt&quot; module gets cleaned up sooner than this one</span>
<span class="comment">    if (nt &amp;&amp; nt-&gt;isEnabled())</span>
<span class="comment">    {</span>
<span class="comment">        recordNodeEvent(&quot;DOWN&quot;, &quot;circle&quot;);</span>
<span class="comment">    }</span>
<span class="comment">*/</span>
}
</pre></div>
</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="abc842e182202d89c16cadbe453d88350"></a><!-- doxytag: member="NAMTraceWriter::initialize" ref="abc842e182202d89c16cadbe453d88350" args="(int stage)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void NAMTraceWriter::initialize </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>stage</em></td><td>)</td>
          <td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<div class="fragment"><pre class="fragment">{
    <span class="keywordflow">if</span> (stage==1)  <span class="comment">// let NAMTrace module initialize in stage 0</span>
    {
        <span class="comment">// get pointer to the NAMTrace module</span>
        cModule *namMod = simulation.getModuleByPath(<span class="stringliteral">&quot;nam&quot;</span>);
        <span class="keywordflow">if</span> (!namMod)
        {
            <a class="code" href="class_n_a_m_trace_writer.html#a41819db35e8fb9a79369d58dea90ec09">nt</a> = NULL;
            <a class="code" href="_i_n_e_t_defs_8h.html#a650ef3eff8a2900bef69dae29c05d2dd">EV</a> &lt;&lt; <span class="stringliteral">&quot;NAMTraceWriter: nam module not found, no trace will be written\n&quot;</span>;
            <span class="keywordflow">return</span>;
        }

        <span class="comment">// store ptr to namtrace module</span>
        <a class="code" href="class_n_a_m_trace_writer.html#a41819db35e8fb9a79369d58dea90ec09">nt</a> = check_and_cast&lt;<a class="code" href="class_n_a_m_trace.html">NAMTrace</a>*&gt;(namMod);

        <span class="comment">// register given namid; -1 means autoconfigure</span>
        <span class="keywordtype">int</span> namid0 = par(<span class="stringliteral">&quot;namid&quot;</span>);
        cModule *node = getParentModule();  <span class="comment">// the host or router</span>
        <a class="code" href="class_n_a_m_trace_writer.html#ad8d40b42fd5ef8bb1764f31a6ae30ae8">namid</a> = <a class="code" href="class_n_a_m_trace_writer.html#a41819db35e8fb9a79369d58dea90ec09">nt</a>-&gt;<a class="code" href="class_n_a_m_trace.html#a46bdca1373188a1d562bf91de5d04d11">assignNamId</a>(node, namid0);
        <span class="keywordflow">if</span> (namid0==-1)
            par(<span class="stringliteral">&quot;namid&quot;</span>) = <a class="code" href="class_n_a_m_trace_writer.html#ad8d40b42fd5ef8bb1764f31a6ae30ae8">namid</a>;  <span class="comment">// let parameter reflect autoconfigured namid</span>

        <span class="comment">// write &quot;node&quot; entry to the trace</span>
        <span class="keywordflow">if</span> (<a class="code" href="class_n_a_m_trace_writer.html#a41819db35e8fb9a79369d58dea90ec09">nt</a>-&gt;<a class="code" href="class_n_a_m_trace.html#a6290f39804dd04d85e047d2b1a4d10d7">isEnabled</a>())
            <a class="code" href="class_n_a_m_trace_writer.html#a26f33a8a63dad5943dff47ce7cd6d0da">recordNodeEvent</a>(<span class="stringliteral">&quot;UP&quot;</span>, <span class="stringliteral">&quot;circle&quot;</span>);

        <span class="comment">// subscribe to the interesting notifications</span>
        <a class="code" href="class_notification_board.html">NotificationBoard</a> *nb = <a class="code" href="class_notification_board_access.html">NotificationBoardAccess</a>().<a class="code" href="class_module_access.html#a44956ddb52973612afbba0eeecf8bb66">get</a>();
        nb-&gt;<a class="code" href="class_notification_board.html#aeb02a282e6c807c1cb064a28e8409ff2">subscribe</a>(<span class="keyword">this</span>, <a class="code" href="_notifier_consts_8h.html#a06fc87d81c62e9abb8790b6e5713c55bae0063c4a74bab199079a3ff291a0bb42">NF_NODE_FAILURE</a>);
        nb-&gt;<a class="code" href="class_notification_board.html#aeb02a282e6c807c1cb064a28e8409ff2">subscribe</a>(<span class="keyword">this</span>, <a class="code" href="_notifier_consts_8h.html#a06fc87d81c62e9abb8790b6e5713c55ba95a9f1f7e23636c5b3ccf1ba8cdf011a">NF_NODE_RECOVERY</a>);
        nb-&gt;<a class="code" href="class_notification_board.html#aeb02a282e6c807c1cb064a28e8409ff2">subscribe</a>(<span class="keyword">this</span>, <a class="code" href="_notifier_consts_8h.html#a06fc87d81c62e9abb8790b6e5713c55ba3fc715010607b5a5d604735808bcd508">NF_PP_TX_BEGIN</a>);
        nb-&gt;<a class="code" href="class_notification_board.html#aeb02a282e6c807c1cb064a28e8409ff2">subscribe</a>(<span class="keyword">this</span>, <a class="code" href="_notifier_consts_8h.html#a06fc87d81c62e9abb8790b6e5713c55bac5728eed9d45bec1189b26d79aeff5b8">NF_PP_RX_END</a>);
        nb-&gt;<a class="code" href="class_notification_board.html#aeb02a282e6c807c1cb064a28e8409ff2">subscribe</a>(<span class="keyword">this</span>, <a class="code" href="_notifier_consts_8h.html#a06fc87d81c62e9abb8790b6e5713c55ba53fa4604bf2e03acd9598b0db09e8e11">NF_L2_Q_DROP</a>);
    }
    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (stage==2 &amp;&amp; <a class="code" href="class_n_a_m_trace_writer.html#a41819db35e8fb9a79369d58dea90ec09">nt</a>!=NULL &amp;&amp; <a class="code" href="class_n_a_m_trace_writer.html#a41819db35e8fb9a79369d58dea90ec09">nt</a>-&gt;<a class="code" href="class_n_a_m_trace.html#a6290f39804dd04d85e047d2b1a4d10d7">isEnabled</a>())
    {
        <span class="comment">// write &quot;link&quot; entries</span>
        <a class="code" href="class_i_interface_table.html">IInterfaceTable</a> *ift = <a class="code" href="class_interface_table_access.html">InterfaceTableAccess</a>().<a class="code" href="class_module_access.html#a44956ddb52973612afbba0eeecf8bb66">get</a>();
        cModule *node = getParentModule();  <span class="comment">// the host or router</span>
        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;ift-&gt;<a class="code" href="class_i_interface_table.html#a2b0ce46cd92da6f64fc363410dc71904">getNumInterfaces</a>(); i++)
        {
            <span class="comment">// skip loopback interfaces</span>
            <a class="code" href="class_interface_entry.html">InterfaceEntry</a> *ie = ift-&gt;<a class="code" href="class_i_interface_table.html#a19ce4ca3b47b52b8e2b67c25806c4b49">getInterface</a>(i);
            <span class="keywordflow">if</span> (ie-&gt;<a class="code" href="class_interface_entry.html#a0ee93e88273f61390d1293dae55004d1">isLoopback</a>()) <span class="keywordflow">continue</span>;
            <span class="keywordflow">if</span> (!ie-&gt;<a class="code" href="class_interface_entry.html#a91ff5ecd3f8a0e38a09f40694b760a65">isPointToPoint</a>()) <span class="keywordflow">continue</span>; <span class="comment">// consider pont-to-point links only</span>

            <span class="comment">// fill in peerNamIds in InterfaceEntries</span>
            cGate *outgate = node-&gt;gate(ie-&gt;<a class="code" href="class_interface_entry.html#a28c151905c57d6d19ecb026367f93278">getNodeOutputGateId</a>());
            <span class="keywordflow">if</span> (!outgate || !outgate-&gt;getNextGate()) <span class="keywordflow">continue</span>;
            cModule *peernode = outgate-&gt;getNextGate()-&gt;getOwnerModule(); <span class="comment">// FIXME not entirely correct: what if a subnet is &quot;boxed&quot;?</span>
            cModule *peerwriter = peernode-&gt;getSubmodule(<span class="stringliteral">&quot;namTrace&quot;</span>);
            <span class="keywordflow">if</span> (!peerwriter) error(<span class="stringliteral">&quot;module %s doesn&#39;t have a submodule named namTrace&quot;</span>, peernode-&gt;getFullPath().c_str());
            <span class="keywordtype">int</span> peernamid = peerwriter-&gt;par(<span class="stringliteral">&quot;namid&quot;</span>);
            ie-&gt;<a class="code" href="class_interface_entry.html#ab2642147de209c738f171c8ae05dd132">setPeerNamId</a>(peernamid);

            <span class="comment">// find delay</span>
            simtime_t delay = 0;
            cDatarateChannel *chan = <span class="keyword">dynamic_cast&lt;</span>cDatarateChannel*<span class="keyword">&gt;</span>(outgate-&gt;getChannel());
            <span class="keywordflow">if</span> (chan) delay = chan-&gt;getDelay();

            <span class="comment">// write link entry into trace</span>
            <a class="code" href="class_n_a_m_trace_writer.html#a2e24f03665a06177035537fb361f1aa8">recordLinkEvent</a>(peernamid, ie-&gt;<a class="code" href="class_interface_entry.html#a54591c28cfc7a3ccbf8025ff4bb4f889">getDatarate</a>(), delay, <span class="stringliteral">&quot;UP&quot;</span>);
        }
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a882721ae03388a6115163d89e1159a40"></a><!-- doxytag: member="NAMTraceWriter::numInitStages" ref="a882721ae03388a6115163d89e1159a40" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual int NAMTraceWriter::numInitStages </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [inline, protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<div class="fragment"><pre class="fragment">{<span class="keywordflow">return</span> 3;}
</pre></div>
</div>
</div>
<a class="anchor" id="aa23f82118398aa92a06664fe8fc43617"></a><!-- doxytag: member="NAMTraceWriter::receiveChangeNotification" ref="aa23f82118398aa92a06664fe8fc43617" args="(int category, const cPolymorphic *details)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void NAMTraceWriter::receiveChangeNotification </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>category</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const cPolymorphic *&#160;</td>
          <td class="paramname"><em>details</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Redefined <a class="el" href="class_i_notifiable.html">INotifiable</a> method. Called by <a class="el" href="class_notification_board.html">NotificationBoard</a> on changes. </p>

<p>Implements <a class="el" href="class_i_notifiable.html#a67d757190e1128eaec8f0a8e51ed38f6">INotifiable</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="comment">// don&#39;t do anything if global NAMTrace module doesn&#39;t exist or does not have a file open</span>
    <span class="keywordflow">if</span> (!<a class="code" href="class_n_a_m_trace_writer.html#a41819db35e8fb9a79369d58dea90ec09">nt</a> || !<a class="code" href="class_n_a_m_trace_writer.html#a41819db35e8fb9a79369d58dea90ec09">nt</a>-&gt;<a class="code" href="class_n_a_m_trace.html#a6290f39804dd04d85e047d2b1a4d10d7">isEnabled</a>())
        <span class="keywordflow">return</span>;

    <a class="code" href="_notifier_consts_8cc.html#a68fd4b933fae636048bb9ee52fd922e5">printNotificationBanner</a>(category, details);

    <span class="comment">// process notification</span>
    <span class="keywordflow">if</span> (category==<a class="code" href="_notifier_consts_8h.html#a06fc87d81c62e9abb8790b6e5713c55ba3fc715010607b5a5d604735808bcd508">NF_PP_TX_BEGIN</a> || category==<a class="code" href="_notifier_consts_8h.html#a06fc87d81c62e9abb8790b6e5713c55bac5728eed9d45bec1189b26d79aeff5b8">NF_PP_RX_END</a> || category==<a class="code" href="_notifier_consts_8h.html#a06fc87d81c62e9abb8790b6e5713c55ba53fa4604bf2e03acd9598b0db09e8e11">NF_L2_Q_DROP</a>)
    {
        <a class="code" href="class_tx_notif_details.html">TxNotifDetails</a> *d = check_and_cast&lt;<a class="code" href="class_tx_notif_details.html">TxNotifDetails</a> *&gt;(details);
        <span class="keywordtype">int</span> peernamid = d-&gt;<a class="code" href="class_tx_notif_details.html#af7fed7112f5c22bebca2799b8e811c3f">getInterfaceEntry</a>()-&gt;<a class="code" href="class_interface_entry.html#ac84f7ce25867c64837b84bf2ac120a0e">getPeerNamId</a>();
        cPacket *msg = d-&gt;<a class="code" href="class_tx_notif_details.html#a4adf108f7298255d0f2f6a7962b0b030">getPacket</a>();

        <span class="keywordflow">switch</span>(category)
        {
            <span class="keywordflow">case</span> <a class="code" href="_notifier_consts_8h.html#a06fc87d81c62e9abb8790b6e5713c55ba3fc715010607b5a5d604735808bcd508">NF_PP_TX_BEGIN</a>: <a class="code" href="class_n_a_m_trace_writer.html#af7018709ca48f989580066ebe642f8b9">recordPacketEvent</a>(<span class="charliteral">&#39;h&#39;</span>, peernamid, msg); <span class="keywordflow">break</span>;
            <span class="keywordflow">case</span> <a class="code" href="_notifier_consts_8h.html#a06fc87d81c62e9abb8790b6e5713c55bac5728eed9d45bec1189b26d79aeff5b8">NF_PP_RX_END</a>:   <a class="code" href="class_n_a_m_trace_writer.html#af7018709ca48f989580066ebe642f8b9">recordPacketEvent</a>(<span class="charliteral">&#39;r&#39;</span>, peernamid, msg); <span class="keywordflow">break</span>;
            <span class="keywordflow">case</span> <a class="code" href="_notifier_consts_8h.html#a06fc87d81c62e9abb8790b6e5713c55ba53fa4604bf2e03acd9598b0db09e8e11">NF_L2_Q_DROP</a>:   <a class="code" href="class_n_a_m_trace_writer.html#af7018709ca48f989580066ebe642f8b9">recordPacketEvent</a>(<span class="charliteral">&#39;d&#39;</span>, peernamid, msg); <span class="keywordflow">break</span>;
        }
    }
    <span class="keywordflow">else</span>
    {
        <span class="keywordflow">switch</span>(category)
        {
            <span class="keywordflow">case</span> <a class="code" href="_notifier_consts_8h.html#a06fc87d81c62e9abb8790b6e5713c55bae0063c4a74bab199079a3ff291a0bb42">NF_NODE_FAILURE</a>: <span class="keywordflow">break</span>; <span class="comment">// TODO</span>
            <span class="keywordflow">case</span> <a class="code" href="_notifier_consts_8h.html#a06fc87d81c62e9abb8790b6e5713c55ba95a9f1f7e23636c5b3ccf1ba8cdf011a">NF_NODE_RECOVERY</a>: <span class="keywordflow">break</span>; <span class="comment">// TODO</span>
        }
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a2e24f03665a06177035537fb361f1aa8"></a><!-- doxytag: member="NAMTraceWriter::recordLinkEvent" ref="a2e24f03665a06177035537fb361f1aa8" args="(int peernamid, double datarate, simtime_t delay, const char *state)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void NAMTraceWriter::recordLinkEvent </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>peernamid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>datarate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">simtime_t&#160;</td>
          <td class="paramname"><em>delay</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>state</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="class_n_a_m_trace_writer.html#abc842e182202d89c16cadbe453d88350">initialize()</a>.</p>
<div class="fragment"><pre class="fragment">{
    ASSERT(<a class="code" href="class_n_a_m_trace_writer.html#a41819db35e8fb9a79369d58dea90ec09">nt</a> &amp;&amp; <a class="code" href="class_n_a_m_trace_writer.html#a41819db35e8fb9a79369d58dea90ec09">nt</a>-&gt;<a class="code" href="class_n_a_m_trace.html#a6290f39804dd04d85e047d2b1a4d10d7">isEnabled</a>());
    std::ostream&amp; out = <a class="code" href="class_n_a_m_trace_writer.html#a41819db35e8fb9a79369d58dea90ec09">nt</a>-&gt;<a class="code" href="class_n_a_m_trace.html#a111d1601d77a5895ecd60bf4202384e1">out</a>();

    <span class="comment">// link entry (to be registered ON ONE END ONLY! This also means that</span>
    <span class="comment">// ns2 thinks that datarate and delay must be the same in both directions)</span>
    <span class="keywordflow">if</span> (<a class="code" href="class_n_a_m_trace_writer.html#ad8d40b42fd5ef8bb1764f31a6ae30ae8">namid</a> &lt; peernamid)
        out &lt;&lt; <span class="stringliteral">&quot;l -t * -s &quot;</span> &lt;&lt; <a class="code" href="class_n_a_m_trace_writer.html#ad8d40b42fd5ef8bb1764f31a6ae30ae8">namid</a> &lt;&lt; <span class="stringliteral">&quot; -d &quot;</span> &lt;&lt; peernamid
            &lt;&lt; <span class="stringliteral">&quot; -S &quot;</span> &lt;&lt; state &lt;&lt; <span class="stringliteral">&quot; -r &quot;</span> &lt;&lt; (int)datarate &lt;&lt; <span class="stringliteral">&quot; -D &quot;</span> &lt;&lt; delay &lt;&lt; endl;

    <span class="comment">// queue entry</span>
    out &lt;&lt; <span class="stringliteral">&quot;q -t * -s &quot;</span> &lt;&lt; <a class="code" href="class_n_a_m_trace_writer.html#ad8d40b42fd5ef8bb1764f31a6ae30ae8">namid</a> &lt;&lt; <span class="stringliteral">&quot; -d &quot;</span> &lt;&lt; peernamid &lt;&lt; <span class="stringliteral">&quot; -a 0 &quot;</span> &lt;&lt; endl;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a26f33a8a63dad5943dff47ce7cd6d0da"></a><!-- doxytag: member="NAMTraceWriter::recordNodeEvent" ref="a26f33a8a63dad5943dff47ce7cd6d0da" args="(const char *state, const char *shape)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void NAMTraceWriter::recordNodeEvent </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>shape</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="class_n_a_m_trace_writer.html#abc842e182202d89c16cadbe453d88350">initialize()</a>.</p>
<div class="fragment"><pre class="fragment">{
    ASSERT(<a class="code" href="class_n_a_m_trace_writer.html#a41819db35e8fb9a79369d58dea90ec09">nt</a> &amp;&amp; <a class="code" href="class_n_a_m_trace_writer.html#a41819db35e8fb9a79369d58dea90ec09">nt</a>-&gt;<a class="code" href="class_n_a_m_trace.html#a6290f39804dd04d85e047d2b1a4d10d7">isEnabled</a>());
    std::ostream&amp; out = <a class="code" href="class_n_a_m_trace_writer.html#a41819db35e8fb9a79369d58dea90ec09">nt</a>-&gt;<a class="code" href="class_n_a_m_trace.html#a111d1601d77a5895ecd60bf4202384e1">out</a>();
    out &lt;&lt; <span class="stringliteral">&quot;n -t &quot;</span>;
    <span class="keywordflow">if</span> (simTime() == 0.0)
        out &lt;&lt; <span class="stringliteral">&quot;*&quot;</span>;
    <span class="keywordflow">else</span>
        out &lt;&lt; simTime();
    out &lt;&lt; <span class="stringliteral">&quot; -s &quot;</span> &lt;&lt; <a class="code" href="class_n_a_m_trace_writer.html#ad8d40b42fd5ef8bb1764f31a6ae30ae8">namid</a> &lt;&lt; <span class="stringliteral">&quot; -a &quot;</span> &lt;&lt; <a class="code" href="class_n_a_m_trace_writer.html#ad8d40b42fd5ef8bb1764f31a6ae30ae8">namid</a> &lt;&lt; <span class="stringliteral">&quot; -S &quot;</span> &lt;&lt; state &lt;&lt; <span class="stringliteral">&quot; -v &quot;</span> &lt;&lt; shape &lt;&lt; endl;
}
</pre></div>
</div>
</div>
<a class="anchor" id="af7018709ca48f989580066ebe642f8b9"></a><!-- doxytag: member="NAMTraceWriter::recordPacketEvent" ref="af7018709ca48f989580066ebe642f8b9" args="(char event, int peernamid, cPacket *msg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void NAMTraceWriter::recordPacketEvent </td>
          <td>(</td>
          <td class="paramtype">char&#160;</td>
          <td class="paramname"><em>event</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>peernamid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">cPacket *&#160;</td>
          <td class="paramname"><em>msg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="class_n_a_m_trace_writer.html#aa23f82118398aa92a06664fe8fc43617">receiveChangeNotification()</a>.</p>
<div class="fragment"><pre class="fragment">{
    ASSERT(<a class="code" href="class_n_a_m_trace_writer.html#a41819db35e8fb9a79369d58dea90ec09">nt</a> &amp;&amp; <a class="code" href="class_n_a_m_trace_writer.html#a41819db35e8fb9a79369d58dea90ec09">nt</a>-&gt;<a class="code" href="class_n_a_m_trace.html#a6290f39804dd04d85e047d2b1a4d10d7">isEnabled</a>());
    std::ostream&amp; out = <a class="code" href="class_n_a_m_trace_writer.html#a41819db35e8fb9a79369d58dea90ec09">nt</a>-&gt;<a class="code" href="class_n_a_m_trace.html#a111d1601d77a5895ecd60bf4202384e1">out</a>();

    <span class="keywordtype">int</span> size = msg-&gt;getByteLength();
    <span class="keywordtype">int</span> color = 0;
    <span class="keywordflow">for</span> (cPacket *em = msg; em; em = em-&gt;getEncapsulatedPacket())
        <span class="keywordflow">if</span> (em-&gt;hasPar(<span class="stringliteral">&quot;color&quot;</span>))
            {color = em-&gt;par(<span class="stringliteral">&quot;color&quot;</span>).longValue(); <span class="keywordflow">break</span>;}

    out &lt;&lt; <span class="keyword">event</span> &lt;&lt; <span class="stringliteral">&quot; -t &quot;</span> &lt;&lt; simTime();
    <span class="keywordflow">if</span> (event==<span class="charliteral">&#39;h&#39;</span>)
        out &lt;&lt; <span class="stringliteral">&quot; -s &quot;</span> &lt;&lt; <a class="code" href="class_n_a_m_trace_writer.html#ad8d40b42fd5ef8bb1764f31a6ae30ae8">namid</a> &lt;&lt; <span class="stringliteral">&quot; -d &quot;</span> &lt;&lt; peernamid;
    <span class="keywordflow">else</span>
        out &lt;&lt; <span class="stringliteral">&quot; -s &quot;</span> &lt;&lt; peernamid &lt;&lt; <span class="stringliteral">&quot; -d &quot;</span> &lt;&lt; <a class="code" href="class_n_a_m_trace_writer.html#ad8d40b42fd5ef8bb1764f31a6ae30ae8">namid</a>;

    out &lt;&lt; <span class="stringliteral">&quot; -e &quot;</span> &lt;&lt; size &lt;&lt; <span class="stringliteral">&quot; -a &quot;</span> &lt;&lt; color &lt;&lt; endl;
}
</pre></div>
</div>
</div>
<hr/><h2>Member Data Documentation</h2>
<a class="anchor" id="ad8d40b42fd5ef8bb1764f31a6ae30ae8"></a><!-- doxytag: member="NAMTraceWriter::namid" ref="ad8d40b42fd5ef8bb1764f31a6ae30ae8" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="class_n_a_m_trace_writer.html#ad8d40b42fd5ef8bb1764f31a6ae30ae8">NAMTraceWriter::namid</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="class_n_a_m_trace_writer.html#abc842e182202d89c16cadbe453d88350">initialize()</a>, <a class="el" href="class_n_a_m_trace_writer.html#a2e24f03665a06177035537fb361f1aa8">recordLinkEvent()</a>, <a class="el" href="class_n_a_m_trace_writer.html#a26f33a8a63dad5943dff47ce7cd6d0da">recordNodeEvent()</a>, and <a class="el" href="class_n_a_m_trace_writer.html#af7018709ca48f989580066ebe642f8b9">recordPacketEvent()</a>.</p>

</div>
</div>
<a class="anchor" id="a41819db35e8fb9a79369d58dea90ec09"></a><!-- doxytag: member="NAMTraceWriter::nt" ref="a41819db35e8fb9a79369d58dea90ec09" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_n_a_m_trace.html">NAMTrace</a>* <a class="el" href="class_n_a_m_trace_writer.html#a41819db35e8fb9a79369d58dea90ec09">NAMTraceWriter::nt</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="class_n_a_m_trace_writer.html#abc842e182202d89c16cadbe453d88350">initialize()</a>, <a class="el" href="class_n_a_m_trace_writer.html#aa23f82118398aa92a06664fe8fc43617">receiveChangeNotification()</a>, <a class="el" href="class_n_a_m_trace_writer.html#a2e24f03665a06177035537fb361f1aa8">recordLinkEvent()</a>, <a class="el" href="class_n_a_m_trace_writer.html#a26f33a8a63dad5943dff47ce7cd6d0da">recordNodeEvent()</a>, and <a class="el" href="class_n_a_m_trace_writer.html#af7018709ca48f989580066ebe642f8b9">recordPacketEvent()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="_n_a_m_trace_writer_8h.html">NAMTraceWriter.h</a></li>
<li><a class="el" href="_n_a_m_trace_writer_8cc.html">NAMTraceWriter.cc</a></li>
</ul>
</div>
</div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="class_n_a_m_trace_writer.html">NAMTraceWriter</a>      </li>
      <li class="footer">Generated on Fri Nov 18 2011 12:47:14 for INET Framework for OMNeT++/OMNEST by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </li>
    </ul>
  </div>

</body>
</html>
