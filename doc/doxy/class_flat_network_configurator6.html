<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>INET Framework for OMNeT++/OMNEST: FlatNetworkConfigurator6 Class Reference</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>


</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">INET Framework for OMNeT++/OMNEST
   
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('class_flat_network_configurator6.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#pro-methods">Protected Member Functions</a>  </div>
  <div class="headertitle">
<div class="title">FlatNetworkConfigurator6 Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<!-- doxytag: class="FlatNetworkConfigurator6" -->
<p>Configures <a class="el" href="class_i_pv6.html" title="IPv6 implementation.">IPv6</a> addresses and routing tables for a "flat" network, "flat" meaning that all hosts and routers will have the same network address.  
 <a href="class_flat_network_configurator6.html#details">More...</a></p>

<p><code>#include &lt;FlatNetworkConfigurator6.h&gt;</code></p>

<p><a href="class_flat_network_configurator6-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_flat_network_configurator6.html#a2f5695e02c3283882731e5b252d1192d">numInitStages</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="timer__queue_8h.html#a07640d68b3fdfaa5c48a36265e8f10b8">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_flat_network_configurator6.html#a7384a5ea6158f37546987a6bdf32f9b0">initialize</a> (int stage)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="timer__queue_8h.html#a07640d68b3fdfaa5c48a36265e8f10b8">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_flat_network_configurator6.html#a77ac0593d710a8dc41f3cfc23f6236b7">handleMessage</a> (cMessage *msg)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="timer__queue_8h.html#a07640d68b3fdfaa5c48a36265e8f10b8">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_flat_network_configurator6.html#a4b3401699c2735d6a42e36c3df86b010">configureAdvPrefixes</a> (cTopology &amp;topo)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="timer__queue_8h.html#a07640d68b3fdfaa5c48a36265e8f10b8">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_flat_network_configurator6.html#aa4e9be7807116b4b03193292cefa7368">addOwnAdvPrefixRoutes</a> (cTopology &amp;topo)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="timer__queue_8h.html#a07640d68b3fdfaa5c48a36265e8f10b8">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_flat_network_configurator6.html#a684fdefcfe46d118e158423c3f77fe22">addStaticRoutes</a> (cTopology &amp;topo)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="timer__queue_8h.html#a07640d68b3fdfaa5c48a36265e8f10b8">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_flat_network_configurator6.html#a75dc3f9363d2ee61dae93998034adcfa">setDisplayString</a> (int numIPNodes, int numNonIPNodes)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_flat_network_configurator6.html#aedf7247f30e97c587d9e94069f59c3c4">isIPNode</a> (cTopology::Node *node)</td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>Configures <a class="el" href="class_i_pv6.html" title="IPv6 implementation.">IPv6</a> addresses and routing tables for a "flat" network, "flat" meaning that all hosts and routers will have the same network address. </p>
<p>For more info please see the NED file. </p>
</div><hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="aa4e9be7807116b4b03193292cefa7368"></a><!-- doxytag: member="FlatNetworkConfigurator6::addOwnAdvPrefixRoutes" ref="aa4e9be7807116b4b03193292cefa7368" args="(cTopology &amp;topo)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="timer__queue_8h.html#a07640d68b3fdfaa5c48a36265e8f10b8">void</a> <a class="el" href="class_flat_network_configurator6.html#aa4e9be7807116b4b03193292cefa7368">FlatNetworkConfigurator6::addOwnAdvPrefixRoutes</a> </td>
          <td>(</td>
          <td class="paramtype">cTopology &amp;&#160;</td>
          <td class="paramname"><em>topo</em></td><td>)</td>
          <td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="class_flat_network_configurator6.html#a7384a5ea6158f37546987a6bdf32f9b0">initialize()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="comment">// add globally routable prefixes to routing table</span>
    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; topo.getNumNodes(); i++)
    {
        cTopology::Node *node = topo.getNode(i);

        <span class="comment">// skip bus types</span>
        <span class="keywordflow">if</span> (!<a class="code" href="class_flat_network_configurator6.html#aedf7247f30e97c587d9e94069f59c3c4">isIPNode</a>(node))
            <span class="keywordflow">continue</span>;

        <a class="code" href="class_routing_table6.html" title="Represents the IPv6 routing table and neighbour discovery data structures.">RoutingTable6</a> *rt = <a class="code" href="class_i_pv_x_address_resolver.html" title="Utility class for finding IPv4 or IPv6 address of a host or router.">IPvXAddressResolver</a>().<a class="code" href="class_i_pv_x_address_resolver.html#a3749a01070195e0db3125f2686863e71" title="The function tries to look up the RoutingTable6 module as submodule &quot;routingTable6&quot; or &quot;networkLayer...">routingTable6Of</a>(node-&gt;getModule());
        <a class="code" href="class_i_interface_table.html" title="A C++ interface to abstract the functionality of InterfaceTable.">IInterfaceTable</a> *ift = <a class="code" href="class_i_pv_x_address_resolver.html" title="Utility class for finding IPv4 or IPv6 address of a host or router.">IPvXAddressResolver</a>().<a class="code" href="class_i_pv_x_address_resolver.html#aa337d4676aa162df6d46bb1301509434" title="The function tries to look up the IInterfaceTable module as submodule &quot;interfaceTable&quot; or &quot;networkLay...">interfaceTableOf</a>(node-&gt;getModule());

        <span class="comment">// skip hosts</span>
        <span class="keywordflow">if</span> (!rt-&gt;par(<span class="stringliteral">&quot;isRouter&quot;</span>).boolValue())
            <span class="keywordflow">continue</span>;

        <span class="comment">// add globally routable prefixes to routing table</span>
        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> x = 0; x &lt; ift-&gt;<a class="code" href="class_i_interface_table.html#a2b0ce46cd92da6f64fc363410dc71904" title="Returns the number of interfaces.">getNumInterfaces</a>(); x++)
        {
            <a class="code" href="class_interface_entry.html" title="Interface entry for the interface table in IInterfaceTable.">InterfaceEntry</a> *ie = ift-&gt;<a class="code" href="class_i_interface_table.html#a19ce4ca3b47b52b8e2b67c25806c4b49" title="Returns the InterfaceEntry specified by an index 0..numInterfaces-1.">getInterface</a>(x);

            <span class="keywordflow">if</span> (ie-&gt;<a class="code" href="class_interface_entry.html#a0ee93e88273f61390d1293dae55004d1">isLoopback</a>())
                <span class="keywordflow">continue</span>;

            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> y = 0; y &lt; ie-&gt;<a class="code" href="class_interface_entry.html#a19083391271368e371346eb41ccc6c93">ipv6Data</a>()-&gt;<a class="code" href="class_i_pv6_interface_data.html#a1d84187cfbe9e91f7af79927c813f61c" title="Returns the number of advertised prefixes on the interface.">getNumAdvPrefixes</a>(); y++)
                <span class="keywordflow">if</span> (ie-&gt;<a class="code" href="class_interface_entry.html#a19083391271368e371346eb41ccc6c93">ipv6Data</a>()-&gt;<a class="code" href="class_i_pv6_interface_data.html#a90da8f012bd443c75e6e742bcf6f7d38" title="Returns the ith advertised prefix on the interface.">getAdvPrefix</a>(y).<a class="code" href="struct_i_pv6_interface_data_1_1_adv_prefix.html#a8dbd979f7860762721b55d4793629258">prefix</a>.<a class="code" href="class_i_pv6_address.html#aa2c2499a9e2ca1fd41b615d38654d8aa" title="Utility function based on getScope()">isGlobal</a>())
                    rt-&gt;<a class="code" href="class_routing_table6.html#aad45eef791b41fe469357f1f4c6090bb" title="Add route of type OWN_ADV_PREFIX.">addOrUpdateOwnAdvPrefix</a>(ie-&gt;<a class="code" href="class_interface_entry.html#a19083391271368e371346eb41ccc6c93">ipv6Data</a>()-&gt;<a class="code" href="class_i_pv6_interface_data.html#a90da8f012bd443c75e6e742bcf6f7d38" title="Returns the ith advertised prefix on the interface.">getAdvPrefix</a>(y).<a class="code" href="struct_i_pv6_interface_data_1_1_adv_prefix.html#a8dbd979f7860762721b55d4793629258">prefix</a>,
                                                ie-&gt;<a class="code" href="class_interface_entry.html#a19083391271368e371346eb41ccc6c93">ipv6Data</a>()-&gt;<a class="code" href="class_i_pv6_interface_data.html#a90da8f012bd443c75e6e742bcf6f7d38" title="Returns the ith advertised prefix on the interface.">getAdvPrefix</a>(y).<a class="code" href="struct_i_pv6_interface_data_1_1_adv_prefix.html#a8e68016dcc5cb215199e7f61402f854b">prefixLength</a>,
                                                ie-&gt;<a class="code" href="class_interface_entry.html#adc901fa42c37ce16b5c0785da81106ce">getInterfaceId</a>(), 0);
        }
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a684fdefcfe46d118e158423c3f77fe22"></a><!-- doxytag: member="FlatNetworkConfigurator6::addStaticRoutes" ref="a684fdefcfe46d118e158423c3f77fe22" args="(cTopology &amp;topo)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="timer__queue_8h.html#a07640d68b3fdfaa5c48a36265e8f10b8">void</a> <a class="el" href="class_flat_network_configurator6.html#a684fdefcfe46d118e158423c3f77fe22">FlatNetworkConfigurator6::addStaticRoutes</a> </td>
          <td>(</td>
          <td class="paramtype">cTopology &amp;&#160;</td>
          <td class="paramname"><em>topo</em></td><td>)</td>
          <td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="class_flat_network_configurator6.html#a7384a5ea6158f37546987a6bdf32f9b0">initialize()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordtype">int</span> numIPNodes = 0;

    <span class="comment">// fill in routing tables</span>
    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; topo.getNumNodes(); i++)
    {
        cTopology::Node *destNode = topo.getNode(i);

        <span class="comment">// skip bus types</span>
        <span class="keywordflow">if</span> (!<a class="code" href="class_flat_network_configurator6.html#aedf7247f30e97c587d9e94069f59c3c4">isIPNode</a>(destNode))
            <span class="keywordflow">continue</span>;
<span class="comment">/*</span>
<span class="comment">    void addOrUpdateOwnAdvPrefix(const IPv6Address&amp; destPrefix, int prefixLength,</span>
<span class="comment">                                 int interfaceId, simtime_t expiryTime);</span>
<span class="comment">*/</span>

        numIPNodes++; <span class="comment">// FIXME split into num hosts, num routers</span>
        <a class="code" href="class_routing_table6.html" title="Represents the IPv6 routing table and neighbour discovery data structures.">RoutingTable6</a> *destRt = <a class="code" href="class_i_pv_x_address_resolver.html" title="Utility class for finding IPv4 or IPv6 address of a host or router.">IPvXAddressResolver</a>().<a class="code" href="class_i_pv_x_address_resolver.html#a3749a01070195e0db3125f2686863e71" title="The function tries to look up the RoutingTable6 module as submodule &quot;routingTable6&quot; or &quot;networkLayer...">routingTable6Of</a>(destNode-&gt;getModule());
        <a class="code" href="class_i_interface_table.html" title="A C++ interface to abstract the functionality of InterfaceTable.">IInterfaceTable</a> *destIft = <a class="code" href="class_i_pv_x_address_resolver.html" title="Utility class for finding IPv4 or IPv6 address of a host or router.">IPvXAddressResolver</a>().<a class="code" href="class_i_pv_x_address_resolver.html#aa337d4676aa162df6d46bb1301509434" title="The function tries to look up the IInterfaceTable module as submodule &quot;interfaceTable&quot; or &quot;networkLay...">interfaceTableOf</a>(destNode-&gt;getModule());

        <span class="comment">// don&#39;t add routes towards hosts</span>
        <span class="keywordflow">if</span> (!destRt-&gt;par(<span class="stringliteral">&quot;isRouter&quot;</span>).boolValue())
            <span class="keywordflow">continue</span>;

        <span class="comment">// get a list of globally routable prefixes from the dest node</span>
        std::vector&lt;const IPv6InterfaceData::AdvPrefix*&gt; destPrefixes;
        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> x = 0; x &lt; destIft-&gt;<a class="code" href="class_i_interface_table.html#a2b0ce46cd92da6f64fc363410dc71904" title="Returns the number of interfaces.">getNumInterfaces</a>(); x++)
        {
            <a class="code" href="class_interface_entry.html" title="Interface entry for the interface table in IInterfaceTable.">InterfaceEntry</a> *destIf = destIft-&gt;<a class="code" href="class_i_interface_table.html#a19ce4ca3b47b52b8e2b67c25806c4b49" title="Returns the InterfaceEntry specified by an index 0..numInterfaces-1.">getInterface</a>(x);

            <span class="keywordflow">if</span> (destIf-&gt;<a class="code" href="class_interface_entry.html#a0ee93e88273f61390d1293dae55004d1">isLoopback</a>())
                <span class="keywordflow">continue</span>;

            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> y = 0; y &lt; destIf-&gt;<a class="code" href="class_interface_entry.html#a19083391271368e371346eb41ccc6c93">ipv6Data</a>()-&gt;<a class="code" href="class_i_pv6_interface_data.html#a1d84187cfbe9e91f7af79927c813f61c" title="Returns the number of advertised prefixes on the interface.">getNumAdvPrefixes</a>(); y++)
                <span class="keywordflow">if</span> (destIf-&gt;<a class="code" href="class_interface_entry.html#a19083391271368e371346eb41ccc6c93">ipv6Data</a>()-&gt;<a class="code" href="class_i_pv6_interface_data.html#a90da8f012bd443c75e6e742bcf6f7d38" title="Returns the ith advertised prefix on the interface.">getAdvPrefix</a>(y).<a class="code" href="struct_i_pv6_interface_data_1_1_adv_prefix.html#a8dbd979f7860762721b55d4793629258">prefix</a>.<a class="code" href="class_i_pv6_address.html#aa2c2499a9e2ca1fd41b615d38654d8aa" title="Utility function based on getScope()">isGlobal</a>())
                    destPrefixes.push_back(&amp;destIf-&gt;<a class="code" href="class_interface_entry.html#a19083391271368e371346eb41ccc6c93">ipv6Data</a>()-&gt;<a class="code" href="class_i_pv6_interface_data.html#a90da8f012bd443c75e6e742bcf6f7d38" title="Returns the ith advertised prefix on the interface.">getAdvPrefix</a>(y));
        }

        std::string destModName = destNode-&gt;getModule()-&gt;getFullName();

        <span class="comment">// calculate shortest paths from everywhere towards destNode</span>
        topo.calculateUnweightedSingleShortestPathsTo(destNode);

        <span class="comment">// add route (with dest=destPrefixes) to every router routing table in the network</span>
        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; topo.getNumNodes(); j++)
        {
            <span class="keywordflow">if</span> (i == j)
                <span class="keywordflow">continue</span>;
            <span class="keywordflow">if</span> (!<a class="code" href="class_flat_network_configurator6.html#aedf7247f30e97c587d9e94069f59c3c4">isIPNode</a>(topo.getNode(j)))
                <span class="keywordflow">continue</span>;

            cTopology::Node *atNode = topo.getNode(j);
            <span class="keywordflow">if</span> (atNode-&gt;getNumPaths() == 0)
                <span class="keywordflow">continue</span>;       <span class="comment">// not connected</span>

            <a class="code" href="class_routing_table6.html" title="Represents the IPv6 routing table and neighbour discovery data structures.">RoutingTable6</a> *rt = <a class="code" href="class_i_pv_x_address_resolver.html" title="Utility class for finding IPv4 or IPv6 address of a host or router.">IPvXAddressResolver</a>().<a class="code" href="class_i_pv_x_address_resolver.html#a3749a01070195e0db3125f2686863e71" title="The function tries to look up the RoutingTable6 module as submodule &quot;routingTable6&quot; or &quot;networkLayer...">routingTable6Of</a>(atNode-&gt;getModule());
            <a class="code" href="class_i_interface_table.html" title="A C++ interface to abstract the functionality of InterfaceTable.">IInterfaceTable</a> *ift = <a class="code" href="class_i_pv_x_address_resolver.html" title="Utility class for finding IPv4 or IPv6 address of a host or router.">IPvXAddressResolver</a>().<a class="code" href="class_i_pv_x_address_resolver.html#aa337d4676aa162df6d46bb1301509434" title="The function tries to look up the IInterfaceTable module as submodule &quot;interfaceTable&quot; or &quot;networkLay...">interfaceTableOf</a>(atNode-&gt;getModule());

            <span class="comment">// skip hosts&#39; routing tables</span>
            <span class="keywordflow">if</span> (!rt-&gt;par(<span class="stringliteral">&quot;isRouter&quot;</span>).boolValue())
                <span class="keywordflow">continue</span>;

            <span class="comment">// determine the local interface id</span>
            cGate *localGate = atNode-&gt;getPath(0)-&gt;getLocalGate();
            <a class="code" href="class_interface_entry.html" title="Interface entry for the interface table in IInterfaceTable.">InterfaceEntry</a> *localIf = ift-&gt;<a class="code" href="class_i_interface_table.html#a31ab0c95a4bf741f1f8aa03e1cf76986" title="Returns an interface given by its getNodeOutputGateId().">getInterfaceByNodeOutputGateId</a>(localGate-&gt;getId());

            <span class="comment">// determine next hop link address. That&#39;s a bit tricky because</span>
            <span class="comment">// the directly adjacent cTopo node might be a non-IP getNode(ethernet switch etc)</span>
            <span class="comment">// so we have to &quot;seek through&quot; them.</span>
            cTopology::Node *prevNode = atNode;
            <span class="comment">// if there&#39;s no ethernet switch between atNode and it&#39;s next hop</span>
            <span class="comment">// neighbour, we don&#39;t go into the following while() loop</span>
            <span class="keywordflow">while</span> (!<a class="code" href="class_flat_network_configurator6.html#aedf7247f30e97c587d9e94069f59c3c4">isIPNode</a>(prevNode-&gt;getPath(0)-&gt;getRemoteNode()))
                prevNode = prevNode-&gt;getPath(0)-&gt;getRemoteNode();

            <span class="comment">// ok, the next hop is now just one step away from prevNode</span>
            cGate *remoteGate = prevNode-&gt;getPath(0)-&gt;getRemoteGate();
            cModule *nextHop = remoteGate-&gt;getOwnerModule();
            <a class="code" href="class_i_interface_table.html" title="A C++ interface to abstract the functionality of InterfaceTable.">IInterfaceTable</a> *nextHopIft = <a class="code" href="class_i_pv_x_address_resolver.html" title="Utility class for finding IPv4 or IPv6 address of a host or router.">IPvXAddressResolver</a>().<a class="code" href="class_i_pv_x_address_resolver.html#aa337d4676aa162df6d46bb1301509434" title="The function tries to look up the IInterfaceTable module as submodule &quot;interfaceTable&quot; or &quot;networkLay...">interfaceTableOf</a>(nextHop);
            <a class="code" href="class_interface_entry.html" title="Interface entry for the interface table in IInterfaceTable.">InterfaceEntry</a> *nextHopOnlinkIf = nextHopIft-&gt;<a class="code" href="class_i_interface_table.html#a60257f3b30cedc18a80835d5be8305d9" title="Returns an interface given by its getNodeInputGateId().">getInterfaceByNodeInputGateId</a>(remoteGate-&gt;getId());

            <span class="comment">// find link-local address for next hop</span>
            <a class="code" href="class_i_pv6_address.html" title="Stores a 128-bit IPv6 address in an efficient way.">IPv6Address</a> nextHopLinkLocalAddr = nextHopOnlinkIf-&gt;<a class="code" href="class_interface_entry.html#a19083391271368e371346eb41ccc6c93">ipv6Data</a>()-&gt;<a class="code" href="class_i_pv6_interface_data.html#a3b9fa2d8e186014cf9c758e45b5a56df" title="Returns the first valid link-local address of the interface, or UNSPECIFIED_ADDRESS if there&#39;s none...">getLinkLocalAddress</a>();

            <span class="comment">// traverse through address of each node</span>
            <span class="comment">// add to route table</span>
            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> k = 0; k &lt; destPrefixes.size(); k++)
            {
                rt-&gt;<a class="code" href="class_routing_table6.html#adf9413825a24ef26051d8a78539dec29" title="Creates a static route.">addStaticRoute</a>(destPrefixes[k]-&gt;prefix, destPrefixes[k]-&gt;prefixLength,
                                   localIf-&gt;<a class="code" href="class_interface_entry.html#adc901fa42c37ce16b5c0785da81106ce">getInterfaceId</a>(), nextHopLinkLocalAddr);
            }
        }
    }

    <span class="comment">// update display string</span>
    <a class="code" href="class_flat_network_configurator6.html#a75dc3f9363d2ee61dae93998034adcfa">setDisplayString</a>(numIPNodes, topo.getNumNodes()-numIPNodes);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a4b3401699c2735d6a42e36c3df86b010"></a><!-- doxytag: member="FlatNetworkConfigurator6::configureAdvPrefixes" ref="a4b3401699c2735d6a42e36c3df86b010" args="(cTopology &amp;topo)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="timer__queue_8h.html#a07640d68b3fdfaa5c48a36265e8f10b8">void</a> <a class="el" href="class_flat_network_configurator6.html#a4b3401699c2735d6a42e36c3df86b010">FlatNetworkConfigurator6::configureAdvPrefixes</a> </td>
          <td>(</td>
          <td class="paramtype">cTopology &amp;&#160;</td>
          <td class="paramname"><em>topo</em></td><td>)</td>
          <td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="class_flat_network_configurator6.html#a7384a5ea6158f37546987a6bdf32f9b0">initialize()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="comment">// assign advertised prefixes to all router interfaces</span>
    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; topo.getNumNodes(); i++)
    {
        <span class="comment">// skip bus types</span>
        <span class="keywordflow">if</span> (!<a class="code" href="class_flat_network_configurator6.html#aedf7247f30e97c587d9e94069f59c3c4">isIPNode</a>(topo.getNode(i)))
            <span class="keywordflow">continue</span>;

        <span class="keywordtype">int</span> nodeIndex = i;

        <span class="comment">// find interface table and assign address to all (non-loopback) interfaces</span>
        cModule *mod = topo.getNode(i)-&gt;getModule();
        <a class="code" href="class_i_interface_table.html" title="A C++ interface to abstract the functionality of InterfaceTable.">IInterfaceTable</a> *ift = <a class="code" href="class_i_pv_x_address_resolver.html" title="Utility class for finding IPv4 or IPv6 address of a host or router.">IPvXAddressResolver</a>().<a class="code" href="class_i_pv_x_address_resolver.html#aa337d4676aa162df6d46bb1301509434" title="The function tries to look up the IInterfaceTable module as submodule &quot;interfaceTable&quot; or &quot;networkLay...">interfaceTableOf</a>(mod);
        <a class="code" href="class_routing_table6.html" title="Represents the IPv6 routing table and neighbour discovery data structures.">RoutingTable6</a> *rt = <a class="code" href="class_i_pv_x_address_resolver.html" title="Utility class for finding IPv4 or IPv6 address of a host or router.">IPvXAddressResolver</a>().<a class="code" href="class_i_pv_x_address_resolver.html#a3749a01070195e0db3125f2686863e71" title="The function tries to look up the RoutingTable6 module as submodule &quot;routingTable6&quot; or &quot;networkLayer...">routingTable6Of</a>(mod);

        <span class="comment">// skip hosts</span>
        <span class="keywordflow">if</span> (!rt-&gt;par(<span class="stringliteral">&quot;isRouter&quot;</span>).boolValue())
            <span class="keywordflow">continue</span>;

        <span class="comment">// assign prefix to interfaces</span>
        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; ift-&gt;<a class="code" href="class_i_interface_table.html#a2b0ce46cd92da6f64fc363410dc71904" title="Returns the number of interfaces.">getNumInterfaces</a>(); k++)
        {
            <a class="code" href="class_interface_entry.html" title="Interface entry for the interface table in IInterfaceTable.">InterfaceEntry</a> *ie = ift-&gt;<a class="code" href="class_i_interface_table.html#a19ce4ca3b47b52b8e2b67c25806c4b49" title="Returns the InterfaceEntry specified by an index 0..numInterfaces-1.">getInterface</a>(k);
            <span class="keywordflow">if</span> (!ie-&gt;<a class="code" href="class_interface_entry.html#a19083391271368e371346eb41ccc6c93">ipv6Data</a>() || ie-&gt;<a class="code" href="class_interface_entry.html#a0ee93e88273f61390d1293dae55004d1">isLoopback</a>())
                <span class="keywordflow">continue</span>;
            <span class="keywordflow">if</span> (ie-&gt;<a class="code" href="class_interface_entry.html#a19083391271368e371346eb41ccc6c93">ipv6Data</a>()-&gt;<a class="code" href="class_i_pv6_interface_data.html#a1d84187cfbe9e91f7af79927c813f61c" title="Returns the number of advertised prefixes on the interface.">getNumAdvPrefixes</a>()&gt;0)
                <span class="keywordflow">continue</span>;  <span class="comment">// already has one</span>

            <span class="comment">// add a prefix</span>
            <a class="code" href="class_i_pv6_address.html" title="Stores a 128-bit IPv6 address in an efficient way.">IPv6Address</a> prefix(0xaaaa0000+nodeIndex, ie-&gt;<a class="code" href="class_interface_entry.html#a315657b6b5281241a69bed8e1171ef6f">getNetworkLayerGateIndex</a>()&lt;&lt;16, 0, 0);
            ASSERT(prefix.isGlobal());

            <a class="code" href="struct_i_pv6_interface_data_1_1_adv_prefix.html" title="For routers: advertised prefix configuration.">IPv6InterfaceData::AdvPrefix</a> p;
            p.<a class="code" href="struct_i_pv6_interface_data_1_1_adv_prefix.html#a8dbd979f7860762721b55d4793629258">prefix</a> = prefix;
            p.prefixLength = 64;
            <span class="comment">// RFC 2461:6.2.1. Only default values are used in FlatNetworkConfigurator6</span>
            <span class="comment">// Default: 2592000 seconds (30 days), fixed (i.e., stays the same in</span>
            <span class="comment">// consecutive advertisements).</span>
            p.advValidLifetime = 2592000;
            <span class="comment">// Default: TRUE</span>
            p.advOnLinkFlag = <span class="keyword">true</span>;
            <span class="comment">// Default: 604800 seconds (7 days), fixed (i.e., stays the same in consecutive</span>
            <span class="comment">// advertisements).</span>
            p.advPreferredLifetime = 604800;
            <span class="comment">// Default: TRUE</span>
            p.advAutonomousFlag = <span class="keyword">true</span>;
            ie-&gt;<a class="code" href="class_interface_entry.html#a19083391271368e371346eb41ccc6c93">ipv6Data</a>()-&gt;<a class="code" href="class_i_pv6_interface_data.html#ac746c3ceb962985e4b6fb17364294e46" title="Adds the given advertised prefix to the interface.">addAdvPrefix</a>(p);

            <span class="comment">// add a link-local address (tentative) if it doesn&#39;t have one</span>
            <span class="keywordflow">if</span> (ie-&gt;<a class="code" href="class_interface_entry.html#a19083391271368e371346eb41ccc6c93">ipv6Data</a>()-&gt;<a class="code" href="class_i_pv6_interface_data.html#a3b9fa2d8e186014cf9c758e45b5a56df" title="Returns the first valid link-local address of the interface, or UNSPECIFIED_ADDRESS if there&#39;s none...">getLinkLocalAddress</a>().<a class="code" href="class_i_pv6_address.html#af526cffcc3a4aa5bb96d307de6e8d448" title="Check if the IPv6 Address is undefined.">isUnspecified</a>())
                ie-&gt;<a class="code" href="class_interface_entry.html#a19083391271368e371346eb41ccc6c93">ipv6Data</a>()-&gt;<a class="code" href="class_i_pv6_interface_data.html#a715b339dc41612149940ed0607af1535" title="Assigns the given address to the interface.">assignAddress</a>(<a class="code" href="class_i_pv6_address.html#aa8a3ef9e930a6703ea9cbde5a3ecaaca" title="Forms a link-local address using the given interface identifier.">IPv6Address::formLinkLocalAddress</a>(ie-&gt;<a class="code" href="class_interface_entry.html#a1196c8e3f1a10a26778296af4c14a4bb">getInterfaceToken</a>()), <span class="keyword">true</span>, 0, 0);
        }
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a77ac0593d710a8dc41f3cfc23f6236b7"></a><!-- doxytag: member="FlatNetworkConfigurator6::handleMessage" ref="a77ac0593d710a8dc41f3cfc23f6236b7" args="(cMessage *msg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="timer__queue_8h.html#a07640d68b3fdfaa5c48a36265e8f10b8">void</a> <a class="el" href="class_flat_network_configurator6.html#a77ac0593d710a8dc41f3cfc23f6236b7">FlatNetworkConfigurator6::handleMessage</a> </td>
          <td>(</td>
          <td class="paramtype">cMessage *&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<div class="fragment"><pre class="fragment">{
    error(<span class="stringliteral">&quot;this module doesn&#39;t handle messages, it runs only in initialize()&quot;</span>);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a7384a5ea6158f37546987a6bdf32f9b0"></a><!-- doxytag: member="FlatNetworkConfigurator6::initialize" ref="a7384a5ea6158f37546987a6bdf32f9b0" args="(int stage)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="timer__queue_8h.html#a07640d68b3fdfaa5c48a36265e8f10b8">void</a> <a class="el" href="class_flat_network_configurator6.html#a7384a5ea6158f37546987a6bdf32f9b0">FlatNetworkConfigurator6::initialize</a> </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>stage</em></td><td>)</td>
          <td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<div class="fragment"><pre class="fragment">{
    <span class="comment">// FIXME refactor: make routers[] array? (std::vector&lt;cTopology::Node*&gt;)</span>
    <span class="comment">// FIXME: spare common beginning for all stages?</span>

    cTopology topo(<span class="stringliteral">&quot;topo&quot;</span>);

    <span class="comment">// extract topology</span>
    topo.extractByProperty(<span class="stringliteral">&quot;node&quot;</span>);
    <a class="code" href="_i_n_e_t_defs_8h.html#a650ef3eff8a2900bef69dae29c05d2dd">EV</a> &lt;&lt; <span class="stringliteral">&quot;cTopology found &quot;</span> &lt;&lt; topo.getNumNodes() &lt;&lt; <span class="stringliteral">&quot; nodes\n&quot;</span>;

    <span class="keywordflow">if</span> (stage==2)
    {
        <a class="code" href="class_flat_network_configurator6.html#a4b3401699c2735d6a42e36c3df86b010">configureAdvPrefixes</a>(topo);
    }
    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (stage==3)
    {
        <a class="code" href="class_flat_network_configurator6.html#aa4e9be7807116b4b03193292cefa7368">addOwnAdvPrefixRoutes</a>(topo);
        <a class="code" href="class_flat_network_configurator6.html#a684fdefcfe46d118e158423c3f77fe22">addStaticRoutes</a>(topo);
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="aedf7247f30e97c587d9e94069f59c3c4"></a><!-- doxytag: member="FlatNetworkConfigurator6::isIPNode" ref="aedf7247f30e97c587d9e94069f59c3c4" args="(cTopology::Node *node)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="class_flat_network_configurator6.html#aedf7247f30e97c587d9e94069f59c3c4">FlatNetworkConfigurator6::isIPNode</a> </td>
          <td>(</td>
          <td class="paramtype">cTopology::Node *&#160;</td>
          <td class="paramname"><em>node</em></td><td>)</td>
          <td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="class_flat_network_configurator6.html#aa4e9be7807116b4b03193292cefa7368">addOwnAdvPrefixRoutes()</a>, <a class="el" href="class_flat_network_configurator6.html#a684fdefcfe46d118e158423c3f77fe22">addStaticRoutes()</a>, and <a class="el" href="class_flat_network_configurator6.html#a4b3401699c2735d6a42e36c3df86b010">configureAdvPrefixes()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordflow">return</span> <a class="code" href="class_i_pv_x_address_resolver.html" title="Utility class for finding IPv4 or IPv6 address of a host or router.">IPvXAddressResolver</a>().<a class="code" href="class_i_pv_x_address_resolver.html#acad4a90fa5ec58546e88fb8ee3aeb37b" title="Like interfaceTableOf(), but doesn&#39;t throw error if not found.">findInterfaceTableOf</a>(node-&gt;getModule()) != <a class="code" href="def_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a2f5695e02c3283882731e5b252d1192d"></a><!-- doxytag: member="FlatNetworkConfigurator6::numInitStages" ref="a2f5695e02c3283882731e5b252d1192d" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual int <a class="el" href="class_flat_network_configurator6.html#a2f5695e02c3283882731e5b252d1192d">FlatNetworkConfigurator6::numInitStages</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [inline, protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<div class="fragment"><pre class="fragment">{<span class="keywordflow">return</span> 4;}
</pre></div>
</div>
</div>
<a class="anchor" id="a75dc3f9363d2ee61dae93998034adcfa"></a><!-- doxytag: member="FlatNetworkConfigurator6::setDisplayString" ref="a75dc3f9363d2ee61dae93998034adcfa" args="(int numIPNodes, int numNonIPNodes)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="timer__queue_8h.html#a07640d68b3fdfaa5c48a36265e8f10b8">void</a> <a class="el" href="class_flat_network_configurator6.html#a75dc3f9363d2ee61dae93998034adcfa">FlatNetworkConfigurator6::setDisplayString</a> </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>numIPNodes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>numNonIPNodes</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="class_flat_network_configurator6.html#a684fdefcfe46d118e158423c3f77fe22">addStaticRoutes()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="comment">// update display string</span>
    <span class="keywordtype">char</span> buf[80];
    sprintf(buf, <span class="stringliteral">&quot;%d IPv6 nodes\n%d non-IP nodes&quot;</span>, numIPNodes, numNonIPNodes);
    getDisplayString().setTagArg(<span class="stringliteral">&quot;t&quot;</span>, 0, buf);
}
</pre></div>
</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="_flat_network_configurator6_8h.html">FlatNetworkConfigurator6.h</a></li>
<li><a class="el" href="_flat_network_configurator6_8cc.html">FlatNetworkConfigurator6.cc</a></li>
</ul>
</div><!-- contents -->
</div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="class_flat_network_configurator6.html">FlatNetworkConfigurator6</a>      </li>

    <li class="footer">Generated on Tue Aug 7 2012 16:01:24 for INET Framework for OMNeT++/OMNEST by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.6.1 </li>
   </ul>
 </div>


</body>
</html>
