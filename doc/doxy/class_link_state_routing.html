<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>INET Framework for OMNeT++/OMNEST: LinkStateRouting Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript">
$(document).ready(initResizable);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">INET Framework for OMNeT++/OMNEST</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('class_link_state_routing.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a>  </div>
  <div class="headertitle">
<div class="title">LinkStateRouting Class Reference</div>  </div>
</div>
<div class="contents">
<!-- doxytag: class="LinkStateRouting" --><!-- doxytag: inherits="INotifiable" -->
<p><code>#include &lt;LinkStateRouting.h&gt;</code></p>
<div class="dynheader">
Inheritance diagram for LinkStateRouting:</div>
<div class="dyncontent">
 <div class="center">
  <img src="class_link_state_routing.png" usemap="#LinkStateRouting_map" alt=""/>
  <map id="LinkStateRouting_map" name="LinkStateRouting_map">
<area href="class_i_notifiable.html" alt="INotifiable" shape="rect" coords="0,0,105,24"/>
</map>
 </div></div>

<p><a href="class_link_state_routing-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_link_state_routing.html#aeb64ae785f533259fd8da162400b2ad7">LinkStateRouting</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_link_state_routing.html#ae5d2a91a4ec28e5f75a17a1de6804716">~LinkStateRouting</a> ()</td></tr>
<tr><td colspan="2"><h2><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_link_state_routing.html#a0271766286d9fb98a38ee53c6eee8be3">initialize</a> (int stage)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_link_state_routing.html#a8486f04ef005b1ec004b0418db4fc9d2">numInitStages</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_link_state_routing.html#adcd65572bd812c97222dfd25dc9de1a9">handleMessage</a> (cMessage *msg)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_link_state_routing.html#a9326b19a88da1ba1af639fe6a820fb36">processLINK_STATE_MESSAGE</a> (LinkStateMsg *msg, <a class="el" href="class_i_p_address.html">IPAddress</a> sender)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_link_state_routing.html#a4192929ab1fa083342047b67401d3006">receiveChangeNotification</a> (int category, const cPolymorphic *details)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_link_state_routing.html#abe98db23137657d430814f3dbaadfe91">sendToPeers</a> (const std::vector&lt; TELinkStateInfo &gt; &amp;list, bool req, <a class="el" href="class_i_p_address.html">IPAddress</a> exceptPeer)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_link_state_routing.html#a76bb6a317013baecf987bcfafa1aec90">sendToPeer</a> (<a class="el" href="class_i_p_address.html">IPAddress</a> peer, const std::vector&lt; TELinkStateInfo &gt; &amp;list, bool req)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_link_state_routing.html#a82cb1475d7be4ebdb12e22f4a98e4db5">sendToIP</a> (LinkStateMsg *msg, <a class="el" href="class_i_p_address.html">IPAddress</a> destAddr)</td></tr>
<tr><td colspan="2"><h2><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_t_e_d.html">TED</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_link_state_routing.html#ab491ddada5bdd6864e72e5b86f883b39">tedmod</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">cMessage *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_link_state_routing.html#a039b54b4e936d3c3279e3f67ef996b80">announceMsg</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_i_p_address.html">IPAddress</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_link_state_routing.html#ad5deb130d86431a6aafd04836f9f7fd6">routerId</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">IPAddressVector&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_link_state_routing.html#aa33c276e3e041c1b357a2b8542f1ab5f">peerIfAddrs</a></td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>Implements a minimalistic link state routing protocol that employs flooding. Flooding works like this:</p>
<p>When a router receives a link state packet, it merges the packet contents into its own link state database (ted). If the packet contained new information (ted got updated), the router broadcasts the ted contents to all its other neighbours; otherwise (when the packet didn't contain any new info), nothing happens.</p>
<p>Also: when the announceMsg timer expires, <a class="el" href="class_link_state_routing.html">LinkStateRouting</a> sends out an initial link state message. (Currently this happens only once, at the beginning of the simulation). The "request" bit in the message is set then, asking neighbours to send back their link state databases. (FIXME why's this? redundant messaging: same msg is often sent twice: both as reply and as voluntary "announce").</p>
<p>TODO discover peers by "hello". Peers are those from which the router has received a Hello in the last X seconds. Link info to all peers are maintained; links to ex-peers (those haven't heard of for more than X seconds) are assumed to be down.</p>
<p>See NED file for more info. </p>
</div><hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="aeb64ae785f533259fd8da162400b2ad7"></a><!-- doxytag: member="LinkStateRouting::LinkStateRouting" ref="aeb64ae785f533259fd8da162400b2ad7" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">LinkStateRouting::LinkStateRouting </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<div class="fragment"><pre class="fragment">{
    <a class="code" href="class_link_state_routing.html#a039b54b4e936d3c3279e3f67ef996b80">announceMsg</a> = NULL;
}
</pre></div>
</div>
</div>
<a class="anchor" id="ae5d2a91a4ec28e5f75a17a1de6804716"></a><!-- doxytag: member="LinkStateRouting::~LinkStateRouting" ref="ae5d2a91a4ec28e5f75a17a1de6804716" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">LinkStateRouting::~LinkStateRouting </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<div class="fragment"><pre class="fragment">{
    cancelAndDelete(<a class="code" href="class_link_state_routing.html#a039b54b4e936d3c3279e3f67ef996b80">announceMsg</a>);
}
</pre></div>
</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="adcd65572bd812c97222dfd25dc9de1a9"></a><!-- doxytag: member="LinkStateRouting::handleMessage" ref="adcd65572bd812c97222dfd25dc9de1a9" args="(cMessage *msg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void LinkStateRouting::handleMessage </td>
          <td>(</td>
          <td class="paramtype">cMessage *&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<div class="fragment"><pre class="fragment">{
    <span class="keywordflow">if</span> (msg == <a class="code" href="class_link_state_routing.html#a039b54b4e936d3c3279e3f67ef996b80">announceMsg</a>)
    {
        <span class="keyword">delete</span> <a class="code" href="class_link_state_routing.html#a039b54b4e936d3c3279e3f67ef996b80">announceMsg</a>;
        <a class="code" href="class_link_state_routing.html#a039b54b4e936d3c3279e3f67ef996b80">announceMsg</a> = NULL;
        <a class="code" href="class_link_state_routing.html#abe98db23137657d430814f3dbaadfe91">sendToPeers</a>(<a class="code" href="class_link_state_routing.html#ab491ddada5bdd6864e72e5b86f883b39">tedmod</a>-&gt;<a class="code" href="class_t_e_d.html#a8ab5c356644784262be0ae484395441e">ted</a>, <span class="keyword">true</span>, <a class="code" href="class_i_p_address.html">IPAddress</a>());
    }
    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(msg-&gt;getArrivalGate()-&gt;getName(), <span class="stringliteral">&quot;ipIn&quot;</span>))
    {
        <a class="code" href="_i_n_e_t_defs_8h.html#a650ef3eff8a2900bef69dae29c05d2dd">EV</a> &lt;&lt; <span class="stringliteral">&quot;Processing message from IP: &quot;</span> &lt;&lt; msg &lt;&lt; endl;
        <a class="code" href="class_i_p_control_info.html">IPControlInfo</a> *controlInfo = check_and_cast&lt;<a class="code" href="class_i_p_control_info.html">IPControlInfo</a> *&gt;(msg-&gt;getControlInfo());
        <a class="code" href="class_i_p_address.html">IPAddress</a> sender = controlInfo-&gt;getSrcAddr();
        <a class="code" href="class_link_state_routing.html#a9326b19a88da1ba1af639fe6a820fb36">processLINK_STATE_MESSAGE</a>(check_and_cast&lt;LinkStateMsg*&gt;(msg), sender);
    }
    <span class="keywordflow">else</span>
        ASSERT(<span class="keyword">false</span>);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a0271766286d9fb98a38ee53c6eee8be3"></a><!-- doxytag: member="LinkStateRouting::initialize" ref="a0271766286d9fb98a38ee53c6eee8be3" args="(int stage)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void LinkStateRouting::initialize </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>stage</em></td><td>)</td>
          <td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<div class="fragment"><pre class="fragment">{
    <span class="comment">// we have to wait until routerId gets assigned in stage 3</span>
    <span class="keywordflow">if</span> (stage==4)
    {
        <a class="code" href="class_link_state_routing.html#ab491ddada5bdd6864e72e5b86f883b39">tedmod</a> = <a class="code" href="class_t_e_d_access.html">TEDAccess</a>().<a class="code" href="class_module_access.html#a44956ddb52973612afbba0eeecf8bb66">get</a>();

        <a class="code" href="class_i_routing_table.html">IRoutingTable</a> *rt = <a class="code" href="class_routing_table_access.html">RoutingTableAccess</a>().<a class="code" href="class_module_access.html#a44956ddb52973612afbba0eeecf8bb66">get</a>();
        <a class="code" href="class_link_state_routing.html#ad5deb130d86431a6aafd04836f9f7fd6">routerId</a> = rt-&gt;<a class="code" href="class_i_routing_table.html#a64a9a5b1414f4da0b7b0a3e079091f62">getRouterId</a>();

        <span class="comment">// listen for TED modifications</span>
        <a class="code" href="class_notification_board.html">NotificationBoard</a> *nb = <a class="code" href="class_notification_board_access.html">NotificationBoardAccess</a>().<a class="code" href="class_module_access.html#a44956ddb52973612afbba0eeecf8bb66">get</a>();
        nb-&gt;<a class="code" href="class_notification_board.html#aeb02a282e6c807c1cb064a28e8409ff2">subscribe</a>(<span class="keyword">this</span>, <a class="code" href="_notifier_consts_8h.html#a06fc87d81c62e9abb8790b6e5713c55ba8434e8b760269c6f9680f8fdb45b8a2c">NF_TED_CHANGED</a>);

        <span class="comment">// peers are given as interface names in the &quot;peers&quot; module parameter;</span>
        <span class="comment">// store corresponding interface addresses in peerIfAddrs[]</span>
        cStringTokenizer tokenizer(par(<span class="stringliteral">&quot;peers&quot;</span>));
        <a class="code" href="class_i_interface_table.html">IInterfaceTable</a> *ift = <a class="code" href="class_interface_table_access.html">InterfaceTableAccess</a>().<a class="code" href="class_module_access.html#a44956ddb52973612afbba0eeecf8bb66">get</a>();
        <span class="keyword">const</span> <span class="keywordtype">char</span> *token;
        <span class="keywordflow">while</span> ((token = tokenizer.nextToken())!=NULL)
        {
            ASSERT(ift-&gt;<a class="code" href="class_i_interface_table.html#a8ad86ee823d6200b4f558383b39af658">getInterfaceByName</a>(token));
            <a class="code" href="class_link_state_routing.html#aa33c276e3e041c1b357a2b8542f1ab5f">peerIfAddrs</a>.push_back(ift-&gt;<a class="code" href="class_i_interface_table.html#a8ad86ee823d6200b4f558383b39af658">getInterfaceByName</a>(token)-&gt;<a class="code" href="class_interface_entry.html#ad47857e772397cc2d00de3a8cf464993">ipv4Data</a>()-&gt;<a class="code" href="class_i_pv4_interface_data.html#aec8ebefd03acad479ac89d31d7228331">getIPAddress</a>());
        }

        <span class="comment">// schedule start of flooding link state info</span>
        <a class="code" href="class_link_state_routing.html#a039b54b4e936d3c3279e3f67ef996b80">announceMsg</a> = <span class="keyword">new</span> cMessage(<span class="stringliteral">&quot;announce&quot;</span>);
        scheduleAt(simTime() + exponential(0.01), <a class="code" href="class_link_state_routing.html#a039b54b4e936d3c3279e3f67ef996b80">announceMsg</a>);
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a8486f04ef005b1ec004b0418db4fc9d2"></a><!-- doxytag: member="LinkStateRouting::numInitStages" ref="a8486f04ef005b1ec004b0418db4fc9d2" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual int LinkStateRouting::numInitStages </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [inline, protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<div class="fragment"><pre class="fragment">{<span class="keywordflow">return</span> 5;}
</pre></div>
</div>
</div>
<a class="anchor" id="a9326b19a88da1ba1af639fe6a820fb36"></a><!-- doxytag: member="LinkStateRouting::processLINK_STATE_MESSAGE" ref="a9326b19a88da1ba1af639fe6a820fb36" args="(LinkStateMsg *msg, IPAddress sender)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void LinkStateRouting::processLINK_STATE_MESSAGE </td>
          <td>(</td>
          <td class="paramtype">LinkStateMsg *&#160;</td>
          <td class="paramname"><em>msg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_i_p_address.html">IPAddress</a>&#160;</td>
          <td class="paramname"><em>sender</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="class_link_state_routing.html#adcd65572bd812c97222dfd25dc9de1a9">handleMessage()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="_i_n_e_t_defs_8h.html#a650ef3eff8a2900bef69dae29c05d2dd">EV</a> &lt;&lt; <span class="stringliteral">&quot;received LINK_STATE message from &quot;</span> &lt;&lt; sender &lt;&lt; endl;

    TELinkStateInfoVector forward;

    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n = msg-&gt;getLinkInfoArraySize();

    <span class="keywordtype">bool</span> change = <span class="keyword">false</span>; <span class="comment">// in topology</span>

    <span class="comment">// loop through every link in the message</span>
    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; n; i++)
    {
        <span class="keyword">const</span> TELinkStateInfo&amp; link = msg-&gt;getLinkInfo(i);

        TELinkStateInfo *match;

        <span class="comment">// process link if we haven&#39;t seen this already and timestamp is newer</span>
        <span class="keywordflow">if</span>(<a class="code" href="class_link_state_routing.html#ab491ddada5bdd6864e72e5b86f883b39">tedmod</a>-&gt;<a class="code" href="class_t_e_d.html#a52fe287c977d8dc0b17744f446d42211">checkLinkValidity</a>(link, match))
        {
            ASSERT(link.sourceId == link.advrouter.getInt());

            <a class="code" href="_i_n_e_t_defs_8h.html#a650ef3eff8a2900bef69dae29c05d2dd">EV</a> &lt;&lt; <span class="stringliteral">&quot;new information found&quot;</span> &lt;&lt; endl;

            <span class="keywordflow">if</span>(!match)
            {
                <span class="comment">// and we have no info on this link so far, store it as it is</span>
                <a class="code" href="class_link_state_routing.html#ab491ddada5bdd6864e72e5b86f883b39">tedmod</a>-&gt;<a class="code" href="class_t_e_d.html#a8ab5c356644784262be0ae484395441e">ted</a>.push_back(link);
                change = <span class="keyword">true</span>;
            }
            <span class="keywordflow">else</span>
            {
                <span class="comment">// copy over the information from it</span>
                <span class="keywordflow">if</span>(match-&gt;state != link.state)
                {
                    match-&gt;state = link.state;
                    change = <span class="keyword">true</span>;
                }
                match-&gt;messageId = link.messageId;
                match-&gt;sourceId = link.sourceId;
                match-&gt;timestamp = link.timestamp;
                <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; 8; i++)
                    match-&gt;UnResvBandwidth[i] = link.UnResvBandwidth[i];
                match-&gt;MaxBandwidth = link.MaxBandwidth;
                match-&gt;metric = link.metric;
            }

            forward.push_back(link);
        }
    }

    <span class="keywordflow">if</span>(change)
        <a class="code" href="class_link_state_routing.html#ab491ddada5bdd6864e72e5b86f883b39">tedmod</a>-&gt;<a class="code" href="class_t_e_d.html#a20dbae0b12fb78bc9771eba4e11f0edc">rebuildRoutingTable</a>();

    <span class="keywordflow">if</span>(msg-&gt;getRequest())
    {
        <a class="code" href="class_link_state_routing.html#a76bb6a317013baecf987bcfafa1aec90">sendToPeer</a>(sender, <a class="code" href="class_link_state_routing.html#ab491ddada5bdd6864e72e5b86f883b39">tedmod</a>-&gt;<a class="code" href="class_t_e_d.html#a8ab5c356644784262be0ae484395441e">ted</a>, <span class="keyword">false</span>);
    }

    <span class="keywordflow">if</span>(forward.size() &gt; 0)
    {
        <a class="code" href="class_link_state_routing.html#abe98db23137657d430814f3dbaadfe91">sendToPeers</a>(forward, <span class="keyword">false</span>, sender);
    }

    <span class="keyword">delete</span> msg;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a4192929ab1fa083342047b67401d3006"></a><!-- doxytag: member="LinkStateRouting::receiveChangeNotification" ref="a4192929ab1fa083342047b67401d3006" args="(int category, const cPolymorphic *details)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void LinkStateRouting::receiveChangeNotification </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>category</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const cPolymorphic *&#160;</td>
          <td class="paramname"><em>details</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Called by the <a class="el" href="class_notification_board.html">NotificationBoard</a> whenever a change of a category occurs to which this client has subscribed. </p>

<p>Implements <a class="el" href="class_i_notifiable.html#a67d757190e1128eaec8f0a8e51ed38f6">INotifiable</a>.</p>
<div class="fragment"><pre class="fragment">{
    Enter_Method_Silent();
    <a class="code" href="_notifier_consts_8cc.html#a68fd4b933fae636048bb9ee52fd922e5">printNotificationBanner</a>(category, details);

    ASSERT(category == <a class="code" href="_notifier_consts_8h.html#a06fc87d81c62e9abb8790b6e5713c55ba8434e8b760269c6f9680f8fdb45b8a2c">NF_TED_CHANGED</a>);

    <a class="code" href="_i_n_e_t_defs_8h.html#a650ef3eff8a2900bef69dae29c05d2dd">EV</a> &lt;&lt; <span class="stringliteral">&quot;TED changed\n&quot;</span>;

    TEDChangeInfo *d = check_and_cast&lt;TEDChangeInfo *&gt;(details);

    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> k = d-&gt;getTedLinkIndicesArraySize();

    ASSERT(k &gt; 0);

    <span class="comment">// build linkinfo list</span>
    std::vector&lt;TELinkStateInfo&gt; links;
    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; k; i++)
    {
        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> index = d-&gt;getTedLinkIndices(i);

        <a class="code" href="class_link_state_routing.html#ab491ddada5bdd6864e72e5b86f883b39">tedmod</a>-&gt;<a class="code" href="class_t_e_d.html#a37fa2a3c4c66ae13c8af636b1483bc5d">updateTimestamp</a>(&amp;<a class="code" href="class_link_state_routing.html#ab491ddada5bdd6864e72e5b86f883b39">tedmod</a>-&gt;<a class="code" href="class_t_e_d.html#a8ab5c356644784262be0ae484395441e">ted</a>[index]);
        links.push_back(<a class="code" href="class_link_state_routing.html#ab491ddada5bdd6864e72e5b86f883b39">tedmod</a>-&gt;<a class="code" href="class_t_e_d.html#a8ab5c356644784262be0ae484395441e">ted</a>[index]);
    }

    <a class="code" href="class_link_state_routing.html#abe98db23137657d430814f3dbaadfe91">sendToPeers</a>(links, <span class="keyword">false</span>, <a class="code" href="class_i_p_address.html">IPAddress</a>());
}
</pre></div>
</div>
</div>
<a class="anchor" id="a82cb1475d7be4ebdb12e22f4a98e4db5"></a><!-- doxytag: member="LinkStateRouting::sendToIP" ref="a82cb1475d7be4ebdb12e22f4a98e4db5" args="(LinkStateMsg *msg, IPAddress destAddr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void LinkStateRouting::sendToIP </td>
          <td>(</td>
          <td class="paramtype">LinkStateMsg *&#160;</td>
          <td class="paramname"><em>msg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_i_p_address.html">IPAddress</a>&#160;</td>
          <td class="paramname"><em>destAddr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="class_link_state_routing.html#a76bb6a317013baecf987bcfafa1aec90">sendToPeer()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="comment">// attach control info to packet</span>
    <a class="code" href="class_i_p_control_info.html">IPControlInfo</a> *controlInfo = <span class="keyword">new</span> <a class="code" href="class_i_p_control_info.html">IPControlInfo</a>();
    controlInfo-&gt;setDestAddr(destAddr);
    controlInfo-&gt;setSrcAddr(<a class="code" href="class_link_state_routing.html#ad5deb130d86431a6aafd04836f9f7fd6">routerId</a>);
    controlInfo-&gt;setProtocol(IP_PROT_OSPF);
    msg-&gt;setControlInfo(controlInfo);

    <span class="keywordtype">int</span> length = msg-&gt;getLinkInfoArraySize() * 72;
    msg-&gt;setByteLength(length);

    msg-&gt;addPar(<span class="stringliteral">&quot;color&quot;</span>) = <a class="code" href="_link_state_routing_8h.html#a98a84a9e67f96e70fba99f2b8a1c120a">TED_TRAFFIC</a>;

    send(msg, <span class="stringliteral">&quot;ipOut&quot;</span>);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a76bb6a317013baecf987bcfafa1aec90"></a><!-- doxytag: member="LinkStateRouting::sendToPeer" ref="a76bb6a317013baecf987bcfafa1aec90" args="(IPAddress peer, const std::vector&lt; TELinkStateInfo &gt; &amp;list, bool req)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void LinkStateRouting::sendToPeer </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_i_p_address.html">IPAddress</a>&#160;</td>
          <td class="paramname"><em>peer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; TELinkStateInfo &gt; &amp;&#160;</td>
          <td class="paramname"><em>list</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>req</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="class_link_state_routing.html#a9326b19a88da1ba1af639fe6a820fb36">processLINK_STATE_MESSAGE()</a>, and <a class="el" href="class_link_state_routing.html#abe98db23137657d430814f3dbaadfe91">sendToPeers()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="_i_n_e_t_defs_8h.html#a650ef3eff8a2900bef69dae29c05d2dd">EV</a> &lt;&lt; <span class="stringliteral">&quot;sending LINK_STATE message to &quot;</span> &lt;&lt; peer &lt;&lt; endl;

    LinkStateMsg *out = <span class="keyword">new</span> LinkStateMsg(<span class="stringliteral">&quot;link state&quot;</span>);

    out-&gt;setLinkInfoArraySize(list.size());
    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; list.size(); j++)
        out-&gt;setLinkInfo(j, list[j]);

    out-&gt;setRequest(req);

    <a class="code" href="class_link_state_routing.html#a82cb1475d7be4ebdb12e22f4a98e4db5">sendToIP</a>(out, peer);
}
</pre></div>
</div>
</div>
<a class="anchor" id="abe98db23137657d430814f3dbaadfe91"></a><!-- doxytag: member="LinkStateRouting::sendToPeers" ref="abe98db23137657d430814f3dbaadfe91" args="(const std::vector&lt; TELinkStateInfo &gt; &amp;list, bool req, IPAddress exceptPeer)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void LinkStateRouting::sendToPeers </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; TELinkStateInfo &gt; &amp;&#160;</td>
          <td class="paramname"><em>list</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>req</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_i_p_address.html">IPAddress</a>&#160;</td>
          <td class="paramname"><em>exceptPeer</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="class_link_state_routing.html#adcd65572bd812c97222dfd25dc9de1a9">handleMessage()</a>, <a class="el" href="class_link_state_routing.html#a9326b19a88da1ba1af639fe6a820fb36">processLINK_STATE_MESSAGE()</a>, and <a class="el" href="class_link_state_routing.html#a4192929ab1fa083342047b67401d3006">receiveChangeNotification()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="_i_n_e_t_defs_8h.html#a650ef3eff8a2900bef69dae29c05d2dd">EV</a> &lt;&lt; <span class="stringliteral">&quot;sending LINK_STATE message to peers&quot;</span> &lt;&lt; endl;

    <span class="comment">// send &quot;list&quot; to every peer (linkid in our ted[] entries???) in a LinkStateMsg</span>
    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="class_link_state_routing.html#ab491ddada5bdd6864e72e5b86f883b39">tedmod</a>-&gt;<a class="code" href="class_t_e_d.html#a8ab5c356644784262be0ae484395441e">ted</a>.size(); i++)
    {
        <span class="keywordflow">if</span>(<a class="code" href="class_link_state_routing.html#ab491ddada5bdd6864e72e5b86f883b39">tedmod</a>-&gt;<a class="code" href="class_t_e_d.html#a8ab5c356644784262be0ae484395441e">ted</a>[i].advrouter != <a class="code" href="class_link_state_routing.html#ad5deb130d86431a6aafd04836f9f7fd6">routerId</a>)
            <span class="keywordflow">continue</span>;

        <span class="keywordflow">if</span>(<a class="code" href="class_link_state_routing.html#ab491ddada5bdd6864e72e5b86f883b39">tedmod</a>-&gt;<a class="code" href="class_t_e_d.html#a8ab5c356644784262be0ae484395441e">ted</a>[i].linkid == exceptPeer)
            <span class="keywordflow">continue</span>;

        <span class="keywordflow">if</span>(!<a class="code" href="class_link_state_routing.html#ab491ddada5bdd6864e72e5b86f883b39">tedmod</a>-&gt;<a class="code" href="class_t_e_d.html#a8ab5c356644784262be0ae484395441e">ted</a>[i].state)
            <span class="keywordflow">continue</span>;

        <span class="keywordflow">if</span>(<a class="code" href="_utils_8cc.html#a33bdc8b2583dcc9d2a8bfe1ec578352d">find</a>(<a class="code" href="class_link_state_routing.html#aa33c276e3e041c1b357a2b8542f1ab5f">peerIfAddrs</a>.begin(), <a class="code" href="class_link_state_routing.html#aa33c276e3e041c1b357a2b8542f1ab5f">peerIfAddrs</a>.end(), <a class="code" href="class_link_state_routing.html#ab491ddada5bdd6864e72e5b86f883b39">tedmod</a>-&gt;<a class="code" href="class_t_e_d.html#a8ab5c356644784262be0ae484395441e">ted</a>[i].local) == <a class="code" href="class_link_state_routing.html#aa33c276e3e041c1b357a2b8542f1ab5f">peerIfAddrs</a>.end())
            <span class="keywordflow">continue</span>;

        <span class="comment">// send a copy</span>
        <a class="code" href="class_link_state_routing.html#a76bb6a317013baecf987bcfafa1aec90">sendToPeer</a>(<a class="code" href="class_link_state_routing.html#ab491ddada5bdd6864e72e5b86f883b39">tedmod</a>-&gt;<a class="code" href="class_t_e_d.html#a8ab5c356644784262be0ae484395441e">ted</a>[i].linkid, list, req);
    }
}
</pre></div>
</div>
</div>
<hr/><h2>Member Data Documentation</h2>
<a class="anchor" id="a039b54b4e936d3c3279e3f67ef996b80"></a><!-- doxytag: member="LinkStateRouting::announceMsg" ref="a039b54b4e936d3c3279e3f67ef996b80" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">cMessage* <a class="el" href="class_link_state_routing.html#a039b54b4e936d3c3279e3f67ef996b80">LinkStateRouting::announceMsg</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="class_link_state_routing.html#adcd65572bd812c97222dfd25dc9de1a9">handleMessage()</a>, <a class="el" href="class_link_state_routing.html#a0271766286d9fb98a38ee53c6eee8be3">initialize()</a>, <a class="el" href="class_link_state_routing.html#aeb64ae785f533259fd8da162400b2ad7">LinkStateRouting()</a>, and <a class="el" href="class_link_state_routing.html#ae5d2a91a4ec28e5f75a17a1de6804716">~LinkStateRouting()</a>.</p>

</div>
</div>
<a class="anchor" id="aa33c276e3e041c1b357a2b8542f1ab5f"></a><!-- doxytag: member="LinkStateRouting::peerIfAddrs" ref="aa33c276e3e041c1b357a2b8542f1ab5f" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">IPAddressVector <a class="el" href="class_link_state_routing.html#aa33c276e3e041c1b357a2b8542f1ab5f">LinkStateRouting::peerIfAddrs</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="class_link_state_routing.html#a0271766286d9fb98a38ee53c6eee8be3">initialize()</a>, and <a class="el" href="class_link_state_routing.html#abe98db23137657d430814f3dbaadfe91">sendToPeers()</a>.</p>

</div>
</div>
<a class="anchor" id="ad5deb130d86431a6aafd04836f9f7fd6"></a><!-- doxytag: member="LinkStateRouting::routerId" ref="ad5deb130d86431a6aafd04836f9f7fd6" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_i_p_address.html">IPAddress</a> <a class="el" href="class_link_state_routing.html#ad5deb130d86431a6aafd04836f9f7fd6">LinkStateRouting::routerId</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="class_link_state_routing.html#a0271766286d9fb98a38ee53c6eee8be3">initialize()</a>, <a class="el" href="class_link_state_routing.html#a82cb1475d7be4ebdb12e22f4a98e4db5">sendToIP()</a>, and <a class="el" href="class_link_state_routing.html#abe98db23137657d430814f3dbaadfe91">sendToPeers()</a>.</p>

</div>
</div>
<a class="anchor" id="ab491ddada5bdd6864e72e5b86f883b39"></a><!-- doxytag: member="LinkStateRouting::tedmod" ref="ab491ddada5bdd6864e72e5b86f883b39" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_t_e_d.html">TED</a>* <a class="el" href="class_link_state_routing.html#ab491ddada5bdd6864e72e5b86f883b39">LinkStateRouting::tedmod</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="class_link_state_routing.html#adcd65572bd812c97222dfd25dc9de1a9">handleMessage()</a>, <a class="el" href="class_link_state_routing.html#a0271766286d9fb98a38ee53c6eee8be3">initialize()</a>, <a class="el" href="class_link_state_routing.html#a9326b19a88da1ba1af639fe6a820fb36">processLINK_STATE_MESSAGE()</a>, <a class="el" href="class_link_state_routing.html#a4192929ab1fa083342047b67401d3006">receiveChangeNotification()</a>, and <a class="el" href="class_link_state_routing.html#abe98db23137657d430814f3dbaadfe91">sendToPeers()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="_link_state_routing_8h.html">LinkStateRouting.h</a></li>
<li><a class="el" href="_link_state_routing_8cc.html">LinkStateRouting.cc</a></li>
</ul>
</div>
</div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="class_link_state_routing.html">LinkStateRouting</a>      </li>
      <li class="footer">Generated on Fri Nov 18 2011 12:47:14 for INET Framework for OMNeT++/OMNEST by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </li>
    </ul>
  </div>

</body>
</html>
